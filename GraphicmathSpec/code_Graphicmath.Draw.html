<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Graphicmath" rel="Chapter" href="Graphicmath.html"><title>Graphicmath.Draw</title>
</head>
<body>
<code class="code"><span class="keyword">struct</span><br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Introduction"><h1>Introduction</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(**
The mathematician will find in this module methods in order to draw:
<p>
<ul>
<li>function graphs,</li>
</ul>
<ul>
<li>curves and surfaces,</li>
</ul>
<ul>
<li>vector fields,</li>
</ul>
<ul>
<li>frame fields</li>
</ul>

in dimension two and three.
<p>

<span id="2_Comments"><h2>Comments</h2></span>
<p>

The book <code class="code">ocaml-ora-book.pdf</code> available on th web site of Ocaml yields background constructions.
<p>

The site <code class="code">http://www.antigrain.com</code> gives some explanations about the oversampling method for anti-aliasing.
<p>

This module is distributed under the same licence as Ocaml.
<p>

<center>§ </center>
<p>

La mathématicienne ou le mathématicien trouvera dans ce module des méthodes pour dessiner :
<p>
<ul>
<li>graphes de fonctions,</li>
</ul>
<ul>
<li>courbes et surfaces,</li>
</ul>
<ul>
<li>champs de vecteurs,</li>
</ul>
<ul>
<li>champs de repères</li>
</ul>

en dimensions deux et trois.
<p>

<span id="2_Commentaires"><h2>Commentaires</h2></span>
<p>

Le livre <code class="code">ocaml-ora-book.pdf</code> disponible sur le site web d'Ocaml fournit des constructions de base.
<p>

Le site <code class="code">http://www.antigrain.com</code> donne des explications sur le procédé de suréchantillonnnage pour l'antialiassage.
<p>

Ce module est distribué selon la même licence qu'Ocaml.
<p>

<center>Copyright Stéphane Grognet </center>
<center>Laboratoire de mathématiques Jean Leray UMR 6629 CNRS </center>
<center>Fédération de recherche mathématique des Pays de la Loire </center>
<center>IREM des Pays de la Loire - Université de Nantes </center>
<center>version 0.4</center>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@version 0.4
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@author Stéphane Grognet
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@since 2011, 2012, 2013
*)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Outils"><h1>Outils</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Util</span>&nbsp;;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Matrix</span>&nbsp;;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Infinitesimal</span>&nbsp;;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Readwrite</span>&nbsp;;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Data</span>&nbsp;;;<br>
<span class="constructor">Graphics</span>.open_graph&nbsp;<span class="string">""</span>&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Constantes"><h2>Constantes</h2></span>
<span id="2_Constants"><h2>Constants</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>(text_size_h,text_size_v)</pre> Size of the characters.
<p>

Taille des caractères. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;(text_size_h,text_size_v)&nbsp;=&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;<span class="string">"W"</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>tsh</pre> Width of the characters.
<p>

Largeur des caractères. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;tsh&nbsp;=&nbsp;text_size_h&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>tsv</pre> Height of the characters.
<p>

Hauteur des caractères.  *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;tsv&nbsp;=&nbsp;text_size_v&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>color_list</pre> List of the pre-defined colors.
<p>

Liste des couleurs prédéfinies. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;color_list&nbsp;=&nbsp;[|&nbsp;<span class="constructor">Graphics</span>.green&nbsp;;&nbsp;<span class="constructor">Graphics</span>.magenta&nbsp;;&nbsp;<span class="constructor">Graphics</span>.cyan&nbsp;;&nbsp;<span class="constructor">Graphics</span>.blue&nbsp;;&nbsp;<span class="constructor">Graphics</span>.red&nbsp;;&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;;&nbsp;<span class="constructor">Graphics</span>.white&nbsp;;&nbsp;<span class="constructor">Graphics</span>.black&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctions"><h2>Fonctions</h2></span>
<span id="2_Functions"><h2>Functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>color_to_rgb color</pre> color == R * 256 * 256 + G * 256 + B *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;color_to_rgb&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(c:<span class="constructor">Graphics</span>.color)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;c&nbsp;/&nbsp;65536&nbsp;<span class="keyword">and</span>&nbsp;g&nbsp;=&nbsp;c&nbsp;/&nbsp;256&nbsp;<span class="keyword">mod</span>&nbsp;256&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;c&nbsp;<span class="keyword">mod</span>&nbsp;256&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;[|&nbsp;r&nbsp;;&nbsp;g&nbsp;;&nbsp;b&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>inv_color color</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;inv_color&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(c:<span class="constructor">Graphics</span>.color)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;color_to_rgb&nbsp;c&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.rgb&nbsp;(&nbsp;255&nbsp;-&nbsp;z.(0)&nbsp;)&nbsp;(&nbsp;255&nbsp;-&nbsp;z.(1)&nbsp;)&nbsp;(&nbsp;255&nbsp;-&nbsp;z.(2)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>mix_color coefficient color1 color2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;mix_color&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:float)&nbsp;(c1:<span class="constructor">Graphics</span>.color)&nbsp;(c2:<span class="constructor">Graphics</span>.color)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;color_to_rgb&nbsp;c1<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;color_to_rgb&nbsp;c2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;1.&nbsp;-.&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_of_vector&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zzzz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;x&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_of_vector&nbsp;zz&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z_z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.int_of_vector&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zzz&nbsp;zzzz&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.rgb&nbsp;z_z.(0)&nbsp;z_z.(1)&nbsp;z_z.(2)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>bias_color color_bias color</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;bias_color&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(c1:<span class="constructor">Graphics</span>.color)&nbsp;(c2:<span class="constructor">Graphics</span>.color)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;color_to_rgb&nbsp;c1<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;color_to_rgb&nbsp;c2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.rgb&nbsp;(&nbsp;(&nbsp;z.(0)&nbsp;+&nbsp;11&nbsp;*&nbsp;zz.(0)&nbsp;)&nbsp;/&nbsp;12&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(1)&nbsp;+&nbsp;11&nbsp;*&nbsp;zz.(1)&nbsp;)&nbsp;/&nbsp;12&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(2)&nbsp;+&nbsp;11&nbsp;*&nbsp;z.(2)&nbsp;)&nbsp;/&nbsp;12&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>soft_color color</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;soft_color&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(c:<span class="constructor">Graphics</span>.color)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;color_to_rgb&nbsp;c&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.rgb&nbsp;(&nbsp;6&nbsp;*&nbsp;z.(0)&nbsp;/10&nbsp;)&nbsp;(&nbsp;6&nbsp;*&nbsp;z.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;6&nbsp;*&nbsp;z.(2)&nbsp;/&nbsp;10&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>inv_color_vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;inv_color_vector&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;inv_color&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>inv_color_matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;inv_color_matrix&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;inv_color_vector&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>arrow paint x y u v</pre> An arrow is formed of four segments. The function <code class="code">paint</code> is supposed to draw a segment.
<p>

Une flèche est constituée de quatre segments. La fonction <code class="code">paint</code> est censée dessiner un segment. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;arrow&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(x:int)&nbsp;(y:int)&nbsp;(u:int)&nbsp;(v:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;x&nbsp;+&nbsp;u<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;y&nbsp;+&nbsp;v<br>
&nbsp;<span class="keyword">and</span>&nbsp;su&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.int_sign&nbsp;u<br>
&nbsp;<span class="keyword">and</span>&nbsp;sv&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.int_sign&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;uu&nbsp;=&nbsp;-&nbsp;(&nbsp;sv&nbsp;+&nbsp;v&nbsp;/&nbsp;20&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vv&nbsp;=&nbsp;su&nbsp;+&nbsp;u&nbsp;/&nbsp;20<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;uuu&nbsp;=&nbsp;su&nbsp;+&nbsp;u&nbsp;/&nbsp;10<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vvv&nbsp;=&nbsp;sv&nbsp;+&nbsp;v&nbsp;/&nbsp;10&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x_x&nbsp;=&nbsp;x&nbsp;+&nbsp;uu<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_y&nbsp;=&nbsp;y&nbsp;+&nbsp;vv<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_xx&nbsp;=&nbsp;x&nbsp;-&nbsp;uu<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_yy&nbsp;=&nbsp;y&nbsp;-&nbsp;vv<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xxx&nbsp;=&nbsp;xx&nbsp;+&nbsp;uu&nbsp;-&nbsp;uuu<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yyy&nbsp;=&nbsp;yy&nbsp;+&nbsp;vv&nbsp;&nbsp;-&nbsp;vvv<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xxxx&nbsp;=&nbsp;xx&nbsp;-&nbsp;uu&nbsp;-&nbsp;uuu<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yyyy&nbsp;=&nbsp;yy&nbsp;-&nbsp;vv&nbsp;-&nbsp;vvv&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;[|&nbsp;(x,y,xx,yy)&nbsp;;&nbsp;(x_x,y_y,x_xx,y_yy)&nbsp;;&nbsp;(xx,yy,xxx,yyy)&nbsp;;&nbsp;(xx,yy,xxxx,yyyy)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;3&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;old_x&nbsp;,&nbsp;old_y&nbsp;,&nbsp;new_x&nbsp;,&nbsp;new_y&nbsp;)&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;old_x&nbsp;old_y&nbsp;new_x&nbsp;new_y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>box3 frame_coordinates</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;box_3&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(coordinates:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;c0&nbsp;=&nbsp;[|&nbsp;[|&nbsp;coordinates.(0)&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;coordinates.(1)&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;coordinates.(2)&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;coordinates.(3)&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;coordinates.(4)&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;coordinates.(5)&nbsp;|]&nbsp;|]<br>
&nbsp;<span class="keyword">and</span>&nbsp;c1&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;;&nbsp;coordinates.(2)&nbsp;;&nbsp;coordinates.(4)&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;coordinates.(3)&nbsp;;&nbsp;coordinates.(4)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;coordinates.(2)&nbsp;;&nbsp;coordinates.(5)&nbsp;|]&nbsp;;&nbsp;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;coordinates.(3)&nbsp;;&nbsp;coordinates.(5)&nbsp;|]&nbsp;|]<br>
&nbsp;<span class="keyword">and</span>&nbsp;c2&nbsp;=&nbsp;[|&nbsp;[|&nbsp;coordinates.(0)&nbsp;;&nbsp;0.&nbsp;;&nbsp;coordinates.(4)&nbsp;|]&nbsp;;&nbsp;[|&nbsp;coordinates.(0)&nbsp;;&nbsp;0.&nbsp;;&nbsp;coordinates.(5)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;[|&nbsp;coordinates.(1)&nbsp;;&nbsp;0.&nbsp;;&nbsp;coordinates.(4)&nbsp;|]&nbsp;;&nbsp;[|&nbsp;coordinates.(1)&nbsp;;&nbsp;0.&nbsp;;&nbsp;coordinates.(5)&nbsp;|]&nbsp;|]<br>
&nbsp;<span class="keyword">and</span>&nbsp;c3&nbsp;=&nbsp;[|&nbsp;[|&nbsp;coordinates.(0)&nbsp;;&nbsp;coordinates.(2)&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;coordinates.(0)&nbsp;;&nbsp;coordinates.(3)&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;[|&nbsp;coordinates.(1)&nbsp;;&nbsp;coordinates.(2)&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;coordinates.(1)&nbsp;;&nbsp;0.&nbsp;;&nbsp;coordinates.(3)&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]<br>
&nbsp;<span class="keyword">and</span>&nbsp;c4&nbsp;=&nbsp;[|&nbsp;[|&nbsp;coordinates.(0)&nbsp;;&nbsp;coordinates.(2)&nbsp;;&nbsp;coordinates.(4)&nbsp;|]&nbsp;;&nbsp;[|&nbsp;coordinates.(0)&nbsp;;&nbsp;coordinates.(2)&nbsp;;&nbsp;coordinates.(5)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;[|&nbsp;coordinates.(0)&nbsp;;&nbsp;coordinates.(3)&nbsp;;&nbsp;coordinates.(4)&nbsp;|]&nbsp;;&nbsp;[|&nbsp;coordinates.(0)&nbsp;;&nbsp;coordinates.(3)&nbsp;;&nbsp;coordinates.(5)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;[|&nbsp;coordinates.(1)&nbsp;;&nbsp;coordinates.(2)&nbsp;;&nbsp;coordinates.(4)&nbsp;|]&nbsp;;&nbsp;[|&nbsp;coordinates.(1)&nbsp;;&nbsp;coordinates.(2)&nbsp;;&nbsp;coordinates.(5)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;[|&nbsp;coordinates.(1)&nbsp;;&nbsp;coordinates.(3)&nbsp;;&nbsp;coordinates.(4)&nbsp;|]&nbsp;;&nbsp;[|&nbsp;coordinates.(1)&nbsp;;&nbsp;coordinates.(3)&nbsp;;&nbsp;coordinates.(5)&nbsp;|]&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c5&nbsp;=&nbsp;<span class="constructor">Array</span>.append&nbsp;c0&nbsp;c1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c6&nbsp;=&nbsp;<span class="constructor">Array</span>.append&nbsp;c2&nbsp;c3&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c7&nbsp;=&nbsp;<span class="constructor">Array</span>.append&nbsp;c5&nbsp;c6&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.append&nbsp;c7&nbsp;c4&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>box_proj_3_2 vector frame_coordinates</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;box_proj_3_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_chose_3&nbsp;u<br>
&nbsp;<span class="keyword">and</span>&nbsp;eee&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;u<br>
&nbsp;<span class="keyword">and</span>&nbsp;coord&nbsp;=&nbsp;box_3&nbsp;coordinates&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;m.(1)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;m.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coord0&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;v&nbsp;)&nbsp;coord<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coord1&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;w&nbsp;)&nbsp;coord&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;eee&nbsp;*.&nbsp;<span class="constructor">Matrix</span>.vector_float_min&nbsp;coord0&nbsp;;&nbsp;eee&nbsp;*.&nbsp;<span class="constructor">Matrix</span>.vector_float_max&nbsp;coord0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eee&nbsp;*.&nbsp;<span class="constructor">Matrix</span>.vector_float_min&nbsp;coord1&nbsp;;&nbsp;eee&nbsp;*.&nbsp;<span class="constructor">Matrix</span>.vector_float_max&nbsp;coord1&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;11&nbsp;(0,0,0,0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;11&nbsp;(0,0,0,0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;11&nbsp;(0,0,0,0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;11&nbsp;(0,0,0,0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_real&nbsp;=&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_scale&nbsp;=&nbsp;h_real&nbsp;/.&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hh&nbsp;=&nbsp;h_margin&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vv&nbsp;=&nbsp;v_margin&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;max_stringsize&nbsp;=&nbsp;h_margin&nbsp;/&nbsp;(&nbsp;5&nbsp;+&nbsp;tsh&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coupe&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;s&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">String</span>.sub&nbsp;s&nbsp;0&nbsp;(min&nbsp;max_stringsize&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;s&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_scale&nbsp;=&nbsp;1.&nbsp;/.&nbsp;v_inv_scale<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hhh&nbsp;=&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;hh<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h_h&nbsp;=&nbsp;size.(0)&nbsp;-&nbsp;hh<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vvv&nbsp;=&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;vv<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_v&nbsp;=&nbsp;size.(1)&nbsp;-&nbsp;vv<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;coordinates.(0)&nbsp;+.&nbsp;h_scale&nbsp;*.&nbsp;z&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;coordinates.(2)&nbsp;+.&nbsp;v_scale&nbsp;*.&nbsp;z&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_rect&nbsp;hh&nbsp;vv&nbsp;hhh&nbsp;vvv&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;10&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;j&nbsp;=&nbsp;i&nbsp;*&nbsp;(&nbsp;hhh&nbsp;/&nbsp;10&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;jj&nbsp;=&nbsp;i&nbsp;*&nbsp;(&nbsp;vvv&nbsp;/&nbsp;10&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k&nbsp;=&nbsp;1&nbsp;+&nbsp;hh&nbsp;+&nbsp;j<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;kk&nbsp;=&nbsp;1&nbsp;+&nbsp;vv&nbsp;+&nbsp;jj&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.(i)&nbsp;&lt;-&nbsp;(&nbsp;k&nbsp;,&nbsp;vv&nbsp;-&nbsp;4&nbsp;,&nbsp;k&nbsp;,&nbsp;v_v&nbsp;+&nbsp;4&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.(i)&nbsp;&lt;-&nbsp;(&nbsp;k&nbsp;,&nbsp;v_v&nbsp;,&nbsp;k&nbsp;,&nbsp;v_v&nbsp;+&nbsp;4&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;(&nbsp;hh&nbsp;-&nbsp;4&nbsp;,&nbsp;kk&nbsp;,&nbsp;h_h&nbsp;+&nbsp;4&nbsp;,&nbsp;kk&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.(i)&nbsp;&lt;-&nbsp;(&nbsp;h_h&nbsp;,&nbsp;kk&nbsp;,&nbsp;h_h&nbsp;+&nbsp;4&nbsp;,&nbsp;kk&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;(&nbsp;x_function&nbsp;(&nbsp;float&nbsp;j&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;k&nbsp;(&nbsp;vv&nbsp;/&nbsp;3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;coupe&nbsp;chaine&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;k&nbsp;(&nbsp;v_v&nbsp;+&nbsp;vv&nbsp;/&nbsp;3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;coupe&nbsp;chaine&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;(&nbsp;v_function&nbsp;(&nbsp;float&nbsp;jj&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;hh&nbsp;/&nbsp;7&nbsp;)&nbsp;kk&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;coupe&nbsp;chaine&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;h_h&nbsp;+&nbsp;hh&nbsp;/&nbsp;7&nbsp;)&nbsp;kk&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;coupe&nbsp;chaine&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;,&nbsp;c&nbsp;,&nbsp;d&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>restricted_frame frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;restricted_frame&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;11&nbsp;(0,0,0,0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;11&nbsp;(0,0,0,0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_real&nbsp;=&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_scale&nbsp;=&nbsp;h_real&nbsp;/.&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hh&nbsp;=&nbsp;h_margin&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vv&nbsp;=&nbsp;v_margin&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;max_stringsize&nbsp;=&nbsp;h_margin&nbsp;/&nbsp;(&nbsp;5&nbsp;+&nbsp;tsh&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coupe&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;s&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">String</span>.sub&nbsp;s&nbsp;0&nbsp;(min&nbsp;max_stringsize&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;s&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_scale&nbsp;=&nbsp;1.&nbsp;/.&nbsp;v_inv_scale<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hhh&nbsp;=&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;hh<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h_h&nbsp;=&nbsp;size.(0)&nbsp;-&nbsp;hh<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vvv&nbsp;=&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;vv<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_v&nbsp;=&nbsp;size.(1)&nbsp;-&nbsp;vv<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;coordinates.(0)&nbsp;+.&nbsp;h_scale&nbsp;*.&nbsp;z&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;coordinates.(2)&nbsp;+.&nbsp;v_scale&nbsp;*.&nbsp;z&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_rect&nbsp;hh&nbsp;vv&nbsp;hhh&nbsp;vvv&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;10&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;j&nbsp;=&nbsp;i&nbsp;*&nbsp;(&nbsp;hhh&nbsp;/&nbsp;10&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;jj&nbsp;=&nbsp;i&nbsp;*&nbsp;(&nbsp;vvv&nbsp;/&nbsp;10&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k&nbsp;=&nbsp;1&nbsp;+&nbsp;hh&nbsp;+&nbsp;j<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;kk&nbsp;=&nbsp;1&nbsp;+&nbsp;vv&nbsp;+&nbsp;jj&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.(i)&nbsp;&lt;-&nbsp;(&nbsp;k&nbsp;,&nbsp;vv&nbsp;-&nbsp;4&nbsp;,&nbsp;k&nbsp;,&nbsp;v_v&nbsp;+&nbsp;4&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;(&nbsp;hh&nbsp;-&nbsp;4&nbsp;,&nbsp;kk&nbsp;,&nbsp;h_h&nbsp;+&nbsp;4&nbsp;,&nbsp;kk&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;(&nbsp;x_function&nbsp;(&nbsp;float&nbsp;j&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;k&nbsp;(&nbsp;vv&nbsp;/&nbsp;3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;coupe&nbsp;chaine&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;k&nbsp;(&nbsp;v_v&nbsp;+&nbsp;vv&nbsp;/&nbsp;3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;coupe&nbsp;chaine&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;(&nbsp;v_function&nbsp;(&nbsp;float&nbsp;jj&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;hh&nbsp;/&nbsp;7&nbsp;)&nbsp;kk&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;coupe&nbsp;chaine&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;h_h&nbsp;+&nbsp;hh&nbsp;/&nbsp;7&nbsp;)&nbsp;kk&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;coupe&nbsp;chaine&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>grid coordinates size hh vv</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;grid&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;(hh:int)&nbsp;(vv:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;,&nbsp;c&nbsp;,&nbsp;d&nbsp;)&nbsp;=&nbsp;frame&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.red&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;a&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;c&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.white&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;coordinates.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;hh&nbsp;/&nbsp;3&nbsp;)&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;coordinates.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;(&nbsp;tsh&nbsp;*&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;chaine&nbsp;)&nbsp;+&nbsp;3&nbsp;)&nbsp;)&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;coordinates.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;3&nbsp;(&nbsp;2&nbsp;*&nbsp;vv&nbsp;/&nbsp;3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;coordinates.(3)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;3&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;vv&nbsp;/&nbsp;3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>paint_coordinates coordinates size hh vv</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;paint_coordinates&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;(hh:int)&nbsp;(vv:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;restricted_frame&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.white&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;coordinates.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;hh&nbsp;/&nbsp;3&nbsp;)&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;coordinates.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;(&nbsp;tsh&nbsp;*&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;chaine&nbsp;)&nbsp;+&nbsp;3&nbsp;)&nbsp;)&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;coordinates.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;3&nbsp;(&nbsp;2&nbsp;*&nbsp;vv&nbsp;/&nbsp;3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;coordinates.(3)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;3&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;vv&nbsp;/&nbsp;3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>prepare_1_1 coordinates size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;prepare_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_size&nbsp;=&nbsp;string_of_int&nbsp;size.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_size&nbsp;=&nbsp;string_of_int&nbsp;size.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_real&nbsp;=&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_scale&nbsp;=&nbsp;h_real&nbsp;/.&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hh&nbsp;=&nbsp;h_margin&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vv&nbsp;=&nbsp;v_margin&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;coordinates.(0)&nbsp;+.&nbsp;h_scale&nbsp;*.&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;v_inv_scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.open_graph&nbsp;(&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;h_size&nbsp;^&nbsp;<span class="string">"x"</span>&nbsp;^&nbsp;v_size&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.black&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_rect&nbsp;0&nbsp;0&nbsp;size.(0)&nbsp;size.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>prep_1_1 coordinates size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;prep_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_size&nbsp;=&nbsp;string_of_int&nbsp;size.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_size&nbsp;=&nbsp;string_of_int&nbsp;size.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;hh&nbsp;=&nbsp;h_margin&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vv&nbsp;=&nbsp;v_margin&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.open_graph&nbsp;(&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;h_size&nbsp;^&nbsp;<span class="string">"x"</span>&nbsp;^&nbsp;v_size&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.black&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_rect&nbsp;0&nbsp;0&nbsp;size.(0)&nbsp;size.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>prepare_1_2 nsteps coordinates size interval</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;prepare_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_size&nbsp;=&nbsp;string_of_int&nbsp;size.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_size&nbsp;=&nbsp;string_of_int&nbsp;size.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_real&nbsp;=&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;h_real<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;t_scale&nbsp;=&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hh&nbsp;=&nbsp;h_margin&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vv&nbsp;=&nbsp;v_margin&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;interval.(0)&nbsp;+.&nbsp;t_scale&nbsp;*.&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;v_inv_scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.open_graph&nbsp;(&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;h_size&nbsp;^&nbsp;<span class="string">"x"</span>&nbsp;^&nbsp;v_size&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.black&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_rect&nbsp;0&nbsp;0&nbsp;size.(0)&nbsp;size.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;t_function&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>prepare_field_1_2 nsteps coordinates size interval</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;prepare_field_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_size&nbsp;=&nbsp;string_of_int&nbsp;size.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_size&nbsp;=&nbsp;string_of_int&nbsp;size.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_real&nbsp;=&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;h_real<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;t_scale&nbsp;=&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hh&nbsp;=&nbsp;h_margin&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vv&nbsp;=&nbsp;v_margin&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;interval.(0)&nbsp;+.&nbsp;t_scale&nbsp;*.&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;v_inv_scale&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vx_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vy_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;*.&nbsp;v_inv_scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.open_graph&nbsp;(&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;h_size&nbsp;^&nbsp;<span class="string">"x"</span>&nbsp;^&nbsp;v_size&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.black&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_rect&nbsp;0&nbsp;0&nbsp;size.(0)&nbsp;size.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;t_function&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;,&nbsp;vx_function&nbsp;,&nbsp;vy_function&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>prepare_section_2_2 section half_ngrid coordinates size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;prepare_section_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;array<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ngrid&nbsp;=&nbsp;2&nbsp;*&nbsp;half_ngrid<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;(&nbsp;f&nbsp;[|&nbsp;coordinates.(0)&nbsp;;&nbsp;coordinates.(2)&nbsp;|]&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_size&nbsp;=&nbsp;string_of_int&nbsp;size.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_size&nbsp;=&nbsp;string_of_int&nbsp;size.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_real&nbsp;=&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_factor&nbsp;=&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;/&nbsp;ngrid<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_factor&nbsp;=&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;/&nbsp;ngrid<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;h_real<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hh&nbsp;=&nbsp;h_margin&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vv&nbsp;=&nbsp;v_margin&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_scale&nbsp;=&nbsp;h_real&nbsp;/.&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_scale&nbsp;=&nbsp;v_real&nbsp;/.&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hhh&nbsp;=&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;hh<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h_h&nbsp;=&nbsp;size.(0)&nbsp;-&nbsp;hh<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vvv&nbsp;=&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;vv<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_v&nbsp;=&nbsp;size.(1)&nbsp;-&nbsp;vv&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x_function&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;i&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;*.&nbsp;h_real&nbsp;/.&nbsp;(&nbsp;float&nbsp;ngrid&nbsp;)&nbsp;+.&nbsp;coordinates.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_function&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;i&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;*.&nbsp;v_real&nbsp;/.&nbsp;(&nbsp;float&nbsp;ngrid&nbsp;)&nbsp;+.&nbsp;coordinates.(2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vx_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vy_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;*.&nbsp;v_inv_scale&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;coordinates.(0)&nbsp;+.&nbsp;h_scale&nbsp;*.&nbsp;z&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;coordinates.(2)&nbsp;+.&nbsp;v_scale&nbsp;*.&nbsp;z&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;r&nbsp;,&nbsp;ngrid&nbsp;,&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;hhh&nbsp;,&nbsp;vvv&nbsp;,&nbsp;h_h&nbsp;,&nbsp;v_v&nbsp;,&nbsp;h_size&nbsp;,&nbsp;v_size&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;h_factor&nbsp;,&nbsp;v_factor&nbsp;,&nbsp;h_function&nbsp;,&nbsp;v_function&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;,&nbsp;vx_function&nbsp;,&nbsp;vy_function&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>init_section_2_2 hh vv hhh vvv h_size v_size size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;init_section_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(hh:int)&nbsp;(vv:int)&nbsp;(hhh:int)&nbsp;(vvv:int)&nbsp;h_size&nbsp;v_size&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;<br>
&nbsp;<span class="constructor">Graphics</span>.open_graph&nbsp;(&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;h_size&nbsp;^&nbsp;<span class="string">"x"</span>&nbsp;^&nbsp;v_size&nbsp;)&nbsp;;<br>
&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.black&nbsp;;<br>
&nbsp;<span class="constructor">Graphics</span>.fill_rect&nbsp;0&nbsp;0&nbsp;size.(0)&nbsp;size.(1)&nbsp;;<br>
&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;;<br>
&nbsp;<span class="constructor">Graphics</span>.draw_rect&nbsp;hh&nbsp;vv&nbsp;hhh&nbsp;vvv&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>terminate_section_2_2 hh vv hhh vvv h_h v_v h_margin v_margin h_function v_function coordinates size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;terminate_section_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(hh:int)&nbsp;(vv:int)&nbsp;(hhh:int)&nbsp;(vvv:int)&nbsp;(h_h:int)&nbsp;(v_v:int)&nbsp;(h_margin:int)&nbsp;(v_margin:int)&nbsp;h_function&nbsp;v_function&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;aa&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;11&nbsp;(0,0,0,0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;11&nbsp;(0,0,0,0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;11&nbsp;(0,0,0,0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;11&nbsp;(0,0,0,0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;max_stringsize&nbsp;=&nbsp;h_margin&nbsp;/&nbsp;(&nbsp;5&nbsp;+&nbsp;tsh&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coupe&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;s&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">String</span>.sub&nbsp;s&nbsp;0&nbsp;(min&nbsp;max_stringsize&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;s&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;10&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;j&nbsp;=&nbsp;i&nbsp;*&nbsp;(&nbsp;hhh&nbsp;/&nbsp;10&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;jj&nbsp;=&nbsp;i&nbsp;*&nbsp;(&nbsp;vvv&nbsp;/&nbsp;10&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k&nbsp;=&nbsp;1&nbsp;+&nbsp;hh&nbsp;+&nbsp;j<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;kk&nbsp;=&nbsp;1&nbsp;+&nbsp;vv&nbsp;+&nbsp;jj&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aa.(i)&nbsp;&lt;-&nbsp;(&nbsp;k&nbsp;,&nbsp;vv&nbsp;,&nbsp;k&nbsp;,&nbsp;vv&nbsp;-&nbsp;4&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;(&nbsp;k&nbsp;,&nbsp;v_v&nbsp;,&nbsp;k&nbsp;,&nbsp;v_v&nbsp;+&nbsp;4&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cc.(i)&nbsp;&lt;-&nbsp;(&nbsp;hh&nbsp;-&nbsp;4&nbsp;,&nbsp;kk&nbsp;,&nbsp;hh&nbsp;,&nbsp;kk&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dd.(i)&nbsp;&lt;-&nbsp;(&nbsp;h_h&nbsp;,&nbsp;kk&nbsp;,&nbsp;h_h&nbsp;+&nbsp;4&nbsp;,&nbsp;kk&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;(&nbsp;h_function&nbsp;(&nbsp;float&nbsp;j&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;k&nbsp;(&nbsp;vv&nbsp;/&nbsp;3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;coupe&nbsp;chaine&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;k&nbsp;(&nbsp;v_v&nbsp;+&nbsp;vv&nbsp;/&nbsp;3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;coupe&nbsp;chaine&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;(&nbsp;v_function&nbsp;(&nbsp;float&nbsp;jj&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;hh&nbsp;/&nbsp;7&nbsp;)&nbsp;kk&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;coupe&nbsp;chaine&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;h_h&nbsp;+&nbsp;hh&nbsp;/&nbsp;7&nbsp;)&nbsp;kk&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;coupe&nbsp;chaine&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;aa&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;bb&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;cc&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;dd&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.white&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;coordinates.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;hh&nbsp;/&nbsp;3&nbsp;)&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;coordinates.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;(&nbsp;tsh&nbsp;*&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;chaine&nbsp;)&nbsp;+&nbsp;3&nbsp;)&nbsp;)&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;coordinates.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;3&nbsp;(&nbsp;2&nbsp;*&nbsp;vv&nbsp;/&nbsp;3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;string_of_float&nbsp;coordinates.(3)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;3&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;vv&nbsp;/&nbsp;3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>prepare_1_3 u interval nsteps coordinates size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;prepare_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_size&nbsp;=&nbsp;string_of_int&nbsp;size.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_size&nbsp;=&nbsp;string_of_int&nbsp;size.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;6&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;interval.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;a&nbsp;=&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.open_graph&nbsp;(&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;h_size&nbsp;^&nbsp;<span class="string">"x"</span>&nbsp;^&nbsp;v_size&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.black&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_rect&nbsp;0&nbsp;0&nbsp;size.(0)&nbsp;size.(1)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_chose_3&nbsp;u&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;hh&nbsp;=&nbsp;h_margin&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v&nbsp;=&nbsp;m.(1)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;m.(2)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coo&nbsp;=&nbsp;box_proj_3_2&nbsp;u&nbsp;coordinates&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;,&nbsp;accu&nbsp;,&nbsp;hh&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;coo&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>project_1_3 accu a b u v w nsteps coordinates coo</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;project_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(accu:float&nbsp;array)&nbsp;(a:float)&nbsp;(b:float)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array)&nbsp;(w:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(coo:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accumul&nbsp;=&nbsp;ref&nbsp;b&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;(&nbsp;f&nbsp;t&nbsp;)&nbsp;v&nbsp;;&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;(&nbsp;f&nbsp;t&nbsp;)&nbsp;w&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;value&nbsp;=&nbsp;f&nbsp;(&nbsp;!accumul&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;min&nbsp;accu.(0)&nbsp;value.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;max&nbsp;accu.(1)&nbsp;value.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(2)&nbsp;&lt;-&nbsp;min&nbsp;accu.(2)&nbsp;value.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(3)&nbsp;&lt;-&nbsp;max&nbsp;accu.(3)&nbsp;value.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(4)&nbsp;&lt;-&nbsp;min&nbsp;accu.(4)&nbsp;value.(2)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(5)&nbsp;&lt;-&nbsp;max&nbsp;accu.(5)&nbsp;value.(2)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumul&nbsp;:=&nbsp;!accumul&nbsp;+.&nbsp;a&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;g&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>multi_project_1_3 accu a b u v w nsteps coordinates coo</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;multi_project_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(accu:float&nbsp;array)&nbsp;(a:float)&nbsp;(b:float)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array)&nbsp;(w:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(coo:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accumul&nbsp;=&nbsp;ref&nbsp;b<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;(&nbsp;f&nbsp;a&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">assert</span>&nbsp;(&nbsp;r&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;==&nbsp;0&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;rrr&nbsp;=&nbsp;(&nbsp;r&nbsp;/&nbsp;3&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;rr&nbsp;=&nbsp;2&nbsp;*&nbsp;rrr<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r_r&nbsp;=&nbsp;pred&nbsp;rrr&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;result&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;rr&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;px&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;v<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;py&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;w<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;value&nbsp;=&nbsp;f&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r_r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ii&nbsp;=&nbsp;2&nbsp;*&nbsp;i<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;i_i&nbsp;=&nbsp;3&nbsp;*&nbsp;i&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;slice&nbsp;=&nbsp;<span class="constructor">Array</span>.sub&nbsp;value&nbsp;i_i&nbsp;3&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.(ii)&nbsp;&lt;-&nbsp;px&nbsp;slice&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.(&nbsp;succ&nbsp;ii&nbsp;)&nbsp;&lt;-&nbsp;py&nbsp;slice&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;value&nbsp;=&nbsp;f&nbsp;(&nbsp;!accumul&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;min&nbsp;accu.(0)&nbsp;value.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;max&nbsp;accu.(1)&nbsp;value.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(2)&nbsp;&lt;-&nbsp;min&nbsp;accu.(2)&nbsp;value.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(3)&nbsp;&lt;-&nbsp;max&nbsp;accu.(3)&nbsp;value.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(4)&nbsp;&lt;-&nbsp;min&nbsp;accu.(4)&nbsp;value.(2)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(5)&nbsp;&lt;-&nbsp;max&nbsp;accu.(5)&nbsp;value.(2)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumul&nbsp;:=&nbsp;!accumul&nbsp;+.&nbsp;a&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>terminate_1_3 accu hh</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;terminate_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(accu:float&nbsp;array)&nbsp;(hh:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;chaine&nbsp;=&nbsp;<span class="constructor">Matrix</span>.string_of_vector_float&nbsp;accu&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;hh&nbsp;/&nbsp;3&nbsp;)&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;chaine&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>prepare_2_3 u interval nsteps coordinates size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;prepare_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_size&nbsp;=&nbsp;string_of_int&nbsp;size.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_size&nbsp;=&nbsp;string_of_int&nbsp;size.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_closed_equal_subdivision&nbsp;a.(0)&nbsp;ngrid&nbsp;b.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_closed_equal_subdivision&nbsp;a.(1)&nbsp;ngrid&nbsp;b.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;a.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;bbb&nbsp;=&nbsp;a.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;aa&nbsp;=&nbsp;(&nbsp;b.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;aaa&nbsp;=&nbsp;(&nbsp;b.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.open_graph&nbsp;(&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;h_size&nbsp;^&nbsp;<span class="string">"x"</span>&nbsp;^&nbsp;v_size&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.black&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_rect&nbsp;0&nbsp;0&nbsp;size.(0)&nbsp;size.(1)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;hh&nbsp;=&nbsp;h_margin&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;aa&nbsp;,&nbsp;aaa&nbsp;,&nbsp;bb&nbsp;,&nbsp;bbb&nbsp;,&nbsp;hh&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>prepare_section_3_3 vector section half_ngrid coordinates size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;prepare_section_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_size&nbsp;=&nbsp;string_of_int&nbsp;size.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_size&nbsp;=&nbsp;string_of_int&nbsp;size.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_middle&nbsp;=&nbsp;size.(0)&nbsp;/&nbsp;2<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_middle&nbsp;=&nbsp;size.(1)&nbsp;/&nbsp;2<br>
&nbsp;<span class="keyword">and</span>&nbsp;ng&nbsp;=&nbsp;2&nbsp;*&nbsp;half_ngrid<br>
&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;2&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_chose_3&nbsp;u<br>
&nbsp;<span class="keyword">and</span>&nbsp;eee&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;u&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;coord&nbsp;=&nbsp;box_proj_3_2&nbsp;u&nbsp;coordinates&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ngrid&nbsp;=&nbsp;ng&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vv&nbsp;=&nbsp;m.(1)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;m.(2)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h_real&nbsp;=&nbsp;coord.(1)&nbsp;-.&nbsp;coord.(0)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coord.(3)&nbsp;-.&nbsp;coord.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_closed_equal_subdivision&nbsp;coordinates.(0)&nbsp;ngrid&nbsp;coordinates.(1)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_closed_equal_subdivision&nbsp;coordinates.(2)&nbsp;ngrid&nbsp;coordinates.(3)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_closed_equal_subdivision&nbsp;coordinates.(4)&nbsp;ngrid&nbsp;coordinates.(5)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;size.(0)&nbsp;)&nbsp;/.&nbsp;h_real<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;size.(1)&nbsp;)&nbsp;/.&nbsp;v_real<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;eee&nbsp;vv<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;eee&nbsp;ww&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;vx_function&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int_of_float&nbsp;(&nbsp;z&nbsp;*.&nbsp;h_inv_scale&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vy_function&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int_of_float&nbsp;(&nbsp;z&nbsp;*.&nbsp;v_inv_scale&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_function&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int_of_float&nbsp;(&nbsp;z&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;+&nbsp;h_middle<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_function&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int_of_float&nbsp;(&nbsp;z&nbsp;*.&nbsp;v_inv_scale&nbsp;)&nbsp;+&nbsp;v_middle&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;ng&nbsp;,&nbsp;shift&nbsp;,&nbsp;h_size&nbsp;,&nbsp;v_size&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;,&nbsp;zz&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;,&nbsp;vx_function&nbsp;,&nbsp;vy_function&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>init_section_3_3 h_size v_size size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;init_section_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;h_size&nbsp;v_size&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;<br>
&nbsp;<span class="constructor">Graphics</span>.open_graph&nbsp;(&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;h_size&nbsp;^&nbsp;<span class="string">"x"</span>&nbsp;^&nbsp;v_size&nbsp;)&nbsp;;<br>
&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.black&nbsp;;<br>
&nbsp;<span class="constructor">Graphics</span>.fill_rect&nbsp;0&nbsp;0&nbsp;size.(0)&nbsp;size.(1)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>light_rectangle up width height</pre> This function is supposed to draw a segment with integer ends with anti-aliasing.
The boolean <code class="code">up</code> indicates if the segment is oriented SW-NE or in the other case NW-SE.
<p>

Cette fonction sert à dessiner un segment à extrémités entières avec antialiassage. Le booléen <code class="code">up</code> indique si le segment est orienté SO-NE, sinon NO-SE. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;light_rectangle&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(up:bool)&nbsp;(width:int)&nbsp;(height:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;info&nbsp;=&nbsp;[|&nbsp;height&nbsp;;&nbsp;width&nbsp;;&nbsp;0&nbsp;|]<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;float&nbsp;(&nbsp;width&nbsp;-&nbsp;1&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;hh&nbsp;=&nbsp;float&nbsp;(&nbsp;height&nbsp;-&nbsp;1&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;float&nbsp;(&nbsp;width&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;float&nbsp;(&nbsp;height&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;eps&nbsp;=&nbsp;1e-6<br>
&nbsp;<span class="keyword">and</span>&nbsp;p&nbsp;=&nbsp;(&nbsp;float&nbsp;height&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;width&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;rr&nbsp;=&nbsp;pred&nbsp;height&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pinv&nbsp;=&nbsp;1.&nbsp;/.&nbsp;p&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_beginning&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_end&nbsp;=&nbsp;ref&nbsp;pinv<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_left&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_right&nbsp;=&nbsp;ref&nbsp;(&nbsp;min&nbsp;1.&nbsp;pinv&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_left&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_right&nbsp;=&nbsp;ref&nbsp;(&nbsp;min&nbsp;p&nbsp;1.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;luminosity&nbsp;=&nbsp;ref&nbsp;[]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;width&nbsp;,&nbsp;height&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;1&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;luminosity&nbsp;:=&nbsp;(&nbsp;i&nbsp;,&nbsp;0&nbsp;,&nbsp;1.&nbsp;)&nbsp;::&nbsp;!luminosity&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info.(2)&nbsp;&lt;-&nbsp;height&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;1&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;width&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;luminosity&nbsp;:=&nbsp;(&nbsp;0&nbsp;,&nbsp;i&nbsp;,&nbsp;1.&nbsp;)&nbsp;::&nbsp;!luminosity&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info.(2)&nbsp;&lt;-&nbsp;width&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;count&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;up&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;int_of_float&nbsp;(&nbsp;floor&nbsp;!x_beginning&nbsp;)&nbsp;<span class="keyword">to</span>&nbsp;int_of_float&nbsp;(&nbsp;floor&nbsp;(&nbsp;!x_end&nbsp;-.&nbsp;eps&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coeff&nbsp;:=&nbsp;min&nbsp;1.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;[|&nbsp;!x_right&nbsp;-.&nbsp;!x_left&nbsp;;&nbsp;!y_right&nbsp;-.&nbsp;!y_left&nbsp;|]&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;luminosity&nbsp;:=&nbsp;(&nbsp;i&nbsp;,&nbsp;j&nbsp;,&nbsp;!coeff&nbsp;)&nbsp;::&nbsp;!luminosity&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;count&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_left&nbsp;:=&nbsp;min&nbsp;ww&nbsp;!x_right&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y_left&nbsp;:=&nbsp;min&nbsp;hh&nbsp;!y_right&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_right&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_min&nbsp;[|&nbsp;ceil&nbsp;(&nbsp;!x_left&nbsp;+.&nbsp;eps&nbsp;)&nbsp;;&nbsp;!x_left&nbsp;+.&nbsp;pinv&nbsp;;&nbsp;w&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y_right&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_min&nbsp;[|&nbsp;ceil&nbsp;(&nbsp;!y_left&nbsp;+.&nbsp;eps&nbsp;)&nbsp;;&nbsp;!y_left&nbsp;+.&nbsp;p&nbsp;;&nbsp;h&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_right&nbsp;:=&nbsp;min&nbsp;!x_right&nbsp;(&nbsp;!y_right&nbsp;*.&nbsp;pinv&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y_right&nbsp;:=&nbsp;min&nbsp;!y_right&nbsp;(&nbsp;!x_right&nbsp;*.&nbsp;p&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_beginning&nbsp;:=&nbsp;min&nbsp;ww&nbsp;!x_end&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_end&nbsp;:=&nbsp;min&nbsp;w&nbsp;(&nbsp;!x_beginning&nbsp;+.&nbsp;pinv&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;rr&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;int_of_float&nbsp;(&nbsp;floor&nbsp;!x_beginning&nbsp;)&nbsp;<span class="keyword">to</span>&nbsp;int_of_float&nbsp;(&nbsp;floor&nbsp;(&nbsp;!x_end&nbsp;-.&nbsp;eps&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coeff&nbsp;:=&nbsp;min&nbsp;1.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;[|&nbsp;!x_right&nbsp;-.&nbsp;!x_left&nbsp;;&nbsp;!y_right&nbsp;-.&nbsp;!y_left&nbsp;|]&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;luminosity&nbsp;:=&nbsp;(&nbsp;i&nbsp;,&nbsp;j&nbsp;,&nbsp;!coeff&nbsp;)&nbsp;::&nbsp;!luminosity&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;count&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_left&nbsp;:=&nbsp;min&nbsp;ww&nbsp;!x_right&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y_left&nbsp;:=&nbsp;min&nbsp;hh&nbsp;!y_right&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_right&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_min&nbsp;[|&nbsp;ceil&nbsp;(&nbsp;!x_left&nbsp;+.&nbsp;eps&nbsp;)&nbsp;;&nbsp;!x_left&nbsp;+.&nbsp;pinv&nbsp;;&nbsp;w&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y_right&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_min&nbsp;[|&nbsp;ceil&nbsp;(&nbsp;!y_left&nbsp;+.&nbsp;eps&nbsp;)&nbsp;;&nbsp;!y_left&nbsp;+.&nbsp;p&nbsp;;&nbsp;h&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_right&nbsp;:=&nbsp;min&nbsp;!x_right&nbsp;(&nbsp;!y_right&nbsp;*.&nbsp;pinv&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y_right&nbsp;:=&nbsp;min&nbsp;!y_right&nbsp;(&nbsp;!x_right&nbsp;*.&nbsp;p&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_beginning&nbsp;:=&nbsp;min&nbsp;ww&nbsp;!x_end&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_end&nbsp;:=&nbsp;min&nbsp;w&nbsp;(&nbsp;!x_beginning&nbsp;+.&nbsp;pinv&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info.(2)&nbsp;&lt;-&nbsp;!count&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;info&nbsp;,&nbsp;!luminosity&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>enlighten luminosity color</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;enlighten&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;colors&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;float&nbsp;(&nbsp;<span class="constructor">Readwrite</span>.color_to_int_rgb&nbsp;color&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;min&nbsp;255&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;ceil&nbsp;(&nbsp;x&nbsp;*.&nbsp;z&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;result&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;f&nbsp;colors&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.rgb&nbsp;result.(0)&nbsp;result.(1)&nbsp;result.(2)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>power_gamma exponent luminosity</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;power_gamma&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(exponent:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;min&nbsp;1.&nbsp;(&nbsp;max&nbsp;0.&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;(&nbsp;xx&nbsp;**&nbsp;exponent&nbsp;)&nbsp;*.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;(&nbsp;(&nbsp;1.&nbsp;-.&nbsp;xx&nbsp;)&nbsp;**&nbsp;exponent&nbsp;)&nbsp;);;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>draw_smooth_segment gamma color abscissa ordinate abscissa ordinate</pre> 
The segment with integer ends is drawn with anti-aliasing.
<p>

Le segment à extrémités entières est dessiné avec antialiassage.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;draw_smooth_segment&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(old_x:int)&nbsp;(old_y:int)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;x_left&nbsp;,&nbsp;x_right&nbsp;)&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;old_x&nbsp;&lt;=&nbsp;x&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;old_x&nbsp;,&nbsp;x&nbsp;)&nbsp;<span class="keyword">else</span>&nbsp;(&nbsp;x&nbsp;,&nbsp;old_x&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;y_left&nbsp;,&nbsp;y_right&nbsp;)&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;old_y&nbsp;&lt;=&nbsp;y&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;old_y&nbsp;,&nbsp;y&nbsp;)&nbsp;<span class="keyword">else</span>&nbsp;(&nbsp;y&nbsp;,&nbsp;old_y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;width&nbsp;=&nbsp;x_right&nbsp;-&nbsp;x_left<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;height&nbsp;=&nbsp;y_right&nbsp;-&nbsp;y_left<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;up&nbsp;=&nbsp;(&nbsp;x&nbsp;-&nbsp;old_x&nbsp;)&nbsp;*&nbsp;(&nbsp;y&nbsp;-&nbsp;old_y&nbsp;)&nbsp;&gt;=&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;info&nbsp;,&nbsp;luminosity&nbsp;)&nbsp;=&nbsp;light_rectangle&nbsp;up&nbsp;width&nbsp;height&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;remaining&nbsp;=&nbsp;ref&nbsp;luminosity&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;info.(2)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;i&nbsp;,&nbsp;j&nbsp;,&nbsp;coeff&nbsp;)&nbsp;=&nbsp;<span class="constructor">List</span>.hd&nbsp;!remaining&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;(&nbsp;enlighten&nbsp;(&nbsp;gamma&nbsp;coeff&nbsp;)&nbsp;color&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.plot&nbsp;(&nbsp;x_left&nbsp;+&nbsp;j&nbsp;)&nbsp;(&nbsp;y_left&nbsp;+&nbsp;i&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remaining&nbsp;:=&nbsp;<span class="constructor">List</span>.tl&nbsp;!remaining&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.plot&nbsp;old_x&nbsp;old_y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.plot&nbsp;x&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>oversample_paint gamma color h_margin v_margin luminosity_rectangle</pre> 
This function displays pixels of the color <code class="code">color</code> according to the luminosity recorded in the sparse matrix <code class="code">luminosity_rectangle</code>.
<p>

Cette fonction affiche des pixels de couleur <code class="code">color</code> selon la luminosité enregistrée dans la matrice creuse <code class="code">luminosity_rectangle</code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;oversample_paint&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(h_margin:int)&nbsp;(v_margin:int)&nbsp;(luminosity_rectangle:int&nbsp;array&nbsp;*&nbsp;(int&nbsp;*&nbsp;int&nbsp;*&nbsp;float)&nbsp;list)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;info&nbsp;,&nbsp;luminosity&nbsp;)&nbsp;=&nbsp;luminosity_rectangle&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;remaining&nbsp;=&nbsp;ref&nbsp;luminosity&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;info.(2)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;i&nbsp;,&nbsp;j&nbsp;,&nbsp;coeff&nbsp;)&nbsp;=&nbsp;<span class="constructor">List</span>.hd&nbsp;!remaining&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;(&nbsp;enlighten&nbsp;(&nbsp;gamma&nbsp;coeff&nbsp;)&nbsp;color&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.plot&nbsp;(&nbsp;h_margin&nbsp;+&nbsp;j&nbsp;)&nbsp;(&nbsp;v_margin&nbsp;+&nbsp;i&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remaining&nbsp;:=&nbsp;<span class="constructor">List</span>.tl&nbsp;!remaining&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>paint_axes paint_segments color v w extrema</pre> The function <code class="code">paint_segments</code> draws the segments representing the axes.
<p>

La fonction <code class="code">paint_segments</code> dessine les segments représentant les axes. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;paint_axes&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint_segments&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(v:float&nbsp;array)&nbsp;(w:float&nbsp;array)&nbsp;(axes:float&nbsp;array)&nbsp;(coo:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">assert</span>&nbsp;(&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;axes&nbsp;)&nbsp;&gt;=&nbsp;6&nbsp;)&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;h_real&nbsp;=&nbsp;coo.(1)&nbsp;-.&nbsp;coo.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coo.(3)&nbsp;-.&nbsp;coo.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;v&nbsp;x&nbsp;;&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;w&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ax&nbsp;=&nbsp;f&nbsp;[|&nbsp;axes.(0)&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bx&nbsp;=&nbsp;f&nbsp;[|&nbsp;axes.(1)&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ay&nbsp;=&nbsp;f&nbsp;[|&nbsp;0.&nbsp;;&nbsp;axes.(2)&nbsp;;&nbsp;0.&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;by&nbsp;=&nbsp;f&nbsp;[|&nbsp;0.&nbsp;;&nbsp;axes.(3)&nbsp;;&nbsp;0.&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;az&nbsp;=&nbsp;f&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;axes.(4)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bz&nbsp;=&nbsp;f&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;axes.(5)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;h_real<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;)&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;&nbsp;)&nbsp;*.&nbsp;v_inv_scale&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h_center&nbsp;=&nbsp;<span class="constructor">Util</span>.round&nbsp;(&nbsp;-.&nbsp;coo.(0)&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;+&nbsp;h_margin<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_center&nbsp;=&nbsp;<span class="constructor">Util</span>.round&nbsp;(&nbsp;-.&nbsp;coo.(2)&nbsp;*.&nbsp;v_inv_scale&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;h_center&nbsp;+&nbsp;<span class="constructor">Util</span>.round&nbsp;(&nbsp;x_function&nbsp;z.(0)&nbsp;)&nbsp;;&nbsp;v_center&nbsp;+&nbsp;<span class="constructor">Util</span>.round&nbsp;(&nbsp;y_function&nbsp;z.(1)&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;cx&nbsp;=&nbsp;g&nbsp;ax<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dx&nbsp;=&nbsp;g&nbsp;bx<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cy&nbsp;=&nbsp;g&nbsp;ay<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dy&nbsp;=&nbsp;g&nbsp;by<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cz&nbsp;=&nbsp;g&nbsp;az<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dz&nbsp;=&nbsp;g&nbsp;bz&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint_segments&nbsp;color&nbsp;[|&nbsp;(&nbsp;cx&nbsp;,&nbsp;dx&nbsp;)&nbsp;;&nbsp;(&nbsp;cy&nbsp;,&nbsp;dy&nbsp;)&nbsp;;&nbsp;(&nbsp;cz&nbsp;,&nbsp;dz&nbsp;)&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>draw_segments color table</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;draw_segments&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(table:((int&nbsp;array)&nbsp;*&nbsp;(int&nbsp;array))&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;table&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;tableau&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;0&nbsp;,&nbsp;0&nbsp;,&nbsp;0&nbsp;,&nbsp;0&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;fst&nbsp;table.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;snd&nbsp;table.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tableau.(i)&nbsp;&lt;-&nbsp;(&nbsp;a.(0)&nbsp;,&nbsp;a.(1)&nbsp;,&nbsp;b.(0)&nbsp;,&nbsp;b.(1)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;tableau&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>smooth_segments gamma color table</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;smooth_segments&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(table:((int&nbsp;array)&nbsp;*&nbsp;(int&nbsp;array))&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;table&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;fst&nbsp;table.(i)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;snd&nbsp;table.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;color&nbsp;a.(0)&nbsp;a.(1)&nbsp;b.(0)&nbsp;b.(1)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>draw_axes color v w axes coo size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;draw_axes&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(v:float&nbsp;array)&nbsp;(w:float&nbsp;array)&nbsp;(axes:float&nbsp;array)&nbsp;(coo:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;paint_axes&nbsp;draw_segments&nbsp;color&nbsp;v&nbsp;w&nbsp;axes&nbsp;coo&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>smooth_axes gamma color v w axes coo size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;smooth_axes&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(v:float&nbsp;array)&nbsp;(w:float&nbsp;array)&nbsp;(axes:float&nbsp;array)&nbsp;(coo:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;paint_axes&nbsp;(&nbsp;smooth_segments&nbsp;gamma&nbsp;)&nbsp;color&nbsp;v&nbsp;w&nbsp;axes&nbsp;coo&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>func_plot size h_margin v_margin x_function y_function function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;func_plot&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(size:int&nbsp;array)&nbsp;(h_margin:int)&nbsp;(v_margin:int)&nbsp;(x_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(y_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.plot&nbsp;(&nbsp;i&nbsp;+&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;y&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;;<br>
&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>func_segment size h_margin v_margin x_function y_function function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;func_segment&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(size:int&nbsp;array)&nbsp;(h_margin:int)&nbsp;(v_margin:int)&nbsp;(x_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(y_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;y_function&nbsp;(&nbsp;f&nbsp;(&nbsp;x_function&nbsp;0.&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;;<br>
&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.lineto&nbsp;(&nbsp;i&nbsp;+&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;y&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;;<br>
&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>func_smooth gamma color size h_margin v_margin x_function y_function function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;func_smooth&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(size:int&nbsp;array)&nbsp;(h_margin:int)&nbsp;(v_margin:int)&nbsp;(x_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(y_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;old_x&nbsp;=&nbsp;ref&nbsp;h_margin<br>
&nbsp;<span class="keyword">and</span>&nbsp;old_y&nbsp;=&nbsp;ref&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;y_function&nbsp;(&nbsp;f&nbsp;(&nbsp;x_function&nbsp;0.&nbsp;)&nbsp;)&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;y_function&nbsp;(&nbsp;f&nbsp;(&nbsp;x_function&nbsp;0.&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;i&nbsp;+&nbsp;h_margin<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;(&nbsp;int_of_float&nbsp;y&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;color&nbsp;!old_x&nbsp;!old_y&nbsp;xx&nbsp;yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;old_x&nbsp;:=&nbsp;xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;old_y&nbsp;:=&nbsp;yy&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>func_oversample over_sampling_factor gamma color size h_margin v_margin x_function y_function function</pre>
This function records the data corresponding to a display zone of resolution dilated by the factor <code class="code">n</code>
in a sparse matrix, by counting the multiplicity of the points included in the same real pixel.
<p>

Cette fonction enregistre les données correspondant à une zone d'affichage de définition dilatée par le facteur <code class="code">n</code> 
dans une matrice creuse, en comptant la multiplicité des points inclus dans le même pixel réel. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;func_oversample&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(size:int&nbsp;array)&nbsp;(h_margin:int)&nbsp;(v_margin:int)&nbsp;(x_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(y_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;dims&nbsp;=&nbsp;[|&nbsp;size.(1)&nbsp;-2&nbsp;*&nbsp;v_margin&nbsp;;&nbsp;size.(0)&nbsp;-2&nbsp;*&nbsp;h_margin&nbsp;|]<br>
&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;pn&nbsp;=&nbsp;pred&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;filling&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;column&nbsp;=&nbsp;ref&nbsp;[]<br>
&nbsp;<span class="keyword">and</span>&nbsp;intercal&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;index&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;index&nbsp;,&nbsp;b&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_function&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x_function&nbsp;(&nbsp;z&nbsp;*.&nbsp;nn&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_function&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;*.&nbsp;(&nbsp;y_function&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;luminosity&nbsp;=&nbsp;ref&nbsp;[]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;jj&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;dims.(1)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pn&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;j&nbsp;=&nbsp;n&nbsp;*&nbsp;jj&nbsp;+&nbsp;k&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;h_function&nbsp;(&nbsp;float&nbsp;j&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;v_function&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;i&nbsp;=&nbsp;<span class="constructor">Util</span>.round&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ii&nbsp;=&nbsp;i&nbsp;/&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;:=&nbsp;<span class="constructor">Util</span>.list_accumulate&nbsp;compare&nbsp;(&nbsp;+.&nbsp;)&nbsp;(&nbsp;ii&nbsp;,&nbsp;nn&nbsp;)&nbsp;!column&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;luminosity&nbsp;:=&nbsp;<span class="constructor">List</span>.rev_append&nbsp;(&nbsp;<span class="constructor">List</span>.rev_map&nbsp;(&nbsp;intercal&nbsp;jj&nbsp;)&nbsp;!column&nbsp;)&nbsp;!luminosity&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;filling&nbsp;:=&nbsp;!filling&nbsp;+&nbsp;(&nbsp;<span class="constructor">List</span>.length&nbsp;!column&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;:=&nbsp;[]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;coeff&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;oversample_paint&nbsp;gamma&nbsp;color&nbsp;h_margin&nbsp;v_margin&nbsp;(&nbsp;<span class="constructor">Array</span>.append&nbsp;dims&nbsp;[|&nbsp;!filling&nbsp;|]&nbsp;,&nbsp;!luminosity&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>curve_plot color nsteps t_function h_margin v_margin x_function y_function function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;curve_plot&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(nsteps:int)&nbsp;(t_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(h_margin:int)&nbsp;(v_margin:int)&nbsp;(x_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(y_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;t_function&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;(&nbsp;z.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;(&nbsp;z.(1)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.plot&nbsp;(&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;x&nbsp;)&nbsp;+&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;y&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;;<br>
&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>curve_segment color nsteps t_function h_margin v_margin x_function y_function function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;curve_segment&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(nsteps:int)&nbsp;(t_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(h_margin:int)&nbsp;(v_margin:int)&nbsp;(x_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(y_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;z0&nbsp;=&nbsp;f&nbsp;(&nbsp;t_function&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;h_margin&nbsp;+&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;x_function&nbsp;z0.(0)&nbsp;)&nbsp;)&nbsp;)&nbsp;(&nbsp;v_margin&nbsp;+&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;y_function&nbsp;z0.(1)&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;t_function&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;(&nbsp;z.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;(&nbsp;z.(1)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.lineto&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;x&nbsp;)&nbsp;+&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;y&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>curve_smooth gamma color nsteps t_function h_margin v_margin x_function y_function function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;curve_smooth&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(nsteps:int)&nbsp;(t_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(h_margin:int)&nbsp;(v_margin:int)&nbsp;(x_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(y_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;z0&nbsp;=&nbsp;f&nbsp;(&nbsp;t_function&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;old_x&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;x_function&nbsp;z0.(0)&nbsp;)&nbsp;)&nbsp;+&nbsp;h_margin&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;old_y&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;y_function&nbsp;z0.(1)&nbsp;)&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;h_margin&nbsp;+&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;x_function&nbsp;z0.(0)&nbsp;)&nbsp;)&nbsp;)&nbsp;(&nbsp;v_margin&nbsp;+&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;y_function&nbsp;z0.(1)&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;t_function&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;z.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;z.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;(&nbsp;int_of_float&nbsp;x&nbsp;)&nbsp;+&nbsp;h_margin<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;(&nbsp;int_of_float&nbsp;y&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;color&nbsp;!old_x&nbsp;!old_y&nbsp;xx&nbsp;yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;old_x&nbsp;:=&nbsp;xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;old_y&nbsp;:=&nbsp;yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>curve_oversample over_sampling_factor gamma size color nsteps t_function h_margin v_margin x_function y_function function</pre>
This function records the data corresponding to a display zone of resolution dilated by the factor <code class="code">n</code>
in a sparse matrix, by counting the multiplicity of the points included in the same real pixel.
<p>

Cette fonction enregistre les données correspondant à une zone d'affichage de définition dilatée par le facteur <code class="code">n</code> 
dans une matrice creuse, en comptant la multiplicité des points inclus dans le même pixel réel. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;curve_oversample&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(size:int&nbsp;array)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(nsteps:int)&nbsp;(t_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(h_margin:int)&nbsp;(v_margin:int)&nbsp;(x_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(y_function:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;dims&nbsp;=&nbsp;[|&nbsp;size.(1)&nbsp;-2&nbsp;*&nbsp;v_margin&nbsp;;&nbsp;size.(0)&nbsp;-2&nbsp;*&nbsp;h_margin&nbsp;|]<br>
&nbsp;<span class="keyword">and</span>&nbsp;format&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;a.(0)&nbsp;,&nbsp;a.(1)&nbsp;,&nbsp;b&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;cmp&nbsp;=&nbsp;<span class="constructor">Util</span>.lexico_compare&nbsp;(&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;compare&nbsp;b&nbsp;a&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;luminosity&nbsp;=&nbsp;ref&nbsp;[]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;t_function&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;z.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;z.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Util</span>.round&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Util</span>.round&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;luminosity&nbsp;:=&nbsp;<span class="constructor">Util</span>.list_accumulate&nbsp;cmp&nbsp;(&nbsp;+.&nbsp;)&nbsp;(&nbsp;[|&nbsp;yy&nbsp;;&nbsp;xx&nbsp;|]&nbsp;,&nbsp;nn&nbsp;)&nbsp;!luminosity&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;oversample_paint&nbsp;gamma&nbsp;color&nbsp;h_margin&nbsp;v_margin&nbsp;(&nbsp;<span class="constructor">Array</span>.append&nbsp;dims&nbsp;[|&nbsp;<span class="constructor">List</span>.length&nbsp;!luminosity&nbsp;|]&nbsp;,&nbsp;<span class="constructor">List</span>.rev_map&nbsp;format&nbsp;!luminosity&nbsp;)&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_DessinsdeRdansR"><h1>Dessins de R dans R</h1></span>
<span id="1_DrawingsfromRtoR"><h1>Drawings from R to R</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_paint_1_1 paint function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_paint_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;)&nbsp;=&nbsp;prepare_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;grid&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;paint&nbsp;size&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;f&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_draw_1_1 function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_paint_1_1&nbsp;func_plot&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_segment_1_1 function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_paint_1_1&nbsp;func_segment&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_smooth_1_1 gamma function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_paint_1_1&nbsp;(&nbsp;func_smooth&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_oversample_1_1 over_sampling_factor gamma function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_oversample_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_paint_1_1&nbsp;(&nbsp;func_oversample&nbsp;n&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_paint_1_1 paint function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_paint_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;)&nbsp;=&nbsp;prepare_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.white&nbsp;;<br>
&nbsp;&nbsp;paint&nbsp;size&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;f&nbsp;;<br>
&nbsp;&nbsp;paint_coordinates&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_draw_1_1 function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_paint_1_1&nbsp;func_plot&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_segment_1_1 function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_paint_1_1&nbsp;func_segment&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_smooth_1_1 gamma function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_paint_1_1&nbsp;(&nbsp;func_smooth&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_oversample_1_1 over_sampling_factor gamma function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_oversample_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_paint_1_1&nbsp;(&nbsp;func_oversample&nbsp;n&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_paint_1_1 paint function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_paint_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_real&nbsp;=&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_scale&nbsp;=&nbsp;h_real&nbsp;/.&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;coordinates.(0)&nbsp;+.&nbsp;h_scale&nbsp;*.&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;v_inv_scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;size&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;f&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_draw_1_1 function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_partial_paint_1_1&nbsp;func_plot&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_segment_1_1 function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_partial_paint_1_1&nbsp;func_segment&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_smooth_1_1 gamma color function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_partial_paint_1_1&nbsp;(&nbsp;func_smooth&nbsp;gamma&nbsp;color&nbsp;)&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_oversample_1_1 over_sampling_factor gamma color function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_oversample_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_partial_paint_1_1&nbsp;(&nbsp;func_oversample&nbsp;n&nbsp;gamma&nbsp;color&nbsp;)&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_paint_1_1 paint function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_paint_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.white&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;paint&nbsp;f.(i)&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;paint_coordinates&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_draw_1_1 function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multi_paint_1_1&nbsp;function_partial_draw_1_1&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_segment_1_1 function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multi_paint_1_1&nbsp;function_partial_segment_1_1&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_smooth_1_1 gamma function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multi_paint_1_1&nbsp;(&nbsp;function_partial_smooth_1_1&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_oversample_1_1 over_sampling_factor gamma function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_oversample_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multi_paint_1_1&nbsp;(&nbsp;function_partial_oversample_1_1&nbsp;n&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_paint_1_1 paint colors function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_paint_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;paint&nbsp;colors.(i)&nbsp;f.(i)&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;paint_coordinates&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_draw_1_1 colors function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;paint&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;g&nbsp;c&nbsp;s&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;function_partial_draw_1_1&nbsp;g&nbsp;c&nbsp;s&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;function_multicolor_paint_1_1&nbsp;paint&nbsp;colors&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_segment_1_1 colors function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;paint&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;g&nbsp;c&nbsp;s&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;function_partial_segment_1_1&nbsp;g&nbsp;c&nbsp;s&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;function_multicolor_paint_1_1&nbsp;paint&nbsp;colors&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_smooth_1_1 gamma colors function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multicolor_paint_1_1&nbsp;(&nbsp;function_partial_smooth_1_1&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_oversample_1_1 over_sampling_factor gamma colors function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_oversample_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multicolor_paint_1_1&nbsp;(&nbsp;function_partial_oversample_1_1&nbsp;n&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multi_paint_1_1 paint function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multi_paint_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;grid&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;paint&nbsp;f.(i)&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multi_draw_1_1 function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multi_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multi_paint_1_1&nbsp;function_partial_draw_1_1&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multi_segment_1_1 function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multi_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multi_paint_1_1&nbsp;function_partial_segment_1_1&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multi_smooth_1_1 gamma function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multi_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multi_paint_1_1&nbsp;(&nbsp;function_partial_smooth_1_1&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multi_oversample_1_1 over_sampling_factor gamma function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multi_oversample_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multi_paint_1_1&nbsp;(&nbsp;function_partial_oversample_1_1&nbsp;n&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multicolor_paint_1_1 paint colors function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multicolor_paint_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;grid&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;paint&nbsp;colors.(i)&nbsp;f.(i)&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multicolor_draw_1_1 colors function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multicolor_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;paint&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;g&nbsp;c&nbsp;s&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;function_partial_draw_1_1&nbsp;g&nbsp;c&nbsp;s&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;function_grid_multicolor_paint_1_1&nbsp;paint&nbsp;colors&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multicolor_segment_1_1 colors function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multicolor_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;paint&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;g&nbsp;c&nbsp;s&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;function_partial_segment_1_1&nbsp;g&nbsp;c&nbsp;s&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;function_grid_multicolor_paint_1_1&nbsp;paint&nbsp;colors&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multicolor_smooth_1_1 gamma colors function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multicolor_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multicolor_paint_1_1&nbsp;(&nbsp;function_partial_smooth_1_1&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multicolor_oversample_1_1 over_sampling_factor gamma colors function frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multicolor_oversample_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multicolor_paint_1_1&nbsp;(&nbsp;function_partial_oversample_1_1&nbsp;n&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_paint_1_1 paint vector frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_paint_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(v:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;)&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;paint&nbsp;g&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_draw_1_1 vector frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_1&nbsp;function_draw_1_1&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_draw_1_1 vector frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_1&nbsp;function_grid_draw_1_1&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_segment_1_1 vector frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_1&nbsp;function_segment_1_1&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_segment_1_1 vector frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_1&nbsp;function_grid_segment_1_1&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_smooth_1_1 gamma vector frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_1&nbsp;(&nbsp;function_smooth_1_1&nbsp;gamma&nbsp;)&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_smooth_1_1 gamma vector frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_1&nbsp;(&nbsp;function_grid_smooth_1_1&nbsp;gamma&nbsp;)&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multi_paint_1_1 paint matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multi_paint_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0)&nbsp;)&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;<span class="constructor">Util</span>.float_zero&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;paint&nbsp;g&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multi_draw_1_1 matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multi_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_1&nbsp;function_multi_draw_1_1&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_multi_draw_1_1 matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_multi_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_1&nbsp;function_grid_multi_draw_1_1&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multi_segment_1_1 matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multi_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_1&nbsp;function_multi_segment_1_1&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_multi_segment_1_1 matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_multi_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_1&nbsp;function_grid_multi_segment_1_1&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multi_smooth_1_1 gamma matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multi_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_1&nbsp;(&nbsp;function_multi_smooth_1_1&nbsp;gamma&nbsp;)&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_multi_smooth_1_1 gamma matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_multi_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_1&nbsp;(&nbsp;function_grid_multi_smooth_1_1&nbsp;gamma&nbsp;)&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multicolor_paint_1_1 paint colors matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multicolor_paint_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0)&nbsp;)&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;<span class="constructor">Util</span>.float_zero&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;paint&nbsp;colors&nbsp;g&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multicolor_draw_1_1 colors matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multicolor_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multicolor_paint_1_1&nbsp;function_multicolor_draw_1_1&nbsp;colors&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_multicolor_draw_1_1 colors matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_multicolor_draw_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multicolor_paint_1_1&nbsp;function_grid_multicolor_draw_1_1&nbsp;colors&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multicolor_segment_1_1 colors matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multicolor_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multicolor_paint_1_1&nbsp;function_multicolor_segment_1_1&nbsp;colors&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_multicolor_segment_1_1 colors matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_multicolor_segment_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multicolor_paint_1_1&nbsp;function_grid_multicolor_segment_1_1&nbsp;colors&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multicolor_smooth_1_1 gamma colors matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multicolor_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multicolor_paint_1_1&nbsp;(&nbsp;function_multicolor_smooth_1_1&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_multicolor_smooth_1_1 gamma colors matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_multicolor_smooth_1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multicolor_paint_1_1&nbsp;(function_grid_multicolor_smooth_1_1&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;v&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_DessinsdeRdansR2"><h1>Dessins de R dans R^2</h1></span>
<span id="1_DrawingsfromRtoR2"><h1>Drawings from R to R^2</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_paint_1_2 paint function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;t_function&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;)&nbsp;=&nbsp;prepare_1_2&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;interval&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;grid&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;paint&nbsp;nsteps&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;f&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_draw_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_paint_1_2&nbsp;(&nbsp;curve_plot&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_segment_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_paint_1_2&nbsp;(&nbsp;curve_segment&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_smooth_1_2 gamma function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_oversample_1_2 over_sampling_factor gamma function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_paint_1_2 paint function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;t_function&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;)&nbsp;=&nbsp;prepare_1_2&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;interval&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.white&nbsp;;<br>
&nbsp;&nbsp;paint&nbsp;nsteps&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;f&nbsp;;<br>
&nbsp;&nbsp;paint_coordinates&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_draw_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_paint_1_2&nbsp;(&nbsp;curve_plot&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_segment_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_paint_1_2&nbsp;(&nbsp;curve_segment&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_smooth_1_2 gamma function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;function_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_oversample_1_2 over_sampling_factor gamma function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;function_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_paint_1_2 paint function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(g:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_real&nbsp;=&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;h_real<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;t_scale&nbsp;=&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;interval.(0)&nbsp;+.&nbsp;t_scale&nbsp;*.&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;v_inv_scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;nsteps&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;g&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_draw_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(g:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_partial_paint_1_2&nbsp;(&nbsp;curve_plot&nbsp;color&nbsp;)&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_segment_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(g:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_partial_paint_1_2&nbsp;(&nbsp;curve_segment&nbsp;color&nbsp;)&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_smooth_1_2 gamma color function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(g:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_partial_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;color&nbsp;)&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_oversample_1_2 over_sampling_factor gamma color function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(g:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_partial_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;color&nbsp;)&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_color_draw_1_2 function color_function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_color_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(g:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(fc:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_real&nbsp;=&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;h_real<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;t_scale&nbsp;=&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;interval.(0)&nbsp;+.&nbsp;t_scale&nbsp;*.&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;v_inv_scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;t_function&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;g&nbsp;t<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;real_color&nbsp;=&nbsp;fc&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;(&nbsp;zz.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;(&nbsp;zz.(1)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;color&nbsp;=&nbsp;<span class="constructor">Matrix</span>.int_of_vector&nbsp;real_color&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;(&nbsp;<span class="constructor">Graphics</span>.rgb&nbsp;color.(0)&nbsp;color.(1)&nbsp;color.(2)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.plot&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;x&nbsp;)&nbsp;+&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;y&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_color_segment_1_2 function color_function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_color_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(g:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(fc:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_real&nbsp;=&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;h_real<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;t_scale&nbsp;=&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;interval.(0)&nbsp;+.&nbsp;t_scale&nbsp;*.&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;v_inv_scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z0&nbsp;=&nbsp;g&nbsp;(&nbsp;t_function&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;h_margin&nbsp;+&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;x_function&nbsp;z0.(0)&nbsp;)&nbsp;)&nbsp;)&nbsp;(&nbsp;v_margin&nbsp;+&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;y_function&nbsp;z0.(1)&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;t_function&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;g&nbsp;t<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;real_color&nbsp;=&nbsp;fc&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;(&nbsp;zz.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;(&nbsp;zz.(1)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;color&nbsp;=&nbsp;<span class="constructor">Matrix</span>.int_of_vector&nbsp;real_color&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;(&nbsp;<span class="constructor">Graphics</span>.rgb&nbsp;color.(0)&nbsp;color.(1)&nbsp;color.(2)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.lineto&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;x&nbsp;)&nbsp;+&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;y&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_paint_1_2 paint function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.white&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;paint&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;paint_coordinates&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_draw_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multi_paint_1_2&nbsp;(&nbsp;function_partial_draw_1_2&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_segment_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multi_paint_1_2&nbsp;(&nbsp;function_partial_segment_1_2&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_smooth_1_2 gamma function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multi_paint_1_2&nbsp;(&nbsp;function_partial_smooth_1_2&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_oversample_1_2 over_sampling_factor gamma function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multi_paint_1_2&nbsp;(&nbsp;function_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multi_paint_1_2 paint function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multi_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;grid&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;paint&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multi_draw_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multi_paint_1_2&nbsp;(&nbsp;function_partial_draw_1_2&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multi_segment_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multi_paint_1_2&nbsp;(&nbsp;function_partial_segment_1_2&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multi_smooth_1_2 gamma function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multi_paint_1_2&nbsp;(&nbsp;function_partial_smooth_1_2&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multi_oversample_1_2 over_sampling_factor gamma function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multi_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multi_paint_1_2&nbsp;(&nbsp;function_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_paint_1_2 paint colors function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;paint&nbsp;colors.(i)&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;paint_coordinates&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_draw_1_2 colors function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multicolor_paint_1_2&nbsp;function_partial_draw_1_2&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_segment_1_2 colors function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multicolor_paint_1_2&nbsp;function_partial_segment_1_2&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_smooth_1_2 gamma colors function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multicolor_paint_1_2&nbsp;(&nbsp;function_partial_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_oversample_1_2 over_sampling_factor gamma colors function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multicolor_paint_1_2&nbsp;(&nbsp;function_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multicolor_paint_1_2 paint colors function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multicolor_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;grid&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;paint&nbsp;colors.(i)&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multicolor_draw_1_2 colors function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multicolor_paint_1_2&nbsp;function_partial_draw_1_2&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multicolor_segment_1_2 colors function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multicolor_paint_1_2&nbsp;function_partial_segment_1_2&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multicolor_smooth_1_2 gamma colors function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multicolor_paint_1_2&nbsp;(&nbsp;function_partial_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_grid_multicolor_oversample_1_2 over_sampling_factor gamma colors function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_grid_multicolor_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_grid_multicolor_paint_1_2&nbsp;(&nbsp;function_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_paint_1_2 paint matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;g&nbsp;interval&nbsp;r&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_paint_1_2 paint matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_paint_1_2&nbsp;paint&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_draw_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_paint_1_2&nbsp;function_draw_1_2&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_draw_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_2&nbsp;function_draw_1_2&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_grid_draw_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_grid_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_paint_1_2&nbsp;function_grid_draw_1_2&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_draw_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_2&nbsp;function_grid_draw_1_2&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_segment_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_paint_1_2&nbsp;function_segment_1_2&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_segment_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_2&nbsp;function_segment_1_2&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_grid_segment_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_grid_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_paint_1_2&nbsp;function_grid_segment_1_2&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_segment_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_2&nbsp;function_grid_segment_1_2&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_smooth_1_2 gamma matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_paint_1_2&nbsp;(&nbsp;function_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_smooth_1_2 gamma matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_2&nbsp;(&nbsp;function_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_grid_smooth_1_2 gamma matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_grid_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_paint_1_2&nbsp;(&nbsp;function_grid_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_smooth_1_2 gamma matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_2&nbsp;(&nbsp;function_grid_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multi_paint_1_2 paint matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multi_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;2&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multi_paint_1_2 paint matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multi_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;2&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multi_draw_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_2&nbsp;function_multi_draw_1_2&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multi_draw_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_2&nbsp;function_multi_draw_1_2&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_multi_draw_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_2&nbsp;function_grid_multi_draw_1_2&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_grid_multi_draw_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_grid_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_2&nbsp;function_grid_multi_draw_1_2&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multicolor_draw_1_2 colors matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_2&nbsp;(&nbsp;function_multicolor_draw_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multicolor_draw_1_2 colors matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_2&nbsp;(&nbsp;function_multicolor_draw_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_multicolor_draw_1_2 colors matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_2&nbsp;(&nbsp;function_grid_multicolor_draw_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_grid_multicolor_draw_1_2 colors matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_grid_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_2&nbsp;(&nbsp;function_grid_multicolor_draw_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multi_segment_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_2&nbsp;function_multi_segment_1_2&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multi_segment_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_2&nbsp;function_multi_segment_1_2&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_multi_segment_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_2&nbsp;function_grid_multi_segment_1_2&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_grid_multi_segment_1_2 matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_grid_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_2&nbsp;function_grid_multi_segment_1_2&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multicolor_segment_1_2 colors matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_2&nbsp;(&nbsp;function_multicolor_segment_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multicolor_segment_1_2 colors matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_2&nbsp;(&nbsp;function_multicolor_segment_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_multicolor_segment_1_2 colors matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_2&nbsp;(&nbsp;function_grid_multicolor_segment_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_grid_multicolor_segment_1_2 colors matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_grid_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_2&nbsp;(&nbsp;function_grid_multicolor_segment_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multi_smooth_1_2 gamma matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_2&nbsp;(&nbsp;function_multi_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multi_smooth_1_2 gamma matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_2&nbsp;(&nbsp;function_multi_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_multi_smooth_1_2 gamma matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_2&nbsp;(&nbsp;function_grid_multi_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_grid_multi_smooth_1_2 gamma matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_grid_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_2&nbsp;(&nbsp;function_grid_multi_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multicolor_smooth_1_2 gamma colors matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_2&nbsp;(&nbsp;function_multicolor_smooth_1_2&nbsp;gamma&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multicolor_smooth_1_2 gamma colors matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_2&nbsp;(&nbsp;function_multicolor_smooth_1_2&nbsp;gamma&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_grid_multicolor_smooth_1_2 gamma colors matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_grid_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_2&nbsp;(&nbsp;function_grid_multicolor_smooth_1_2&nbsp;gamma&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_grid_multicolor_smooth_1_2 gamma colors matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_grid_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_2&nbsp;(&nbsp;function_grid_multicolor_smooth_1_2&nbsp;gamma&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_DessinsdeRdansTR2"><h1>Dessins de R dans TR^2</h1></span>
<span id="1_DrawingsfromRtoTR2"><h1>Drawings from R to TR^2</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>paint_field arrow_paint nsteps nfeet t_function h_margin v_margin x_function y_function vx_function vy_function function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;paint_field&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;arrow_paint&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;t_function&nbsp;(h_margin:int)&nbsp;(v_margin:int)&nbsp;x_function&nbsp;y_function&nbsp;vx_function&nbsp;vy_function&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ratio&nbsp;=&nbsp;float&nbsp;(&nbsp;nsteps&nbsp;/&nbsp;nfeet&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nfeet&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;t_function&nbsp;(&nbsp;ratio&nbsp;*.&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;(&nbsp;z.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;(&nbsp;z.(1)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;vx_function&nbsp;(&nbsp;z.(2)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;vy_function&nbsp;(&nbsp;z.(3)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrow&nbsp;arrow_paint&nbsp;(&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;x&nbsp;)&nbsp;+&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;y&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;xx&nbsp;)&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;yy&nbsp;)&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_paint_1_2 paint arrow_paint function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;t_function&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;,&nbsp;vx_function&nbsp;,&nbsp;vy_function&nbsp;)&nbsp;=&nbsp;prepare_field_1_2&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;interval&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;grid&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;paint_field&nbsp;arrow_paint&nbsp;nsteps&nbsp;nfeet&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;vx_function&nbsp;vy_function&nbsp;f&nbsp;;<br>
&nbsp;&nbsp;paint&nbsp;nsteps&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;f&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_draw_1_2 function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.green&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;field_grid_paint_1_2&nbsp;(&nbsp;curve_plot&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_segment_1_2 function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.green&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;field_grid_paint_1_2&nbsp;(&nbsp;curve_segment&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_smooth_1_2 gamma function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_grid_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.green&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_oversample_1_2 over_sampling_factor gamma function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_grid_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.green&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_paint_1_2 paint arrow_paint function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;t_function&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;,&nbsp;vx_function&nbsp;,&nbsp;vy_function&nbsp;)&nbsp;=&nbsp;prepare_field_1_2&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;interval&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;paint_coordinates&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ratio&nbsp;=&nbsp;float&nbsp;(&nbsp;nsteps&nbsp;/&nbsp;nfeet&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nfeet&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;t_function&nbsp;(&nbsp;ratio&nbsp;*.&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;(&nbsp;z.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;(&nbsp;z.(1)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;vx_function&nbsp;(&nbsp;z.(2)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;vy_function&nbsp;(&nbsp;z.(3)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrow&nbsp;arrow_paint&nbsp;(&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;x&nbsp;)&nbsp;+&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;y&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;xx&nbsp;)&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;yy&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;paint&nbsp;nsteps&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;f&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_draw_1_2 function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.green&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;field_paint_1_2&nbsp;(&nbsp;curve_plot&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_segment_1_2 function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.green&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;field_paint_1_2&nbsp;(&nbsp;curve_segment&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_smooth_1_2 gamma function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.green&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_oversample_1_2 over_sampling_factor gamma function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.green&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_partial_paint_1_2 paint arrow_paint function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_partial_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_real&nbsp;=&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;h_real<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;t_scale&nbsp;=&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;interval.(0)&nbsp;+.&nbsp;t_scale&nbsp;*.&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;v_inv_scale&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vx_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vy_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;*.&nbsp;v_inv_scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ratio&nbsp;=&nbsp;float&nbsp;(&nbsp;nsteps&nbsp;/&nbsp;nfeet&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nfeet&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;t_function&nbsp;(&nbsp;ratio&nbsp;*.&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;(&nbsp;z.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;(&nbsp;z.(1)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;vx_function&nbsp;(&nbsp;z.(2)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;vy_function&nbsp;(&nbsp;z.(3)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrow&nbsp;arrow_paint&nbsp;(&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;x&nbsp;)&nbsp;+&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;y&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;xx&nbsp;)&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;yy&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;nsteps&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;f&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_partial_draw_1_2 color1 color2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_partial_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color2&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;field_partial_paint_1_2&nbsp;(&nbsp;curve_plot&nbsp;color1&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_partial_segment_1_2 color1 color2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_partial_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color2&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;field_partial_paint_1_2&nbsp;(&nbsp;curve_segment&nbsp;color1&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_partial_smooth_1_2 gamma color1 color2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_partial_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_partial_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;color1&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;color2&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_partial_oversample_1_2 over_sampling_factor gamma color1 color2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_partial_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_partial_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;color1&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;color2&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_multi_paint_1_2 paint arrow_paint function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_multi_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;grid&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;field_partial_paint_1_2&nbsp;paint&nbsp;arrow_paint&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_multi_draw_1_2 function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.green&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;field_grid_multi_paint_1_2&nbsp;(&nbsp;curve_plot&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_multi_segment_1_2 function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.green&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;field_grid_multi_paint_1_2&nbsp;(&nbsp;curve_segment&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_multi_smooth_1_2 gamma function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_grid_multi_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.green&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_multi_oversample_1_2 over_sampling_factor gamma function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_multi_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_grid_multi_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.green&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_multicolor_paint_1_2 paint arrow_paint colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_multicolor_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;grid&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;field_partial_paint_1_2&nbsp;(&nbsp;paint&nbsp;colors.(i)&nbsp;)&nbsp;(&nbsp;arrow_paint&nbsp;(&nbsp;soft_color&nbsp;colors.(i)&nbsp;)&nbsp;)&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_multicolor_draw_1_2 colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;field_grid_multicolor_paint_1_2&nbsp;curve_plot&nbsp;ap&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_multicolor_segment_1_2 colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;field_grid_multicolor_paint_1_2&nbsp;curve_segment&nbsp;ap&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_multicolor_smooth_1_2 gamma colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_grid_multicolor_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_grid_multicolor_oversample_1_2 over_sampling_factor gamma colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_grid_multicolor_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_grid_multicolor_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multi_paint_1_2 paint arrow_paint function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multi_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;paint_coordinates&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;field_partial_paint_1_2&nbsp;paint&nbsp;arrow_paint&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multi_draw_1_2 function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.green&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;field_multi_paint_1_2&nbsp;(&nbsp;curve_plot&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multi_segment_1_2 function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.green&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;field_multi_paint_1_2&nbsp;(&nbsp;curve_segment&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multi_smooth_1_2 gamma function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_multi_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.green&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multi_oversample_1_2 over_sampling_factor gamma function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multi_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_multi_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.green&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multicolor_paint_1_2 paint arrow_paint colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multicolor_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;paint_coordinates&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;field_partial_paint_1_2&nbsp;(&nbsp;paint&nbsp;colors.(i)&nbsp;)&nbsp;(&nbsp;arrow_paint&nbsp;(&nbsp;soft_color&nbsp;colors.(i)&nbsp;)&nbsp;)&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multicolor_draw_1_2 colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;field_multicolor_paint_1_2&nbsp;curve_plot&nbsp;ap&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multicolor_segment_1_2 colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;field_multicolor_paint_1_2&nbsp;curve_segment&nbsp;ap&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multicolor_smooth_1_2 gamma colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_multicolor_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multicolor_oversample_1_2 over_sampling_factor gamma colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multicolor_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_multicolor_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_paint_1_2 paint matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;g&nbsp;interval&nbsp;r&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_paint_1_2 paint matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_paint_1_2&nbsp;paint&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_draw_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_paint_1_2&nbsp;field_draw_1_2&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_draw_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_1_2&nbsp;field_draw_1_2&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_grid_draw_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_grid_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_paint_1_2&nbsp;field_grid_draw_1_2&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_grid_draw_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_grid_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_1_2&nbsp;field_grid_draw_1_2&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_segment_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_paint_1_2&nbsp;field_segment_1_2&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_segment_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_1_2&nbsp;field_segment_1_2&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_grid_segment_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_grid_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_paint_1_2&nbsp;field_grid_segment_1_2&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_grid_segment_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_grid_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_1_2&nbsp;field_grid_segment_1_2&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_smooth_1_2 gamma matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_paint_1_2&nbsp;(&nbsp;field_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_smooth_1_2 gamma matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_1_2&nbsp;(&nbsp;field_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_grid_smooth_1_2 gamma matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_grid_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_paint_1_2&nbsp;(&nbsp;field_grid_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_grid_smooth_1_2 gamma matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_grid_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_1_2&nbsp;(&nbsp;field_grid_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multi_paint_1_2 paint matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;4&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multi_paint_1_2 paint matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multi_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;paint&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_grid_multi_draw_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_grid_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;field_grid_multi_draw_1_2&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_grid_multi_draw_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_grid_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_2&nbsp;field_grid_multi_draw_1_2&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multi_draw_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;field_multi_draw_1_2&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multi_draw_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_2&nbsp;field_multi_draw_1_2&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_grid_multi_segment_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_grid_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;field_grid_multi_segment_1_2&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_grid_multi_segment_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_grid_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_2&nbsp;field_grid_multi_segment_1_2&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multi_segment_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;field_multi_segment_1_2&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multi_segment_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_2&nbsp;field_multi_segment_1_2&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_grid_multi_smooth_1_2 gamma matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_grid_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;(&nbsp;field_grid_multi_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_grid_multi_smooth_1_2 gamma matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_grid_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_2&nbsp;(&nbsp;field_grid_multi_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multi_smooth_1_2 gamma matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;(&nbsp;field_multi_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multi_smooth_1_2 gamma matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_2&nbsp;(&nbsp;field_multi_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_grid_multicolor_draw_1_2 colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_grid_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;(&nbsp;field_grid_multicolor_draw_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_grid_multicolor_draw_1_2 colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_grid_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_2&nbsp;(&nbsp;field_grid_multicolor_draw_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multicolor_draw_1_2 colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;(&nbsp;field_multicolor_draw_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multicolor_draw_1_2 colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_2&nbsp;(&nbsp;field_multicolor_draw_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_grid_multicolor_segment_1_2 colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_grid_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;(&nbsp;field_grid_multicolor_segment_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_grid_multicolor_segment_1_2 colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_grid_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_2&nbsp;(&nbsp;field_grid_multicolor_segment_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multicolor_segment_1_2 colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;(&nbsp;field_multicolor_segment_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multicolor_segment_1_2 colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_2&nbsp;(&nbsp;field_multicolor_segment_1_2&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_grid_multicolor_smooth_1_2 gamma colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_grid_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;(&nbsp;field_grid_multicolor_smooth_1_2&nbsp;gamma&nbsp;colors&nbsp;)&nbsp;&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_grid_multicolor_smooth_1_2 gamma colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_grid_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_2&nbsp;(&nbsp;field_grid_multicolor_smooth_1_2&nbsp;gamma&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multicolor_smooth_1_2 gamma colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_2&nbsp;(&nbsp;field_multicolor_smooth_1_2&nbsp;gamma&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multicolor_smooth_1_2 gamma colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_2&nbsp;(&nbsp;field_multicolor_smooth_1_2&nbsp;gamma&nbsp;colors&nbsp;)&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_DessinsdeRdansRnTR2"><h1>Dessins de R dans R^n ¤ TR^2</h1></span>
<span id="1_DrawingsfromRtoRnTR2"><h1>Drawings from R to R^n ¤ TR^2</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>paint_frame arrow_paint nsteps nfeet t_function h_margin v_margin x_function y_function vx_function vy_function function interval</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;paint_frame&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;arrow_paint&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;t_function&nbsp;(h_margin:int)&nbsp;(v_margin:int)&nbsp;x_function&nbsp;y_function&nbsp;vx_function&nbsp;vy_function&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;(&nbsp;f&nbsp;interval.(0)&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ratio&nbsp;=&nbsp;float&nbsp;(&nbsp;nsteps&nbsp;/&nbsp;nfeet&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nfeet&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;t_function&nbsp;(&nbsp;ratio&nbsp;*.&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;(&nbsp;z.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;(&nbsp;z.(1)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;r&nbsp;-&nbsp;1&nbsp;)&nbsp;/&nbsp;2&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;jj&nbsp;=&nbsp;2&nbsp;*&nbsp;j&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;vx_function&nbsp;(&nbsp;z.(jj)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;vy_function&nbsp;(&nbsp;z.(&nbsp;jj&nbsp;+&nbsp;1&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrow&nbsp;(&nbsp;arrow_paint&nbsp;color_list.(&nbsp;pred&nbsp;j&nbsp;<span class="keyword">mod</span>&nbsp;5&nbsp;)&nbsp;)&nbsp;(&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;x&nbsp;)&nbsp;+&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;y&nbsp;)&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;xx&nbsp;)&nbsp;(&nbsp;<span class="constructor">Util</span>.round&nbsp;yy&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_partial_paint_1_2 paint arrow_paint color function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_partial_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;h_real&nbsp;=&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;v_real&nbsp;=&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(0)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;tsh&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_margin&nbsp;=&nbsp;max&nbsp;(&nbsp;size.(1)&nbsp;/&nbsp;10&nbsp;)&nbsp;(&nbsp;4&nbsp;*&nbsp;tsv&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(0)&nbsp;-&nbsp;2&nbsp;*&nbsp;h_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;h_real<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;t_scale&nbsp;=&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v_inv_scale&nbsp;=&nbsp;(&nbsp;float&nbsp;(&nbsp;size.(1)&nbsp;-&nbsp;2&nbsp;*&nbsp;v_margin&nbsp;)&nbsp;)&nbsp;/.&nbsp;v_real&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;interval.(0)&nbsp;+.&nbsp;t_scale&nbsp;*.&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;z&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;v_inv_scale&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vx_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;*.&nbsp;h_inv_scale&nbsp;)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vy_function&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;*.&nbsp;v_inv_scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint_frame&nbsp;arrow_paint&nbsp;nsteps&nbsp;nfeet&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;vx_function&nbsp;vy_function&nbsp;f&nbsp;interval&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;color&nbsp;nsteps&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;f&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_partial_draw_1_2 color function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_partial_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;couleur&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;couleur&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_partial_paint_1_2&nbsp;curve_plot&nbsp;ap&nbsp;color&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_partial_segment_1_2 color function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_partial_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;couleur&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;couleur&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_partial_paint_1_2&nbsp;curve_segment&nbsp;ap&nbsp;color&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_partial_smooth_1_2 gamma color function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_partial_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;frame_field_partial_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;color&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_partial_oversample_1_2 over_sampling_factor gamma color function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_partial_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;frame_field_partial_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;color&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_paint_1_2 paint arrow_paint function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;t_function&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;,&nbsp;vx_function&nbsp;,&nbsp;vy_function&nbsp;)&nbsp;=&nbsp;prepare_field_1_2&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;interval&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;grid&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;paint_frame&nbsp;arrow_paint&nbsp;nsteps&nbsp;nfeet&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;vx_function&nbsp;vy_function&nbsp;f&nbsp;interval&nbsp;;<br>
&nbsp;&nbsp;paint&nbsp;nsteps&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;f&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_draw_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_grid_paint_1_2&nbsp;(&nbsp;curve_plot&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_segment_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_grid_paint_1_2&nbsp;(&nbsp;curve_segment&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_smooth_1_2 gamma function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_grid_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_oversample_1_2 over_sampling_factor gamma function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_grid_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_paint_1_2 paint arrow_paint function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;t_function&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;,&nbsp;vx_function&nbsp;,&nbsp;vy_function&nbsp;)&nbsp;=&nbsp;prepare_field_1_2&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;interval&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;paint_coordinates&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;paint_frame&nbsp;arrow_paint&nbsp;nsteps&nbsp;nfeet&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;vx_function&nbsp;vy_function&nbsp;f&nbsp;interval&nbsp;;<br>
&nbsp;&nbsp;paint&nbsp;nsteps&nbsp;t_function&nbsp;h_margin&nbsp;v_margin&nbsp;x_function&nbsp;y_function&nbsp;f&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_draw_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_paint_1_2&nbsp;(&nbsp;curve_plot&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_segment_1_2 function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_paint_1_2&nbsp;(&nbsp;curve_segment&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_smooth_1_2 gamma function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_oversample_1_2 over_sampling_factor gamma function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_multi_paint_1_2 paint arrow_paint function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_multi_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;grid&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;frame_field_partial_paint_1_2&nbsp;paint&nbsp;arrow_paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_multi_draw_1_2 function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;couleur&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;couleur&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_grid_multi_paint_1_2&nbsp;curve_plot&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_multi_segment_1_2 function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;couleur&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;couleur&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_grid_multi_paint_1_2&nbsp;curve_segment&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_multi_smooth_1_2 gamma function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_grid_multi_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_multi_oversample_1_2 over_sampling_factor gamma function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_multi_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_grid_multi_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multi_paint_1_2 paint arrow_paint function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multi_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;paint_coordinates&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;frame_field_partial_paint_1_2&nbsp;paint&nbsp;arrow_paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multi_draw_1_2 function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_multi_paint_1_2&nbsp;curve_plot&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multi_segment_1_2 function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_multi_paint_1_2&nbsp;curve_segment&nbsp;ap&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multi_smooth_1_2 gamma function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multi_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_multi_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multi_oversample_1_2 over_sampling_factor gamma function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multi_overample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_multi_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_multicolor_paint_1_2 paint arrow_paint colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_multicolor_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;)&nbsp;=&nbsp;prep_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;grid&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;frame_field_partial_paint_1_2&nbsp;paint&nbsp;arrow_paint&nbsp;colors.(i)&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_multicolor_draw_1_2 colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_grid_multicolor_paint_1_2&nbsp;curve_plot&nbsp;ap&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_multicolor_segment_1_2 colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_grid_multicolor_paint_1_2&nbsp;curve_segment&nbsp;ap&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_multicolor_smooth_1_2 gamma colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_grid_multicolor_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_grid_multicolor_oversample_1_2 over_sampling_factor gamma colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_grid_multicolor_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_grid_multicolor_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multicolor_paint_1_2 paint arrow_paint colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multicolor_paint_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;arrow_paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;)&nbsp;=&nbsp;prepare_1_1&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;paint_coordinates&nbsp;coordinates&nbsp;size&nbsp;hh&nbsp;vv&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;frame_field_partial_paint_1_2&nbsp;paint&nbsp;arrow_paint&nbsp;colors.(i)&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multicolor_draw_1_2 colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;couleur&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;couleur&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_multicolor_paint_1_2&nbsp;curve_plot&nbsp;ap&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multicolor_segment_1_2 colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;couleur&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;couleur&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_multicolor_paint_1_2&nbsp;curve_segment&nbsp;ap&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multicolor_smooth_1_2 gamma colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multicolor_smooth_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_multicolor_paint_1_2&nbsp;(&nbsp;curve_smooth&nbsp;gamma&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multicolor_oversample_1_2 over_sampling_factor gamma colors function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multicolor_oversample_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_multicolor_paint_1_2&nbsp;(&nbsp;curve_oversample&nbsp;n&nbsp;gamma&nbsp;size&nbsp;)&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_draw_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;frame_field_draw_1_2&nbsp;g&nbsp;interval&nbsp;r&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_draw_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_draw_1_2&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_multi_draw_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;4&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;frame_field_multi_draw_1_2&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_multi_draw_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_multi_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_multi_draw_1_2&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_multicolor_draw_1_2 colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;4&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;frame_field_multicolor_draw_1_2&nbsp;colors&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_multicolor_draw_1_2 colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_multicolor_draw_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_multicolor_draw_1_2&nbsp;colors&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_segment_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;frame_field_segment_1_2&nbsp;g&nbsp;interval&nbsp;r&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_segment_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_segment_1_2&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_multi_segment_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;4&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;frame_field_multi_segment_1_2&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_multi_segment_1_2 matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_multi_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_multi_segment_1_2&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_multicolor_segment_1_2 colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;4&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;frame_field_multicolor_segment_1_2&nbsp;colors&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_multicolor_segment_1_2 colors matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_multicolor_segment_1_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_multicolor_segment_1_2&nbsp;colors&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_DessinsdeRdansR3"><h1>Dessins de R dans R^3</h1></span>
<span id="1_DrawingsfromRtoR3"><h1>Drawings from R to R^3</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_paint_1_3 paint axes_paint vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;axes_paint&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;,&nbsp;accu&nbsp;,&nbsp;hh&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;coo&nbsp;)&nbsp;=&nbsp;prepare_1_3&nbsp;u&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;project_1_3&nbsp;accu&nbsp;a&nbsp;b&nbsp;u&nbsp;v&nbsp;w&nbsp;nsteps&nbsp;coordinates&nbsp;coo&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;axes_paint&nbsp;v&nbsp;w&nbsp;accu&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_draw_1_3 vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_paint_1_3&nbsp;function_partial_draw_1_2&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_segment_1_3 vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_paint_1_3&nbsp;function_partial_segment_1_2&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_segment_1_3 vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_paint_1_3&nbsp;function_partial_segment_1_2&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_smooth_1_3 gamma vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_paint_1_3&nbsp;(&nbsp;function_partial_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_oversample _1_3 over_sampling_factor gamma vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_oversample_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_paint_1_3&nbsp;(&nbsp;function_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_paint_1_3 paint vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_chose_3&nbsp;u&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;m.(1)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;m.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;(&nbsp;f&nbsp;t&nbsp;)&nbsp;v&nbsp;;&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;(&nbsp;f&nbsp;t&nbsp;)&nbsp;w&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coo&nbsp;=&nbsp;box_proj_3_2&nbsp;u&nbsp;coordinates&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;coo&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_draw_1_3 color vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_partial_paint_1_3&nbsp;(&nbsp;function_partial_draw_1_2&nbsp;color&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_segment_1_3 color vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_partial_paint_1_3&nbsp;(&nbsp;function_partial_segment_1_2&nbsp;color&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_smooth_1_3 gamma color vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_partial_paint_1_3&nbsp;(&nbsp;function_partial_smooth_1_2&nbsp;gamma&nbsp;color&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_partial_oversample_1_3 over_sampling_factor gamma color vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_partial_oversample_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_partial_paint_1_3&nbsp;(&nbsp;function_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;color&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_color_paint_1_3 paint vector function color_function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_color_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(fc:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_chose_3&nbsp;u&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;m.(1)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;m.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;(&nbsp;f&nbsp;t&nbsp;)&nbsp;v&nbsp;;&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;(&nbsp;f&nbsp;t&nbsp;)&nbsp;w&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coo&nbsp;=&nbsp;box_proj_3_2&nbsp;u&nbsp;coordinates&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;g&nbsp;fc&nbsp;interval&nbsp;nsteps&nbsp;coo&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_color_draw_1_3 vector function color_function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_color_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(fc:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_color_paint_1_3&nbsp;function_color_draw_1_2&nbsp;u&nbsp;f&nbsp;fc&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_color_segment_1_3 vector function color_function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_color_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(fc:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_color_paint_1_3&nbsp;function_color_segment_1_2&nbsp;u&nbsp;f&nbsp;fc&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_paint_1_3 paint axes_paint vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;axes_paint&nbsp;(u:float&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;,&nbsp;accu&nbsp;,&nbsp;hh&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;coo&nbsp;)&nbsp;=&nbsp;prepare_1_3&nbsp;u&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
</code><table><tr><td></td><td><span class="comment">(** The following instruction puts the extremal coordinates in the <code class="code">accu</code> array.
<p>

L'instruction suivante place les coordonnées extrémales dans le tableau <code class="code">accu</code>.*)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;ignore&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;project_1_3&nbsp;accu&nbsp;a&nbsp;b&nbsp;u&nbsp;v&nbsp;w&nbsp;nsteps&nbsp;coordinates&nbsp;coo&nbsp;)&nbsp;f&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;axes_paint&nbsp;v&nbsp;w&nbsp;accu&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_draw_1_3 vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multi_paint_1_3&nbsp;(&nbsp;function_partial_draw_1_3&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_segment_1_3 vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multi_paint_1_3&nbsp;(&nbsp;function_partial_segment_1_3&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_smooth_1_3 gamma vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multi_paint_1_3&nbsp;(&nbsp;function_partial_smooth_1_3&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multi_oversample_1_3 over_sampling_factor gamma vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multi_oversample_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multi_paint_1_3&nbsp;(&nbsp;function_partial_oversample_1_3&nbsp;n&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_paint_1_3 paint axes_paint colors vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;axes_paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;,&nbsp;accu&nbsp;,&nbsp;hh&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;coo&nbsp;)&nbsp;=&nbsp;prepare_1_3&nbsp;u&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
</code><table><tr><td></td><td><span class="comment">(** The following instruction puts the extremal coordinates in the <code class="code">accu</code> array.
<p>

L'instruction suivante place les coordonnées extrémales dans le tableau <code class="code">accu</code>.*)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;ignore&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;project_1_3&nbsp;accu&nbsp;a&nbsp;b&nbsp;u&nbsp;v&nbsp;w&nbsp;nsteps&nbsp;coordinates&nbsp;coo&nbsp;)&nbsp;f&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;axes_paint&nbsp;v&nbsp;w&nbsp;accu&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;paint&nbsp;colors.(i)&nbsp;u&nbsp;f.(i)&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_draw_1_3 colors vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multicolor_paint_1_3&nbsp;function_partial_draw_1_3&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;colors&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_segment_1_3 colors vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multicolor_paint_1_3&nbsp;function_partial_segment_1_3&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;colors&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_smooth_1_3 gamma colors vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multicolor_paint_1_3&nbsp;(&nbsp;function_partial_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;colors&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_multicolor_oversample_1_3 over_sampling_factor gamma colors vector function interval nsteps frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_multicolor_oversample_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_multicolor_paint_1_3&nbsp;(&nbsp;function_partial_oversample_1_3&nbsp;n&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;colors&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_paint_1_3 paint vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;interval&nbsp;r&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_paint_1_3 paint vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_paint_1_3&nbsp;paint&nbsp;u&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_draw_1_3 vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_paint_1_3&nbsp;function_draw_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_draw_1_3 vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_3&nbsp;function_draw_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_segment_1_3 vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_paint_1_3&nbsp;function_segment_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_segment_1_3 vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_3&nbsp;function_segment_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_smooth_1_3 gamma vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_paint_1_3&nbsp;(&nbsp;function_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_smooth_1_3 gamma vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_1_3&nbsp;(&nbsp;function_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multi_paint_1_3 paint vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multi_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;2&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multi_paint_1_3 paint vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multi_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_3&nbsp;paint&nbsp;u&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multi_draw_1_3 vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multi_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_3&nbsp;function_multi_draw_1_3&nbsp;u&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multi_draw_1_3 vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multi_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_3&nbsp;function_multi_draw_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multi_segment_1_3 vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multi_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_3&nbsp;function_multi_segment_1_3&nbsp;u&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multi_segment_1_3 vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multi_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_3&nbsp;function_multi_segment_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multi_smooth_1_3 gamma vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multi_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multi_paint_1_3&nbsp;(&nbsp;function_multi_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multi_smooth_1_3 gamma vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multi_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multi_paint_1_3&nbsp;(&nbsp;function_multi_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multicolor_paint_1_3 paint colors vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multicolor_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;2&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;colors&nbsp;u&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multicolor_paint_1_3 paint colors vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multicolor_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multicolor_paint_1_3&nbsp;paint&nbsp;colors&nbsp;u&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multicolor_draw_1_3 colors vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multicolor_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multicolor_paint_1_3&nbsp;function_multicolor_draw_1_3&nbsp;colors&nbsp;u&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multicolor_draw_1_3 colors vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multicolor_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multicolor_paint_1_3&nbsp;function_multicolor_draw_1_3&nbsp;colors&nbsp;u&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multicolor_segment_1_3 colors vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multicolor_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multicolor_paint_1_3&nbsp;function_multicolor_segment_1_3&nbsp;colors&nbsp;u&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multicolor_segment_1_3 colors vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multicolor_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multicolor_paint_1_3&nbsp;function_multicolor_segment_1_3&nbsp;colors&nbsp;u&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_multicolor_smooth_1_3 gamma colors vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_multicolor_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_multicolor_paint_1_3&nbsp;(&nbsp;function_multicolor_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;u&nbsp;v&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_multicolor_smooth_1_3 gamma colors vector matrix interval frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_multicolor_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_multicolor_paint_1_3&nbsp;(&nbsp;function_multicolor_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;u&nbsp;m&nbsp;interval&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_DessinsdeRdansTR3"><h1>Dessins de R dans TR^3</h1></span>
<span id="1_DrawingsfromRtoTR3"><h1>Drawings from R to TR^3</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_paint_1_3 paint axes_paint vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;axes_paint&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;,&nbsp;accu&nbsp;,&nbsp;hh&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;coo&nbsp;)&nbsp;=&nbsp;prepare_1_3&nbsp;u&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
</code><table><tr><td></td><td><span class="comment">(** The following instruction puts the extremal coordinates in the <code class="code">accu</code> array.
<p>

L'instruction suivante place les coordonnées extrémales dans le tableau <code class="code">accu</code>.*)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;multi_project_1_3&nbsp;accu&nbsp;a&nbsp;b&nbsp;u&nbsp;v&nbsp;w&nbsp;nsteps&nbsp;coordinates&nbsp;coo&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;axes_paint&nbsp;v&nbsp;w&nbsp;accu&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;<span class="constructor">Graphics</span>.green&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_draw_1_3 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_paint_1_3&nbsp;(&nbsp;field_partial_draw_1_2&nbsp;)&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_segment_1_3 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_paint_1_3&nbsp;(&nbsp;field_partial_segment_1_2&nbsp;)&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_smooth_1_3 gamma vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_paint_1_3&nbsp;(&nbsp;field_partial_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_oversample_1_3 over_sampling_factor gamma vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_oversample_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_paint_1_3&nbsp;(&nbsp;field_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_partial_paint_1_3 paint color1 color2 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_partial_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_chose_3&nbsp;u<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;6&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;interval.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;a&nbsp;=&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;m.(1)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;m.(2)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coo&nbsp;=&nbsp;box_proj_3_2&nbsp;u&nbsp;coordinates&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;multi_project_1_3&nbsp;accu&nbsp;a&nbsp;b&nbsp;u&nbsp;v&nbsp;w&nbsp;nsteps&nbsp;coordinates&nbsp;coo&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;color1&nbsp;color2&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coo&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_partial_draw_1_3 color1 color2 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_partial_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_partial_paint_1_3&nbsp;field_partial_draw_1_2&nbsp;color1&nbsp;color2&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_partial_segment_1_3 color1 color2 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_partial_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_partial_paint_1_3&nbsp;field_partial_segment_1_2&nbsp;color1&nbsp;color2&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_partial_smooth_1_3 gamma color1 color2 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_partial_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_partial_paint_1_3&nbsp;(&nbsp;field_partial_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;color1&nbsp;color2&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_partial_oversample_1_3 over_sampling_factor gamma color1 color2 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_partial_oversample_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_partial_paint_1_3&nbsp;(&nbsp;field_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;)&nbsp;color1&nbsp;color2&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multi_paint_1_3 paint axes_paint vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multi_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;axes_paint&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;,&nbsp;accu&nbsp;,&nbsp;hh&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;coo&nbsp;)&nbsp;=&nbsp;prepare_1_3&nbsp;u&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;multi_project_1_3&nbsp;accu&nbsp;a&nbsp;b&nbsp;u&nbsp;v&nbsp;w&nbsp;nsteps&nbsp;coordinates&nbsp;coo&nbsp;f.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;<span class="constructor">Graphics</span>.green&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;axes_paint&nbsp;v&nbsp;w&nbsp;accu&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multi_draw_1_3 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multi_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_multi_paint_1_3&nbsp;field_partial_draw_1_2&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multi_segment_1_3 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multi_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_multi_paint_1_3&nbsp;field_partial_segment_1_2&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multi_smooth_1_3 gamma vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multi_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_multi_paint_1_3&nbsp;(&nbsp;field_partial_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multi_oversample_1_3 over_sampling_factor gamma vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multi_oversample_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_multi_paint_1_3&nbsp;(&nbsp;field_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multicolor_paint_1_3 paint axes_paint colors vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multicolor_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;axes_paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;,&nbsp;accu&nbsp;,&nbsp;hh&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;coo&nbsp;)&nbsp;=&nbsp;prepare_1_3&nbsp;u&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;multi_project_1_3&nbsp;accu&nbsp;a&nbsp;b&nbsp;u&nbsp;v&nbsp;w&nbsp;nsteps&nbsp;coordinates&nbsp;coo&nbsp;f.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;colors.(i)&nbsp;(&nbsp;soft_color&nbsp;colors.(i)&nbsp;)&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;axes_paint&nbsp;v&nbsp;w&nbsp;accu&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multicolor_draw_1_3 colors vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multicolor_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_multicolor_paint_1_3&nbsp;field_partial_draw_1_2&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;colors&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multicolor_segment_1_3 colors vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multicolor_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_multicolor_paint_1_3&nbsp;field_partial_segment_1_2&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;colors&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multicolor_smooth_1_3 gamma colors vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multicolor_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_multicolor_paint_1_3&nbsp;(&nbsp;field_partial_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;colors&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_multicolor_oversample_1_3 over_sampling_factor gamma colors vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_multicolor_oversample_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_multicolor_paint_1_3&nbsp;(&nbsp;field_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;colors&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_paint_1_3 paint vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;interval&nbsp;r&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_paint_1_3 paint vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_paint_1_3&nbsp;paint&nbsp;u&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_draw_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_paint_1_3&nbsp;field_draw_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_draw_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_1_3&nbsp;field_draw_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_segment_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_paint_1_3&nbsp;field_segment_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_segment_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_1_3&nbsp;field_segment_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_smooth_1_3 gamma vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_paint_1_3&nbsp;(&nbsp;field_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_smooth_1_3 gamma vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_1_3&nbsp;(&nbsp;field_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multi_paint_1_3 paint vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multi_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;6&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multi_paint_1_3 paint vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multi_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_3&nbsp;paint&nbsp;u&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;v&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multi_draw_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multi_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_3&nbsp;field_multi_draw_1_3&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multi_draw_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multi_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_3&nbsp;field_multi_draw_1_3&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multi_segment_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multi_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_3&nbsp;field_multi_segment_1_3&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multi_segment_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multi_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_3&nbsp;field_multi_segment_1_3&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multi_smooth_1_3 gamma vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multi_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multi_paint_1_3&nbsp;(&nbsp;field_multi_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multi_smooth_1_3 gamma vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multi_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multi_paint_1_3&nbsp;(&nbsp;field_multi_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multicolor_paint_1_3 paint colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multicolor_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;6&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;colors&nbsp;u&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multicolor_paint_1_3 paint colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multicolor_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multicolor_paint_1_3&nbsp;paint&nbsp;colors&nbsp;u&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;v&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multicolor_draw_1_3 colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multicolor_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multicolor_paint_1_3&nbsp;field_multicolor_draw_1_3&nbsp;colors&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multicolor_draw_1_3 colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multicolor_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multicolor_paint_1_3&nbsp;field_multicolor_draw_1_3&nbsp;colors&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multicolor_segment_1_3 colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multicolor_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multicolor_paint_1_3&nbsp;field_multicolor_segment_1_3&nbsp;colors&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multicolor_segment_1_3 colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multicolor_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multicolor_paint_1_3&nbsp;field_multicolor_segment_1_3&nbsp;colors&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_trans_multicolor_smooth_1_3 gamma colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_trans_multicolor_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_trans_multicolor_paint_1_3&nbsp;(&nbsp;field_multicolor_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_multicolor_smooth_1_3 gamma colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_multicolor_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_multicolor_paint_1_3&nbsp;(&nbsp;field_multicolor_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_DessinsdeRdansRnTR3"><h1>Dessins de R dans R^n ¤ TR^3</h1></span>
<span id="1_DrawingsfromRtoRnTR3"><h1>Drawings from R to R^n ¤ TR^3</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_paint_1_3 paint axes_paint vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;axes_paint&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;,&nbsp;accu&nbsp;,&nbsp;hh&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;coo&nbsp;)&nbsp;=&nbsp;prepare_1_3&nbsp;u&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;multi_project_1_3&nbsp;accu&nbsp;a&nbsp;b&nbsp;u&nbsp;v&nbsp;w&nbsp;nsteps&nbsp;coordinates&nbsp;coo&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;axes_paint&nbsp;v&nbsp;w&nbsp;accu&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;paint&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_draw_1_3 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_paint_1_3&nbsp;frame_field_draw_1_2&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_segment_1_3 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_paint_1_3&nbsp;frame_field_segment_1_2&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_smooth_1_3 gamma vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_paint_1_3&nbsp;(&nbsp;frame_field_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_oversample_1_3 over_sampling_factor gamma vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_oversample_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_paint_1_3&nbsp;(&nbsp;frame_field_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_partial_paint_1_3 paint color vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_partial_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_chose_3&nbsp;u<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;6&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;interval.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;a&nbsp;=&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;m.(1)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;m.(2)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coo&nbsp;=&nbsp;box_proj_3_2&nbsp;u&nbsp;coordinates&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;multi_project_1_3&nbsp;accu&nbsp;a&nbsp;b&nbsp;u&nbsp;v&nbsp;w&nbsp;nsteps&nbsp;coordinates&nbsp;coo&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;color&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coo&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_partial_draw_1_3 color vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_partial_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_partial_paint_1_3&nbsp;frame_field_partial_draw_1_2&nbsp;color&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_partial_segment_1_3 color vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_partial_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_partial_paint_1_3&nbsp;frame_field_partial_segment_1_2&nbsp;color&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_partial_smooth_1_3 gamma color vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_partial_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_partial_paint_1_3&nbsp;(&nbsp;frame_field_partial_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;color&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_partial_oversample_1_3 over_sampling_factor gamma color vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_partial_oversample_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_partial_paint_1_3&nbsp;(&nbsp;frame_field_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;)&nbsp;color&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multi_paint_1_3 paint axes_paint vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multi_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;axes_paint&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;,&nbsp;accu&nbsp;,&nbsp;hh&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;coo&nbsp;)&nbsp;=&nbsp;prepare_1_3&nbsp;u&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
</code><table><tr><td></td><td><span class="comment">(** The following instruction puts the extremal coordinates in the <code class="code">accu</code> array.
<p>

L'instruction suivante place les coordonnées extrémales dans le tableau <code class="code">accu</code>.*)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;multi_project_1_3&nbsp;accu&nbsp;a&nbsp;b&nbsp;u&nbsp;v&nbsp;w&nbsp;nsteps&nbsp;coordinates&nbsp;coo&nbsp;)&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;axes_paint&nbsp;v&nbsp;w&nbsp;accu&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;g.(i)&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multi_draw_1_3 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multi_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_multi_paint_1_3&nbsp;(&nbsp;frame_field_partial_draw_1_2&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multi_segment_1_3 vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multi_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_multi_paint_1_3&nbsp;(&nbsp;frame_field_partial_segment_1_2&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multi_smooth_1_3 gamma vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multi_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_multi_paint_1_3&nbsp;(&nbsp;frame_field_partial_smooth_1_2&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multi_oversample_1_3 over_sampling_factor gamma vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multi_oversample_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_multi_paint_1_3&nbsp;(&nbsp;frame_field_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multicolor_paint_1_3 paint axes_paint vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multicolor_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;axes_paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;f<br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;,&nbsp;accu&nbsp;,&nbsp;hh&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;coo&nbsp;)&nbsp;=&nbsp;prepare_1_3&nbsp;u&nbsp;interval&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
</code><table><tr><td></td><td><span class="comment">(** The following instruction puts the extremal coordinates in the <code class="code">accu</code> array.
<p>

L'instruction suivante place les coordonnées extrémales dans le tableau <code class="code">accu</code>.*)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;multi_project_1_3&nbsp;accu&nbsp;a&nbsp;b&nbsp;u&nbsp;v&nbsp;w&nbsp;nsteps&nbsp;coordinates&nbsp;coo&nbsp;)&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;axes_paint&nbsp;v&nbsp;w&nbsp;accu&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;colors.(i)&nbsp;g.(i)&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coo&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multicolor_draw_1_3 colors vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multicolor_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_multicolor_paint_1_3&nbsp;frame_field_partial_draw_1_2&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;colors&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multicolor_segment_1_3 colors vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multicolor_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_multicolor_paint_1_3&nbsp;frame_field_partial_segment_1_2&nbsp;(&nbsp;draw_axes&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;colors&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multicolor_smooth_1_3 gamma colors vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multicolor_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_multicolor_paint_1_3&nbsp;(&nbsp;frame_field_partial_smooth_1_2&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;colors&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_multicolor_oversample_1_3 over_sampling_factor gamma colors vector function interval nsteps nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_multicolor_oversample_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(f:&nbsp;(float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_multicolor_paint_1_3&nbsp;(&nbsp;frame_field_partial_oversample_1_2&nbsp;n&nbsp;gamma&nbsp;)&nbsp;(&nbsp;smooth_axes&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;)&nbsp;colors&nbsp;u&nbsp;f&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_paint_1_3 paint vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;interval&nbsp;r&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_paint_1_3 paint vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_paint_1_3&nbsp;paint&nbsp;u&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_draw_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_paint_1_3&nbsp;frame_field_draw_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_draw_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_1_3&nbsp;frame_field_draw_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_segment_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_paint_1_3&nbsp;frame_field_segment_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_segment_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_1_3&nbsp;frame_field_segment_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_smooth_1_3 gamma vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_paint_1_3&nbsp;(&nbsp;frame_field_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_smooth_1_3 gamma vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_1_3&nbsp;(&nbsp;frame_field_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_multi_paint_1_3 paint vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_multi_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;4&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_multi_paint_1_3 paint vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_multi_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_multi_paint_1_3&nbsp;paint&nbsp;u&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_multi_draw_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_multi_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_multi_paint_1_3&nbsp;frame_field_multi_draw_1_3&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_multi_draw_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_multi_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_multi_paint_1_3&nbsp;frame_field_multi_draw_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_multi_segment_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_multi_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_multi_paint_1_3&nbsp;frame_field_multi_segment_1_3&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_multi_segment_1_3 vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_multi_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_multi_paint_1_3&nbsp;frame_field_multi_segment_1_3&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_multi_smooth_1_3 gamma vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_multi_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_multi_paint_1_3&nbsp;(&nbsp;frame_field_multi_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_multi_smooth_1_3 gamma vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_multi_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_multi_paint_1_3&nbsp;(&nbsp;frame_field_multi_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_multicolor_paint_1_3 paint colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_multicolor_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nsteps&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale&nbsp;=&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;/.&nbsp;(&nbsp;interval.(1)&nbsp;-.&nbsp;interval.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;<span class="constructor">Util</span>.vector_zero&nbsp;4&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.vector_trans_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;interval.(0)&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;colors&nbsp;u&nbsp;g&nbsp;interval&nbsp;nsteps&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_multicolor_paint_1_3 paint colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_multicolor_paint_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_multicolor_paint_1_3&nbsp;paint&nbsp;colors&nbsp;u&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;)&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_multicolor_draw_1_3 colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_multicolor_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_multicolor_paint_1_3&nbsp;frame_field_multicolor_draw_1_3&nbsp;colors&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_multicolor_draw_1_3 colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_multicolor_draw_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_multicolor_paint_1_3&nbsp;frame_field_multicolor_draw_1_3&nbsp;colors&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_multicolor_segment_1_3 colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_multicolor_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_multicolor_paint_1_3&nbsp;frame_field_multicolor_segment_1_3&nbsp;colors&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_multicolor_segment_1_3 colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_multicolor_segment_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_multicolor_paint_1_3&nbsp;frame_field_multicolor_segment_1_3&nbsp;colors&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_trans_multicolor_smooth_1_3 gamma colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_trans_multicolor_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_trans_multicolor_paint_1_3&nbsp;(&nbsp;frame_field_multicolor_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;u&nbsp;v&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_multicolor_smooth_1_3 gamma colors vector matrix interval nfeet frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_multicolor_smooth_1_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(colors:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(interval:float&nbsp;array)&nbsp;(nfeet:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_multicolor_paint_1_3&nbsp;(&nbsp;frame_field_multicolor_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;colors&nbsp;u&nbsp;m&nbsp;interval&nbsp;nfeet&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_DessinsdeR2dansR3"><h1>Dessins de R^2 dans R^3</h1></span>
<span id="1_DrawingsfromR2toR3"><h1>Drawings from R^2 to R^3</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_paint_2_3 paint vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;aa&nbsp;,&nbsp;aaa&nbsp;,&nbsp;bb&nbsp;,&nbsp;bbb&nbsp;,&nbsp;hh&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;)&nbsp;=&nbsp;prepare_2_3&nbsp;u&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;accumul&nbsp;=&nbsp;ref&nbsp;bb<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;6&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accumulator&nbsp;=&nbsp;ref&nbsp;bbb&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ngrid&nbsp;&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;accumul&nbsp;:=&nbsp;bb&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accumulator&nbsp;:=&nbsp;bbb&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;;&nbsp;yy.(i)&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;xx.(i)&nbsp;;&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;value&nbsp;=&nbsp;g&nbsp;(&nbsp;!accumul&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;valeur&nbsp;=&nbsp;h&nbsp;(&nbsp;!accumulator)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;min&nbsp;accu.(0)&nbsp;(&nbsp;min&nbsp;value.(0)&nbsp;valeur.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;max&nbsp;accu.(1)&nbsp;(&nbsp;max&nbsp;value.(0)&nbsp;valeur.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(2)&nbsp;&lt;-&nbsp;min&nbsp;accu.(2)&nbsp;(&nbsp;min&nbsp;value.(1)&nbsp;valeur.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(3)&nbsp;&lt;-&nbsp;max&nbsp;accu.(3)&nbsp;(&nbsp;max&nbsp;value.(1)&nbsp;valeur.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(4)&nbsp;&lt;-&nbsp;min&nbsp;accu.(4)&nbsp;(&nbsp;min&nbsp;value.(2)&nbsp;valeur.(2)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(5)&nbsp;&lt;-&nbsp;max&nbsp;accu.(5)&nbsp;(&nbsp;max&nbsp;value.(2)&nbsp;valeur.(2)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumul&nbsp;:=&nbsp;!accumul&nbsp;+.&nbsp;aa&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumulator&nbsp;:=&nbsp;!accumulator&nbsp;+.&nbsp;aaa&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;u&nbsp;g&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;b.(0)&nbsp;|]&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;u&nbsp;h&nbsp;[|&nbsp;a.(1)&nbsp;;&nbsp;b.(1)&nbsp;|]&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_draw_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
function_paint_2_3&nbsp;function_partial_draw_1_3&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_segment_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
function_paint_2_3&nbsp;function_partial_segment_1_3&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_smooth_2_3 gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
function_paint_2_3&nbsp;(&nbsp;function_partial_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_oversample_2_3 over_sampling_factor gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_oversample_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
function_paint_2_3&nbsp;(&nbsp;function_partial_oversample_1_3&nbsp;n&nbsp;gamma&nbsp;)&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_color_paint_2_3 paint vector function color_function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_color_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;aa&nbsp;,&nbsp;aaa&nbsp;,&nbsp;bb&nbsp;,&nbsp;bbb&nbsp;,&nbsp;hh&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;)&nbsp;=&nbsp;prepare_2_3&nbsp;u&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;accumul&nbsp;=&nbsp;ref&nbsp;bb<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;6&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accumulator&nbsp;=&nbsp;ref&nbsp;bbb&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ngrid&nbsp;&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;accumul&nbsp;:=&nbsp;bb&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accumulator&nbsp;:=&nbsp;bbb&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;;&nbsp;yy.(i)&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;gc&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;fc&nbsp;[|&nbsp;x&nbsp;;&nbsp;yy.(i)&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;xx.(i)&nbsp;;&nbsp;x&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hc&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;fc&nbsp;[|&nbsp;xx.(i)&nbsp;;&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;value&nbsp;=&nbsp;g&nbsp;(&nbsp;!accumul&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;valeur&nbsp;=&nbsp;h&nbsp;(&nbsp;!accumulator)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;min&nbsp;accu.(0)&nbsp;(&nbsp;min&nbsp;value.(0)&nbsp;valeur.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;max&nbsp;accu.(1)&nbsp;(&nbsp;max&nbsp;value.(0)&nbsp;valeur.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(2)&nbsp;&lt;-&nbsp;min&nbsp;accu.(2)&nbsp;(&nbsp;min&nbsp;value.(1)&nbsp;valeur.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(3)&nbsp;&lt;-&nbsp;max&nbsp;accu.(3)&nbsp;(&nbsp;max&nbsp;value.(1)&nbsp;valeur.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(4)&nbsp;&lt;-&nbsp;min&nbsp;accu.(4)&nbsp;(&nbsp;min&nbsp;value.(2)&nbsp;valeur.(2)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(5)&nbsp;&lt;-&nbsp;max&nbsp;accu.(5)&nbsp;(&nbsp;max&nbsp;value.(2)&nbsp;valeur.(2)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumul&nbsp;:=&nbsp;!accumul&nbsp;+.&nbsp;aa&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumulator&nbsp;:=&nbsp;!accumulator&nbsp;+.&nbsp;aaa&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;gc&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;b.(0)&nbsp;|]&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;h&nbsp;hc&nbsp;[|&nbsp;a.(1)&nbsp;;&nbsp;b.(1)&nbsp;|]&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_color_draw_2_3 vector function color_function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_color_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_color_paint_2_3&nbsp;function_color_draw_1_3&nbsp;u&nbsp;f&nbsp;fc&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_color_segment_2_3 vector function color_function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_color_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_color_paint_2_3&nbsp;function_color_segment_1_3&nbsp;u&nbsp;f&nbsp;fc&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_paint_2_3 paint vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;x.(0)&nbsp;;&nbsp;x.(1)&nbsp;;&nbsp;ff&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;function_paint_2_3&nbsp;paint&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_draw_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;graph_paint_2_3&nbsp;function_partial_draw_1_3&nbsp;u&nbsp;ff&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_segment_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;graph_paint_2_3&nbsp;function_partial_segment_1_3&nbsp;u&nbsp;ff&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_smooth_2_3 gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;graph_paint_2_3&nbsp;(&nbsp;function_partial_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;ff&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_oversample_2_3 over_sampling_factor gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_oversample_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;graph_paint_2_3&nbsp;(&nbsp;function_partial_oversample_1_3&nbsp;n&nbsp;gamma&nbsp;)&nbsp;u&nbsp;ff&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_color_paint_2_3 paint vector function color_function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_color_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;x.(0)&nbsp;;&nbsp;x.(1)&nbsp;;&nbsp;ff&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;function_color_paint_2_3&nbsp;paint&nbsp;u&nbsp;f&nbsp;fc&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_color_draw_2_3 vector function color_function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_color_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;graph_color_paint_2_3&nbsp;function_color_draw_1_3&nbsp;u&nbsp;ff&nbsp;fc&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_color_segment_2_3 vector function color_function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_color_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;graph_color_paint_2_3&nbsp;function_color_segment_1_3&nbsp;u&nbsp;ff&nbsp;fc&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_reverse_paint_2_3 paint vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_reverse_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;aa&nbsp;,&nbsp;aaa&nbsp;,&nbsp;bb&nbsp;,&nbsp;bbb&nbsp;,&nbsp;hh&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;)&nbsp;=&nbsp;prepare_2_3&nbsp;u&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;accumul&nbsp;=&nbsp;ref&nbsp;bb<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;6&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accumulator&nbsp;=&nbsp;ref&nbsp;bbb&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;ngrid&nbsp;-&nbsp;1&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumul&nbsp;:=&nbsp;bb&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumulator&nbsp;:=&nbsp;bbb&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;;&nbsp;yy.(i)&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;xx.(i)&nbsp;;&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;value&nbsp;=&nbsp;g&nbsp;(&nbsp;!accumul&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;valeur&nbsp;=&nbsp;h&nbsp;(&nbsp;!accumulator)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;min&nbsp;accu.(0)&nbsp;(&nbsp;min&nbsp;value.(0)&nbsp;valeur.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;max&nbsp;accu.(1)&nbsp;(&nbsp;max&nbsp;value.(0)&nbsp;valeur.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(2)&nbsp;&lt;-&nbsp;min&nbsp;accu.(2)&nbsp;(&nbsp;min&nbsp;value.(1)&nbsp;valeur.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(3)&nbsp;&lt;-&nbsp;max&nbsp;accu.(3)&nbsp;(&nbsp;max&nbsp;value.(1)&nbsp;valeur.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(4)&nbsp;&lt;-&nbsp;min&nbsp;accu.(4)&nbsp;(&nbsp;min&nbsp;value.(2)&nbsp;valeur.(2)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(5)&nbsp;&lt;-&nbsp;max&nbsp;accu.(5)&nbsp;(&nbsp;max&nbsp;value.(2)&nbsp;valeur.(2)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumul&nbsp;:=&nbsp;!accumul&nbsp;+.&nbsp;aa&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumulator&nbsp;:=&nbsp;!accumulator&nbsp;+.&nbsp;aaa&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;u&nbsp;g&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;b.(0)&nbsp;|]&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;u&nbsp;h&nbsp;[|&nbsp;a.(1)&nbsp;;&nbsp;b.(1)&nbsp;|]&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_reverse_draw_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_reverse_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_reverse_paint_2_3&nbsp;function_partial_draw_1_3&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_reverse_segment_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_reverse_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_reverse_paint_2_3&nbsp;function_partial_segment_1_3&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_reverse_smooth_2_3 gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_reverse_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_reverse_paint_2_3&nbsp;(&nbsp;function_partial_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_reverse_oversample_2_3 over_sampling_factor gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_reverse_oversample_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_reverse_paint_2_3&nbsp;(&nbsp;function_partial_oversample_1_3&nbsp;n&nbsp;gamma&nbsp;)&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_reverse_color_paint_2_3 paint vector function color_function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_reverse_color_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;aa&nbsp;,&nbsp;aaa&nbsp;,&nbsp;bb&nbsp;,&nbsp;bbb&nbsp;,&nbsp;hh&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;)&nbsp;=&nbsp;prepare_2_3&nbsp;u&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;accumul&nbsp;=&nbsp;ref&nbsp;bb<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;6&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accumulator&nbsp;=&nbsp;ref&nbsp;bbb&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;ngrid&nbsp;-&nbsp;1&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;accumul&nbsp;:=&nbsp;bb&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accumulator&nbsp;:=&nbsp;bbb&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;;&nbsp;yy.(i)&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;gc&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;fc&nbsp;[|&nbsp;x&nbsp;;&nbsp;yy.(i)&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;xx.(i)&nbsp;;&nbsp;x&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hc&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;fc&nbsp;[|&nbsp;xx.(i)&nbsp;;&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;value&nbsp;=&nbsp;g&nbsp;(&nbsp;!accumul&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;valeur&nbsp;=&nbsp;h&nbsp;(&nbsp;!accumulator)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;min&nbsp;accu.(0)&nbsp;(&nbsp;min&nbsp;value.(0)&nbsp;valeur.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;max&nbsp;accu.(1)&nbsp;(&nbsp;max&nbsp;value.(0)&nbsp;valeur.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(2)&nbsp;&lt;-&nbsp;min&nbsp;accu.(2)&nbsp;(&nbsp;min&nbsp;value.(1)&nbsp;valeur.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(3)&nbsp;&lt;-&nbsp;max&nbsp;accu.(3)&nbsp;(&nbsp;max&nbsp;value.(1)&nbsp;valeur.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(4)&nbsp;&lt;-&nbsp;min&nbsp;accu.(4)&nbsp;(&nbsp;min&nbsp;value.(2)&nbsp;valeur.(2)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(5)&nbsp;&lt;-&nbsp;max&nbsp;accu.(5)&nbsp;(&nbsp;max&nbsp;value.(2)&nbsp;valeur.(2)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumul&nbsp;:=&nbsp;!accumul&nbsp;+.&nbsp;aa&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accumulator&nbsp;:=&nbsp;!accumulator&nbsp;+.&nbsp;aaa&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;gc&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;b.(0)&nbsp;|]&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;h&nbsp;hc&nbsp;[|&nbsp;a.(1)&nbsp;;&nbsp;b.(1)&nbsp;|]&nbsp;nsteps&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;terminate_1_3&nbsp;accu&nbsp;hh&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_reverse_color_draw_2_3 vector function color_function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_reverse_color_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_reverse_color_paint_2_3&nbsp;function_color_draw_1_3&nbsp;u&nbsp;f&nbsp;fc&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>function_reverse_color_segment_2_3 vector function color_function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;function_reverse_color_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;function_reverse_color_paint_2_3&nbsp;function_color_segment_1_3&nbsp;u&nbsp;f&nbsp;fc&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_reverse_paint_2_3 paint vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_reverse_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;x.(0)&nbsp;;&nbsp;x.(1)&nbsp;;&nbsp;ff&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;function_reverse_paint_2_3&nbsp;paint&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_reverse_draw_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_reverse_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;graph_reverse_paint_2_3&nbsp;function_partial_draw_1_3&nbsp;u&nbsp;ff&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_reverse_segment_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_reverse_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;graph_reverse_paint_2_3&nbsp;function_partial_segment_1_3&nbsp;u&nbsp;ff&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_reverse_smooth_2_3 gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_reverse_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;graph_reverse_paint_2_3&nbsp;(&nbsp;function_partial_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;ff&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_reverse_oversample_2_3 over_sampling_factor gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_reverse_oversample_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;graph_reverse_paint_2_3&nbsp;(&nbsp;function_partial_oversample_1_3&nbsp;n&nbsp;gamma&nbsp;)&nbsp;u&nbsp;ff&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_reverse_color_paint_2_3 paint vector function color_function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_reverse_color_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;x.(0)&nbsp;;&nbsp;x.(1)&nbsp;;&nbsp;ff&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;function_reverse_color_paint_2_3&nbsp;paint&nbsp;u&nbsp;f&nbsp;fc&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_reverse_color_draw_2_3 vector function color_function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_reverse_color_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;graph_reverse_color_paint_2_3&nbsp;function_color_draw_1_3&nbsp;u&nbsp;ff&nbsp;fc&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_reverse_color_segment_2_3 vector function color_function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_reverse_color_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(ff:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;graph_reverse_color_paint_2_3&nbsp;function_color_segment_1_3&nbsp;u&nbsp;ff&nbsp;fc&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_graph_paint_2_3 paint vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_graph_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale_x&nbsp;=&nbsp;(&nbsp;float&nbsp;c&nbsp;)&nbsp;/.&nbsp;(&nbsp;b.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;scale_y&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;b.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.interpol_2&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;z.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)&nbsp;*.&nbsp;scale_x&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)&nbsp;*.&nbsp;scale_y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;a&nbsp;b&nbsp;(&nbsp;max&nbsp;r&nbsp;c&nbsp;)&nbsp;(&nbsp;min&nbsp;r&nbsp;c&nbsp;)&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_graph_draw_2_3 vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_graph_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_graph_paint_2_3&nbsp;graph_draw_2_3&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_graph_segment_2_3 vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_graph_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_graph_paint_2_3&nbsp;graph_segment_2_3&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_graph_smooth_2_3 gamma vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_graph_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_graph_paint_2_3&nbsp;(&nbsp;graph_smooth_2_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_graph_color_paint_2_3 paint vector matrix color_function a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_graph_color_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale_x&nbsp;=&nbsp;(&nbsp;float&nbsp;c&nbsp;)&nbsp;/.&nbsp;(&nbsp;b.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;scale_y&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;b.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.interpol_2&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;z.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)&nbsp;*.&nbsp;scale_x&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)&nbsp;*.&nbsp;scale_y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;fc&nbsp;a&nbsp;b&nbsp;(&nbsp;max&nbsp;r&nbsp;c&nbsp;)&nbsp;(&nbsp;min&nbsp;r&nbsp;c&nbsp;)&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_graph_color_draw_2_3 vector matrix color_function a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_graph_color_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_graph_color_paint_2_3&nbsp;graph_color_draw_2_3&nbsp;u&nbsp;m&nbsp;fc&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_graph_color_segment_2_3 vector matrix color_function a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_graph_color_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_graph_color_paint_2_3&nbsp;graph_color_segment_2_3&nbsp;u&nbsp;m&nbsp;fc&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_paint_2_3 paint vector tensor a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale_x&nbsp;=&nbsp;(&nbsp;float&nbsp;c&nbsp;)&nbsp;/.&nbsp;(&nbsp;b.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;scale_y&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;b.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.interpol_2&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.vector_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;z.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)&nbsp;*.&nbsp;scale_x&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)&nbsp;*.&nbsp;scale_y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;a&nbsp;b&nbsp;(&nbsp;max&nbsp;r&nbsp;c&nbsp;)&nbsp;(&nbsp;min&nbsp;r&nbsp;c&nbsp;)&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_draw_2_3 vector tensor a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_2_3&nbsp;function_draw_2_3&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_segment_2_3 vector tensor a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_2_3&nbsp;function_segment_2_3&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_smooth_2_3 gamma vector tensor a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_paint_2_3&nbsp;(&nbsp;function_smooth_2_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_color_paint_2_3 paint vector tensor color_function  a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_color_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale_x&nbsp;=&nbsp;(&nbsp;float&nbsp;c&nbsp;)&nbsp;/.&nbsp;(&nbsp;b.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;scale_y&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;b.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.interpol_2&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.vector_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;z.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)&nbsp;*.&nbsp;scale_x&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)&nbsp;*.&nbsp;scale_y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;fc&nbsp;a&nbsp;b&nbsp;(&nbsp;max&nbsp;r&nbsp;c&nbsp;)&nbsp;(&nbsp;min&nbsp;r&nbsp;c&nbsp;)&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_color_draw_2_3 vector tensor color_function  a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_color_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_color_paint_2_3&nbsp;function_color_draw_2_3&nbsp;u&nbsp;m&nbsp;fc&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_color_segment_2_3 vector tensor color_function  a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_color_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(fc:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_color_paint_2_3&nbsp;function_color_segment_2_3&nbsp;u&nbsp;m&nbsp;fc&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_DessinsdeR2dansTR3"><h1>Dessins de R^2 dans TR^3</h1></span>
<span id="1_DrawingsfromR2toTR3"><h1>Drawings from R^2 to TR^3</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_paint_2_3 paint vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;aa&nbsp;,&nbsp;aaa&nbsp;,&nbsp;bb&nbsp;,&nbsp;bbb&nbsp;,&nbsp;hh&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;)&nbsp;=&nbsp;prepare_2_3&nbsp;u&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ngrid&nbsp;&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;;&nbsp;yy.(i)&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;xx.(i)&nbsp;;&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;<span class="constructor">Graphics</span>.green&nbsp;u&nbsp;g&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;b.(0)&nbsp;|]&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;<span class="constructor">Graphics</span>.green&nbsp;u&nbsp;h&nbsp;[|&nbsp;a.(1)&nbsp;;&nbsp;b.(1)&nbsp;|]&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_draw_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_paint_2_3&nbsp;field_partial_draw_1_3&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_segment_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_paint_2_3&nbsp;field_partial_segment_1_3&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_smooth_2_3 gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_paint_2_3&nbsp;(&nbsp;field_partial_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_oversample_2_3 over_sampling_factor gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_oversample_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_paint_2_3&nbsp;(&nbsp;field_partial_oversample_1_3&nbsp;n&nbsp;gamma&nbsp;)&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_reverse_paint_2_3 paint vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_reverse_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;aa&nbsp;,&nbsp;aaa&nbsp;,&nbsp;bb&nbsp;,&nbsp;bbb&nbsp;,&nbsp;hh&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;)&nbsp;=&nbsp;prepare_2_3&nbsp;u&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;ngrid&nbsp;&nbsp;-&nbsp;1&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;;&nbsp;yy.(i)&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;xx.(i)&nbsp;;&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;<span class="constructor">Graphics</span>.green&nbsp;u&nbsp;g&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;b.(0)&nbsp;|]&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;<span class="constructor">Graphics</span>.green&nbsp;u&nbsp;h&nbsp;[|&nbsp;a.(1)&nbsp;;&nbsp;b.(1)&nbsp;|]&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_reverse_draw_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_reverse_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_reverse_paint_2_3&nbsp;field_partial_draw_1_3&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_reverse_segment_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_reverse_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_reverse_paint_2_3&nbsp;field_partial_segment_1_3&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_reverse_smooth_2_3 gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_reverse_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_reverse_paint_2_3&nbsp;(&nbsp;field_partial_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_reverse_oversample_2_3 over_sampling_factor gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_reverse_oversample_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_reverse_paint_2_3&nbsp;(&nbsp;field_partial_oversample_1_3&nbsp;n&nbsp;gamma&nbsp;)&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_paint_2_3 paint vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale_x&nbsp;=&nbsp;(&nbsp;float&nbsp;c&nbsp;)&nbsp;/.&nbsp;(&nbsp;b.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;scale_y&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;b.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.interpol_2&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.vector_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;z.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)&nbsp;*.&nbsp;scale_x&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)&nbsp;*.&nbsp;scale_y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;a&nbsp;b&nbsp;(&nbsp;max&nbsp;r&nbsp;c&nbsp;)&nbsp;(&nbsp;min&nbsp;r&nbsp;c&nbsp;)&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_draw_2_3 vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_2_3&nbsp;field_draw_2_3&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_segment_2_3 vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_2_3&nbsp;field_segment_2_3&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_smooth_2_3 gamma vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_2_3&nbsp;(&nbsp;field_smooth_2_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_reverse_field_draw_2_3 vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_reverse_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_2_3&nbsp;field_reverse_draw_2_3&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_reverse_field_segment_2_3 vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_reverse_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_2_3&nbsp;field_reverse_segment_2_3&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_reverse_field_smooth_2_3 gamma vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_reverse_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_2_3&nbsp;(&nbsp;field_reverse_smooth_2_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_DessinsdeR2dansRnTR3"><h1>Dessins de R^2 dans R^n ¤ TR^3</h1></span>
<span id="1_DrawingsfromR2toRnTR3"><h1>Drawings from R^2 to R^n ¤ TR^3</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_paint_2_3 paint vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;aa&nbsp;,&nbsp;aaa&nbsp;,&nbsp;bb&nbsp;,&nbsp;bbb&nbsp;,&nbsp;hh&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;)&nbsp;=&nbsp;prepare_2_3&nbsp;u&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ngrid&nbsp;&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;;&nbsp;yy.(i)&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;xx.(i)&nbsp;;&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;u&nbsp;g&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;b.(0)&nbsp;|]&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;u&nbsp;h&nbsp;[|&nbsp;a.(1)&nbsp;;&nbsp;b.(1)&nbsp;|]&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_draw_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_paint_2_3&nbsp;frame_field_partial_draw_1_3&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_segment_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_paint_2_3&nbsp;frame_field_partial_segment_1_3&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_smooth_2_3 gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_paint_2_3&nbsp;(&nbsp;frame_field_partial_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_oversample_2_3 over_sampling_factor gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_oversample_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_paint_2_3&nbsp;(&nbsp;frame_field_partial_oversample_1_3&nbsp;n&nbsp;gamma&nbsp;)&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_reverse_paint_2_3 paint vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_reverse_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;aa&nbsp;,&nbsp;aaa&nbsp;,&nbsp;bb&nbsp;,&nbsp;bbb&nbsp;,&nbsp;hh&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;)&nbsp;=&nbsp;prepare_2_3&nbsp;u&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;ngrid&nbsp;&nbsp;-&nbsp;1&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;;&nbsp;yy.(i)&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;xx.(i)&nbsp;;&nbsp;x&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;u&nbsp;g&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;b.(0)&nbsp;|]&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;<span class="constructor">Graphics</span>.white&nbsp;u&nbsp;h&nbsp;[|&nbsp;a.(1)&nbsp;;&nbsp;b.(1)&nbsp;|]&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_reverse_draw_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_reverse_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_reverse_paint_2_3&nbsp;frame_field_partial_draw_1_3&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_reverse_segment_2_3 vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_reverse_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_reverse_paint_2_3&nbsp;frame_field_partial_segment_1_3&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_reverse_smooth_2_3 gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_reverse_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_reverse_paint_2_3&nbsp;(&nbsp;frame_field_partial_smooth_1_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_reverse_oversample_2_3 over_sampling_factor gamma vector function a b nsteps ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_reverse_oversample_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_reverse_paint_2_3&nbsp;(&nbsp;frame_field_partial_oversample_1_3&nbsp;n&nbsp;gamma&nbsp;)&nbsp;u&nbsp;f&nbsp;a&nbsp;b&nbsp;nsteps&nbsp;ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_paint_2_3 paint vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_paint_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale_x&nbsp;=&nbsp;(&nbsp;float&nbsp;c&nbsp;)&nbsp;/.&nbsp;(&nbsp;b.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;scale_y&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;b.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.interpol_2&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.vector_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;z.(0)&nbsp;-.&nbsp;a.(0)&nbsp;)&nbsp;*.&nbsp;scale_x&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(1)&nbsp;-.&nbsp;a.(1)&nbsp;)&nbsp;*.&nbsp;scale_y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;g&nbsp;a&nbsp;b&nbsp;(&nbsp;max&nbsp;r&nbsp;c&nbsp;)&nbsp;(&nbsp;min&nbsp;r&nbsp;c&nbsp;)&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_draw_2_3 vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_2_3&nbsp;frame_field_draw_2_3&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_segment_2_3 vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_2_3&nbsp;frame_field_segment_2_3&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_smooth_2_3 gamma vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_2_3&nbsp;(&nbsp;frame_field_smooth_2_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_reverse_draw_2_3 vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_reverse_draw_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_2_3&nbsp;frame_field_reverse_draw_2_3&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_reverse_segment_2_3 vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_reverse_segment_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_2_3&nbsp;frame_field_reverse_segment_2_3&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_reverse_smooth_2_3 gamma vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_reverse_smooth_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_2_3&nbsp;(&nbsp;frame_field_reverse_smooth_2_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;m&nbsp;a&nbsp;b&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_SectionsdeTR2"><h1>Sections de TR^2</h1></span>
<span id="1_SectionsofTR2"><h1>Sections of TR^2</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_paint_2_2 arrow_paint function half_ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_paint_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;arrow_paint&nbsp;(f:float&nbsp;array<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;r&nbsp;,&nbsp;ngrid&nbsp;,&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;hhh&nbsp;,&nbsp;vvv&nbsp;,&nbsp;h_h&nbsp;,&nbsp;v_v&nbsp;,&nbsp;h_size&nbsp;,&nbsp;v_size&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;h_factor&nbsp;,&nbsp;v_factor&nbsp;,&nbsp;h_function&nbsp;,&nbsp;v_function&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;,&nbsp;vx_function&nbsp;,&nbsp;vy_function&nbsp;)&nbsp;=&nbsp;prepare_section_2_2&nbsp;f&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;init_section_2_2&nbsp;hh&nbsp;vv&nbsp;hhh&nbsp;vvv&nbsp;h_size&nbsp;v_size&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ngrid&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;i<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ii&nbsp;=&nbsp;h_factor&nbsp;*&nbsp;i&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ngrid&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;j<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;jj&nbsp;=&nbsp;v_factor&nbsp;*&nbsp;j&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;vx_function&nbsp;(&nbsp;z.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;vy_function&nbsp;(&nbsp;z.(1)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrow&nbsp;arrow_paint&nbsp;(&nbsp;ii&nbsp;+&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;jj&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;(&nbsp;int_of_float&nbsp;xx&nbsp;)&nbsp;(&nbsp;int_of_float&nbsp;yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;terminate_section_2_2&nbsp;hh&nbsp;vv&nbsp;hhh&nbsp;vvv&nbsp;h_h&nbsp;v_v&nbsp;h_margin&nbsp;v_margin&nbsp;h_function&nbsp;v_function&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_draw_2_2 function half_ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_draw_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;array<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.white&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;field_paint_2_2&nbsp;ap&nbsp;f&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_smooth_2_2 gamma function half_ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_smooth_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;array<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_paint_2_2&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;<span class="constructor">Graphics</span>.white&nbsp;)&nbsp;f&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_partial_paint_2_2 ngrid h_margin v_margin h_factor v_factor x_function y_function vx_function vy_function arrow_paint color function half_ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_partial_paint_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;ngrid&nbsp;h_margin&nbsp;v_margin&nbsp;h_factor&nbsp;v_factor&nbsp;x_function&nbsp;y_function&nbsp;vx_function&nbsp;vy_function&nbsp;arrow_paint&nbsp;(color:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;array<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ngrid&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;x_function&nbsp;i<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ii&nbsp;=&nbsp;h_factor&nbsp;*&nbsp;i&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ngrid&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;y_function&nbsp;j<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;jj&nbsp;=&nbsp;v_factor&nbsp;*&nbsp;j&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;vx_function&nbsp;(&nbsp;z.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;vy_function&nbsp;(&nbsp;z.(1)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrow&nbsp;(&nbsp;arrow_paint&nbsp;color&nbsp;)&nbsp;(&nbsp;ii&nbsp;+&nbsp;h_margin&nbsp;)&nbsp;(&nbsp;jj&nbsp;+&nbsp;v_margin&nbsp;)&nbsp;(&nbsp;int_of_float&nbsp;xx&nbsp;)&nbsp;(&nbsp;int_of_float&nbsp;yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_paint_2_2 paint vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_paint_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale_x&nbsp;=&nbsp;(&nbsp;float&nbsp;c&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;scale_y&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.interpol_2&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.vector_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;z.(0)&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;scale_x&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(1)&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;scale_y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;g&nbsp;(&nbsp;(&nbsp;min&nbsp;r&nbsp;c&nbsp;)&nbsp;/&nbsp;2&nbsp;)&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_draw_2_2 vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_draw_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_2_2&nbsp;field_draw_2_2&nbsp;m&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_smooth_2_2 gamma vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_smooth_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_2_2&nbsp;(&nbsp;field_smooth_2_2&nbsp;gamma&nbsp;)&nbsp;m&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_SectionsdeTR2Rn"><h1>Sections de TR^2 ¤ R^n</h1></span>
<span id="1_SectionsofTR2Rn"><h1>Sections of TR^2 ¤ R^n</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_paint_2_2 arrow_paint function half_ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_paint_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;arrow_paint&nbsp;(f:float&nbsp;array<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;r&nbsp;,&nbsp;ngrid&nbsp;,&nbsp;hh&nbsp;,&nbsp;vv&nbsp;,&nbsp;hhh&nbsp;,&nbsp;vvv&nbsp;,&nbsp;h_h&nbsp;,&nbsp;v_v&nbsp;,&nbsp;h_size&nbsp;,&nbsp;v_size&nbsp;,&nbsp;h_margin&nbsp;,&nbsp;v_margin&nbsp;,&nbsp;h_factor&nbsp;,&nbsp;v_factor&nbsp;,&nbsp;h_function&nbsp;,&nbsp;v_function&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;,&nbsp;vx_function&nbsp;,&nbsp;vy_function&nbsp;)&nbsp;=&nbsp;prepare_section_2_2&nbsp;f&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;init_section_2_2&nbsp;hh&nbsp;vv&nbsp;hhh&nbsp;vvv&nbsp;h_size&nbsp;v_size&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;/&nbsp;2&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kk&nbsp;=&nbsp;2&nbsp;*&nbsp;k&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;f&nbsp;z&nbsp;<span class="keyword">in</span>&nbsp;[|&nbsp;zz.(kk)&nbsp;;&nbsp;zz.(&nbsp;kk&nbsp;+&nbsp;1&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field_partial_paint_2_2&nbsp;ngrid&nbsp;h_margin&nbsp;v_margin&nbsp;h_factor&nbsp;v_factor&nbsp;x_function&nbsp;y_function&nbsp;vx_function&nbsp;vy_function&nbsp;arrow_paint&nbsp;(&nbsp;color_list.(&nbsp;k&nbsp;<span class="keyword">mod</span>&nbsp;5&nbsp;)&nbsp;)&nbsp;g&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;terminate_section_2_2&nbsp;hh&nbsp;vv&nbsp;hhh&nbsp;vvv&nbsp;h_h&nbsp;v_v&nbsp;h_margin&nbsp;v_margin&nbsp;h_function&nbsp;v_function&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_draw_2_2 function half_ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_draw_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;array<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_paint_2_2&nbsp;ap&nbsp;f&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_smooth_2_2 gamma function half_ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_smooth_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(f:float&nbsp;array<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_paint_2_2&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;f&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_paint_2_2 paint vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_paint_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale_x&nbsp;=&nbsp;(&nbsp;float&nbsp;c&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;scale_y&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.interpol_2&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.vector_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;z.(0)&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;scale_x&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(1)&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;scale_y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;g&nbsp;(&nbsp;(&nbsp;min&nbsp;r&nbsp;c&nbsp;)&nbsp;/&nbsp;2&nbsp;-&nbsp;1&nbsp;)&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_draw_2_2 vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_draw_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_2_2&nbsp;frame_field_draw_2_2&nbsp;m&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_smooth_2_2 gamma vector matrix a b frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_smooth_2_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_2_2&nbsp;(&nbsp;frame_field_smooth_2_2&nbsp;gamma&nbsp;)&nbsp;m&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_SectionsdeTR3"><h1>Sections de TR^3</h1></span>
<span id="1_SectionsofTR3"><h1>Sections of TR^3</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_paint_3_3 arrow_paint vector color1 color2 function ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_paint_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;arrow_paint&nbsp;(u:float&nbsp;array)&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;ng&nbsp;,&nbsp;shift&nbsp;,&nbsp;h_size&nbsp;,&nbsp;v_size&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;,&nbsp;zz&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;,&nbsp;vx_function&nbsp;,&nbsp;vy_function&nbsp;)&nbsp;=&nbsp;prepare_section_3_3&nbsp;u&nbsp;f&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;init_section_3_3&nbsp;h_size&nbsp;v_size&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ng&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;couleur&nbsp;=&nbsp;mix_color&nbsp;(&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;ng&nbsp;)&nbsp;)&nbsp;color1&nbsp;color2<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;xx.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ng&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ng&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;zz.(k)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pos&nbsp;=&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;z&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xyz&nbsp;=&nbsp;f&nbsp;pos&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift.(0)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;v&nbsp;pos&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift.(1)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;w&nbsp;pos&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x_x&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;xyz&nbsp;v<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;xyz&nbsp;w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrow&nbsp;(&nbsp;arrow_paint&nbsp;couleur&nbsp;)&nbsp;(&nbsp;x_function&nbsp;shift.(0)&nbsp;)&nbsp;(&nbsp;y_function&nbsp;shift.(1)&nbsp;)&nbsp;(&nbsp;vx_function&nbsp;x_x&nbsp;)&nbsp;(&nbsp;vy_function&nbsp;y_y&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_draw_3_3 vector color1 color2 function ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_draw_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;field_paint_3_3&nbsp;ap&nbsp;u&nbsp;color1&nbsp;color2&nbsp;f&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_smooth_3_3 gamma vector color1 color2 function ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_smooth_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;field_paint_3_3&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;u&nbsp;color1&nbsp;color2&nbsp;f&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>field_partial_paint_3_3 ng xx yy zz shift v w x_function y_function vx_function vy_function arrow_paint vector color1 color2 function ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;field_partial_paint_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;ng&nbsp;xx&nbsp;yy&nbsp;zz&nbsp;shift&nbsp;v&nbsp;w&nbsp;x_function&nbsp;y_function&nbsp;vx_function&nbsp;vy_function&nbsp;arrow_paint&nbsp;(u:float&nbsp;array)&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ng&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;couleur&nbsp;=&nbsp;mix_color&nbsp;(&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;ng&nbsp;)&nbsp;)&nbsp;color1&nbsp;color2<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;xx.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ng&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ng&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;zz.(k)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pos&nbsp;=&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;z&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xyz&nbsp;=&nbsp;f&nbsp;pos&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift.(0)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;v&nbsp;pos&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift.(1)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;w&nbsp;pos&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x_x&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;xyz&nbsp;v<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y_y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;xyz&nbsp;w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arrow&nbsp;(&nbsp;arrow_paint&nbsp;couleur&nbsp;)&nbsp;(&nbsp;x_function&nbsp;shift.(0)&nbsp;)&nbsp;(&nbsp;y_function&nbsp;shift.(1)&nbsp;)&nbsp;(&nbsp;vx_function&nbsp;x_x&nbsp;)&nbsp;(&nbsp;vy_function&nbsp;y_y&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_paint_3_3 paint vector color1 color2 matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_paint_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;s&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale_x&nbsp;=&nbsp;(&nbsp;float&nbsp;s&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;scale_y&nbsp;=&nbsp;(&nbsp;float&nbsp;c&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;scale_z&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(5)&nbsp;-.&nbsp;coordinates.(4)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.interpol_3&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.vector_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;z.(0)&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;scale_x&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(1)&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;scale_y&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(2)&nbsp;-.&nbsp;coordinates.(4)&nbsp;)&nbsp;*.&nbsp;scale_z&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;color1&nbsp;color2&nbsp;g&nbsp;(&nbsp;(&nbsp;min&nbsp;r&nbsp;c&nbsp;)&nbsp;/&nbsp;2&nbsp;)&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_draw_3_3 vector color1 color2 matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_draw_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_3_3&nbsp;field_draw_3_3&nbsp;u&nbsp;color1&nbsp;color2&nbsp;m&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_field_smooth_3_3 gamma vector color1 color2 matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_field_smooth_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(color1:<span class="constructor">Graphics</span>.color)&nbsp;(color2:<span class="constructor">Graphics</span>.color)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_field_paint_3_3&nbsp;(&nbsp;field_smooth_3_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;color1&nbsp;color2&nbsp;m&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_SectionsdeTR3Rn"><h1>Sections de TR^3 ¤ R^n</h1></span>
<span id="1_SectionsofTR3Rn"><h1>Sections of TR^3 ¤ R^n</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdessines"><h2>Fonctions dessinées</h2></span>
<span id="2_Drawnfunctions"><h2>Drawn functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_paint_3_3 paint vector color1 color2 function ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_paint_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(colors1:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(colors2:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;ng&nbsp;,&nbsp;shift&nbsp;,&nbsp;h_size&nbsp;,&nbsp;v_size&nbsp;,&nbsp;v&nbsp;,&nbsp;w&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;,&nbsp;zz&nbsp;,&nbsp;x_function&nbsp;,&nbsp;y_function&nbsp;,&nbsp;vx_function&nbsp;,&nbsp;vy_function&nbsp;)&nbsp;=&nbsp;prepare_section_3_3&nbsp;u&nbsp;f&nbsp;half_ngrid&nbsp;coordinates&nbsp;size<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;&nbsp;(&nbsp;f&nbsp;[|&nbsp;coordinates.(0)&nbsp;;&nbsp;coordinates.(2)&nbsp;;&nbsp;coordinates.(4)&nbsp;|]&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;init_section_3_3&nbsp;h_size&nbsp;v_size&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;/&nbsp;3&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kk&nbsp;=&nbsp;3&nbsp;*&nbsp;k<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k_k&nbsp;=&nbsp;k&nbsp;<span class="keyword">mod</span>&nbsp;5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;f&nbsp;z&nbsp;<span class="keyword">in</span>&nbsp;[|&nbsp;zz.(kk)&nbsp;;&nbsp;zz.(&nbsp;kk&nbsp;+&nbsp;1&nbsp;)&nbsp;;&nbsp;zz.(&nbsp;kk&nbsp;+&nbsp;2&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field_partial_paint_3_3&nbsp;ng&nbsp;xx&nbsp;yy&nbsp;zz&nbsp;shift&nbsp;v&nbsp;w&nbsp;x_function&nbsp;y_function&nbsp;vx_function&nbsp;vy_function&nbsp;paint&nbsp;u&nbsp;colors1.(k_k)&nbsp;colors2.(k_k)&nbsp;g&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_draw_3_3 vector color1 color2 function ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_draw_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(colors1:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(colors2:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;color&nbsp;a&nbsp;b&nbsp;c&nbsp;d&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(a,b,c,d)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;frame_field_paint_3_3&nbsp;ap&nbsp;u&nbsp;colors1&nbsp;colors2&nbsp;f&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frame_field_smooth_3_3 gamma vector color1 color2 function ngrid frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frame_field_smooth_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(colors1:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(colors2:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(half_ngrid:int)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;frame_field_paint_3_3&nbsp;(&nbsp;draw_smooth_segment&nbsp;gamma&nbsp;)&nbsp;u&nbsp;colors1&nbsp;colors2&nbsp;f&nbsp;half_ngrid&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Dessinsdiscrets"><h2>Dessins discrets</h2></span>
<span id="2_Discretedrawings"><h2>Discrete drawings</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_paint_3_3 paint vector color1 color2 matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_paint_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;paint&nbsp;(u:float&nbsp;array)&nbsp;(colors1:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(colors2:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;s&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;scale_x&nbsp;=&nbsp;(&nbsp;float&nbsp;s&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(1)&nbsp;-.&nbsp;coordinates.(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;scale_y&nbsp;=&nbsp;(&nbsp;float&nbsp;c&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(3)&nbsp;-.&nbsp;coordinates.(2)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;scale_z&nbsp;=&nbsp;(&nbsp;float&nbsp;r&nbsp;)&nbsp;/.&nbsp;(&nbsp;coordinates.(5)&nbsp;-.&nbsp;coordinates.(4)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.interpol_3&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.vector_interpol&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.float_tune_interpol&nbsp;<span class="constructor">Infinitesimal</span>.mean_float_discrete_richardson_binary_diff&nbsp;<span class="constructor">Infinitesimal</span>.float_decay_16&nbsp;)&nbsp;)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;z.(0)&nbsp;-.&nbsp;coordinates.(0)&nbsp;)&nbsp;*.&nbsp;scale_x&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(1)&nbsp;-.&nbsp;coordinates.(2)&nbsp;)&nbsp;*.&nbsp;scale_y&nbsp;)&nbsp;(&nbsp;(&nbsp;z.(2)&nbsp;-.&nbsp;coordinates.(4)&nbsp;)&nbsp;*.&nbsp;scale_z&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;paint&nbsp;u&nbsp;colors1&nbsp;colors2&nbsp;g&nbsp;(&nbsp;(&nbsp;min&nbsp;r&nbsp;c&nbsp;)&nbsp;/&nbsp;2&nbsp;)&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_draw_3_3 vector color1 color2 matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_draw_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(u:float&nbsp;array)&nbsp;(colors1:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(colors2:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_3_3&nbsp;frame_field_draw_3_3&nbsp;u&nbsp;colors1&nbsp;colors2&nbsp;m&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_frame_field_smooth_3_3 gamma vector color1 color2 matrix frame_coordinates window_size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_frame_field_smooth_3_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(gamma:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(u:float&nbsp;array)&nbsp;(colors1:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(colors2:<span class="constructor">Graphics</span>.color&nbsp;array)&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array&nbsp;array)&nbsp;(coordinates:float&nbsp;array)&nbsp;(size:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_frame_field_paint_3_3&nbsp;(&nbsp;frame_field_smooth_3_3&nbsp;gamma&nbsp;)&nbsp;u&nbsp;colors1&nbsp;colors2&nbsp;m&nbsp;coordinates&nbsp;size&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ § § </center> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;;<br>
<br>
<span class="keyword">end</span></code></body></html>