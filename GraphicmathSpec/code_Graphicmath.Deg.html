<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Graphicmath" rel="Chapter" href="Graphicmath.html"><title>Graphicmath.Deg</title>
</head>
<body>
<code class="code"><span class="keyword">struct</span><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Introduction"><h1>Introduction</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(**
The mathematician will find in this module utility functions and types to treat big degrees and valuations
of polynomials and polynomial fractions. The infinite values are provided by the real numbers.
<p>

<span id="2_Conventions"><h2>Conventions</h2></span>
<p>

When of type <code class="code">float</code>, the absolute value of degrees must not be greater than or equal to a value
which is the minimum of the inverse of <code class="code">epsilon_float</code> and of <code class="code">max_int</code>.
<p>

The addition and substraction and multiplication pass quickly enough into big integers in order to avoid casual overflows.
<p>

This module is distributed under the same licence as Ocaml.
<p>

<center>§ </center>
<p>

La mathématicienne ou le mathématicien trouvera dans ce module des fonctions utilitaires et types pour traiter
les grands degrés et valuations des polynômes et fractions ratonnelles. Les infinis sont fournis par les réels.
<p>

<span id="2_Conventions"><h2>Conventions</h2></span>
<p>

Pour les degrés de type <code class="code">float</code>, la valeur absolue ne doit pas atteindre ou dépasser une valeur
qui est le minimum de l'inverse de <code class="code">epsilon_float</code> et de <code class="code">max_int</code>.
<p>

Les addition, soustraction et multiplication passent assez rapidement dans les grands entiers pour éviter d'éventuels dépassements de capacité.
<p>

Ce module est distribué selon la même licence qu'Ocaml.
<p>

<center>Copyright Stéphane Grognet </center>
<center>Laboratoire de mathématiques Jean Leray UMR 6629 CNRS </center>
<center>Fédération de recherche mathématique des Pays de la Loire </center>
<center>IREM des Pays de la Loire - Université de Nantes </center>
<center>version 0.1</center>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@version 0.1
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@author Stéphane Grognet
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@since février 2012
*)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>bad_float real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;bad_float&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;abs_float&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;result&nbsp;=&nbsp;ref&nbsp;<span class="keyword">false</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;xx&nbsp;&gt;=&nbsp;1.&nbsp;/.&nbsp;epsilon_float&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;(&nbsp;int_of_float&nbsp;xx&nbsp;&lt;&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;(&nbsp;int_of_float&nbsp;xx&nbsp;&gt;=&nbsp;max_int&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;(&nbsp;xx&nbsp;&gt;=&nbsp;float&nbsp;max_int&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;<span class="keyword">true</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;x&nbsp;infinity&nbsp;=&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;x&nbsp;neg_infinity&nbsp;=&nbsp;0&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;<span class="keyword">false</span>&nbsp;;<br>
&nbsp;&nbsp;!result&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The type collects integer and big integer and real values.
The real numbers provide the infinities.
<p>

Le type collationne les valeurs entières, grandes entières, réelles.
Les réels fournissent les infinis. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">type</span>&nbsp;t&nbsp;=&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;<span class="keyword">of</span>&nbsp;float<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;<span class="keyword">of</span>&nbsp;int<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Big_int</span>.big_int&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;zero&nbsp;=&nbsp;<span class="constructor">Int</span>&nbsp;0&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;witness&nbsp;=&nbsp;<span class="constructor">Witness</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_demakeup degree</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_demakeup&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;u&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.float_demakeup."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;u<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Not&nbsp;a&nbsp;Float&nbsp;in&nbsp;Deg.float_demakeup."</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_demakeup degree</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_demakeup&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;u<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Not&nbsp;an&nbsp;Int&nbsp;in&nbsp;Deg.int_demakeup."</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>big_demakeup degree</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;big_demakeup&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;u<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Not&nbsp;a&nbsp;Big&nbsp;in&nbsp;Deg.float_demakeup."</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>print degree</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;print&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;print_string&nbsp;<span class="string">"Deg.Witness"</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;print_float&nbsp;u<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;print_int&nbsp;u<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;print_string&nbsp;(&nbsp;<span class="constructor">Big_int</span>.string_of_big_int&nbsp;u&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>eq_zero degree</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;eq_zero&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">false</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;0.&nbsp;)&nbsp;=&nbsp;0<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;0&nbsp;)&nbsp;=&nbsp;0<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.compare_big_int&nbsp;u&nbsp;<span class="constructor">Big_int</span>.zero_big_int&nbsp;)&nbsp;=&nbsp;0&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>copy degree</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;copy&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Witness</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Float</span>&nbsp;(&nbsp;u&nbsp;+.&nbsp;0.&nbsp;)<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Int</span>&nbsp;u<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.add_big_int&nbsp;u&nbsp;<span class="constructor">Big_int</span>.zero_big_int&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>opp degree</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;opp&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Witness</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;u&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.opp."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Float</span>&nbsp;(&nbsp;-.&nbsp;u&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;-&nbsp;u&nbsp;)<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.minus_big_int&nbsp;u&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>to_int degree</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;to_int&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;in&nbsp;Deg.to_int."</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int_of_float&nbsp;u<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;u<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big_int</span>.int_of_big_int&nbsp;u&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>from_int integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;from_int&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(u:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>pred degree</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;pred&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Witness</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Float</span>&nbsp;(&nbsp;u&nbsp;-.&nbsp;1.&nbsp;)<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;pred&nbsp;u&nbsp;)<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.pred_big_int&nbsp;u&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>succ degree</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;succ&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Witness</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Float</span>&nbsp;(&nbsp;u&nbsp;+.&nbsp;1.&nbsp;)<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;succ&nbsp;u&nbsp;)<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.succ_big_int&nbsp;u&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>maximum degree1 degree2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;maximum&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:t)&nbsp;(y:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;u&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.maximum."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.maximum."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Float</span>&nbsp;(&nbsp;max&nbsp;u&nbsp;v&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;maximum&nbsp;y&nbsp;(&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;int_of_float&nbsp;u&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.maximum."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;max&nbsp;u&nbsp;(&nbsp;int_of_float&nbsp;v&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;max&nbsp;u&nbsp;v&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.max_big_int&nbsp;v&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;u&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.maximum."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;maximum&nbsp;x&nbsp;(&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;int_of_float&nbsp;v&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;maximum&nbsp;y&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.max_big_int&nbsp;u&nbsp;v&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>minimum degree1 degree2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;minimum&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:t)&nbsp;(y:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;opp&nbsp;(&nbsp;maximum&nbsp;(&nbsp;opp&nbsp;x&nbsp;)&nbsp;(&nbsp;opp&nbsp;y&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>add degree1 degree2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;add&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:t)&nbsp;(y:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;adding&nbsp;in&nbsp;Deg.add."</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;u&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.add."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;adding&nbsp;in&nbsp;Deg.add."</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.add."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;neg_infinity&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Undetermined&nbsp;form&nbsp;in&nbsp;Deg.add."</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;adding&nbsp;in&nbsp;Deg.add."</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.add."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;infinity&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Undetermined&nbsp;form&nbsp;in&nbsp;Deg.add."</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;adding&nbsp;in&nbsp;Deg.add."</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.add."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;u&nbsp;)&nbsp;+&nbsp;(&nbsp;int_of_float&nbsp;v&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;add&nbsp;y&nbsp;(&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;int_of_float&nbsp;u&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;adding&nbsp;in&nbsp;Deg.add."</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.add."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;add&nbsp;x&nbsp;(&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;int_of_float&nbsp;v&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.add_big_int&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;u&nbsp;)&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;v&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.add_big_int&nbsp;v&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;u&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;adding&nbsp;in&nbsp;Deg.add."</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.add."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;add&nbsp;x&nbsp;(&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;int_of_float&nbsp;v&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;add&nbsp;y&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.add_big_int&nbsp;u&nbsp;v&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sub degree1 degree2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sub&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:t)&nbsp;(y:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;substracting&nbsp;in&nbsp;Deg.sub."</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;u&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.sub."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;substracting&nbsp;in&nbsp;Deg.sub."</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.sub."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;x&nbsp;(&nbsp;opp&nbsp;y&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;add&nbsp;x&nbsp;(&nbsp;opp&nbsp;y&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;substracting&nbsp;in&nbsp;Deg.sub."</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.sub."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;x&nbsp;(&nbsp;opp&nbsp;y&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;add&nbsp;x&nbsp;(&nbsp;opp&nbsp;y&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>shift integer degree</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;shift&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(i:int)&nbsp;(x:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;add&nbsp;(&nbsp;<span class="constructor">Int</span>&nbsp;i&nbsp;)&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>mult degree1 degree2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;mult&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:t)&nbsp;(y:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;multiplying&nbsp;in&nbsp;Deg.sub."</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;u&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.mult."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;multiplying&nbsp;in&nbsp;Deg.sub."</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.mult."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;v&nbsp;=&nbsp;0.&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Undetermined&nbsp;form&nbsp;in&nbsp;Deg.mult."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;v&nbsp;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;opp&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;0&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Undetermined&nbsp;form&nbsp;in&nbsp;Deg.mult."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;opp&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;<span class="constructor">Big_int</span>.zero_big_int&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Undetermined&nbsp;form&nbsp;in&nbsp;Deg.mult."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;opp&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;opp&nbsp;(&nbsp;mult&nbsp;(&nbsp;opp&nbsp;x&nbsp;)&nbsp;y&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;mult&nbsp;(&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;(&nbsp;int_of_float&nbsp;u&nbsp;)&nbsp;)&nbsp;)&nbsp;y<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;multiplying&nbsp;in&nbsp;Deg.sub."</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.mult."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;0&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Undetermined&nbsp;form&nbsp;in&nbsp;Deg.mult."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;opp&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;opp&nbsp;(&nbsp;mult&nbsp;x&nbsp;(&nbsp;opp&nbsp;y&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.mult_big_int&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;u&nbsp;)&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;(&nbsp;int_of_float&nbsp;v&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.mult_big_int&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;u&nbsp;)&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;v&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.mult_big_int&nbsp;v&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;u&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Witness&nbsp;multiplying&nbsp;in&nbsp;Deg.sub."</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.mult."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;<span class="constructor">Big_int</span>.zero_big_int&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Undetermined&nbsp;form&nbsp;in&nbsp;Deg.mult."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;opp&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;opp&nbsp;(&nbsp;mult&nbsp;x&nbsp;(&nbsp;opp&nbsp;y&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.mult_big_int&nbsp;u&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;(&nbsp;int_of_float&nbsp;v&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;mult&nbsp;y&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big</span>&nbsp;(&nbsp;<span class="constructor">Big_int</span>.mult_big_int&nbsp;u&nbsp;v&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>compare degree1 degree2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;compare&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:t)&nbsp;(y:t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;0<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;u&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.compare."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span>&nbsp;(&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;float_demakeup&nbsp;y&nbsp;<span class="keyword">in</span>&nbsp;ignore&nbsp;(&nbsp;bad_float&nbsp;v&nbsp;)&nbsp;;&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;v&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Not&nbsp;a&nbsp;Float&nbsp;in&nbsp;Deg.float_demakeup."</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span>&nbsp;(&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;float_demakeup&nbsp;y&nbsp;<span class="keyword">in</span>&nbsp;ignore&nbsp;(&nbsp;bad_float&nbsp;v&nbsp;)&nbsp;;&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;v&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Not&nbsp;a&nbsp;Float&nbsp;in&nbsp;Deg.float_demakeup."</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.compare."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;v<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;compare&nbsp;(&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;int_of_float&nbsp;u&nbsp;)&nbsp;)&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.compare."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;(&nbsp;int_of_float&nbsp;v&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;u&nbsp;v<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big_int</span>.compare_big_int&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;u&nbsp;)&nbsp;v<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;u&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Witness</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Float</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;bad_float&nbsp;v&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;real&nbsp;in&nbsp;Deg.compare."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;(&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;infinity&nbsp;,&nbsp;<span class="constructor">Pervasives</span>.compare&nbsp;v&nbsp;neg_infinity&nbsp;)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;0&nbsp;,&nbsp;_&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;(&nbsp;_&nbsp;,&nbsp;0&nbsp;)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;-&nbsp;(&nbsp;compare&nbsp;(&nbsp;<span class="constructor">Int</span>&nbsp;(&nbsp;int_of_float&nbsp;v&nbsp;)&nbsp;)&nbsp;x&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Int</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;-&nbsp;(&nbsp;compare&nbsp;y&nbsp;x&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Big</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big_int</span>.compare_big_int&nbsp;u&nbsp;v<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ § § </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<span class="keyword">end</span></code></body></html>