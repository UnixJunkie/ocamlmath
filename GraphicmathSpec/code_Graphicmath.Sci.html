<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Graphicmath" rel="Chapter" href="Graphicmath.html"><title>Graphicmath.Sci</title>
</head>
<body>
<code class="code"><span class="keyword">struct</span><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Introduction"><h1>Introduction</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(**
The mathematician will find in this module:
<p>
<ul>
<li>constructions in order to do the elementary operations with complex numbers in scientific notation whose mantissas are greater than fifty three bits,</li>
</ul>
<OL>
<li>either with absolute precision, mantissas being big rational numbers, </li>
<li>or with mantissas truncated at 1024 bits,</li>
</OL>
<ul>
<li>common convergence acceleration methods,</li>
</ul>
<ul>
<li>functions on complex numbers in scientific notation whose mantissas are truncated at 1024 bits
(the last figures of the mantissa may be wrong):</li>
</ul>
<OL>
<li>root functions,</li>
<li>solutions of polynomial equations of degree 2 or 3 or 4,</li>
<li>trigonometric functions.</li>
</OL>

<span id="2_Conventions"><h2>Conventions</h2></span>
<p>

A (complex) number in scientific notation is an array <code class="code">[| x ; y ; w |]</code> of three numbers of type <code class="code"><span class="constructor">Num</span>.num</code> 
which represent <code class="code">z = ( x + i y ) * 2 ^ w</code>. They satisfy <code class="code">x = y = w = 0</code> or <code class="code">1 &lt;= x ^ 2 + y ^ 2 &lt; 4</code>, and <code class="code">w</code> is a big integer.
<p>

Some constants come from the module <a href="Data.Classical.html"> Data.Classical</a>.
<p>

This module is distributed under the same licence as Ocaml.
<p>

<center>§ </center>
<p>

La mathématicienne ou le mathématicien trouvera dans ce module :
<p>
<ul>
<li>des constructions pour effectuer les opérations élémentaires avec des nombres complexes en notation scientifique dont la mantisse dépasse cinquante-trois bits :</li>
</ul>
<OL>
<li>en précision absolue, les mantisses étant de grands nombres rationnels,</li>
<li>ou avec des mantisses tronquées à 1024 bits,</li>
</OL>
<ul>
<li>des méthodes usuelles d'accélération de convergence,</li>
</ul>
<ul>
<li>des fonctions sur des nombres complexes en notation scientifique dont la mantisse est tronquée à 1024 bits
(les derniers chiffres de la mantisse peuvent être faux) : </li>
</ul>
<OL>
<li>fonctions racines,</li>
<li>solutions d'équations polynomiales de degré 2, 3 ou 4,</li>
<li>fonctions trigonométriques.</li>
</OL>

<span id="2_Conventions"><h2>Conventions</h2></span>
<p>

Un nombre (complexe) en notation scientifique est un tableau <code class="code">[| x ; y ; w |]</code> de trois nombres de type <code class="code"><span class="constructor">Num</span>.num</code> 
qui représentent <code class="code">z = ( x + i y ) * 2 ^ w</code>. Ils vérifient <code class="code">x = y = w = 0</code> ou bien <code class="code">1 &lt;= x ^ 2 + y ^ 2 &lt; 4</code>, et <code class="code">w</code> est un grand entier.
<p>

Des constantes proviennent du module <a href="Data.Classical.html"> Data.Classical</a>.
<p>

Ce module est distribué selon la même licence qu'Ocaml.
<p>

<center>Copyright Stéphane Grognet </center>
<center>Laboratoire de mathématiques Jean Leray UMR 6629 CNRS </center>
<center>Fédération de recherche mathématique des Pays de la Loire </center>
<center>IREM des Pays de la Loire - Université de Nantes </center>
<center>version 0.4</center>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@version 0.4
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@author Stéphane Grognet
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@since 2011, 2012, 2013
*)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Util</span>&nbsp;;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Data</span>&nbsp;;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Hash</span>&nbsp;;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Matrix</span>&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Constantesdiversesetmisesenforme"><h1>Constantes diverses et mises en forme</h1></span>
<span id="1_Miscellaneousconstantsandformatting"><h1>Miscellaneous constants and formatting</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_0</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_0&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;0&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_1</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_1&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;1&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_1</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_1&nbsp;=&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;num_1&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;2&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_2&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;2&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_3</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_3&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;3&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_3</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_3&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;3&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_3_over_2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_3_over_2&nbsp;=&nbsp;<span class="constructor">Num</span>.div_num&nbsp;num_3&nbsp;num_2&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_3_over_2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_3_over_2&nbsp;=&nbsp;<span class="constructor">Num</span>.div_num&nbsp;num_minus_3&nbsp;num_2&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_4</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_4&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;4&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_4</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_4&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;4&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_5</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_5&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;5<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_5</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_5&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;5&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_6</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_6&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;6<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_6</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_6&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;6&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_7</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_7&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;7<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_7</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_7&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;7&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_8</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_8&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;8<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_8</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_8&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;8&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_9</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_9&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;9<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_9</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_9&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;9&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_10</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_10&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;10&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_10</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_10&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;10&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_12</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_12&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;12&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_12</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_12&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;12&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_16</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_16&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;16&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_16</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_16&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;16&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_27</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_27&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;27&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_27</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_27&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;27&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_32</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_32&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;32&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_32</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_32&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;32&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_64</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_64&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;64&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_64</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_64&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;64&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_128</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_128&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;128&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_128</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_128&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;128&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_256</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_256&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;256&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_256</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_256&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;256&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_512</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_512&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;512&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_512</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_512&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;512&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_1024&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;1024&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_1024&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;1024&nbsp;)<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2048</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2048&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;2048&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_2048</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_2048&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;2048&nbsp;)<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_16</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_16&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_16&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_32</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_32&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_32&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_64</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_64&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_64&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_128</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_128&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_128&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_256</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_256&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_256&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_512</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_512&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_512&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_1024&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_1024&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_2048</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_2048&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_2048&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_05</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_05&nbsp;=&nbsp;&nbsp;<span class="constructor">Num</span>.div_num&nbsp;num_1&nbsp;num_2&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_minus_05</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_minus_05&nbsp;=&nbsp;&nbsp;<span class="constructor">Num</span>.div_num&nbsp;num_minus_1&nbsp;num_2&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_minus_16</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_minus_16&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_minus_16&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_minus_32</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_minus_32&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_minus_32&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_minus_64</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_minus_64&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_minus_64&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_minus_128</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_minus_128&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_minus_128&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_minus_256</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_minus_256&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_minus_256&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_minus_512</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_minus_512&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_minus_512&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_2_pow_minus_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_2_pow_minus_1024&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;num_minus_1024&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The <code class="code">num_of_float</code> function is not provided by the Ocaml distribution.
<p>

La fonction <code class="code">num_of_float</code> n'est pas fournie par la distribution <code class="code"><span class="constructor">Ocaml</span></code>. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_of_float real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_of_float&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;x&nbsp;&gt;&nbsp;max_float&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Too&nbsp;big&nbsp;a&nbsp;float&nbsp;for&nbsp;Sci.num_of_float."</span><br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;(&nbsp;string_of_float&nbsp;x&nbsp;)&nbsp;^&nbsp;<span class="string">"e"</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;i&nbsp;=&nbsp;<span class="constructor">String</span>.index&nbsp;s&nbsp;<span class="string">'e'</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">String</span>.length&nbsp;s&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;j&nbsp;=&nbsp;<span class="keyword">try</span>&nbsp;<span class="constructor">String</span>.index&nbsp;s&nbsp;<span class="string">'.'</span>&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Not_found</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;i&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">String</span>.sub&nbsp;s&nbsp;0&nbsp;j<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;l&nbsp;&lt;=&nbsp;3&nbsp;<span class="keywordsign">||</span>&nbsp;i&nbsp;=&nbsp;j&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="constructor">String</span>.sub&nbsp;s&nbsp;(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;(&nbsp;i&nbsp;-&nbsp;j&nbsp;-&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;e&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;i&nbsp;=&nbsp;l&nbsp;-&nbsp;1&nbsp;<span class="keyword">then</span>&nbsp;<span class="string">"0"</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="constructor">String</span>.sub&nbsp;s&nbsp;(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;(&nbsp;l&nbsp;-&nbsp;i&nbsp;-&nbsp;2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;<span class="constructor">String</span>.make&nbsp;(&nbsp;max&nbsp;1&nbsp;(&nbsp;i&nbsp;-&nbsp;j&nbsp;)&nbsp;)&nbsp;<span class="string">'0'</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">String</span>.set&nbsp;d&nbsp;0&nbsp;<span class="string">'1'</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_string&nbsp;(&nbsp;n&nbsp;^&nbsp;nn&nbsp;^&nbsp;<span class="string">"/"</span>&nbsp;^&nbsp;d&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ee&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_string&nbsp;e&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_10&nbsp;ee&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;m&nbsp;p<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;&nbsp;&nbsp;&nbsp;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_epsilon_float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_epsilon_float&nbsp;=&nbsp;num_of_float&nbsp;epsilon_float&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_min_float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_min_float&nbsp;=&nbsp;num_of_float&nbsp;min_float&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_max_float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_max_float&nbsp;=&nbsp;num_of_float&nbsp;max_float&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_min_int</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_min_int&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;min_int&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_max_int</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_max_int&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;max_int&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_0</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_0&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_1</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_1&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_1</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_1&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_2&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_2&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_2i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_2i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_1&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_2i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_2i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_1&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_4</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_4&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_2&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_4</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_4&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_2&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_4i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_4i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_2&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_4i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_4i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_2&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_8</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_8&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_3&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_8</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_8&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_3&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_8i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_8i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_3&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_8i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_8i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_3&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_16</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_16&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_4&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_16</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_16&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_4&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_16i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_16i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_4&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_16i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_16i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_4&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_32</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_32&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_5&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_32</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_32&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_5&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_32i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_32i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_5&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_32i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_32i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_5&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_64</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_64&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_6&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_64</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_64&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_6&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_64i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_64i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_6&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_64i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_64i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_6&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_128</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_128&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_7&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_128</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_128&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_7&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_128i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_128i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_7&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_128i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_128i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_7&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_256</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_256&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_8&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_256</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_256&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_8&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_256i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_256i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_8&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_256i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_256i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_8&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_512</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_512&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_9&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_512</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_512&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_9&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_512i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_512i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_9&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_512i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_512i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_9&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_1024&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_10&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_1024&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_10&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_1024i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_1024i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_10&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_1024i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_1024i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_10&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_05</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_05&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_05</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_05&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_05i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_05i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_minus_1&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_05i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_05i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_minus_1&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_025</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_025&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_2&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_025</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_2&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_2&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_025i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_025i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_minus_2&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_025i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_025i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_minus_2&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_0125</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_0125&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_3&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_0125</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_2&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_3&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_0125i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_025i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_minus_3&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_0125i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_025i&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_minus_3&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_2_pow_minus_4</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_2_pow_minus_4&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_4&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_2_pow_minus_4</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_2_pow_minus_4&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_4&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_i_2_pow_minus_4</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_i_2_pow_minus_4&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_minus_4&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_i_2_pow_minus_4</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_i_2_pow_minus_4&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_minus_4&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_2_pow_minus_5</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_2_pow_minus_5&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_5&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_2_pow_minus_5</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_2_pow_minus_5&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_5&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_i_2_pow_minus_5</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_i_2_pow_minus_5&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_minus_5&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_i_2_pow_minus_5</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_i_2_pow_minus_5&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_minus_5&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_2_pow_minus_6</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_2_pow_minus_6&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_6&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_2_pow_minus_6</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_2_pow_minus_6&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_6&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_i_2_pow_minus_6</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_i_2_pow_minus_6&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_minus_6&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_i_2_pow_minus_6</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_i_2_pow_minus_6&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_minus_6&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_2_pow_minus_7</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_2_pow_minus_7&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_7&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_2_pow_minus_7</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_2_pow_minus_7&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_7&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_i_2_pow_minus_7</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_i_2_pow_minus_7&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_minus_7&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_i_2_pow_minus_7</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_i_2_pow_minus_7&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_minus_7&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_2_pow_minus_8</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_2_pow_minus_8&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_8&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_2_pow_minus_8</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_2_pow_minus_8&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_8&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_i_2_pow_minus_8</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_i_2_pow_minus_8&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_minus_8&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_i_2_pow_minus_8</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_i_2_pow_minus_8&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_minus_8&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_2_pow_minus_9</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_2_pow_minus_9&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_9&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_2_pow_minus_9</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_2_pow_minus_9&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_9&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_i_2_pow_minus_9</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_i_2_pow_minus_9&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_minus_9&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_i_2_pow_minus_9</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_i_2_pow_minus_9&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_minus_9&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_2_pow_minus_10</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_2_pow_minus_10&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_10&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_2_pow_minus_10</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_2_pow_minus_10&nbsp;=&nbsp;[|&nbsp;num_minus_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_10&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_i_2_pow_minus_10</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_i_2_pow_minus_10&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;;&nbsp;num_minus_10&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_i_2_pow_minus_10</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_i_2_pow_minus_10&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_minus_1&nbsp;;&nbsp;num_minus_10&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The formatting function of numbers in scientific notation is delicate 
and is useful to the definitions of the elementary operations.
<p>

La fonction de mise en forme des nombres en notation scientifique est délicate 
et sert aux définitions des opérations élémentaires. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>format number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;format&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;ref&nbsp;a.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Num</span>.add_num&nbsp;(&nbsp;<span class="constructor">Num</span>.square_num&nbsp;!x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.square_num&nbsp;!y&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.eq_num&nbsp;!m&nbsp;num_0&nbsp;<span class="keyword">then</span>&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="constructor">Num</span>.ge_num&nbsp;!m&nbsp;num_2_pow_1024&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!w&nbsp;num_512&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_minus_512&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;num_2_pow_minus_512&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!m&nbsp;num_2_pow_minus_1024&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.ge_num&nbsp;!m&nbsp;num_2_pow_512&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!w&nbsp;num_256&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_minus_256&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;num_2_pow_minus_256&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!m&nbsp;num_2_pow_minus_512&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.ge_num&nbsp;!m&nbsp;num_2_pow_256&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!w&nbsp;num_128&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_minus_128&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;num_2_pow_minus_128&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!m&nbsp;num_2_pow_minus_256&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.ge_num&nbsp;!m&nbsp;num_2_pow_128&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!w&nbsp;num_64&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_minus_64&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;num_2_pow_minus_64&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!m&nbsp;num_2_pow_minus_128&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.ge_num&nbsp;!m&nbsp;num_2_pow_64&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!w&nbsp;num_32&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_minus_32&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;num_2_pow_minus_32&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!m&nbsp;num_2_pow_minus_64&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.ge_num&nbsp;!m&nbsp;num_2_pow_32&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!w&nbsp;num_16&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_minus_16&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;num_2_pow_minus_16&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!m&nbsp;num_2_pow_minus_32&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="constructor">Num</span>.le_num&nbsp;!m&nbsp;num_2_pow_minus_1024&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;!w&nbsp;num_512&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_512&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;num_2_pow_512&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!m&nbsp;num_2_pow_1024&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.le_num&nbsp;!m&nbsp;num_2_pow_minus_512&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;!w&nbsp;num_256&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_256&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;num_2_pow_256&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!m&nbsp;num_2_pow_512&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.le_num&nbsp;!m&nbsp;num_2_pow_minus_256&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;!w&nbsp;num_128&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_128&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;num_2_pow_128&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!m&nbsp;num_2_pow_256&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.le_num&nbsp;!m&nbsp;num_2_pow_minus_128&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;!w&nbsp;num_64&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_64&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;num_2_pow_64&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!m&nbsp;num_2_pow_128&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.le_num&nbsp;!m&nbsp;num_2_pow_minus_64&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;!w&nbsp;num_32&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_32&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;num_2_pow_32&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!m&nbsp;num_2_pow_64&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.le_num&nbsp;!m&nbsp;num_2_pow_minus_32&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;!w&nbsp;num_16&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_16&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;num_2_pow_16&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!m&nbsp;num_2_pow_32&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Num</span>.float_of_num&nbsp;!m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;mmm&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;floor&nbsp;(&nbsp;(&nbsp;log&nbsp;mm&nbsp;)&nbsp;/.&nbsp;log&nbsp;4.&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_05&nbsp;mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;coeff&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!y&nbsp;coeff&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!w&nbsp;mmm&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;(&nbsp;<span class="constructor">Num</span>.square_num&nbsp;!x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.square_num&nbsp;!y&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.ge_num&nbsp;!m&nbsp;num_4&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.div_num&nbsp;!x&nbsp;num_2&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Num</span>.div_num&nbsp;!y&nbsp;num_2&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;<span class="constructor">Num</span>.succ_num&nbsp;!w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;!x&nbsp;;&nbsp;!y&nbsp;;&nbsp;!w&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_3</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_3&nbsp;=&nbsp;format&nbsp;[|&nbsp;num_3&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_3</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_3&nbsp;=&nbsp;format&nbsp;[|&nbsp;num_minus_3&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_3i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_3i&nbsp;=&nbsp;format&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_3&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_6</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_6&nbsp;=&nbsp;format&nbsp;[|&nbsp;num_3&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_6</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_6&nbsp;=&nbsp;format&nbsp;[|&nbsp;num_minus_3&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_1&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_27</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_27&nbsp;=&nbsp;format&nbsp;[|&nbsp;num_27&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_minus_27</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_minus_27&nbsp;=&nbsp;format&nbsp;[|&nbsp;num_minus_27&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_10</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_10&nbsp;=&nbsp;format&nbsp;[|&nbsp;num_10&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_10i</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_10i&nbsp;=&nbsp;format&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_10&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_FonctionslmentairespourNumnum"><h1>Fonctions élémentaires pour Num.num</h1></span>
<span id="1_ElementaryfunctionsforNumnum"><h1>Elementary functions for Num.num</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_sqrt integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_sqrt&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Num</span>.num_of_big_int&nbsp;(&nbsp;<span class="constructor">Big_int</span>.sqrt_big_int&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;x&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_add_int integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_add_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Num</span>.add_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;y&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_sub_int integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_sub_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;y&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_mult_int integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_mult_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;y&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_div_int integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_div_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Num</span>.div_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;y&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_mod_int integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_mod_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Num</span>.mod_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;y&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>make_fraction num denom</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;make_fraction&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(numer:int)&nbsp;(denom:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Num</span>.num_of_ratio&nbsp;(&nbsp;<span class="constructor">Ratio</span>.create_ratio&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;numer&nbsp;)&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;denom&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>print_make_fraction num denom</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;print_make_fraction&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(num:int)&nbsp;(denom:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;print_string&nbsp;(&nbsp;<span class="constructor">Num</span>.string_of_num&nbsp;(&nbsp;make_fraction&nbsp;num&nbsp;denom&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Fonctionslmentairespourlesnombrescomplexesennotationscientifique"><h1>Fonctions élémentaires pour les nombres complexes en notation scientifique</h1></span>
<span id="1_Elementaryfunctionsforcomplexnumbersinscientificnotation"><h1>Elementary functions for complex numbers in scientific notation</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_copy number</pre> *)</span></td></tr></table><code class="code">&nbsp;<br>
<span class="keyword">let</span>&nbsp;sci_copy&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;3&nbsp;num_0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;2&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;b.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_0&nbsp;a.(i)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;b&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_of_sci number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_of_sci&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Num</span>.float_of_num&nbsp;a&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>complex_of_sci number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;complex_of_sci&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;a.(0)&nbsp;(&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;a.(2)&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;a.(1)&nbsp;(&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;a.(2)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Num</span>.float_of_num&nbsp;x<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Num</span>.float_of_num&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;[|&nbsp;[|&nbsp;xx&nbsp;;&nbsp;-.&nbsp;yy&nbsp;|]&nbsp;;&nbsp;[|&nbsp;yy&nbsp;;&nbsp;xx&nbsp;|]&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_of_num number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_of_num&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;format&nbsp;[|&nbsp;x&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_to_string_array number_array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_to_string_array&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Num</span>.string_of_num&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;[|&nbsp;s.(0)&nbsp;;&nbsp;s.(1)&nbsp;;&nbsp;s.(2)&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_to_string number_array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_to_string&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Num</span>.string_of_num&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;s.(0)&nbsp;^&nbsp;<span class="string">"&nbsp;;&nbsp;"</span>&nbsp;^&nbsp;s.(1)&nbsp;^&nbsp;<span class="string">"&nbsp;;&nbsp;"</span>&nbsp;^&nbsp;s.(2)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_of_string_array string_array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_of_string_array&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(s:string&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Num</span>.num_of_string&nbsp;s&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;format&nbsp;[|&nbsp;x.(0)&nbsp;;&nbsp;x.(1)&nbsp;;&nbsp;x.(2)&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_of_string string</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_of_string&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(s:string)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;listing&nbsp;=&nbsp;<span class="constructor">Str</span>.split&nbsp;(&nbsp;<span class="constructor">Str</span>.regexp&nbsp;<span class="string">"&nbsp;;&nbsp;"</span>&nbsp;)&nbsp;s&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Num</span>.num_of_string&nbsp;(&nbsp;<span class="constructor">Array</span>.of_list&nbsp;listing&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;format&nbsp;[|&nbsp;x.(0)&nbsp;;&nbsp;x.(1)&nbsp;;&nbsp;x.(2)&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_of_float real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_of_float&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;sci_of_num&nbsp;(&nbsp;num_of_float&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_of_int integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_of_int&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;sci_of_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_of_complex real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_of_complex&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;z.(0).(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;z.(1).(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;z.(0).(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;z.(1).(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;num_of_float&nbsp;x<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;num_of_float&nbsp;y<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;aa&nbsp;=&nbsp;num_of_float&nbsp;xx<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;num_of_float&nbsp;yy&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;format&nbsp;[|&nbsp;<span class="constructor">Num</span>.add_num&nbsp;a&nbsp;aa&nbsp;;&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;b&nbsp;bb&nbsp;;&nbsp;num_minus_1&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>square_module number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;square_module&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;a.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;a.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;a.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;(&nbsp;<span class="constructor">Num</span>.square_num&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.square_num&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;format&nbsp;[|&nbsp;m&nbsp;;&nbsp;num_0&nbsp;;&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;num_2&nbsp;w&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>norm_inf number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;norm_inf&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;a.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;a.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;a.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Num</span>.max_num&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;format&nbsp;[|&nbsp;m&nbsp;;&nbsp;num_0&nbsp;;&nbsp;w&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>norm_1 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;norm_1&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;a.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;a.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;a.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;format&nbsp;[|&nbsp;m&nbsp;;&nbsp;num_0&nbsp;;&nbsp;w&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>real_part number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;real_part&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;format&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;num_0&nbsp;;&nbsp;a.(2)&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>imag_part number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imag_part&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;format&nbsp;[|&nbsp;a.(1)&nbsp;;&nbsp;num_0&nbsp;;&nbsp;a.(2)&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>real_part_abs number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;real_part_abs&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;format&nbsp;[|&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;a.(0)&nbsp;;&nbsp;num_0&nbsp;;&nbsp;a.(2)&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>imag_part_abs number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imag_part_abs&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;format&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;a.(1)&nbsp;;&nbsp;a.(2)&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>opp number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;opp&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
[|&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;a.(0)&nbsp;;&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;a.(1)&nbsp;;&nbsp;a.(2)&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>itimes number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;itimes&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
[|&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;a.(1)&nbsp;;&nbsp;a.(0)&nbsp;;&nbsp;a.(2)&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>plus number1 number2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;plus&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;a.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;b.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.ge_num&nbsp;ww&nbsp;w&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;www&nbsp;=&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;w&nbsp;ww&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w_w&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;www&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;a.(0)&nbsp;w_w<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;a.(1)&nbsp;w_w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;x&nbsp;b.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;y&nbsp;b.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;format&nbsp;[|&nbsp;xx&nbsp;;&nbsp;yy&nbsp;;&nbsp;ww&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;plus&nbsp;b&nbsp;a&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>minus number1 number2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;minus&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;plus&nbsp;a&nbsp;(&nbsp;opp&nbsp;b&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>mult number1 number2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;mult&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;a.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;b.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;www&nbsp;=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;ww&nbsp;w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;a.(0)&nbsp;b.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;a.(1)&nbsp;b.(1)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;a.(0)&nbsp;b.(1)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;a.(1)&nbsp;b.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;format&nbsp;[|&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;x&nbsp;xx&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;y&nbsp;yy&nbsp;;&nbsp;www&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>conj number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;conj&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;a.(1)&nbsp;;&nbsp;a.(2)&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>inv number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;inv&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;a.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;a.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;a.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;(&nbsp;<span class="constructor">Num</span>.square_num&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.square_num&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;format&nbsp;[|&nbsp;<span class="constructor">Num</span>.div_num&nbsp;x&nbsp;m&nbsp;;&nbsp;<span class="constructor">Num</span>.div_num&nbsp;(&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;y&nbsp;)&nbsp;m&nbsp;;&nbsp;&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;w&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>div number1 number2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;div&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;mult&nbsp;a&nbsp;(&nbsp;inv&nbsp;b&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>eq_0 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;eq_0&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;norm_inf&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;b.(0)&nbsp;=&nbsp;num_0&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>not_eq_0 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;not_eq_0&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;norm_inf&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;b.(0)&nbsp;&lt;&gt;&nbsp;num_0&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>eq number1 number2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;eq&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;eq_0&nbsp;(&nbsp;minus&nbsp;a&nbsp;b&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>not_eq number1 number2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;not_eq&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;not_eq_0&nbsp;(&nbsp;minus&nbsp;a&nbsp;b&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_pow exponent number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;int_pow&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">match</span>&nbsp;n&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_1<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;a<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;-1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;inv&nbsp;a<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;int_pow&nbsp;(&nbsp;abs&nbsp;n&nbsp;)&nbsp;(&nbsp;inv&nbsp;a&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;int_pow&nbsp;(&nbsp;n&nbsp;/&nbsp;2&nbsp;)&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;<span class="keyword">mod</span>&nbsp;2&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;mult&nbsp;b&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;mult&nbsp;(&nbsp;mult&nbsp;b&nbsp;b&nbsp;)&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_epsilon_float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_epsilon_float&nbsp;=&nbsp;sci_of_float&nbsp;epsilon_float&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_min_float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_min_float&nbsp;=&nbsp;sci_of_float&nbsp;min_float&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_max_float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_max_float&nbsp;=&nbsp;sci_of_float&nbsp;max_float&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_min_int</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_min_int&nbsp;=&nbsp;sci_of_int&nbsp;min_int&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_max_int</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_max_int&nbsp;=&nbsp;sci_of_int&nbsp;max_int&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Utilisationdestructurescreusesenarithmtique"><h1>Utilisation de structures creuses en arithmétique</h1></span>
<span id="1_Useofsparsestructuresinarithmetic"><h1>Use of sparse structures in arithmetic</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The module <code class="code"><span class="constructor">Z</span></code> is used as an argument for the functor <code class="code"><span class="constructor">Hashtbl</span>.<span class="constructor">Make</span></code>.
<p>

Le module <code class="code"><span class="constructor">Z</span></code> sert d'argument au foncteur <code class="code"><span class="constructor">Hashtbl</span>.<span class="constructor">Make</span></code>. *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">module</span>&nbsp;<span class="constructor">Z</span>&nbsp;=&nbsp;<span class="keyword">struct</span><br>
<br>
<span class="keyword">type</span>&nbsp;t&nbsp;=&nbsp;int&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;equal&nbsp;=&nbsp;(&nbsp;=&nbsp;)&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;hash&nbsp;=&nbsp;<span class="constructor">Hashtbl</span>.hash&nbsp;;;<br>
<br>
<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The module <code class="code"><span class="constructor">P</span></code> is used to construct hash tables where to store the prime numbers.
<p>

Le module <code class="code"><span class="constructor">P</span></code> sert à construire des tables de hachage où stocker les nombres premiers. *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">module</span>&nbsp;<span class="constructor">P</span>&nbsp;=&nbsp;(&nbsp;<span class="constructor">Hashtbl</span>.<span class="constructor">Make</span>&nbsp;(<span class="constructor">Z</span>)<br>
:&nbsp;<span class="keyword">sig</span><br>
&nbsp;&nbsp;<span class="keyword">include</span>&nbsp;<span class="keyword">module</span>&nbsp;<span class="keyword">type</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Hashtbl</span>.<span class="constructor">Make</span>&nbsp;(<span class="constructor">Z</span>)<br>
&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="keyword">type</span>&nbsp;key&nbsp;=&nbsp;int&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>left_dump table</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;left_dump&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:<span class="keywordsign">'</span>a&nbsp;<span class="constructor">P</span>.t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">P</span>.fold&nbsp;(&nbsp;<span class="keyword">fun</span>&nbsp;key&nbsp;coeff&nbsp;liste&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;key&nbsp;::&nbsp;liste&nbsp;)&nbsp;x&nbsp;[]&nbsp;<span class="keyword">in</span><br>
&nbsp;<span class="constructor">Array</span>.of_list&nbsp;(&nbsp;<span class="constructor">List</span>.fast_sort&nbsp;compare&nbsp;accu&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>primes_init size</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;primes_init&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">P</span>.create&nbsp;n&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>first_compare x y</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;first_compare&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;compare&nbsp;(&nbsp;fst&nbsp;x&nbsp;)&nbsp;(&nbsp;fst&nbsp;y&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The module <code class="code"><span class="constructor">H</span></code> is used to construct hash tables where to store the prime factors of the factorial with multiplicity.
<p>

Le module <code class="code"><span class="constructor">H</span></code> sert à construire des tables de hachage où stocker les facteurs premiers de la factorielle avec multiplicité. *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">module</span>&nbsp;<span class="constructor">H</span>&nbsp;=&nbsp;(&nbsp;<span class="constructor">Hash</span>.<span class="constructor">Make</span>&nbsp;(<span class="constructor">Data</span>.<span class="constructor">Zindex</span>)&nbsp;(<span class="constructor">Hash</span>.<span class="constructor">Z</span>)&nbsp;(<span class="constructor">Data</span>.<span class="constructor">Zcoeff</span>)<br>
:&nbsp;<span class="keyword">sig</span><br>
&nbsp;&nbsp;<span class="keyword">include</span>&nbsp;<span class="keyword">module</span>&nbsp;<span class="keyword">type</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Hash</span>.<span class="constructor">Make</span>&nbsp;(<span class="constructor">Data</span>.<span class="constructor">Zindex</span>)&nbsp;(<span class="constructor">Hash</span>.<span class="constructor">Z</span>)&nbsp;(<span class="constructor">Data</span>.<span class="constructor">Zcoeff</span>)<br>
&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="keyword">type</span>&nbsp;index&nbsp;:=&nbsp;int&nbsp;<span class="keyword">with</span>&nbsp;<span class="keyword">type</span>&nbsp;weight&nbsp;:=&nbsp;int&nbsp;)&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;powers_init&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">H</span>.create&nbsp;n&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;flush&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(h:<span class="constructor">H</span>.t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.of_list&nbsp;(&nbsp;<span class="constructor">H</span>.flush&nbsp;h&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>contract list_of_power_pairs</pre> The list must be ordered according to the first factors.
<p>

La liste doit être ordonnée selon les premiers facteurs. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;contract&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;contract_aux&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;accu&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;z&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;accu<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;head&nbsp;::&nbsp;tail&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;tail&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;head&nbsp;::&nbsp;accu<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;x&nbsp;::&nbsp;queue&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;fst&nbsp;head&nbsp;=&nbsp;fst&nbsp;x&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;contract_aux&nbsp;accu&nbsp;(&nbsp;(&nbsp;fst&nbsp;head&nbsp;,&nbsp;(&nbsp;snd&nbsp;head&nbsp;)&nbsp;+&nbsp;(&nbsp;snd&nbsp;x&nbsp;)&nbsp;)&nbsp;::&nbsp;queue&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;contract_aux&nbsp;(&nbsp;head&nbsp;::&nbsp;accu&nbsp;)&nbsp;tail<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">List</span>.rev&nbsp;(&nbsp;contract_aux&nbsp;[]&nbsp;z&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>complete_sieve_aux number step factor powers source factors primes</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;complete_sieve_aux&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(step:int)&nbsp;(factor:int)&nbsp;(powers:<span class="constructor">H</span>.t)&nbsp;(source:int&nbsp;array)&nbsp;(factors:(int&nbsp;*&nbsp;int)&nbsp;list&nbsp;array)&nbsp;(primes:int&nbsp;<span class="constructor">P</span>.t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;n&nbsp;/&nbsp;step&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;not&nbsp;(&nbsp;<span class="constructor">P</span>.mem&nbsp;primes&nbsp;factor&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">P</span>.add&nbsp;primes&nbsp;factor&nbsp;0&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nn&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;index&nbsp;=&nbsp;step&nbsp;*&nbsp;i&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source.(index)&nbsp;&lt;-&nbsp;source.(index)&nbsp;/&nbsp;factor<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;factors.(index)&nbsp;&lt;-&nbsp;contract&nbsp;(&nbsp;<span class="constructor">List</span>.merge&nbsp;first_compare&nbsp;[&nbsp;(&nbsp;factor&nbsp;,&nbsp;1&nbsp;)&nbsp;]&nbsp;factors.(index&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">H</span>.add&nbsp;powers&nbsp;(&nbsp;factor&nbsp;,&nbsp;nn&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>complete_sieve table_size number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;complete_sieve&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(p:int)&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;sn&nbsp;=&nbsp;succ&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;powers&nbsp;=&nbsp;powers_init&nbsp;p<br>
&nbsp;<span class="keyword">and</span>&nbsp;primes&nbsp;=&nbsp;primes_init&nbsp;p&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;factors&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;sn&nbsp;[]<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;source&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;sn&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;source.(i)&nbsp;&lt;-&nbsp;i<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;factor&nbsp;=&nbsp;source.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;factor&nbsp;&lt;&gt;&nbsp;1&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;complete_sieve_aux&nbsp;n&nbsp;i&nbsp;factor&nbsp;powers&nbsp;source&nbsp;factors&nbsp;primes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;(&nbsp;left_dump&nbsp;primes&nbsp;,&nbsp;factors&nbsp;,&nbsp;flush&nbsp;powers&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>primes_sieve_aux number step factor source primes</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;primes_sieve_aux&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(step:int)&nbsp;(factor:int)&nbsp;(source:int&nbsp;array)&nbsp;(primes:int&nbsp;<span class="constructor">P</span>.t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;n&nbsp;/&nbsp;step&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;not&nbsp;(&nbsp;<span class="constructor">P</span>.mem&nbsp;primes&nbsp;factor&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">P</span>.add&nbsp;primes&nbsp;factor&nbsp;0&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nn&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;index&nbsp;=&nbsp;step&nbsp;*&nbsp;i&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source.(index)&nbsp;&lt;-&nbsp;source.(index)&nbsp;/&nbsp;factor<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>primes_sieve table_size number</pre> This function is ten to one hundred times slower than the unix function <code class="code">primes</code> on moderate numbers.
<p>

Cette fonction est dix à cent fois plus lente que la fonction unix <code class="code">primes</code> sur des nombres modérés. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;primes_sieve&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(p:int)&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;sn&nbsp;=&nbsp;succ&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;primes&nbsp;=&nbsp;primes_init&nbsp;p&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;source&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;sn&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;source.(i)&nbsp;&lt;-&nbsp;i<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;factor&nbsp;=&nbsp;source.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;factor&nbsp;&lt;&gt;&nbsp;1&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;primes_sieve_aux&nbsp;n&nbsp;i&nbsp;factor&nbsp;source&nbsp;primes&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;left_dump&nbsp;primes&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sieve number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sieve&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;primes_sieve&nbsp;(&nbsp;n&nbsp;/&nbsp;64&nbsp;)&nbsp;n&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>factorial_sieve_aux number step factor powers source primes</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;factorial_sieve_aux&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(step:int)&nbsp;(factor:int)&nbsp;(powers:<span class="constructor">H</span>.t)&nbsp;(source:int&nbsp;array)&nbsp;(primes:int&nbsp;<span class="constructor">P</span>.t)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;n&nbsp;/&nbsp;step&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;not&nbsp;(&nbsp;<span class="constructor">P</span>.mem&nbsp;primes&nbsp;factor&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">P</span>.add&nbsp;primes&nbsp;factor&nbsp;0&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nn&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;index&nbsp;=&nbsp;step&nbsp;*&nbsp;i&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source.(index)&nbsp;&lt;-&nbsp;source.(index)&nbsp;/&nbsp;factor<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">H</span>.add&nbsp;powers&nbsp;(&nbsp;factor&nbsp;,&nbsp;nn&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>factorial_sieve table_size number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;factorial_sieve&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(p:int)&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;sn&nbsp;=&nbsp;succ&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;powers&nbsp;=&nbsp;powers_init&nbsp;p<br>
&nbsp;<span class="keyword">and</span>&nbsp;primes&nbsp;=&nbsp;primes_init&nbsp;p&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;source&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;sn&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;source.(i)&nbsp;&lt;-&nbsp;i<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;factor&nbsp;=&nbsp;source.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;factor&nbsp;&lt;&gt;&nbsp;1&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factorial_sieve_aux&nbsp;n&nbsp;i&nbsp;factor&nbsp;powers&nbsp;source&nbsp;primes&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;()<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;(&nbsp;left_dump&nbsp;primes&nbsp;,&nbsp;flush&nbsp;powers&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>naive_factors number</pre> This function is slower than the following one but reacts well with big prime factors. 
In case of a prime number, the resulting list contains a unique element.
<p>

Cette fonction est plus lente que la suivante mais réagit bien avec de grands facteurs premiers. 
Dans le cas d'un nombre premier, la liste résultat ne contient qu'un élément. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;naive_factors&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;sieve&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;power&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;dividend&nbsp;=&nbsp;ref&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;[]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;(&nbsp;pred&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;p&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;!i&nbsp;&gt;=&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;factor&nbsp;=&nbsp;p.(!i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;!dividend&nbsp;<span class="keyword">mod</span>&nbsp;factor&nbsp;==&nbsp;0&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dividend&nbsp;:=&nbsp;!dividend&nbsp;/&nbsp;factor&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;power&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!power&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;(&nbsp;factor&nbsp;,&nbsp;!power&nbsp;)&nbsp;::&nbsp;!accu&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!dividend&nbsp;=&nbsp;1&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;-1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power&nbsp;:=&nbsp;0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decr&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>factors number</pre> This function calls the former one when it has not been able to factorize the number with small prime numbers.
<p>

Cett fonction appelle la précédente quand elle n'a pas pu factoriser entièrement le nombre avec de petits premiers.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;factors&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;sieve&nbsp;(&nbsp;<span class="constructor">Util</span>.int_sqrt&nbsp;n&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;listing&nbsp;=&nbsp;ref&nbsp;[]<br>
&nbsp;<span class="keyword">and</span>&nbsp;power&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;dividend&nbsp;=&nbsp;ref&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;[]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;p&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;factor&nbsp;=&nbsp;p.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;!dividend&nbsp;<span class="keyword">mod</span>&nbsp;factor&nbsp;==&nbsp;0&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dividend&nbsp;:=&nbsp;!dividend&nbsp;/&nbsp;factor&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;power&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!power&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;(&nbsp;factor&nbsp;,&nbsp;!power&nbsp;)&nbsp;::&nbsp;!accu&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;power&nbsp;:=&nbsp;0&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!dividend&nbsp;&gt;&nbsp;1&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;listing&nbsp;:=&nbsp;naive_factors&nbsp;!dividend&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">List</span>.rev_append&nbsp;!accu&nbsp;!listing&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>is_prime number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;is_prime&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Util</span>.list_is_empty&nbsp;(&nbsp;<span class="constructor">List</span>.tl&nbsp;(&nbsp;factors&nbsp;n&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>fact table_size number</pre> This way of calculating the factorial is quicker than that of the following chapter (inside the toplevel).
<p>

Cette manière de calculer la factorielle est plus rapide que celle du chapitre suivant (dans le toplevel). *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;fact&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(size:int)&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;factorial_sieve&nbsp;size&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Big_int</span>.power_int_positive_int&nbsp;x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;<span class="constructor">Big_int</span>.mult_big_int&nbsp;(&nbsp;<span class="constructor">Util</span>.big&nbsp;1&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;f&nbsp;(&nbsp;snd&nbsp;s&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>approx_decimal_fact table_size number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;approx_decimal_fact&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(size:int)&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;float_of_sci&nbsp;(&nbsp;sci_of_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_big_int&nbsp;(&nbsp;fact&nbsp;size&nbsp;n&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;expo&nbsp;=&nbsp;f.(2)&nbsp;*.&nbsp;(&nbsp;log&nbsp;2.&nbsp;)&nbsp;/.&nbsp;(&nbsp;log&nbsp;10.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;expo_dec&nbsp;=&nbsp;float&nbsp;(&nbsp;int_of_float&nbsp;expo&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;mantissa&nbsp;=&nbsp;f.(0)&nbsp;*.&nbsp;(&nbsp;10.&nbsp;**&nbsp;(&nbsp;expo&nbsp;-.&nbsp;expo_dec&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;mantissa&nbsp;&lt;&nbsp;10.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;mantissa&nbsp;;&nbsp;expo_dec&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;mantissa&nbsp;/.&nbsp;10.&nbsp;;&nbsp;expo_dec&nbsp;+.&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>phi_euler number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;phi_euler&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;liste&nbsp;=&nbsp;ref&nbsp;(&nbsp;factors&nbsp;n&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="constructor">Util</span>.list_non_empty&nbsp;!liste&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;p&nbsp;,&nbsp;a&nbsp;)&nbsp;=&nbsp;<span class="constructor">List</span>.hd&nbsp;!liste&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;*&nbsp;(&nbsp;<span class="constructor">Util</span>.int_power&nbsp;(&nbsp;pred&nbsp;a&nbsp;)&nbsp;p&nbsp;)&nbsp;*&nbsp;(&nbsp;pred&nbsp;p&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;liste&nbsp;:=&nbsp;<span class="constructor">List</span>.tl&nbsp;!liste&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_AutourdePI"><h1>Autour de PI</h1></span>
<span id="1_AroundPI"><h1>Around PI</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(**
Source : 
<p>

The CAML Numbers Reference Manual by Valérie Ménissier-Morain, technical
report 141, INRIA, july 1992 (available electronically,
ftp://ftp.inria.fr/INRIA/publication/RT/RT-0141.ps.gz).
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_fact_aux num_integer1 num_integer2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;num_fact_aux&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:<span class="constructor">Num</span>.num)&nbsp;(y:<span class="constructor">Num</span>.num)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">Num</span>.int_of_num&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;num_fact_aux&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;x&nbsp;y&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.pred_num&nbsp;y&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_fact num_integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_fact&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;num_fact_aux&nbsp;num_1&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>print_num_fact num_integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;print_num_fact&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;print_string&nbsp;(&nbsp;<span class="constructor">Num</span>.string_of_num&nbsp;(&nbsp;num_fact&nbsp;x&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_fact num_integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_fact&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;format&nbsp;[|&nbsp;num_fact&nbsp;x&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_sqrt640320 digits</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_sqrt640320&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(digits:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;pow&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;10&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;digits&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_big_int&nbsp;(&nbsp;<span class="constructor">Big_int</span>.sqrt_big_int&nbsp;(&nbsp;<span class="constructor">Num</span>.big_int_of_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;640320&nbsp;)&nbsp;pow&nbsp;)&nbsp;pow&nbsp;)&nbsp;)&nbsp;)&nbsp;,&nbsp;pow&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_approx_pi digits</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_approx_pi&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(digits:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;prod&nbsp;=&nbsp;ref&nbsp;num_12<br>
&nbsp;<span class="keyword">and</span>&nbsp;sum&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;13591409&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;640320&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;12&nbsp;*&nbsp;13591409&nbsp;)&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;sixn&nbsp;=&nbsp;ref&nbsp;num_0<br>
&nbsp;<span class="keyword">and</span>&nbsp;binom&nbsp;=&nbsp;ref&nbsp;num_1&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** 3n^2+3n+1 *)</span></td></tr></table><code class="code"><br>
&nbsp;<span class="keyword">and</span>&nbsp;pown3&nbsp;=&nbsp;ref&nbsp;num_0&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** n^3 *)</span></td></tr></table><code class="code"><br>
&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;sqrt&nbsp;,&nbsp;pow&nbsp;)&nbsp;=&nbsp;num_sqrt640320&nbsp;(&nbsp;digits&nbsp;-&nbsp;2&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;pow3&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;640320&nbsp;)&nbsp;num_3&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pow_test&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;pow&nbsp;num_10&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="constructor">Num</span>.gt_num&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!prod&nbsp;!sum&nbsp;)&nbsp;pow_test&nbsp;)&nbsp;)&nbsp;!d&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;prod&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-&nbsp;8&nbsp;)&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.succ_num&nbsp;!sixn&nbsp;)&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;(&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!sixn&nbsp;num_3&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!sixn&nbsp;num_5&nbsp;)&nbsp;)&nbsp;)&nbsp;!prod&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;sum&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;545140134&nbsp;)&nbsp;!sum&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;pown3&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!binom&nbsp;!pown3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!pown3&nbsp;pow3&nbsp;)&nbsp;!d&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!pown3&nbsp;&nbsp;pow3&nbsp;)&nbsp;!n&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!prod&nbsp;!sum&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;sixn&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!sixn&nbsp;num_6&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;binom&nbsp;:=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!sixn&nbsp;!binom<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Num</span>.div_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;sqrt&nbsp;!d&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!n&nbsp;pow&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>num_show_pi digits</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;num_show_pi&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(digits:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Num</span>.approx_num_fix&nbsp;digits&nbsp;(&nbsp;num_approx_pi&nbsp;digits&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_approx_pi digits</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_approx_pi&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(digits:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;format&nbsp;[|&nbsp;num_approx_pi&nbsp;digits&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>pi_1000_10</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;pi_1000_10&nbsp;=&nbsp;sci_approx_pi&nbsp;1000&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>half_pi_1000_10</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;half_pi_1000_10&nbsp;=&nbsp;mult&nbsp;sci_05&nbsp;pi_1000_10&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_approx_ipi digits</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_approx_ipi&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(digits:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;format&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;num_approx_pi&nbsp;digits&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Fonctionsdebaseenprcisionfixe"><h1>Fonctions de base en précision fixe</h1></span>
<span id="1_Fixedprecisionbasicfunctions"><h1>Fixed precision basic functions</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The mantissa is truncated at 1024 bits.
<p>

La mantisse est tronquée à 1024 bits. *)</span></td></tr></table><code class="code"><br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>format_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;format_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;aa&nbsp;=&nbsp;format&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;aa.(0)&nbsp;num_2_pow_1024<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;aa.(1)&nbsp;num_2_pow_1024&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Util</span>.round_num&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Util</span>.round_num&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;format&nbsp;[|&nbsp;xx&nbsp;;&nbsp;yy&nbsp;;&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;aa.(2)&nbsp;num_1024&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>mantissa_threshold</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;mantissa_threshold&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_minus_1024&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>print_sci_1024_2 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;print_sci_1024_2&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;print_string&nbsp;(&nbsp;<span class="string">"real&nbsp;mantissa&nbsp;:&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;<span class="constructor">Num</span>.approx_num_exp&nbsp;310&nbsp;a.(0)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;print_newline&nbsp;()&nbsp;;<br>
&nbsp;print_string&nbsp;(&nbsp;<span class="string">"imaginary&nbsp;mantissa&nbsp;:&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;<span class="constructor">Num</span>.approx_num_exp&nbsp;310&nbsp;a.(1)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;print_newline&nbsp;()&nbsp;;<br>
&nbsp;print_string&nbsp;(&nbsp;<span class="string">"binary&nbsp;exponent&nbsp;:&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;<span class="constructor">Num</span>.string_of_num&nbsp;a.(2)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;print_newline&nbsp;()&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>print_sci_1024_10 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;print_sci_1024_10&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;a.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;print_string&nbsp;(&nbsp;<span class="string">"real&nbsp;part&nbsp;:&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;<span class="constructor">Num</span>.approx_num_exp&nbsp;310&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;a.(0)&nbsp;b&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;print_newline&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;print_string&nbsp;(&nbsp;<span class="string">"imaginary&nbsp;part&nbsp;:&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;<span class="constructor">Num</span>.approx_num_exp&nbsp;310&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;a.(1)&nbsp;b&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;print_newline&nbsp;()&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>plus_1024 number1 number2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;plus_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;plus&nbsp;(&nbsp;format_1024&nbsp;a&nbsp;)&nbsp;(&nbsp;format_1024&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;p.(0)&nbsp;num_2_pow_1024<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;p.(1)&nbsp;num_2_pow_1024&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Util</span>.round_num&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Util</span>.round_num&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;format&nbsp;[|&nbsp;xx&nbsp;;&nbsp;yy&nbsp;;&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;p.(2)&nbsp;num_1024&nbsp;|]&nbsp;;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>minus_1024 number1 number2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;minus_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;minus&nbsp;(&nbsp;format_1024&nbsp;a&nbsp;)&nbsp;(&nbsp;format_1024&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;p.(0)&nbsp;num_2_pow_1024<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;p.(1)&nbsp;num_2_pow_1024&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Util</span>.round_num&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Util</span>.round_num&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;format&nbsp;[|&nbsp;xx&nbsp;;&nbsp;yy&nbsp;;&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;p.(2)&nbsp;num_1024&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>mult_1024 number1 number2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;mult_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;aa&nbsp;=&nbsp;format&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;format&nbsp;b&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xa&nbsp;=&nbsp;<span class="constructor">Util</span>.round_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;aa.(0)&nbsp;num_2_pow_1024&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ya&nbsp;=&nbsp;<span class="constructor">Util</span>.round_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;aa.(1)&nbsp;num_2_pow_1024&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xb&nbsp;=&nbsp;<span class="constructor">Util</span>.round_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;bb.(0)&nbsp;num_2_pow_1024&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yb&nbsp;=&nbsp;<span class="constructor">Util</span>.round_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;bb.(1)&nbsp;num_2_pow_1024&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;aa.(2)&nbsp;bb.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;xa&nbsp;xb<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;ya&nbsp;yb<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;xa&nbsp;yb<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;ya&nbsp;xb&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;format_1024&nbsp;[|&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;x&nbsp;xx&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;y&nbsp;yy&nbsp;;&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;w&nbsp;num_2048&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>square_module_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;square_module_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;real_part&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;imag_part&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;plus_1024&nbsp;(&nbsp;mult_1024&nbsp;x&nbsp;x&nbsp;)&nbsp;(&nbsp;mult_1024&nbsp;y&nbsp;y&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>norm_inf_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;norm_inf_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;a.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;a.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;a.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Num</span>.max_num&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;format_1024&nbsp;[|&nbsp;m&nbsp;;&nbsp;num_0&nbsp;;&nbsp;w&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>norm_1_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;norm_1_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;a.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;a.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;a.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;format_1024&nbsp;[|&nbsp;m&nbsp;;&nbsp;num_0&nbsp;;&nbsp;w&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>div_1024 dividend divisor</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;div_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;aa&nbsp;=&nbsp;format_1024&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;format_1024&nbsp;b&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;format_1024&nbsp;(&nbsp;div&nbsp;aa&nbsp;bb&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>real_sqrt_1024 number</pre> This function operates on the real part.
<p>

Cette fonction agit sur la partie réelle. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;real_sqrt_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;aa&nbsp;=&nbsp;real_part&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;aa.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;<span class="constructor">Num</span>.quo_num&nbsp;w&nbsp;num_2<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;www&nbsp;=&nbsp;<span class="constructor">Num</span>.mod_num&nbsp;w&nbsp;num_2<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;aa.(0)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.sign_num&nbsp;www&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.sign_num&nbsp;www&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_05&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2_pow_2048&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Util</span>.round_num&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_big_int&nbsp;(&nbsp;<span class="constructor">Big_int</span>.sqrt_big_int&nbsp;(&nbsp;<span class="constructor">Num</span>.big_int_of_num&nbsp;z&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;r&nbsp;num_2_pow_minus_1024&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;s&nbsp;;&nbsp;num_0&nbsp;;&nbsp;ww&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>module_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;module_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;real_sqrt_1024&nbsp;(&nbsp;square_module_1024&nbsp;a&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>real_part_compare_1024 number1 number2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;real_part_compare_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(y:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;minus_1024&nbsp;x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Num</span>.compare_num&nbsp;z.(0)&nbsp;num_0&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>imag_part_compare_1024 number1 number2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imag_part_compare_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(y:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;minus_1024&nbsp;x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Num</span>.compare_num&nbsp;z.(1)&nbsp;num_0&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>eq_0_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;eq_0_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;(&nbsp;(&nbsp;<span class="constructor">Num</span>.compare_num&nbsp;z.(0)&nbsp;num_0&nbsp;)&nbsp;=&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;(&nbsp;<span class="constructor">Num</span>.compare_num&nbsp;z.(1)&nbsp;num_0&nbsp;)&nbsp;=&nbsp;0&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sqrt_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sqrt_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;square_module&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;test&nbsp;=&nbsp;complex_of_sci&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;a.(1)&nbsp;;&nbsp;num_0&nbsp;|]<br>
&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;real_part&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;dp&nbsp;=&nbsp;imag_part&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;sci_0<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;sci_0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;test.(0).(0)&nbsp;+.&nbsp;abs_float&nbsp;test.(0).(1)&nbsp;&lt;&nbsp;epsilon_float&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;sci_0<br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;real_sqrt_1024&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pp&nbsp;=&nbsp;plus&nbsp;s&nbsp;d<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;mm&nbsp;=&nbsp;minus&nbsp;s&nbsp;d&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p_p&nbsp;=&nbsp;square_module&nbsp;pp<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;m_m&nbsp;=&nbsp;square_module&nbsp;mm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Num</span>.sign_num&nbsp;(&nbsp;minus&nbsp;p_p&nbsp;m_m&nbsp;).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;c&nbsp;&gt;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;real_sqrt_1024&nbsp;(&nbsp;mult&nbsp;sci_05&nbsp;pp&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;div&nbsp;dp&nbsp;(&nbsp;mult&nbsp;sci_2&nbsp;!x&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;real_sqrt_1024&nbsp;(&nbsp;mult&nbsp;sci_05&nbsp;mm&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;div&nbsp;dp&nbsp;(&nbsp;mult&nbsp;sci_2&nbsp;!y&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plus_1024&nbsp;!x&nbsp;(&nbsp;itimes&nbsp;!y&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>inv_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;inv_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;aa&nbsp;=&nbsp;format_1024&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;aa.(0)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;aa.(1)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;aa.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Num</span>.add_num&nbsp;(&nbsp;<span class="constructor">Num</span>.square_num&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.square_num&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;format_1024&nbsp;[|&nbsp;<span class="constructor">Num</span>.div_num&nbsp;x&nbsp;m&nbsp;;&nbsp;<span class="constructor">Num</span>.div_num&nbsp;(&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;y&nbsp;)&nbsp;m&nbsp;;&nbsp;&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;w&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_pow_1024 exponent number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;int_pow_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">match</span>&nbsp;n&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_1<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;a<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;-1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;inv_1024&nbsp;a<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;int_pow_1024&nbsp;(&nbsp;abs&nbsp;n&nbsp;)&nbsp;(&nbsp;inv_1024&nbsp;a&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;int_pow_1024&nbsp;(&nbsp;n&nbsp;/&nbsp;2&nbsp;)&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;<span class="keyword">mod</span>&nbsp;2&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;mult_1024&nbsp;b&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;mult_1024&nbsp;(&nbsp;mult_1024&nbsp;b&nbsp;b&nbsp;)&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>solve_degree_2_1024 a b c</pre> Gives the two solutions of <code class="code">a x ^ 2 + b x + c = 0</code>.
<p>

Donne les deux solutions x de <code class="code">a x ^ 2 + b x + c = 0</code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;solve_degree_2_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(c:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;bb&nbsp;=&nbsp;mult_1024&nbsp;b&nbsp;sci_minus_05&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;d&nbsp;=&nbsp;minus_1024&nbsp;(&nbsp;mult_1024&nbsp;bb&nbsp;bb&nbsp;)&nbsp;(&nbsp;mult_1024&nbsp;a&nbsp;c&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq_0&nbsp;d&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;div_1024&nbsp;bb&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;x&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dd&nbsp;=&nbsp;sqrt_1024&nbsp;d&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;minus_1024&nbsp;bb&nbsp;dd<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;p&nbsp;=&nbsp;plus_1024&nbsp;bb&nbsp;dd&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;square_module_1024&nbsp;m<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;pp&nbsp;=&nbsp;square_module_1024&nbsp;p&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;comp&nbsp;=&nbsp;<span class="constructor">Num</span>.sign_num&nbsp;(&nbsp;minus_1024&nbsp;pp&nbsp;mm&nbsp;).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;comp&nbsp;&gt;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;div_1024&nbsp;p&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;div_1024&nbsp;c&nbsp;p&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;div_1024&nbsp;m&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;div_1024&nbsp;c&nbsp;m&nbsp;;&nbsp;x&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>real_cubic_root_1024 threshold number</pre> This function operates on the real part.
<p>

Cette fonction agit sur la partie réelle. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;real_cubic_root_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;aa&nbsp;=&nbsp;real_part&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;aa.(2)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;aa.(0)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;<span class="constructor">Num</span>.quo_num&nbsp;w&nbsp;num_3<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;www&nbsp;=&nbsp;<span class="constructor">Num</span>.int_of_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mod_num&nbsp;w&nbsp;num_3&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;www&nbsp;=&nbsp;1&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_2&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;www&nbsp;=&nbsp;2&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_4&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;www&nbsp;=&nbsp;-1&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!x&nbsp;num_05&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;www&nbsp;=&nbsp;-2&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Num</span>.div_num&nbsp;!x&nbsp;num_4&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Num</span>.float_of_num&nbsp;!x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;xx&nbsp;&lt;=&nbsp;min_float&nbsp;<span class="keyword">then</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;exp&nbsp;(&nbsp;(&nbsp;log&nbsp;xx&nbsp;)&nbsp;/.&nbsp;3.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;num_of_float&nbsp;yy&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;ref&nbsp;max_float&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;!error&nbsp;&gt;&nbsp;min_float&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;!y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Num</span>.div_num&nbsp;(&nbsp;<span class="constructor">Num</span>.add_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;num_2&nbsp;z&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.div_num&nbsp;!x&nbsp;(&nbsp;<span class="constructor">Num</span>.square_num&nbsp;z&nbsp;)&nbsp;)&nbsp;)&nbsp;num_3&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;<span class="constructor">Num</span>.float_of_num&nbsp;(&nbsp;<span class="constructor">Num</span>.abs_num&nbsp;(&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;z&nbsp;zz&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;succ&nbsp;!i<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;format_1024&nbsp;[|&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;<span class="constructor">Num</span>.sign_num&nbsp;aa.(0)&nbsp;)&nbsp;)&nbsp;!y&nbsp;;&nbsp;num_0&nbsp;;&nbsp;ww&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>cubic_root_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cubic_root_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;a.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;a.(1)&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;<span class="constructor">Num</span>.quo_num&nbsp;w&nbsp;num_3<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;www&nbsp;=&nbsp;<span class="constructor">Num</span>.int_of_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mod_num&nbsp;w&nbsp;num_3&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;www&nbsp;=&nbsp;1&nbsp;<span class="keyword">then</span>&nbsp;z&nbsp;:=&nbsp;mult_1024&nbsp;!z&nbsp;sci_2&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;www&nbsp;=&nbsp;2&nbsp;<span class="keyword">then</span>&nbsp;z&nbsp;:=&nbsp;mult_1024&nbsp;!z&nbsp;sci_4&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;www&nbsp;=&nbsp;-1&nbsp;<span class="keyword">then</span>&nbsp;z&nbsp;:=&nbsp;mult_1024&nbsp;!z&nbsp;sci_05&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;www&nbsp;=&nbsp;-2&nbsp;<span class="keyword">then</span>&nbsp;z&nbsp;:=&nbsp;div_1024&nbsp;!z&nbsp;sci_4&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;complex_of_sci&nbsp;!z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;zz.(0).(0)&nbsp;)&nbsp;+.&nbsp;(&nbsp;abs_float&nbsp;zz.(1).(0)&nbsp;)&nbsp;&lt;=&nbsp;epsilon_float&nbsp;<span class="keyword">then</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z_z&nbsp;=&nbsp;{&nbsp;<span class="constructor">Complex</span>.re&nbsp;=&nbsp;zz.(0).(0)&nbsp;;&nbsp;<span class="constructor">Complex</span>.im&nbsp;=&nbsp;zz.(1).(0)&nbsp;}&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;<span class="constructor">Complex</span>.exp&nbsp;(&nbsp;<span class="constructor">Complex</span>.div&nbsp;(&nbsp;<span class="constructor">Complex</span>.log&nbsp;z_z&nbsp;)&nbsp;{&nbsp;<span class="constructor">Complex</span>.re&nbsp;=&nbsp;3.&nbsp;;&nbsp;<span class="constructor">Complex</span>.im&nbsp;=&nbsp;0.&nbsp;}&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xz&nbsp;=&nbsp;zzz.<span class="constructor">Complex</span>.re<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yz&nbsp;=&nbsp;zzz.<span class="constructor">Complex</span>.im&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;sci_of_complex&nbsp;[|&nbsp;[|&nbsp;xz&nbsp;;&nbsp;-.&nbsp;yz&nbsp;|]&nbsp;;&nbsp;[|&nbsp;yz&nbsp;;&nbsp;xz&nbsp;|]&nbsp;|]&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;ref&nbsp;max_float&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;!error&nbsp;&gt;&nbsp;min_float&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;!y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;div_1024&nbsp;(&nbsp;plus_1024&nbsp;(&nbsp;mult_1024&nbsp;sci_2&nbsp;x&nbsp;)&nbsp;(&nbsp;div_1024&nbsp;!z&nbsp;(&nbsp;mult_1024&nbsp;x&nbsp;x&nbsp;)&nbsp;)&nbsp;)&nbsp;sci_3&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;succ&nbsp;!i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;e&nbsp;=&nbsp;complex_of_sci&nbsp;(&nbsp;minus_1024&nbsp;x&nbsp;xx&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ee&nbsp;=&nbsp;e.(0).(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;eee&nbsp;=&nbsp;e.(1).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;sqrt&nbsp;(&nbsp;ee&nbsp;*.&nbsp;ee&nbsp;+.&nbsp;eee&nbsp;*.&nbsp;eee&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mult_1024&nbsp;!y&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;ww&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>nth_root_1024 order number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;nth_root_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;a.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;nm1&nbsp;=&nbsp;pred&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;n_n&nbsp;=&nbsp;sci_of_int&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;[|&nbsp;a.(0)&nbsp;;&nbsp;a.(1)&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;<span class="constructor">Num</span>.quo_num&nbsp;w&nbsp;nn<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n__n&nbsp;=&nbsp;sci_of_int&nbsp;nm1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;www&nbsp;=&nbsp;<span class="constructor">Num</span>.int_of_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mod_num&nbsp;w&nbsp;nn&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;www&nbsp;&lt;&gt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;z&nbsp;:=&nbsp;mult_1024&nbsp;!z&nbsp;(&nbsp;int_pow&nbsp;www&nbsp;sci_2&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;complex_of_sci&nbsp;!z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;zz.(0).(0)&nbsp;)&nbsp;+.&nbsp;(&nbsp;abs_float&nbsp;zz.(1).(0)&nbsp;)&nbsp;&lt;=&nbsp;epsilon_float&nbsp;<span class="keyword">then</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z_z&nbsp;=&nbsp;{&nbsp;<span class="constructor">Complex</span>.re&nbsp;=&nbsp;zz.(0).(0)&nbsp;;&nbsp;<span class="constructor">Complex</span>.im&nbsp;=&nbsp;zz.(1).(0)&nbsp;}&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;<span class="constructor">Complex</span>.exp&nbsp;(&nbsp;<span class="constructor">Complex</span>.div&nbsp;(&nbsp;<span class="constructor">Complex</span>.log&nbsp;z_z&nbsp;)&nbsp;{&nbsp;<span class="constructor">Complex</span>.re&nbsp;=&nbsp;float&nbsp;n&nbsp;;&nbsp;<span class="constructor">Complex</span>.im&nbsp;=&nbsp;0.&nbsp;}&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xz&nbsp;=&nbsp;zzz.<span class="constructor">Complex</span>.re<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yz&nbsp;=&nbsp;zzz.<span class="constructor">Complex</span>.im&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;sci_of_complex&nbsp;[|&nbsp;[|&nbsp;xz&nbsp;;&nbsp;-.&nbsp;yz&nbsp;|]&nbsp;;&nbsp;[|&nbsp;yz&nbsp;;&nbsp;xz&nbsp;|]&nbsp;|]&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;ref&nbsp;max_float&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;!error&nbsp;&gt;&nbsp;min_float&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;!y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;div_1024&nbsp;(&nbsp;plus_1024&nbsp;(&nbsp;mult_1024&nbsp;n__n&nbsp;x&nbsp;)&nbsp;(&nbsp;div_1024&nbsp;!z&nbsp;(&nbsp;int_pow_1024&nbsp;nm1&nbsp;x&nbsp;)&nbsp;)&nbsp;)&nbsp;n_n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;succ&nbsp;!i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;e&nbsp;=&nbsp;complex_of_sci&nbsp;(&nbsp;minus_1024&nbsp;x&nbsp;xx&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ee&nbsp;=&nbsp;e.(0).(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;eee&nbsp;=&nbsp;e.(1).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;sqrt&nbsp;(&nbsp;ee&nbsp;*.&nbsp;ee&nbsp;+.&nbsp;eee&nbsp;*.&nbsp;eee&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mult_1024&nbsp;!y&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;ww&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_1024_jj</pre> Primitive sixth root of unity.
<p>

Racine sixième primitive de l'unité. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_1024_jj&nbsp;=&nbsp;cubic_root_1024&nbsp;sci_minus_1&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_1024_j</pre> Primitive cubic root of unity.
<p>

Racine cubique primitive de l'unité. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_1024_j&nbsp;=&nbsp;mult_1024&nbsp;sci_1024_jj&nbsp;sci_1024_jj&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_1024_j2</pre> Second primitive cubic root of unity.
<p>

Deuxième racine cubique primitive de l'unité. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_1024_j2&nbsp;=&nbsp;conj&nbsp;sci_1024_j<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sci_1024_primitive_root_of_unity integer</pre> Primitive nth root of unity.
<p>

Racine n-ème primitive de l'unité. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sci_1024_primitive_root_of_unity&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;<span class="keyword">mod</span>&nbsp;2&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;nth_root_1024&nbsp;(&nbsp;n&nbsp;/&nbsp;2&nbsp;)&nbsp;sci_minus_1<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;nth_root_1024&nbsp;n&nbsp;sci_minus_1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;mult_1024&nbsp;x&nbsp;x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sqrt_1024_of_3</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sqrt_1024_of_3&nbsp;=&nbsp;sqrt_1024&nbsp;sci_3&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sqrt_1024_of_27</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sqrt_1024_of_27&nbsp;=&nbsp;sqrt_1024&nbsp;sci_27&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>solve_degree_3_1024 a b c d</pre> Gives the three solutions of <code class="code">a x ^ 3 + b x ^ 2 + c x + d = 0</code>.
<p>

Donne les trois solutions x de <code class="code">a x ^ 3 + b x ^ 2 + c x + d = 0</code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;solve_degree_3_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(c:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(d:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;b_a&nbsp;=&nbsp;div_1024&nbsp;b&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;c_a&nbsp;=&nbsp;div_1024&nbsp;c&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;d_a&nbsp;=&nbsp;div_1024&nbsp;d&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Num</span>.sign_num&nbsp;(&nbsp;minus_1024&nbsp;x.(0)&nbsp;y.(0)&nbsp;).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;minus_1024&nbsp;c_a&nbsp;(&nbsp;div_1024&nbsp;(&nbsp;mult_1024&nbsp;b_a&nbsp;b_a&nbsp;)&nbsp;sci_3&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;q&nbsp;=&nbsp;plus_1024&nbsp;d_a&nbsp;(&nbsp;minus_1024&nbsp;(&nbsp;div_1024&nbsp;(&nbsp;mult_1024&nbsp;sci_2&nbsp;(&nbsp;int_pow_1024&nbsp;3&nbsp;b_a&nbsp;)&nbsp;)&nbsp;sci_27&nbsp;)&nbsp;(&nbsp;div_1024&nbsp;(&nbsp;mult_1024&nbsp;b_a&nbsp;c_a&nbsp;)&nbsp;sci_3&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pp&nbsp;=&nbsp;mult_1024&nbsp;sci_minus_27&nbsp;(&nbsp;int_pow_1024&nbsp;3&nbsp;p&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;qq&nbsp;=&nbsp;mult_1024&nbsp;sci_27&nbsp;q&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;solve_degree_2_1024&nbsp;sci_1&nbsp;qq&nbsp;pp&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m1&nbsp;=&nbsp;cubic_root_1024&nbsp;t.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;m2&nbsp;=&nbsp;cubic_root_1024&nbsp;t.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;mm1&nbsp;=&nbsp;square_module_1024&nbsp;m1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;mm2&nbsp;=&nbsp;square_module_1024&nbsp;m2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;a1&nbsp;=&nbsp;ref&nbsp;m1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;a2&nbsp;=&nbsp;ref&nbsp;m2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;diff&nbsp;=&nbsp;minus_1024&nbsp;mm1&nbsp;mm2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;m3p&nbsp;=&nbsp;mult_1024&nbsp;sci_minus_3&nbsp;p&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;<span class="constructor">Num</span>.sign_num&nbsp;diff.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;s&nbsp;&gt;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;a2&nbsp;:=&nbsp;div_1024&nbsp;m3p&nbsp;m1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;a1&nbsp;:=&nbsp;div_1024&nbsp;m3p&nbsp;m2&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x1&nbsp;=&nbsp;ref&nbsp;(&nbsp;div_1024&nbsp;(&nbsp;plus_1024&nbsp;!a1&nbsp;!a2&nbsp;)&nbsp;sci_3&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x2&nbsp;=&nbsp;ref&nbsp;(&nbsp;div_1024&nbsp;(&nbsp;plus_1024&nbsp;(&nbsp;mult_1024&nbsp;sci_1024_j2&nbsp;!a1&nbsp;)&nbsp;(&nbsp;mult_1024&nbsp;sci_1024_j&nbsp;!a2&nbsp;)&nbsp;)&nbsp;sci_3&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x3&nbsp;=&nbsp;ref&nbsp;(&nbsp;div_1024&nbsp;(&nbsp;plus_1024&nbsp;(&nbsp;mult_1024&nbsp;sci_1024_j&nbsp;!a1&nbsp;)&nbsp;(&nbsp;mult_1024&nbsp;sci_1024_j2&nbsp;!a2&nbsp;)&nbsp;)&nbsp;sci_3&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;square_module_1024&nbsp;x&nbsp;;&nbsp;sci_copy&nbsp;x&nbsp;|]&nbsp;)&nbsp;[|&nbsp;!x1&nbsp;;&nbsp;!x2&nbsp;;&nbsp;!x3&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.sort&nbsp;f&nbsp;m&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x2&nbsp;:=&nbsp;m.(1).(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x3&nbsp;:=&nbsp;m.(2).(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x1&nbsp;:=&nbsp;div_1024&nbsp;(&nbsp;opp&nbsp;q&nbsp;)&nbsp;(&nbsp;mult_1024&nbsp;!x2&nbsp;!x3&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;plus_1024&nbsp;x&nbsp;(&nbsp;div_1024&nbsp;b_a&nbsp;sci_minus_3&nbsp;)&nbsp;)&nbsp;[|&nbsp;!x1&nbsp;;&nbsp;!x2&nbsp;;&nbsp;!x3&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>solve_degree_4_1024 a b c d e</pre> Gives the four solutions of <code class="code">a x ^ 4 + b x ^ 3 + c x ^ 2 + d x + e = 0</code>.
<p>

Donne les quatre solutions x de <code class="code">a x ^ 4 + b x ^ 3 + c x ^ 2 + d x + e = 0</code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;solve_degree_4_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(c:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(d:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(e:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;b_a&nbsp;=&nbsp;div_1024&nbsp;b&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;c_a&nbsp;=&nbsp;div_1024&nbsp;c&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;d_a&nbsp;=&nbsp;div_1024&nbsp;d&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;e_a&nbsp;=&nbsp;div_1024&nbsp;e&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Num</span>.sign_num&nbsp;(&nbsp;minus_1024&nbsp;x.(0)&nbsp;y.(0)&nbsp;).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b_4a&nbsp;=&nbsp;div&nbsp;b_a&nbsp;sci_4&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sq_b_4a&nbsp;=&nbsp;mult_1024&nbsp;b_4a&nbsp;b_4a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;minus_1024&nbsp;c_a&nbsp;(&nbsp;mult_1024&nbsp;sq_b_4a&nbsp;sci_6&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;q&nbsp;=&nbsp;plus_1024&nbsp;d_a&nbsp;(&nbsp;minus_1024&nbsp;(&nbsp;int_pow_1024&nbsp;3&nbsp;(&nbsp;mult&nbsp;sci_05&nbsp;b_a&nbsp;)&nbsp;)&nbsp;(&nbsp;mult&nbsp;sci_05&nbsp;(&nbsp;mult_1024&nbsp;b_a&nbsp;c_a&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;plus_1024&nbsp;e_a&nbsp;(&nbsp;minus_1024&nbsp;(&nbsp;mult_1024&nbsp;c_a&nbsp;sq_b_4a&nbsp;)&nbsp;(&nbsp;plus_1024&nbsp;(&nbsp;mult_1024&nbsp;sci_3&nbsp;(&nbsp;mult_1024&nbsp;sq_b_4a&nbsp;sq_b_4a&nbsp;)&nbsp;)&nbsp;(&nbsp;mult_1024&nbsp;b_4a&nbsp;d_a&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;minus_1024&nbsp;(&nbsp;mult&nbsp;sci_05&nbsp;x&nbsp;)&nbsp;b_4a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pp&nbsp;=&nbsp;mult&nbsp;sci_2&nbsp;p<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;qq&nbsp;=&nbsp;minus_1024&nbsp;(&nbsp;mult_1024&nbsp;p&nbsp;p&nbsp;)&nbsp;(&nbsp;mult_1024&nbsp;sci_4&nbsp;r&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;rr&nbsp;=&nbsp;opp&nbsp;(&nbsp;mult_1024&nbsp;q&nbsp;q&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;solve_degree_3_1024&nbsp;sci_1&nbsp;pp&nbsp;qq&nbsp;rr&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;square_module_1024&nbsp;x&nbsp;;&nbsp;sci_copy&nbsp;x&nbsp;|]&nbsp;)&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.sort&nbsp;f&nbsp;m&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m3&nbsp;=&nbsp;sqrt_1024&nbsp;m.(2).(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;m2&nbsp;=&nbsp;sqrt_1024&nbsp;m.(1).(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m1&nbsp;=&nbsp;div_1024&nbsp;(&nbsp;opp&nbsp;q&nbsp;)&nbsp;(&nbsp;mult_1024&nbsp;m2&nbsp;m3&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x1&nbsp;=&nbsp;plus_1024&nbsp;m1&nbsp;(&nbsp;plus_1024&nbsp;m2&nbsp;m3&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x2&nbsp;=&nbsp;minus_1024&nbsp;m1&nbsp;(&nbsp;plus_1024&nbsp;m2&nbsp;m3&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x3&nbsp;=&nbsp;minus_1024&nbsp;m2&nbsp;(&nbsp;plus_1024&nbsp;m1&nbsp;m3&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x4&nbsp;=&nbsp;minus_1024&nbsp;m3&nbsp;(&nbsp;plus_1024&nbsp;m1&nbsp;m2&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;g&nbsp;[|&nbsp;x1&nbsp;;&nbsp;x2&nbsp;;&nbsp;x3&nbsp;;&nbsp;x4&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>det_2_1024 sci_2x2_matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;det_2_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:<span class="constructor">Num</span>.num&nbsp;array&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;minus_1024&nbsp;(&nbsp;mult_1024&nbsp;m.(0).(0)&nbsp;m.(1).(1)&nbsp;)&nbsp;(&nbsp;mult_1024&nbsp;m.(0).(1)&nbsp;m.(1).(0)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>det_3_1024 sci_3x3_matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;det_3_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:<span class="constructor">Num</span>.num&nbsp;array&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;mult_1024&nbsp;m.(0).(0)&nbsp;(&nbsp;det_2_1024&nbsp;[|&nbsp;[|&nbsp;m.(1).(1)&nbsp;;&nbsp;m.(1).(2)&nbsp;|]&nbsp;;&nbsp;[|&nbsp;m.(2).(1)&nbsp;;&nbsp;m.(2).(2)&nbsp;|]&nbsp;|]&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;mult_1024&nbsp;m.(0).(1)&nbsp;(&nbsp;det_2_1024&nbsp;[|&nbsp;[|&nbsp;m.(1).(2)&nbsp;;&nbsp;m.(1).(0)&nbsp;|]&nbsp;;&nbsp;[|&nbsp;m.(2).(2)&nbsp;;&nbsp;m.(2).(0)&nbsp;|]&nbsp;|]&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;mult_1024&nbsp;m.(0).(2)&nbsp;(&nbsp;det_2_1024&nbsp;[|&nbsp;[|&nbsp;m.(1).(0)&nbsp;;&nbsp;m.(1).(1)&nbsp;|]&nbsp;;&nbsp;[|&nbsp;m.(2).(0)&nbsp;;&nbsp;m.(2).(1)&nbsp;|]&nbsp;|]&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;plus_1024&nbsp;(&nbsp;plus_1024&nbsp;a&nbsp;b&nbsp;)&nbsp;c&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Acclrateursdeconvergenceenprcisionfixe"><h1>Accélérateurs de convergence en précision fixe</h1></span>
<span id="1_Fixedprecisionconvergenceaccelerators"><h1>Fixed precision convergence accelerators</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>aitken_seki_1024 u(n) u(n+1) u(n+2)</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;aitken_seki_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(c:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
</code><table><tr><td></td><td><span class="comment">(** alternative definition
 let numer = det_2_1024 <code class="code"><span class="keywordsign">|</span> [| a ; b |] ; [| b ; c |] <span class="keywordsign">|</span></code>
 and denom = minus_1024 ( plus_1024 a c ) ( mult_1024 sci_2 b ) in
  div_1024 numer denom ;;
*)</span></td></tr></table><code class="code"><br>
&nbsp;<span class="keyword">let</span>&nbsp;d&nbsp;=&nbsp;minus_1024&nbsp;b&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;e&nbsp;=&nbsp;minus_1024&nbsp;c&nbsp;b&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;mult_1024&nbsp;d&nbsp;e<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;g&nbsp;=&nbsp;minus_1024&nbsp;d&nbsp;e&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;div_1024&nbsp;f&nbsp;g&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;plus_1024&nbsp;b&nbsp;h&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>aitken_seki_rec_1024 k n value_array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;aitken_seki_rec_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(k:int)&nbsp;(n:int)&nbsp;(s:<span class="constructor">Num</span>.num&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;k&nbsp;&lt;&nbsp;-1&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Needed&nbsp;k&nbsp;&gt;=&nbsp;-1&nbsp;in&nbsp;Sci.aitken_seki_rec_1024."</span>&nbsp;;<br>
&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Negative&nbsp;index&nbsp;of&nbsp;sequence&nbsp;in&nbsp;Sci.aitken_seki_rec_1024."</span>&nbsp;;<br>
&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Array</span>.length&nbsp;s&nbsp;&lt;=&nbsp;n&nbsp;+&nbsp;2&nbsp;*&nbsp;k&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Too&nbsp;short&nbsp;sequence&nbsp;in&nbsp;Sci.aitken_seki_rec_1024."</span>&nbsp;;<br>
&nbsp;<span class="keyword">match</span>&nbsp;k&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;s.(n)<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;aitken_seki_1024&nbsp;s.(n)&nbsp;s.(&nbsp;n&nbsp;+&nbsp;1&nbsp;)&nbsp;s.(&nbsp;n&nbsp;+&nbsp;2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;s.(&nbsp;n&nbsp;+&nbsp;2&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kk&nbsp;=&nbsp;pred&nbsp;k&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;aitken_seki_rec_1024&nbsp;kk&nbsp;n&nbsp;s<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;aitken_seki_rec_1024&nbsp;kk&nbsp;(&nbsp;n&nbsp;+&nbsp;1&nbsp;)&nbsp;s<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;aitken_seki_rec_1024&nbsp;kk&nbsp;(&nbsp;n&nbsp;+&nbsp;2&nbsp;)&nbsp;s&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq_0&nbsp;(&nbsp;minus_1024&nbsp;b&nbsp;a&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;eq_0&nbsp;(&nbsp;minus_1024&nbsp;c&nbsp;b&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;eq_0&nbsp;(&nbsp;minus_1024&nbsp;a&nbsp;c&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;c<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aitken_seki_1024&nbsp;a&nbsp;b&nbsp;c<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>shanks2_1024 u(n) u(n+1) u(n+2) u(n+3) u(n+4)</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;shanks2_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(b:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(c:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(d:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(e:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;delta0&nbsp;=&nbsp;minus_1024&nbsp;b&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;delta1&nbsp;=&nbsp;minus_1024&nbsp;c&nbsp;b<br>
&nbsp;<span class="keyword">and</span>&nbsp;delta2&nbsp;=&nbsp;minus_1024&nbsp;d&nbsp;c<br>
&nbsp;<span class="keyword">and</span>&nbsp;delta3&nbsp;=&nbsp;minus_1024&nbsp;e&nbsp;d&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dd0&nbsp;=&nbsp;minus_1024&nbsp;delta1&nbsp;delta0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd1&nbsp;=&nbsp;minus_1024&nbsp;delta2&nbsp;delta1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd2&nbsp;=&nbsp;minus_1024&nbsp;delta3&nbsp;delta2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;denom&nbsp;=&nbsp;det_2_1024&nbsp;[|&nbsp;[|&nbsp;dd0&nbsp;;&nbsp;dd1&nbsp;|]&nbsp;;&nbsp;[|&nbsp;dd1&nbsp;;&nbsp;dd2&nbsp;|]&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;numer&nbsp;=&nbsp;det_3_1024&nbsp;[|&nbsp;[|&nbsp;a&nbsp;;&nbsp;b&nbsp;;&nbsp;c&nbsp;|]&nbsp;;&nbsp;[|&nbsp;b&nbsp;;&nbsp;c&nbsp;;&nbsp;d&nbsp;|]&nbsp;;&nbsp;[|&nbsp;c&nbsp;;&nbsp;d&nbsp;;&nbsp;e&nbsp;|]&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;numer&nbsp;denom&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>wynn_1024 k n value_array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;wynn_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(k:int)&nbsp;(n:int)&nbsp;(s:<span class="constructor">Num</span>.num&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;k&nbsp;&lt;&nbsp;-1&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Needed&nbsp;k&nbsp;&gt;=&nbsp;-1&nbsp;in&nbsp;Sci.wynn_1024."</span>&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;km1&nbsp;=&nbsp;pred&nbsp;k<br>
&nbsp;<span class="keyword">and</span>&nbsp;km2&nbsp;=&nbsp;k&nbsp;-&nbsp;2<br>
&nbsp;<span class="keyword">and</span>&nbsp;np&nbsp;=&nbsp;succ&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;k&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;-1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Negative&nbsp;index&nbsp;of&nbsp;sequence&nbsp;in&nbsp;Sci.wynn_1024."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;&gt;&nbsp;pred&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;s&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Too&nbsp;short&nbsp;sequence&nbsp;in&nbsp;Sci.wynn_1024."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;s.(n)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;wynn_1024&nbsp;km2&nbsp;np&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;wynn_1024&nbsp;km1&nbsp;np&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;wynn_1024&nbsp;km1&nbsp;n&nbsp;s&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;d&nbsp;=&nbsp;minus_1024&nbsp;b&nbsp;c&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq_0&nbsp;d&nbsp;<span class="keyword">then</span>&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;plus_1024&nbsp;a&nbsp;(&nbsp;div_1024&nbsp;sci_1&nbsp;d&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>wynn_rho_1024 k n value_array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;wynn_rho_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(k:int)&nbsp;(n:int)&nbsp;(s:<span class="constructor">Num</span>.num&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;k&nbsp;&lt;&nbsp;-1&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Needed&nbsp;k&nbsp;&gt;=&nbsp;-1&nbsp;in&nbsp;Sci.wynn_rho_1024."</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;km1&nbsp;=&nbsp;pred&nbsp;k<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;km2&nbsp;=&nbsp;k&nbsp;-&nbsp;2<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;np&nbsp;=&nbsp;succ&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;k&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;-1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Negative&nbsp;index&nbsp;of&nbsp;sequence&nbsp;in&nbsp;Sci.wynn_rho_1024."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;&gt;&nbsp;pred&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;s&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Too&nbsp;short&nbsp;sequence&nbsp;in&nbsp;Sci.wynn_rho_1024."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.(n)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;wynn_rho_1024&nbsp;km2&nbsp;np&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;wynn_rho_1024&nbsp;km1&nbsp;np&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;wynn_rho_1024&nbsp;km1&nbsp;n&nbsp;s&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;d&nbsp;=&nbsp;minus_1024&nbsp;b&nbsp;c&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq_0&nbsp;d&nbsp;<span class="keyword">then</span>&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;plus_1024&nbsp;a&nbsp;(&nbsp;div_1024&nbsp;(&nbsp;sci_of_int&nbsp;k&nbsp;)&nbsp;d&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>brezinski_1024 k n value_array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;brezinski_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(k:int)&nbsp;(n:int)&nbsp;(s:<span class="constructor">Num</span>.num&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;k&nbsp;&lt;&nbsp;-1&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Needed&nbsp;k&nbsp;&gt;=&nbsp;-1&nbsp;in&nbsp;Sci.brezinski_1024."</span>&nbsp;;<br>
&nbsp;<span class="keyword">match</span>&nbsp;k&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;-1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Negative&nbsp;index&nbsp;of&nbsp;sequence&nbsp;in&nbsp;Sci.brezinski_1024."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;&gt;&nbsp;pred&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;s&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Too&nbsp;short&nbsp;sequence&nbsp;in&nbsp;Sci.brezinski_1024."</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;s.(n)<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;km1&nbsp;=&nbsp;pred&nbsp;k<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;km2&nbsp;=&nbsp;k&nbsp;-&nbsp;2<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;np&nbsp;=&nbsp;succ&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;k&nbsp;<span class="keyword">mod</span>&nbsp;2&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;brezinski_1024&nbsp;km2&nbsp;np&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;brezinski_1024&nbsp;km1&nbsp;np&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;brezinski_1024&nbsp;km1&nbsp;n&nbsp;s&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;d&nbsp;=&nbsp;minus_1024&nbsp;b&nbsp;c&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq_0&nbsp;d&nbsp;<span class="keyword">then</span>&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;plus_1024&nbsp;a&nbsp;(&nbsp;div_1024&nbsp;sci_1&nbsp;d&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;brezinski_1024&nbsp;km2&nbsp;np&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;np2&nbsp;=&nbsp;succ&nbsp;np&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;brezinski_1024&nbsp;km1&nbsp;np2&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;brezinski_1024&nbsp;km1&nbsp;np&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;brezinski_1024&nbsp;km2&nbsp;np2&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;brezinski_1024&nbsp;km2&nbsp;np&nbsp;s&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;d&nbsp;=&nbsp;minus_1024&nbsp;b&nbsp;bb<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;minus_1024&nbsp;c&nbsp;cc&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ee&nbsp;=&nbsp;mult_1024&nbsp;d&nbsp;dd<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;eee&nbsp;=&nbsp;plus_1024&nbsp;(&nbsp;brezinski_1024&nbsp;km1&nbsp;n&nbsp;s&nbsp;)&nbsp;(&nbsp;brezinski_1024&nbsp;km1&nbsp;np2&nbsp;s&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;eeee&nbsp;=&nbsp;minus_1024&nbsp;eee&nbsp;(&nbsp;mult_1024&nbsp;sci_2&nbsp;(&nbsp;brezinski_1024&nbsp;km1&nbsp;np&nbsp;s&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq_0&nbsp;eeee&nbsp;<span class="keyword">then</span>&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;plus_1024&nbsp;a&nbsp;(&nbsp;div_1024&nbsp;ee&nbsp;eeee&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>approx_1024 value_array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;approx_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(s:<span class="constructor">Num</span>.num&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;rr&nbsp;=&nbsp;pred&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;s&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kk&nbsp;=&nbsp;rr&nbsp;/&nbsp;2<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;parity&nbsp;=&nbsp;rr&nbsp;<span class="keyword">mod</span>&nbsp;2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;parity&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;aitken_seki_rec_1024&nbsp;kk&nbsp;0&nbsp;s&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;(&nbsp;aitken_seki_rec_1024&nbsp;kk&nbsp;1&nbsp;s&nbsp;)&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Fonctionsclassiquesenprcisionfixe"><h1>Fonctions classiques en précision fixe</h1></span>
<span id="1_Fixedprecisionclassicalfunctions"><h1>Fixed precision classical functions</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>pi_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;pi_1024&nbsp;=&nbsp;format_1024&nbsp;(&nbsp;sci_approx_pi&nbsp;310&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>minus_pi_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;minus_pi_1024&nbsp;=&nbsp;format_1024&nbsp;(&nbsp;opp&nbsp;(&nbsp;sci_approx_pi&nbsp;310&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>ipi_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;ipi_1024&nbsp;=&nbsp;format_1024&nbsp;(&nbsp;sci_approx_ipi&nbsp;310&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>minus_ipi_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;minus_ipi_1024&nbsp;=&nbsp;format_1024&nbsp;(&nbsp;opp&nbsp;(&nbsp;sci_approx_ipi&nbsp;310&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>half_pi_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;half_pi_1024&nbsp;=&nbsp;mult_1024&nbsp;sci_05&nbsp;pi_1024&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>minus_half_pi_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;minus_half_pi_1024&nbsp;=&nbsp;mult_1024&nbsp;sci_05&nbsp;minus_pi_1024&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>half_ipi_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;half_ipi_1024&nbsp;=&nbsp;mult_1024&nbsp;sci_05&nbsp;ipi_1024&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>minus_half_ipi_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;minus_half_ipi_1024&nbsp;=&nbsp;mult_1024&nbsp;sci_05&nbsp;minus_ipi_1024&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>quarter_pi_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;quarter_pi_1024&nbsp;=&nbsp;mult_1024&nbsp;sci_025&nbsp;pi_1024&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>minus_quarter_pi_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;minus_quarter_pi_1024&nbsp;=&nbsp;mult_1024&nbsp;sci_025&nbsp;minus_pi_1024&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>quarter_ipi_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;quarter_ipi_1024&nbsp;=&nbsp;mult_1024&nbsp;sci_025&nbsp;ipi_1024&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>minus_quarter_ipi_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;minus_quarter_ipi_1024&nbsp;=&nbsp;mult_1024&nbsp;sci_025&nbsp;minus_ipi_1024&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>e_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;e_1024&nbsp;=&nbsp;format_1024&nbsp;[|&nbsp;<span class="constructor">Data</span>.<span class="constructor">Classical</span>.num_e_1024&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>minus_e_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;minus_e_1024&nbsp;=&nbsp;opp&nbsp;e_1024&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>log_2_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;log_2_1024&nbsp;=&nbsp;format_1024&nbsp;[|&nbsp;<span class="constructor">Data</span>.<span class="constructor">Classical</span>.num_log_2_1024&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>log_10_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;log_10_1024&nbsp;=&nbsp;format_1024&nbsp;[|&nbsp;<span class="constructor">Data</span>.<span class="constructor">Classical</span>.num_log_10_1024&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>integer_part_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;integer_part_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.ge_num&nbsp;x.(2)&nbsp;num_1024&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Not&nbsp;an&nbsp;acceptable&nbsp;number&nbsp;in&nbsp;Sci.integer_part_1024."</span>&nbsp;;<br>
&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.lt_num&nbsp;x.(2)&nbsp;num_0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_0<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;factor&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;x.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;factor&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;factor&nbsp;x.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;format_1024&nbsp;[|&nbsp;<span class="constructor">Num</span>.integer_num&nbsp;xx&nbsp;;&nbsp;<span class="constructor">Num</span>.integer_num&nbsp;yy&nbsp;;&nbsp;num_0&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>round_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;round_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.ge_num&nbsp;x.(2)&nbsp;num_1024&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Not&nbsp;an&nbsp;acceptable&nbsp;number&nbsp;in&nbsp;Sci.round_1024."</span>&nbsp;;<br>
&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.lt_num&nbsp;x.(2)&nbsp;num_0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_0<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;factor&nbsp;=&nbsp;<span class="constructor">Num</span>.power_num&nbsp;num_2&nbsp;x.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;factor&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;factor&nbsp;x.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;format_1024&nbsp;[|&nbsp;<span class="constructor">Util</span>.round_num&nbsp;xx&nbsp;;&nbsp;<span class="constructor">Util</span>.round_num&nbsp;yy&nbsp;;&nbsp;num_0&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>fractional_part_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;fractional_part_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;integer_part_1024&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;minus_1024&nbsp;x&nbsp;xx&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>th_threshold</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;th_threshold&nbsp;=&nbsp;511.5&nbsp;*.&nbsp;(&nbsp;log&nbsp;2.&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>quadruple_th_real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;quadruple_th_real&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;mult&nbsp;x&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;y4&nbsp;=&nbsp;[|&nbsp;x.(0)&nbsp;;&nbsp;num_0&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_2&nbsp;x.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y_y&nbsp;=&nbsp;plus&nbsp;yy&nbsp;sci_1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy4&nbsp;=&nbsp;[|&nbsp;yy.(0)&nbsp;;&nbsp;num_0&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_2&nbsp;yy.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;mult&nbsp;y_y&nbsp;y_y<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;mult&nbsp;y4&nbsp;y_y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;d&nbsp;=&nbsp;plus&nbsp;yyy&nbsp;yy4&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;n&nbsp;d<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>quadruple_tan_real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;quadruple_tan_real&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;mult&nbsp;x&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;y4&nbsp;=&nbsp;[|&nbsp;x.(0)&nbsp;;&nbsp;num_0&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_2&nbsp;x.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y_y&nbsp;=&nbsp;minus&nbsp;sci_1&nbsp;yy<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy4&nbsp;=&nbsp;[|&nbsp;yy.(0)&nbsp;;&nbsp;num_0&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_2&nbsp;yy.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;mult&nbsp;y_y&nbsp;y_y<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;mult&nbsp;y4&nbsp;y_y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;d&nbsp;=&nbsp;minus&nbsp;yyy&nbsp;yy4&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;n&nbsp;d<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** Some of the following functions make use of a threshold.
The value of the threshold acts upon the speed and the precision of the calculus.
A good value for the threshold may be between 0.01 and 1e-6.
<p>

Certaines des fonctions suivantes utilisent un seuil.
La valeur du seuil influence la vitesse et la précision du calcul.
Une bonne valeur pour le seuil peut être entre 0.01 et 1e-6. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The two following functions have mutually recursive definitions.
<p>

les deux fonctions qui suivent ont des définitions mutuellement récursives. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>th_of_real_1024 threshold number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;th_of_real_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.lt_num&nbsp;x.(0)&nbsp;num_0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;opp&nbsp;(&nbsp;th_of_real_1024&nbsp;threshold&nbsp;(&nbsp;opp&nbsp;x&nbsp;)&nbsp;)<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;greater_than_threshold&nbsp;=&nbsp;(&nbsp;complex_of_sci&nbsp;x&nbsp;).(0).(0)&nbsp;&gt;=&nbsp;th_threshold<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;seuil&nbsp;=&nbsp;abs_float&nbsp;threshold&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;greater_than_threshold&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keyword">true</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_1<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keyword">false</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;complex_of_sci&nbsp;x&nbsp;).(0).(0)&nbsp;&gt;=&nbsp;seuil&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;th_of_real_1024&nbsp;threshold&nbsp;[|&nbsp;x.(0)&nbsp;;&nbsp;num_0&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_minus_2&nbsp;x.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quadruple_th_real&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;expm1_1024&nbsp;[|&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;x.(0)&nbsp;;&nbsp;num_0&nbsp;;&nbsp;<span class="constructor">Num</span>.succ_num&nbsp;x.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;plus&nbsp;sci_2&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;(&nbsp;opp&nbsp;y&nbsp;)&nbsp;yy<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>expm1_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">and</span>&nbsp;expm1_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;complex_of_sci&nbsp;x&nbsp;).(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;num_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;result&nbsp;=&nbsp;ref&nbsp;sci_0<br>
&nbsp;<span class="keyword">and</span>&nbsp;gauge&nbsp;=&nbsp;ref&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;!gauge&nbsp;&gt;=&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;plus&nbsp;!result&nbsp;!shift&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Num</span>.incr_num&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;div_1024&nbsp;(&nbsp;mult&nbsp;x&nbsp;!shift&nbsp;)&nbsp;(&nbsp;sci_of_num&nbsp;!i&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;(&nbsp;complex_of_sci&nbsp;[|&nbsp;!shift.(0)&nbsp;;&nbsp;!shift.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_3&nbsp;!shift.(2)&nbsp;|]&nbsp;).(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;gauge&nbsp;:=&nbsp;compare&nbsp;(&nbsp;(&nbsp;abs_float&nbsp;!xx.(0)&nbsp;)&nbsp;+.&nbsp;(&nbsp;abs_float&nbsp;!xx.(1)&nbsp;)&nbsp;)&nbsp;min_float&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;format_1024&nbsp;!result&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>tan_of_real_1024 threshold number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;tan_of_real_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;real_part&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;seuil&nbsp;=&nbsp;abs_float&nbsp;threshold&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;q&nbsp;=&nbsp;integer_part_1024&nbsp;(&nbsp;div&nbsp;xx&nbsp;pi_1024&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x_x&nbsp;=&nbsp;minus&nbsp;x&nbsp;(&nbsp;mult&nbsp;q&nbsp;pi_1024&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Num</span>.lt_num&nbsp;x_x.(0)&nbsp;num_0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opp&nbsp;(&nbsp;tan_of_real_1024&nbsp;threshold&nbsp;(&nbsp;opp&nbsp;x_x&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;real_part_compare_1024&nbsp;x_x&nbsp;half_pi_1024&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;complex_of_sci&nbsp;x_x&nbsp;).(0).(0)&nbsp;&gt;=&nbsp;seuil&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;tan_of_real_1024&nbsp;threshold&nbsp;[|&nbsp;x_x.(0)&nbsp;;&nbsp;num_0&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_minus_2&nbsp;x_x.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quadruple_tan_real&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;expm1_1024&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;x_x.(0)&nbsp;;&nbsp;<span class="constructor">Num</span>.succ_num&nbsp;x_x.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;plus&nbsp;sci_2&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;[|&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;y.(1)&nbsp;;&nbsp;y.(0)&nbsp;;&nbsp;y.(2)&nbsp;|]&nbsp;yy<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>direct_tan_1024 threshold number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;direct_tan_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;real_part&nbsp;z<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;imag_part&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;tx&nbsp;=&nbsp;tan_of_real_1024&nbsp;threshold&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ty&nbsp;=&nbsp;th_of_real_1024&nbsp;threshold&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ity&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;ty.(0)&nbsp;;&nbsp;ty.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;plus&nbsp;tx&nbsp;ity<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;minus&nbsp;sci_1&nbsp;(&nbsp;mult&nbsp;tx&nbsp;ity&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;n&nbsp;d<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Infinity"</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;real_part_compare_1024&nbsp;y&nbsp;sci_0&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;sci_i&nbsp;(&nbsp;th_of_real_1024&nbsp;threshold&nbsp;y&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>tan_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;tan_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;z&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_0<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;let&nbsp;t1&nbsp;=&nbsp;direct_tan_1024&nbsp;1e-2&nbsp;z&nbsp;*)</span><br>
&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;and&nbsp;t2&nbsp;=&nbsp;direct_tan_1024&nbsp;1e-3&nbsp;z&nbsp;*)</span><br>
&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;and&nbsp;t3&nbsp;=&nbsp;direct_tan_1024&nbsp;1e-4&nbsp;z&nbsp;in&nbsp;*)</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t1&nbsp;=&nbsp;direct_tan_1024&nbsp;1e-8&nbsp;z<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;t2&nbsp;=&nbsp;direct_tan_1024&nbsp;1e-11&nbsp;z<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;t3&nbsp;=&nbsp;direct_tan_1024&nbsp;1e-14&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;approx_1024&nbsp;[|&nbsp;t1&nbsp;;&nbsp;t2&nbsp;;&nbsp;t3&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>tan_dot_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;tan_dot_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;tan_1024&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;plus_1024&nbsp;sci_1&nbsp;(&nbsp;mult&nbsp;t&nbsp;t&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>direct_th_1024 threshold number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;direct_th_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;real_part&nbsp;z<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;imag_part&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;tx&nbsp;=&nbsp;th_of_real_1024&nbsp;threshold&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ty&nbsp;=&nbsp;tan_of_real_1024&nbsp;threshold&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ity&nbsp;=&nbsp;[|&nbsp;num_0&nbsp;;&nbsp;ty.(0)&nbsp;;&nbsp;ty.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;plus&nbsp;tx&nbsp;ity<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;plus&nbsp;sci_1&nbsp;(&nbsp;mult&nbsp;tx&nbsp;ity&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;n&nbsp;d<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Infinity"</span>&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;real_part_compare_1024&nbsp;x&nbsp;sci_0&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv_1024&nbsp;(&nbsp;th_of_real_1024&nbsp;threshold&nbsp;x&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>th_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;th_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;z&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_0<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;<span class="comment">(*&nbsp;let&nbsp;t1&nbsp;=&nbsp;direct_th_1024&nbsp;1e-2&nbsp;z&nbsp;*)</span><br>
&nbsp;<span class="comment">(*&nbsp;and&nbsp;t2&nbsp;=&nbsp;direct_th_1024&nbsp;1e-3&nbsp;z&nbsp;*)</span><br>
&nbsp;<span class="comment">(*&nbsp;and&nbsp;t3&nbsp;=&nbsp;direct_th_1024&nbsp;1e-4&nbsp;z&nbsp;in&nbsp;*)</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t1&nbsp;=&nbsp;direct_th_1024&nbsp;1e-8&nbsp;z<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;t2&nbsp;=&nbsp;direct_th_1024&nbsp;1e-11&nbsp;z<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;t3&nbsp;=&nbsp;direct_th_1024&nbsp;1e-14&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;approx_1024&nbsp;[|&nbsp;t1&nbsp;;&nbsp;t2&nbsp;;&nbsp;t3&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>th_dot_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;th_dot_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;th_1024&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;minus_1024&nbsp;sci_1&nbsp;(&nbsp;mult&nbsp;t&nbsp;t&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>cos_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cos_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;z&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_1<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;tan_1024&nbsp;[|&nbsp;z.(0)&nbsp;;&nbsp;z.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.pred_num&nbsp;z.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t2&nbsp;=&nbsp;mult&nbsp;t&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;minus&nbsp;sci_1&nbsp;t2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;plus&nbsp;sci_1&nbsp;t2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;n&nbsp;d<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Infinity"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_minus_1<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>direct_sin_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;direct_sin_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;complex_of_sci&nbsp;x&nbsp;).(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x2&nbsp;=&nbsp;(&nbsp;mult&nbsp;x&nbsp;x)<br>
&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;num_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;ref&nbsp;num_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;result&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;gauge&nbsp;=&nbsp;ref&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;!gauge&nbsp;&gt;=&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Num</span>.incr_num&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!d&nbsp;!i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;mult&nbsp;x2&nbsp;!shift&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Num</span>.incr_num&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!d&nbsp;(&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;!i&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;div_1024&nbsp;!shift&nbsp;(&nbsp;sci_of_num&nbsp;!d&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;(&nbsp;complex_of_sci&nbsp;[|&nbsp;!shift.(0)&nbsp;;&nbsp;!shift.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_3&nbsp;!shift.(2)&nbsp;|]&nbsp;).(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;gauge&nbsp;:=&nbsp;compare&nbsp;(&nbsp;(&nbsp;abs_float&nbsp;!xx.(0)&nbsp;)&nbsp;+.&nbsp;(&nbsp;abs_float&nbsp;!xx.(1)&nbsp;)&nbsp;)&nbsp;min_float&nbsp;;<br>
&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;plus_1024&nbsp;!result&nbsp;!shift&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!result&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sin_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sin_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;z&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_0<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;test&nbsp;=&nbsp;complex_of_sci&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;abs_float&nbsp;test.(0).(0)&nbsp;+.&nbsp;abs_float&nbsp;test.(0).(1)&nbsp;)&nbsp;&lt;&nbsp;-3.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;direct_sin_1024&nbsp;z<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;tan_1024&nbsp;[|&nbsp;z.(0)&nbsp;;&nbsp;z.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.pred_num&nbsp;z.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t2&nbsp;=&nbsp;mult&nbsp;t&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;mult&nbsp;sci_2&nbsp;t<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;plus&nbsp;sci_1&nbsp;t2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;n&nbsp;d<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Infinity"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>ch_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;ch_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;z&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_1<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;th_1024&nbsp;[|&nbsp;z.(0)&nbsp;;&nbsp;z.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.pred_num&nbsp;z.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t2&nbsp;=&nbsp;mult&nbsp;t&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;plus&nbsp;sci_1&nbsp;t2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;minus&nbsp;sci_1&nbsp;t2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;n&nbsp;d<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Infinity"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_minus_1<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>direct_sh_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;direct_sh_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;complex_of_sci&nbsp;x&nbsp;).(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x2&nbsp;=&nbsp;(&nbsp;mult&nbsp;x&nbsp;x)<br>
&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;num_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;ref&nbsp;num_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;result&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;gauge&nbsp;=&nbsp;ref&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;!gauge&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Num</span>.incr_num&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!d&nbsp;!i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;mult&nbsp;x2&nbsp;!shift&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Num</span>.incr_num&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!d&nbsp;!i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;div_1024&nbsp;!shift&nbsp;(&nbsp;sci_of_num&nbsp;!d&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;(&nbsp;complex_of_sci&nbsp;[|&nbsp;!shift.(0)&nbsp;;&nbsp;!shift.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_3&nbsp;!shift.(2)&nbsp;|]&nbsp;).(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;gauge&nbsp;:=&nbsp;compare&nbsp;(&nbsp;(&nbsp;abs_float&nbsp;!xx.(0)&nbsp;)&nbsp;+.&nbsp;(&nbsp;abs_float&nbsp;!xx.(1)&nbsp;)&nbsp;)&nbsp;min_float&nbsp;;<br>
&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;plus_1024&nbsp;!result&nbsp;!shift&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!result&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sh_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sh_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;z&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_0<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;test&nbsp;=&nbsp;complex_of_sci&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;abs_float&nbsp;test.(0).(0)&nbsp;+.&nbsp;abs_float&nbsp;test.(0).(1)&nbsp;)&nbsp;&lt;&nbsp;-3.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;direct_sh_1024&nbsp;z<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;th_1024&nbsp;[|&nbsp;z.(0)&nbsp;;&nbsp;z.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.pred_num&nbsp;z.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t2&nbsp;=&nbsp;mult&nbsp;t&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;mult&nbsp;sci_2&nbsp;t<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;minus&nbsp;sci_1&nbsp;t2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;n&nbsp;d<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Infinity"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>exp_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;exp_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;z&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_1<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;test&nbsp;=&nbsp;complex_of_sci&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;abs_float&nbsp;test.(0).(0)&nbsp;+.&nbsp;abs_float&nbsp;test.(0).(1)&nbsp;)&nbsp;&lt;&nbsp;-3.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plus_1024&nbsp;sci_1&nbsp;(&nbsp;expm1_1024&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;th_1024&nbsp;[|&nbsp;z.(0)&nbsp;;&nbsp;z.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.pred_num&nbsp;z.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;plus&nbsp;sci_1&nbsp;t<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;minus&nbsp;sci_1&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;n&nbsp;d<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Infinity"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_minus_1<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** cotan_1024 number *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cotan_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;ref&nbsp;sci_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;annihilate&nbsp;=&nbsp;ref&nbsp;<span class="keyword">false</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;tan_1024&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Infinity"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;annihilate&nbsp;:=&nbsp;<span class="keyword">true</span>&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;!t&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!annihilate&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;sci_0<br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv_1024&nbsp;!t<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** sec_1024 number *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sec_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;ref&nbsp;sci_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;annihilate&nbsp;=&nbsp;ref&nbsp;<span class="keyword">false</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;cos_1024&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Infinity"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;annihilate&nbsp;:=&nbsp;<span class="keyword">true</span>&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;!c&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!annihilate&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;sci_0<br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv_1024&nbsp;!c<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** sech_1024 number *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sech_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;ref&nbsp;sci_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;annihilate&nbsp;=&nbsp;ref&nbsp;<span class="keyword">false</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;ch_1024&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Infinity"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;annihilate&nbsp;:=&nbsp;<span class="keyword">true</span>&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;!c&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!annihilate&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;sci_0<br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv_1024&nbsp;!c<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** cosec_1024 number *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cosec_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;ref&nbsp;sci_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;annihilate&nbsp;=&nbsp;ref&nbsp;<span class="keyword">false</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;sin_1024&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Infinity"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;annihilate&nbsp;:=&nbsp;<span class="keyword">true</span>&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;!s&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!annihilate&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;sci_0<br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv_1024&nbsp;!s<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** cosech_1024 number *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cosech_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;ref&nbsp;sci_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;annihilate&nbsp;=&nbsp;ref&nbsp;<span class="keyword">false</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;sh_1024&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;<span class="string">"Infinity"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;annihilate&nbsp;:=&nbsp;<span class="keyword">true</span>&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;!s&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!annihilate&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;sci_0<br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv_1024&nbsp;!s<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The algorithm of the arithmetic and geometric means comes from the pages 15 and 16 of the document <code class="code">log2.ps</code>
at the following address.
<p>

<code class="code">http://numbers.computation.free.fr/<span class="constructor">Constants</span>/constants.html</code>
<p>

L'algorithme de la moyenne arithmétique et géométrique provient des pages 15 et 16
du document <code class="code">log2.ps</code> à l'adresse précédente. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>agm_1024 vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;agm_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;z.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;z.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;plus_1024&nbsp;x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;[|&nbsp;[|&nbsp;s.(0)&nbsp;;&nbsp;s.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.pred_num&nbsp;s.(2)&nbsp;|]&nbsp;;&nbsp;sqrt_1024&nbsp;(&nbsp;mult&nbsp;x&nbsp;y&nbsp;)&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** agm_sum_1024 vector *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;agm_sum_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;z<br>
&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;num_minus_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;abs_float&nbsp;x&nbsp;)&nbsp;+.&nbsp;(&nbsp;abs_float&nbsp;y&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;z_z&nbsp;=&nbsp;ref&nbsp;(&nbsp;minus&nbsp;(&nbsp;mult&nbsp;z.(0)&nbsp;z.(0)&nbsp;)&nbsp;(&nbsp;mult&nbsp;z.(1)&nbsp;z.(1)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;error&nbsp;=&nbsp;ref&nbsp;(&nbsp;complex_of_sci&nbsp;[|&nbsp;!z_z.(0)&nbsp;;&nbsp;!z_z.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_5&nbsp;!z_z.(2)&nbsp;|]&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zzz&nbsp;=&nbsp;ref&nbsp;[|&nbsp;!z_z.(0)&nbsp;;&nbsp;!z_z.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.pred_num&nbsp;!z_z.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;result&nbsp;=&nbsp;ref&nbsp;!zzz&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;f&nbsp;!error.(0).(0)&nbsp;!error.(0).(1)&nbsp;&gt;&nbsp;32.&nbsp;*.&nbsp;min_float&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Num</span>.incr_num&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;agm_1024&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z_z&nbsp;:=&nbsp;minus&nbsp;(&nbsp;mult&nbsp;!zz.(0)&nbsp;!zz.(0)&nbsp;)&nbsp;(&nbsp;mult&nbsp;!zz.(1)&nbsp;!zz.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zzz&nbsp;:=&nbsp;[|&nbsp;!z_z.(0)&nbsp;;&nbsp;!z_z.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!i&nbsp;!z_z.(2)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;complex_of_sci&nbsp;[|&nbsp;!zzz.(0)&nbsp;;&nbsp;!zzz.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_6&nbsp;!zzz.(2)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;plus&nbsp;!result&nbsp;!zzz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;format_1024&nbsp;!result&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>agm_log_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;agm_log_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;factor&nbsp;=&nbsp;[|&nbsp;num_1&nbsp;;&nbsp;num_0&nbsp;;&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;(&nbsp;-514&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;s1&nbsp;=&nbsp;agm_sum_1024&nbsp;[|&nbsp;sci_1&nbsp;;&nbsp;factor&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;sz&nbsp;=&nbsp;agm_sum_1024&nbsp;[|&nbsp;sci_1&nbsp;;&nbsp;(&nbsp;mult&nbsp;factor&nbsp;z&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r1&nbsp;=&nbsp;minus&nbsp;sci_1&nbsp;s1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;rz&nbsp;=&nbsp;minus&nbsp;sci_1&nbsp;sz&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;minus&nbsp;s1&nbsp;sz<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;mult&nbsp;r1&nbsp;rz&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div_1024&nbsp;n&nbsp;d&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>log1p_1024</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;log1p_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;z&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_0<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;error&nbsp;=&nbsp;ref&nbsp;(&nbsp;complex_of_sci&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;num_2<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;ref&nbsp;sci_0<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;sign&nbsp;=&nbsp;ref&nbsp;<span class="keyword">true</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;abs_float&nbsp;x&nbsp;)&nbsp;+.&nbsp;(&nbsp;abs_float&nbsp;y&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;puissance&nbsp;=&nbsp;ref&nbsp;(&nbsp;mult&nbsp;z&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;result&nbsp;=&nbsp;ref&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;f&nbsp;!error.(0).(0)&nbsp;!error.(0).(1)&nbsp;&gt;&nbsp;min_float&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coefficient&nbsp;:=&nbsp;div&nbsp;!puissance&nbsp;[|&nbsp;!i&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!sign&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;minus&nbsp;!result&nbsp;!coefficient<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;plus&nbsp;!result&nbsp;!coefficient&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Num</span>.incr_num&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sign&nbsp;:=&nbsp;not&nbsp;!sign&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;puissance&nbsp;:=&nbsp;mult&nbsp;z&nbsp;!puissance&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;complex_of_sci&nbsp;[|&nbsp;!coefficient.(0)&nbsp;;&nbsp;!coefficient.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_3&nbsp;!coefficient.(2)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;format_1024&nbsp;!result<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>direct_log_1024 threshold number</pre> A good threshold is -100.
<p>

Un bon seuil est -100. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;direct_log_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;diff&nbsp;=&nbsp;minus&nbsp;z&nbsp;sci_1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;float_diff&nbsp;=&nbsp;complex_of_sci&nbsp;diff&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;abs_float&nbsp;float_diff.(0).(0)&nbsp;+.&nbsp;abs_float&nbsp;float_diff.(0).(1)&nbsp;)&nbsp;&lt;&nbsp;threshold&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;log1p_1024&nbsp;diff<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;agm_log_1024&nbsp;[|&nbsp;z.(0)&nbsp;;&nbsp;z.(1)&nbsp;;&nbsp;num_minus_1&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;mult&nbsp;log_2_1024&nbsp;[|&nbsp;<span class="constructor">Num</span>.succ_num&nbsp;z.(2)&nbsp;;&nbsp;num_0&nbsp;;&nbsp;num_0&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plus_1024&nbsp;x&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>log_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;log_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;direct_log_1024&nbsp;(&nbsp;-100.&nbsp;)&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;exp_1024&nbsp;y<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w0&nbsp;=&nbsp;plus&nbsp;y&nbsp;sci_minus_1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w1&nbsp;=&nbsp;div&nbsp;z&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;plus&nbsp;w0&nbsp;w1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;exp_1024&nbsp;yy<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w2&nbsp;=&nbsp;plus&nbsp;yy&nbsp;sci_minus_1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w3&nbsp;=&nbsp;div&nbsp;z&nbsp;xx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;plus&nbsp;w2&nbsp;w3&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;approx_1024&nbsp;[|&nbsp;y&nbsp;;&nbsp;yy&nbsp;;&nbsp;yyy&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>tune_arg function derivative argument candidate</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;tune_arg&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;f&nbsp;fdot&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(y:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;minus_1024&nbsp;(&nbsp;f&nbsp;y&nbsp;)&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;fdot&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;minus_1024&nbsp;y&nbsp;(&nbsp;div&nbsp;z&nbsp;zz&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>adapt_arg steps threshold function derivative argument candidate</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;adapt_arg&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(steps:int)&nbsp;(threshold:float)&nbsp;f&nbsp;fdot&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;(y:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nouveau&nbsp;=&nbsp;ref&nbsp;(&nbsp;tune_arg&nbsp;f&nbsp;fdot&nbsp;x&nbsp;y&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;ancien&nbsp;=&nbsp;ref&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;error&nbsp;=&nbsp;ref&nbsp;(&nbsp;complex_of_sci&nbsp;(&nbsp;minus&nbsp;!nouveau&nbsp;!ancien&nbsp;)&nbsp;).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;!i&nbsp;&lt;&nbsp;steps&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;(&nbsp;abs_float&nbsp;!error.(0)&nbsp;+.&nbsp;abs_float&nbsp;!error.(1)&nbsp;)&nbsp;&gt;&nbsp;threshold&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;ancien&nbsp;:=&nbsp;!nouveau&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;nouveau&nbsp;:=&nbsp;tune_arg&nbsp;f&nbsp;fdot&nbsp;x&nbsp;!nouveau&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;(&nbsp;complex_of_sci&nbsp;(&nbsp;minus&nbsp;!nouveau&nbsp;!ancien&nbsp;)&nbsp;).(0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!nouveau&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>argth_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;argth_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;eq_0_1024&nbsp;(&nbsp;plus_1024&nbsp;z&nbsp;sci_minus_1&nbsp;)&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;(&nbsp;eq_0_1024&nbsp;(&nbsp;plus_1024&nbsp;z&nbsp;sci_1&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;failwith&nbsp;<span class="string">"Infinity"</span>&nbsp;;<br>
&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;z&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_0<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;test&nbsp;=&nbsp;complex_of_sci&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;abs_float&nbsp;test.(0).(0)&nbsp;+.&nbsp;abs_float&nbsp;test.(0).(1)&nbsp;)&nbsp;&lt;&nbsp;-3.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adapt_arg&nbsp;100&nbsp;(&nbsp;16.&nbsp;*.&nbsp;min_float&nbsp;)&nbsp;th_1024&nbsp;th_dot_1024&nbsp;z&nbsp;z<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;plus&nbsp;sci_1&nbsp;z<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;minus&nbsp;sci_1&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;q&nbsp;=&nbsp;div&nbsp;n&nbsp;d&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;log_1024&nbsp;q&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;y.(0)&nbsp;;&nbsp;y.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.pred_num&nbsp;y.(2)&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Infinity"</span><br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>argch_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;argch_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;diff&nbsp;=&nbsp;minus&nbsp;z&nbsp;sci_1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;diff&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;sci_0<br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;float_test&nbsp;=&nbsp;complex_of_sci&nbsp;diff&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;abs_float&nbsp;float_test.(0).(0)&nbsp;+.&nbsp;abs_float&nbsp;float_test.(0).(1)&nbsp;)&nbsp;&lt;&nbsp;-3.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adapt_arg&nbsp;100&nbsp;(&nbsp;16.&nbsp;*.&nbsp;min_float&nbsp;)&nbsp;ch_1024&nbsp;sh_1024&nbsp;z&nbsp;(&nbsp;sqrt_1024&nbsp;(&nbsp;mult&nbsp;sci_2&nbsp;diff&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;mult&nbsp;z&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;sqrt_1024&nbsp;(&nbsp;plus&nbsp;zz&nbsp;sci_minus_1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_1024&nbsp;(&nbsp;plus&nbsp;z&nbsp;s&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>direct_argsh_1024 steps number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;direct_argsh_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(steps:int)&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;complex_of_sci&nbsp;x&nbsp;).(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x2&nbsp;=&nbsp;(&nbsp;mult&nbsp;x&nbsp;x)<br>
&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;power&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;num_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;factor&nbsp;=&nbsp;ref&nbsp;num_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;num_0<br>
&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;ref&nbsp;num_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;result&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;gauge&nbsp;=&nbsp;ref&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;!gauge&nbsp;&gt;&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;<span class="constructor">Num</span>.int_of_num&nbsp;!i&nbsp;&lt;&nbsp;steps&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Num</span>.incr_num&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;<span class="constructor">Num</span>.succ_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;num_2&nbsp;!i&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!accu&nbsp;(&nbsp;<span class="constructor">Num</span>.div_num&nbsp;(&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!i&nbsp;num_minus_05&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.minus_num&nbsp;!i&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;factor&nbsp;:=&nbsp;<span class="constructor">Num</span>.div_num&nbsp;!accu&nbsp;!d&nbsp;;<br>
&nbsp;&nbsp;&nbsp;power&nbsp;:=&nbsp;mult_1024&nbsp;x2&nbsp;!power&nbsp;;<br>
&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;mult&nbsp;!power&nbsp;(&nbsp;sci_of_num&nbsp;!factor&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;(&nbsp;complex_of_sci&nbsp;[|&nbsp;!shift.(0)&nbsp;;&nbsp;!shift.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_3&nbsp;!shift.(2)&nbsp;|]&nbsp;).(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;gauge&nbsp;:=&nbsp;compare&nbsp;(&nbsp;(&nbsp;abs_float&nbsp;!xx.(0)&nbsp;)&nbsp;+.&nbsp;(&nbsp;abs_float&nbsp;!xx.(1)&nbsp;)&nbsp;)&nbsp;min_float&nbsp;;<br>
&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;plus_1024&nbsp;!result&nbsp;!shift&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!result&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>argsh_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;argsh_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;z&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_0<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;test&nbsp;=&nbsp;complex_of_sci&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;abs_float&nbsp;test.(0).(0)&nbsp;+.&nbsp;abs_float&nbsp;test.(0).(1)&nbsp;)&nbsp;&lt;&nbsp;-3.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adapt_arg&nbsp;100&nbsp;(&nbsp;16.&nbsp;*.&nbsp;min_float&nbsp;)&nbsp;sh_1024&nbsp;ch_1024&nbsp;z&nbsp;(&nbsp;direct_argsh_1024&nbsp;2&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;mult&nbsp;z&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;sqrt_1024&nbsp;(&nbsp;plus&nbsp;zz&nbsp;sci_1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_1024&nbsp;(&nbsp;plus&nbsp;z&nbsp;s&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>arctan_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;arctan_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;z&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_0<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;mult&nbsp;sci_minus_i&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mult_1024&nbsp;sci_i&nbsp;(&nbsp;argth_1024&nbsp;zz&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>direct_arcsin_1024 steps number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;direct_arcsin_1024&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(steps:int)&nbsp;(x:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;complex_of_sci&nbsp;x&nbsp;).(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x2&nbsp;=&nbsp;(&nbsp;mult_1024&nbsp;x&nbsp;x)<br>
&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;power&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;num_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;factor&nbsp;=&nbsp;ref&nbsp;num_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;num_0<br>
&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;ref&nbsp;num_1<br>
&nbsp;<span class="keyword">and</span>&nbsp;result&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;gauge&nbsp;=&nbsp;ref&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;!gauge&nbsp;&gt;=&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;<span class="constructor">Num</span>.int_of_num&nbsp;!i&nbsp;&lt;&nbsp;steps&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Num</span>.incr_num&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;<span class="constructor">Num</span>.succ_num&nbsp;(&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;num_2&nbsp;!i&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;!accu&nbsp;(&nbsp;<span class="constructor">Num</span>.div_num&nbsp;(&nbsp;<span class="constructor">Num</span>.add_num&nbsp;!i&nbsp;num_minus_05&nbsp;)&nbsp;!i&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;factor&nbsp;:=&nbsp;<span class="constructor">Num</span>.div_num&nbsp;!accu&nbsp;!d&nbsp;;<br>
&nbsp;&nbsp;&nbsp;power&nbsp;:=&nbsp;mult&nbsp;x2&nbsp;!power&nbsp;;<br>
&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;mult&nbsp;!power&nbsp;(&nbsp;sci_of_num&nbsp;!factor&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;(&nbsp;complex_of_sci&nbsp;[|&nbsp;!shift.(0)&nbsp;;&nbsp;!shift.(1)&nbsp;;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;num_3&nbsp;!shift.(2)&nbsp;|]&nbsp;).(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;gauge&nbsp;:=&nbsp;compare&nbsp;(&nbsp;(&nbsp;abs_float&nbsp;!xx.(0)&nbsp;)&nbsp;+.&nbsp;(&nbsp;abs_float&nbsp;!xx.(1)&nbsp;)&nbsp;)&nbsp;min_float&nbsp;;<br>
&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;plus&nbsp;!result&nbsp;!shift&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!result&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>arcsin_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;arcsin_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;eq_0_1024&nbsp;z&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;sci_0<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;test&nbsp;=&nbsp;complex_of_sci&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;abs_float&nbsp;test.(0).(0)&nbsp;+.&nbsp;abs_float&nbsp;test.(0).(1)&nbsp;)&nbsp;&lt;&nbsp;-3.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adapt_arg&nbsp;100&nbsp;(&nbsp;16.&nbsp;*.&nbsp;min_float&nbsp;)&nbsp;sin_1024&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sci_1&nbsp;)&nbsp;z&nbsp;(&nbsp;direct_arcsin_1024&nbsp;2&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;mult&nbsp;sci_minus_i&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mult_1024&nbsp;sci_i&nbsp;(&nbsp;argsh_1024&nbsp;zz&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>arccos_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;arccos_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;argch_1024&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;mult_1024&nbsp;sci_minus_i&nbsp;zz&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>arcsec_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;arcsec_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;arccos_1024&nbsp;(&nbsp;inv&nbsp;z&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>argsech_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;argsech_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;argch_1024&nbsp;(&nbsp;inv&nbsp;z&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>arccosec_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;arccosec_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;arcsin_1024&nbsp;(&nbsp;inv&nbsp;z&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>argcosech_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;argcosech_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;argsh_1024&nbsp;(&nbsp;inv&nbsp;z&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>arccotan_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;arccotan_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;arctan_1024&nbsp;(&nbsp;inv&nbsp;z&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>arccoth_1024 number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;argcoth_1024&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(z:<span class="constructor">Num</span>.num&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;argth_1024&nbsp;(&nbsp;inv&nbsp;z&nbsp;)&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ § § </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<span class="keyword">end</span></code></body></html>