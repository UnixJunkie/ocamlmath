<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Graphicmath" rel="Chapter" href="Graphicmath.html"><title>Graphicmath.Widget</title>
</head>
<body>
<code class="code"><span class="keyword">struct</span><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Introduction"><h1>Introduction</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(**
The mathematician will find in this module:
<p>
<ul>
<li>utility functions in order to make interactive graphical windows,</li>
</ul>
<ul>
<li>some dialog boxes.</li>
</ul>

<span id="2_Conventions"><h2>Conventions</h2></span>
<p>

In order to activate a graphic element, one has to click in the area that it determines (with the left button of the pointing device),
casually twice.
<p>

The use is rather aimed at analogic metrology.
<p>

<span id="2_Comments"><h2>Comments</h2></span>
<p>

When rewriting a button, it useful to use messages with the same number of lines,
lines with fixed lengths, and a character font with fixed width.
<p>

For character string edition, controls similar to common controls are available,
given that not all of them are reachable, depending on the system :
<p>
<ul>
<li>move to left end with <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">A</span></code>,</li>
</ul>
<ul>
<li>delete left part with <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">U</span></code>,</li>
</ul>
<ul>
<li>delete toward left with <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">Space</span></code>, <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">H</span></code>, <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">R</span></code>, <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">X</span></code>,</li>
</ul>
<ul>
<li>move left with <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">B</span></code>, <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">P</span></code>,</li>
</ul>
<ul>
<li>move right with <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">F</span></code>, <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">N</span></code>,</li>
</ul>
<ul>
<li>delete toward right with <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">S</span></code>, <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">Z</span></code>,</li>
</ul>
<ul>
<li>delete right part with <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">K</span></code>,</li>
</ul>
<ul>
<li>move to right end with <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">E</span></code>.</li>
</ul>

The position of the edited character is at the change of the color of the text.
<p>

This module is distributed under the same licence as Ocaml.
<p>

<center>§ </center>
<p>

La mathématicienne ou le mathématicien trouvera dans ce module :
<p>
<ul>
<li>des fonctions utilitaires pour construire des fenêtres graphiques interactives,</li>
</ul>
<ul>
<li>quelques boîtes de dialogues.</li>
</ul>

<span id="2_Conventions"><h2>Conventions</h2></span>
<p>

Pour activer un élément graphique, il faut cliquer dans zone qu'il délimite (avec le bouton gauche du pointeur),
éventuellement deux fois.
<p>

L'utilisation visée est plutôt la métrologie analogique.
<p>

<span id="2_Commentaires"><h2>Commentaires</h2></span>
<p>

Quand on réécrit un bouton, il est utile que les messages utilisent le même nombre de lignes, 
des lignes de longueurs invariables et une police de caractères à chasse fixe.
<p>

Pour le modelage de chaînes de caractères, des commandes proches des commandes habituelles sont disponibles, 
sachant qu'elles ne sont pas toutes accessibles d'un système à l'autre :
<p>
<ul>
<li>déplacement vers l'extrémité gauche avec <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">A</span></code>,</li>
</ul>
<ul>
<li>effaçage de la partie gauche avec <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">U</span></code>,</li>
</ul>
<ul>
<li>effaçage vers la gauche avec <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">Space</span></code>, <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">H</span></code>, <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">R</span></code>, <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">X</span></code>,</li>
</ul>
<ul>
<li>déplacement vers la gauche avec <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">B</span></code>, <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">P</span></code>,</li>
</ul>
<ul>
<li>déplacement vers la droite avec <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">F</span></code>, <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">N</span></code>,</li>
</ul>
<ul>
<li>effaçage vers la droite avec <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">S</span></code>, <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">Z</span></code>,</li>
</ul>
<ul>
<li>effaçage de la partie droite avec <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">K</span></code>,</li>
</ul>
<ul>
<li>déplacement vers l'extrémité droite avec <code class="code"><span class="constructor">Ctl</span>-<span class="constructor">E</span></code>.</li>
</ul>

La position du caractère courant est au changement de couleur du texte.
<p>

Ce module est distribué selon la même licence qu'Ocaml.
<p>

<center>Copyright Stéphane Grognet </center>
<center>Laboratoire de mathématiques Jean Leray UMR 6629 CNRS </center>
<center>Fédération de recherche mathématique des Pays de la Loire </center>
<center>IREM des Pays de la Loire - Université de Nantes </center>
<center>version 0.3</center>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@version 0.3
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@author Stéphane Grognet
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@since 2012, 2013
*)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Utilitaires"><h1>Utilitaires</h1></span>
<span id="1_Utilities"><h1>Utilities</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Util</span>&nbsp;;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Matrix</span>&nbsp;;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Readwrite</span>&nbsp;;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Infinitesimal</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>dark_grey</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;dark_grey&nbsp;=&nbsp;65793&nbsp;*&nbsp;70&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>bee_v integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;bee_v&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;433&nbsp;*&nbsp;x&nbsp;/&nbsp;250&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>half_bee_v integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;half_bee_v&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;433&nbsp;*&nbsp;x&nbsp;/&nbsp;500&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>bee_h integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;bee_h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;250&nbsp;*&nbsp;x&nbsp;/&nbsp;433&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>double_bee_h integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;double_bee_h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;500&nbsp;*&nbsp;x&nbsp;/&nbsp;433&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>tour_split integer center_abscissa center_ordinate radius</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;tour_split&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(x:float)&nbsp;(y:float)&nbsp;(r:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Infinitesimal</span>.halfpi&nbsp;*.&nbsp;(&nbsp;(&nbsp;2.&nbsp;+.&nbsp;4.&nbsp;*.&nbsp;x&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;-.&nbsp;1.&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;a&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;n&nbsp;2&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;row.(0)&nbsp;&lt;-&nbsp;x&nbsp;+.&nbsp;r&nbsp;*.&nbsp;cos&nbsp;(&nbsp;f&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;row.(1)&nbsp;&lt;-&nbsp;y&nbsp;+.&nbsp;r&nbsp;*.&nbsp;sin&nbsp;(&nbsp;f&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;a&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>ring_split integer center_abscissa center_ordinate inner_radius exterior_radius</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;ring_split&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(x:int)&nbsp;(y:int)&nbsp;(r_in:int)&nbsp;(r_ext:int)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;float&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;float&nbsp;y<br>
&nbsp;<span class="keyword">and</span>&nbsp;ri&nbsp;=&nbsp;float&nbsp;r_in<br>
&nbsp;<span class="keyword">and</span>&nbsp;re&nbsp;=&nbsp;float&nbsp;r_ext<br>
&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;int_of_float&nbsp;z.(0)&nbsp;,&nbsp;int_of_float&nbsp;z.(1)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t_in&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;f&nbsp;(&nbsp;tour_split&nbsp;n&nbsp;xx&nbsp;yy&nbsp;ri&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;t_ext&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;f&nbsp;(&nbsp;tour_split&nbsp;n&nbsp;xx&nbsp;yy&nbsp;re&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.append&nbsp;t_in&nbsp;(&nbsp;<span class="constructor">Util</span>.reverse_array&nbsp;t_ext&nbsp;)&nbsp;;;<br>
&nbsp;<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>triangle_isobarycentre x y z</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;triangle_isobarycentre&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int&nbsp;*&nbsp;int)&nbsp;(y:int&nbsp;*&nbsp;int)&nbsp;(z:int&nbsp;*&nbsp;int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;[|&nbsp;(&nbsp;fst&nbsp;x&nbsp;+&nbsp;fst&nbsp;y&nbsp;+&nbsp;fst&nbsp;z&nbsp;)&nbsp;/&nbsp;3&nbsp;;&nbsp;(&nbsp;snd&nbsp;x&nbsp;+&nbsp;snd&nbsp;y&nbsp;+&nbsp;snd&nbsp;z&nbsp;)&nbsp;/&nbsp;3&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>triangle_barycentre weight x y z</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;triangle_barycentre&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(weight:float)&nbsp;(x:int&nbsp;*&nbsp;int)&nbsp;(y:int&nbsp;*&nbsp;int)&nbsp;(z:int&nbsp;*&nbsp;int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;[|&nbsp;int_of_float&nbsp;(&nbsp;weight&nbsp;*.&nbsp;(&nbsp;float&nbsp;(&nbsp;fst&nbsp;x&nbsp;)&nbsp;)&nbsp;+.&nbsp;(&nbsp;0.5&nbsp;*.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;weight&nbsp;)&nbsp;)&nbsp;*.&nbsp;(&nbsp;float&nbsp;(&nbsp;fst&nbsp;y&nbsp;+&nbsp;fst&nbsp;z&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;int_of_float&nbsp;(&nbsp;weight&nbsp;*.&nbsp;(&nbsp;float&nbsp;(&nbsp;snd&nbsp;x&nbsp;)&nbsp;)&nbsp;+.&nbsp;(&nbsp;0.5&nbsp;*.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;weight&nbsp;)&nbsp;)&nbsp;*.&nbsp;(&nbsp;float&nbsp;(&nbsp;snd&nbsp;y&nbsp;+&nbsp;snd&nbsp;z&nbsp;)&nbsp;)&nbsp;)&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>positive_argument x y</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;positive_argument&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:float)&nbsp;(y:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;y&nbsp;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span>&nbsp;atan2&nbsp;y&nbsp;x<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;y&nbsp;&lt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;(&nbsp;atan2&nbsp;y&nbsp;x&nbsp;)&nbsp;+.&nbsp;<span class="constructor">Infinitesimal</span>.doublepi<br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span>&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="constructor">Infinitesimal</span>.pi&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Interrupteurs"><h1>Interrupteurs</h1></span>
<span id="1_Switches"><h1>Switches</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>rect_switch center_abscissa center_ordinate button_color text_color text</pre> The function returns the coordinates
of the bottom left corner, the coordinates of the upper right corner.
<p>

La fonction retourne les coordonnées du coin en bas à gauche, les coordonnées du point en haut à droite. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rect_switch&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(abscissa:int)&nbsp;(ordinate:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(text:string&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.foreground&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_sum&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;bw&nbsp;=&nbsp;min&nbsp;(&nbsp;(&nbsp;7&nbsp;*&nbsp;w&nbsp;)&nbsp;/&nbsp;5&nbsp;)&nbsp;(&nbsp;w&nbsp;+&nbsp;20&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bh&nbsp;=&nbsp;min&nbsp;(&nbsp;(&nbsp;8&nbsp;*&nbsp;h&nbsp;)&nbsp;/&nbsp;5&nbsp;)&nbsp;(&nbsp;h&nbsp;+&nbsp;10&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;abscissa&nbsp;-&nbsp;bw&nbsp;/&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ordinate&nbsp;-&nbsp;bh&nbsp;/&nbsp;2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_rect&nbsp;x&nbsp;y&nbsp;bw&nbsp;bh&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_rect&nbsp;(&nbsp;x&nbsp;+&nbsp;1&nbsp;)&nbsp;(&nbsp;y&nbsp;+&nbsp;1&nbsp;)&nbsp;(&nbsp;bw&nbsp;-&nbsp;2&nbsp;)&nbsp;(&nbsp;bh&nbsp;-&nbsp;2&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;pred&nbsp;n&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;left&nbsp;=&nbsp;x&nbsp;+&nbsp;(&nbsp;bw&nbsp;-&nbsp;widths.(i)&nbsp;-&nbsp;2&nbsp;)&nbsp;/&nbsp;2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;left&nbsp;(&nbsp;y&nbsp;+&nbsp;!shift&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;!shift&nbsp;+&nbsp;heights.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;abscissa&nbsp;;&nbsp;ordinate&nbsp;;&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;x&nbsp;+&nbsp;bw&nbsp;;&nbsp;y&nbsp;+&nbsp;bh&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>is_over_rect_button button_position abscissa ordinate</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;is_over_rect_button&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:int&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;table&nbsp;=&nbsp;[|&nbsp;x&nbsp;&gt;=&nbsp;button.(2)&nbsp;;&nbsp;x&nbsp;&lt;=&nbsp;button.(4)&nbsp;;&nbsp;y&nbsp;&gt;=&nbsp;button.(3)&nbsp;;&nbsp;y&nbsp;&lt;=&nbsp;button.(5)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;)&nbsp;<span class="keyword">true</span>&nbsp;table&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>hat_switch center_abscissa center_ordinate button_color text_color text</pre> The function returns 
the position of the circonscript rectangle of the triangle.
<p>

La fonction retourne la position du rectangle circonscrit au triangle. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;hat_switch&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(abscissa:int)&nbsp;(ordinate:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(text:string&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;double_bee_h&nbsp;h&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;j&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;+&nbsp;(&nbsp;n&nbsp;-&nbsp;j&nbsp;)&nbsp;*&nbsp;coeff&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;width_measures&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;f&nbsp;widths&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;width_measures&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;size&nbsp;=&nbsp;5&nbsp;+&nbsp;(&nbsp;(&nbsp;11&nbsp;*&nbsp;wh&nbsp;)&nbsp;/&nbsp;20&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;bw&nbsp;=&nbsp;2&nbsp;*&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;abscissa&nbsp;-&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bh&nbsp;=&nbsp;bee_v&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;(&nbsp;1&nbsp;+&nbsp;size&nbsp;/&nbsp;5&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;x&nbsp;+&nbsp;bw<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ordinate&nbsp;-&nbsp;bh&nbsp;/&nbsp;3&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;y&nbsp;+&nbsp;bh&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sequence&nbsp;=&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;xx&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;x&nbsp;+&nbsp;size&nbsp;,&nbsp;yy&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.foreground&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;pred&nbsp;n&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;left&nbsp;=&nbsp;x&nbsp;+&nbsp;(&nbsp;7&nbsp;*&nbsp;w&nbsp;-&nbsp;4&nbsp;*&nbsp;widths.(i)&nbsp;)&nbsp;/&nbsp;8&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;left&nbsp;(&nbsp;y&nbsp;+&nbsp;!shift&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;!shift&nbsp;+&nbsp;heights.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;abscissa&nbsp;;&nbsp;ordinate&nbsp;;&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;xx&nbsp;;&nbsp;yy&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>is_over_hat_button button_position abscissa ordinate</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;is_over_hat_button&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:int&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;button.(3)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dy&nbsp;=&nbsp;y&nbsp;-&nbsp;yy&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;table&nbsp;=&nbsp;[|&nbsp;x&nbsp;&gt;=&nbsp;button.(2)&nbsp;+&nbsp;(&nbsp;bee_h&nbsp;dy&nbsp;)&nbsp;;&nbsp;x&nbsp;&lt;=&nbsp;button.(4)&nbsp;-&nbsp;(&nbsp;bee_h&nbsp;dy&nbsp;)&nbsp;;&nbsp;y&nbsp;&gt;=&nbsp;yy&nbsp;;&nbsp;y&nbsp;&lt;=&nbsp;button.(5)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;)&nbsp;<span class="keyword">true</span>&nbsp;table&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>cup_switch center_abscissa center_ordinate button_color text_color text</pre> The function returns 
the position of the circonscript rectangle of the triangle.
<p>

La fonction retourne la position du rectangle circonscrit au triangle. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cup_switch&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(abscissa:int)&nbsp;(ordinate:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(text:string&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;double_bee_h&nbsp;h&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;j&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;+&nbsp;(&nbsp;succ&nbsp;j&nbsp;)&nbsp;*&nbsp;coeff&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;width_measures&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;f&nbsp;widths&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;width_measures&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;size&nbsp;=&nbsp;5&nbsp;+&nbsp;(&nbsp;(&nbsp;11&nbsp;*&nbsp;wh&nbsp;)&nbsp;/&nbsp;20&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;bw&nbsp;=&nbsp;2&nbsp;*&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;abscissa&nbsp;-&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bh&nbsp;=&nbsp;bee_v&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;(&nbsp;-&nbsp;size&nbsp;/&nbsp;10&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;x&nbsp;+&nbsp;bw<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ordinate&nbsp;+&nbsp;bh&nbsp;/&nbsp;3&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;y&nbsp;-&nbsp;bh&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sequence&nbsp;=&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;xx&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;x&nbsp;+&nbsp;size&nbsp;,&nbsp;yy&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.foreground&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;!shift&nbsp;-&nbsp;heights.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;left&nbsp;=&nbsp;x&nbsp;+&nbsp;(&nbsp;7&nbsp;*&nbsp;w&nbsp;-&nbsp;4&nbsp;*&nbsp;widths.(i)&nbsp;)&nbsp;/&nbsp;8&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;left&nbsp;(&nbsp;y&nbsp;+&nbsp;!shift&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;abscissa&nbsp;;&nbsp;ordinate&nbsp;;&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;xx&nbsp;;&nbsp;yy&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>is_over_cup_button button_position abscissa ordinate</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;is_over_cup_button&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:int&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;button.(3)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dy&nbsp;=&nbsp;y&nbsp;-&nbsp;yy&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;table&nbsp;=&nbsp;[|&nbsp;x&nbsp;&gt;=&nbsp;button.(2)&nbsp;-&nbsp;(&nbsp;bee_h&nbsp;dy&nbsp;)&nbsp;;&nbsp;x&nbsp;&lt;=&nbsp;button.(4)&nbsp;+&nbsp;(&nbsp;bee_h&nbsp;dy&nbsp;)&nbsp;;&nbsp;y&nbsp;&gt;=&nbsp;button.(5)&nbsp;;&nbsp;y&nbsp;&lt;=&nbsp;yy&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;)&nbsp;<span class="keyword">true</span>&nbsp;table&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>right_switch center_abscissa center_ordinate button_color text_color text</pre> The function returns 
the position of the circonscript rectangle of the triangle.
<p>

La fonction retourne la position du rectangle circonscrit au triangle. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;right_switch&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(abscissa:int)&nbsp;(ordinate:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(text:string&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;double_bee_h&nbsp;h&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;j&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;+&nbsp;(&nbsp;abs&nbsp;(&nbsp;n&nbsp;/&nbsp;2&nbsp;-&nbsp;j&nbsp;)&nbsp;)&nbsp;*&nbsp;coeff&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;width_measures&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;f&nbsp;widths&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;width_measures&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;size&nbsp;=&nbsp;5&nbsp;+&nbsp;(&nbsp;(&nbsp;19&nbsp;*&nbsp;wh&nbsp;)&nbsp;/&nbsp;20&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;bw&nbsp;=&nbsp;2&nbsp;*&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ordinate&nbsp;-&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bh&nbsp;=&nbsp;bee_v&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;(&nbsp;1&nbsp;+&nbsp;11&nbsp;*&nbsp;size&nbsp;/&nbsp;20&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;abscissa&nbsp;-&nbsp;bh&nbsp;/&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;y&nbsp;+&nbsp;bh&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;x&nbsp;+&nbsp;bw&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sequence&nbsp;=&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;xx&nbsp;,&nbsp;y&nbsp;+&nbsp;size&nbsp;)&nbsp;;&nbsp;(&nbsp;x&nbsp;,&nbsp;yy&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.foreground&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;pred&nbsp;n&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;left&nbsp;=&nbsp;x&nbsp;+&nbsp;size&nbsp;/&nbsp;5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;left&nbsp;(&nbsp;y&nbsp;+&nbsp;!shift&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;!shift&nbsp;+&nbsp;heights.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;abscissa&nbsp;;&nbsp;ordinate&nbsp;;&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;xx&nbsp;;&nbsp;yy&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>is_over_right_button button_position abscissa ordinate</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;is_over_right_button&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:int&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;button.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dx&nbsp;=&nbsp;x&nbsp;-&nbsp;xx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;table&nbsp;=&nbsp;[|&nbsp;x&nbsp;&gt;=&nbsp;xx&nbsp;;&nbsp;x&nbsp;&lt;=&nbsp;button.(4)&nbsp;;&nbsp;y&nbsp;&gt;=&nbsp;button.(3)&nbsp;+&nbsp;(&nbsp;bee_h&nbsp;dx&nbsp;)&nbsp;;&nbsp;y&nbsp;&lt;=&nbsp;button.(5)&nbsp;-&nbsp;(&nbsp;bee_h&nbsp;dx&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;)&nbsp;<span class="keyword">true</span>&nbsp;table&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>left_switch center_abscissa center_ordinate button_color text_color text</pre> The function returns 
the position of the circonscript rectangle of the triangle.
<p>

La fonction retourne la position du rectangle circonscrit au triangle. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;left_switch&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(abscissa:int)&nbsp;(ordinate:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(text:string&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;double_bee_h&nbsp;h&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;j&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;+&nbsp;(&nbsp;abs&nbsp;(&nbsp;n&nbsp;/&nbsp;2&nbsp;-&nbsp;j&nbsp;)&nbsp;)&nbsp;*&nbsp;coeff&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;width_measures&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;f&nbsp;widths&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;width_measures&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;size&nbsp;=&nbsp;5&nbsp;+&nbsp;(&nbsp;(&nbsp;19&nbsp;*&nbsp;wh&nbsp;)&nbsp;/&nbsp;20&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;bw&nbsp;=&nbsp;2&nbsp;*&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bh&nbsp;=&nbsp;bee_v&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ordinate&nbsp;-&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;(&nbsp;1&nbsp;+&nbsp;11&nbsp;*&nbsp;size&nbsp;/&nbsp;20&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;abscissa&nbsp;+&nbsp;bw&nbsp;/&nbsp;3<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;y&nbsp;+&nbsp;bh&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;x&nbsp;-&nbsp;bw&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sequence&nbsp;=&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;xx&nbsp;,&nbsp;y&nbsp;+&nbsp;size&nbsp;)&nbsp;;&nbsp;(&nbsp;x&nbsp;,&nbsp;yy&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.foreground&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;pred&nbsp;n&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;left&nbsp;=&nbsp;x&nbsp;-&nbsp;(&nbsp;18&nbsp;*&nbsp;w&nbsp;+&nbsp;3&nbsp;*&nbsp;size&nbsp;)&nbsp;/&nbsp;20&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;left&nbsp;(&nbsp;y&nbsp;+&nbsp;!shift&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;!shift&nbsp;+&nbsp;heights.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;abscissa&nbsp;;&nbsp;ordinate&nbsp;;&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;xx&nbsp;;&nbsp;yy&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>is_over_left_button button_position abscissa ordinate</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;is_over_left_button&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:int&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;button.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dx&nbsp;=&nbsp;x&nbsp;-&nbsp;xx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;table&nbsp;=&nbsp;[|&nbsp;x&nbsp;&lt;=&nbsp;xx&nbsp;;&nbsp;x&nbsp;&gt;=&nbsp;button.(4)&nbsp;;&nbsp;y&nbsp;&gt;=&nbsp;button.(3)&nbsp;-&nbsp;(&nbsp;bee_h&nbsp;dx&nbsp;)&nbsp;;&nbsp;y&nbsp;&lt;=&nbsp;button.(5)&nbsp;+&nbsp;(&nbsp;bee_h&nbsp;dx&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;)&nbsp;<span class="keyword">true</span>&nbsp;table&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>ll_switch bottom_left_corner_abscissa bottom_left_corner_ordinate button_color text_color text</pre> The function returns
the position of the circonscript rectangle of the triangle.
<p>

La fonction retourne la position du rectangle circonscrit au triangle. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;ll_switch&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(text:string&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;j&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;+&nbsp;(&nbsp;n&nbsp;-&nbsp;j&nbsp;)&nbsp;*&nbsp;h&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;width_measures&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;f&nbsp;widths&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;width_measures&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;size&nbsp;=&nbsp;5&nbsp;+&nbsp;(&nbsp;(&nbsp;12&nbsp;*&nbsp;wh&nbsp;)&nbsp;/&nbsp;20&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;bw&nbsp;=&nbsp;2&nbsp;*&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;(&nbsp;1&nbsp;+&nbsp;size&nbsp;/&nbsp;10&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;x&nbsp;+&nbsp;bw<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;y&nbsp;+&nbsp;bw&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sequence&nbsp;=&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;xx&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;x&nbsp;,&nbsp;yy&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.foreground&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;pred&nbsp;n&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;left&nbsp;=&nbsp;x&nbsp;+&nbsp;size&nbsp;/&nbsp;10&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;left&nbsp;(&nbsp;y&nbsp;+&nbsp;!shift&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;!shift&nbsp;+&nbsp;heights.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;xx&nbsp;;&nbsp;yy&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>is_over_ll_button button_position abscissa ordinate</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;is_over_ll_button&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:int&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;button.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dx&nbsp;=&nbsp;x&nbsp;-&nbsp;xx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;table&nbsp;=&nbsp;[|&nbsp;x&nbsp;&gt;=&nbsp;xx&nbsp;;&nbsp;x&nbsp;&lt;=&nbsp;button.(2)&nbsp;;&nbsp;y&nbsp;&gt;=&nbsp;button.(1)&nbsp;;&nbsp;y&nbsp;&lt;=&nbsp;button.(3)&nbsp;-&nbsp;dx&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;)&nbsp;<span class="keyword">true</span>&nbsp;table&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>lr_switch bottom_right_corner_abscissa bottom_right_corner_ordinate button_color text_color text</pre> The function returns
the position of the circonscript rectangle of the triangle.
<p>

La fonction retourne la position du rectangle circonscrit au triangle. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;lr_switch&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(text:string&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;j&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;+&nbsp;(&nbsp;n&nbsp;-&nbsp;j&nbsp;)&nbsp;*&nbsp;h&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;width_measures&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;f&nbsp;widths&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;width_measures&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;size&nbsp;=&nbsp;5&nbsp;+&nbsp;(&nbsp;(&nbsp;12&nbsp;*&nbsp;wh&nbsp;)&nbsp;/&nbsp;20&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;bw&nbsp;=&nbsp;2&nbsp;*&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;(&nbsp;1&nbsp;+&nbsp;size&nbsp;/&nbsp;10&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;x&nbsp;-&nbsp;bw<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;y&nbsp;+&nbsp;bw&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sequence&nbsp;=&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;xx&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;x&nbsp;,&nbsp;yy&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.foreground&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;pred&nbsp;n&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;left&nbsp;=&nbsp;x&nbsp;-&nbsp;(&nbsp;29&nbsp;*&nbsp;size&nbsp;)&nbsp;/&nbsp;20&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;left&nbsp;(&nbsp;y&nbsp;+&nbsp;!shift&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;!shift&nbsp;+&nbsp;heights.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;xx&nbsp;;&nbsp;yy&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>is_over_lr_button button_position abscissa ordinate</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;is_over_lr_button&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:int&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;button.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dx&nbsp;=&nbsp;x&nbsp;-&nbsp;xx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;table&nbsp;=&nbsp;[|&nbsp;x&nbsp;&lt;=&nbsp;xx&nbsp;;&nbsp;x&nbsp;&gt;=&nbsp;button.(2)&nbsp;;&nbsp;y&nbsp;&gt;=&nbsp;button.(1)&nbsp;;&nbsp;y&nbsp;&lt;=&nbsp;button.(3)&nbsp;+&nbsp;dx&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;)&nbsp;<span class="keyword">true</span>&nbsp;table&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>ul_switch upper_left_corner_abscissa upper_left_corner_ordinate button_color text_color text</pre> The function returns
the position of the circonscript rectangle of the triangle.
<p>

La fonction retourne la position du rectangle circonscrit au triangle. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;ul_switch&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(text:string&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;j&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;+&nbsp;j&nbsp;*&nbsp;h&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;width_measures&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;f&nbsp;widths&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;width_measures&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;size&nbsp;=&nbsp;5&nbsp;+&nbsp;(&nbsp;(&nbsp;12&nbsp;*&nbsp;wh&nbsp;)&nbsp;/&nbsp;20&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;bw&nbsp;=&nbsp;2&nbsp;*&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;(&nbsp;1&nbsp;+&nbsp;size&nbsp;/&nbsp;10&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;x&nbsp;+&nbsp;bw<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;y&nbsp;-&nbsp;bw&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sequence&nbsp;=&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;xx&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;x&nbsp;,&nbsp;yy&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.foreground&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;left&nbsp;=&nbsp;x&nbsp;+&nbsp;size&nbsp;/&nbsp;10&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;!shift&nbsp;+&nbsp;heights.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;left&nbsp;(&nbsp;y&nbsp;-&nbsp;!shift&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;xx&nbsp;;&nbsp;yy&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>is_over_ul_button button_position abscissa ordinate</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;is_over_ul_button&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:int&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;button.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dx&nbsp;=&nbsp;x&nbsp;-&nbsp;xx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;table&nbsp;=&nbsp;[|&nbsp;x&nbsp;&gt;=&nbsp;xx&nbsp;;&nbsp;x&nbsp;&lt;=&nbsp;button.(2)&nbsp;;&nbsp;y&nbsp;&lt;=&nbsp;button.(1)&nbsp;;&nbsp;y&nbsp;&gt;=&nbsp;button.(3)&nbsp;+&nbsp;dx&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;)&nbsp;<span class="keyword">true</span>&nbsp;table&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>ur_switch upper_right_corner_abscissa upper_right_corner_ordinate button_color text_color text</pre> The function returns
the position of the circonscript rectangle of the triangle.
<p>

La fonction retourne la position du rectangle circonscrit au triangle. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;ur_switch&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(text:string&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;j&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;+&nbsp;(&nbsp;n&nbsp;-&nbsp;j&nbsp;)&nbsp;*&nbsp;h&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;width_measures&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;f&nbsp;widths&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;width_measures&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;size&nbsp;=&nbsp;5&nbsp;+&nbsp;(&nbsp;(&nbsp;13&nbsp;*&nbsp;wh&nbsp;)&nbsp;/&nbsp;20&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;bw&nbsp;=&nbsp;2&nbsp;*&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;ref&nbsp;(&nbsp;1&nbsp;+&nbsp;size&nbsp;/&nbsp;5&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;x&nbsp;-&nbsp;bw<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;y&nbsp;-&nbsp;bw&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sequence&nbsp;=&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;xx&nbsp;,&nbsp;y&nbsp;)&nbsp;;&nbsp;(&nbsp;x&nbsp;,&nbsp;yy&nbsp;)&nbsp;|]&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.foreground&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_poly&nbsp;sequence&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;left&nbsp;=&nbsp;x&nbsp;-&nbsp;(&nbsp;27&nbsp;*&nbsp;size&nbsp;)&nbsp;/&nbsp;20&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;left&nbsp;(&nbsp;y&nbsp;-&nbsp;!shift&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift&nbsp;:=&nbsp;!shift&nbsp;+&nbsp;heights.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;xx&nbsp;;&nbsp;yy&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>is_over_ur_button button_position abscissa ordinate</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;is_over_ur_button&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:int&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;button.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;button.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dx&nbsp;=&nbsp;x&nbsp;-&nbsp;xx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;table&nbsp;=&nbsp;[|&nbsp;x&nbsp;&lt;=&nbsp;button.(0)&nbsp;;&nbsp;x&nbsp;&gt;=&nbsp;xx&nbsp;;&nbsp;y&nbsp;&lt;=&nbsp;yy&nbsp;;&nbsp;y&nbsp;&gt;=&nbsp;yy&nbsp;-&nbsp;dx&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;)&nbsp;<span class="keyword">true</span>&nbsp;table&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Slecteurs"><h1>Sélecteurs</h1></span>
<span id="1_Selectors"><h1>Selectors</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>polygon_selector center_abscissa center_ordinate small_radius button_color color text_color selection_color text selection</pre> The function returns 
the coordinates of the center, the radius of the button, the big radius, the size of the choice, the selection.
<p>

La fonction retourne les coordonnées du centre, le rayon du bouton, le grand rayon, la taille du choix, la sélection. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;polygon_selector&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(small_radius:int)&nbsp;(max_radius:int)&nbsp;(button_color:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(selection_color:int)&nbsp;(text:string&nbsp;array)&nbsp;(selection:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;center&nbsp;=&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;succ&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n_n&nbsp;=&nbsp;n&nbsp;+&nbsp;nn&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;(&nbsp;(&nbsp;max&nbsp;w&nbsp;h&nbsp;)&nbsp;*&nbsp;(&nbsp;30&nbsp;+&nbsp;5&nbsp;*&nbsp;n&nbsp;)&nbsp;)&nbsp;/&nbsp;(&nbsp;30&nbsp;+&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;radius&nbsp;=&nbsp;min&nbsp;(&nbsp;small_radius&nbsp;+&nbsp;wh&nbsp;)&nbsp;max_radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;ring_split&nbsp;nn&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;p&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;button_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;i&nbsp;=&nbsp;selection&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;selection_color<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;position&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;2&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;follower&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;place&nbsp;=&nbsp;triangle_barycentre&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;99&nbsp;*&nbsp;n&nbsp;+&nbsp;wh&nbsp;)&nbsp;)&nbsp;**&nbsp;(-0.25)&nbsp;)&nbsp;center&nbsp;position&nbsp;follower&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;place.(0)&nbsp;-&nbsp;(&nbsp;2&nbsp;*&nbsp;widths.(i)&nbsp;/&nbsp;5&nbsp;)&nbsp;)&nbsp;(&nbsp;place.(1)&nbsp;-&nbsp;(&nbsp;3&nbsp;*&nbsp;heights.(i)&nbsp;)&nbsp;/&nbsp;5&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;small_radius&nbsp;;&nbsp;radius&nbsp;;&nbsp;n&nbsp;;&nbsp;selection&nbsp;|]&nbsp;;;&nbsp;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>cursor_polygon_selector center_abscissa center_ordinate small_radius button_color color text_color selection_color text selection</pre> The function returns 
the coordinates of the center, the radius of the button, the big radius, the size of the choice, the selection.
<p>

La fonction retourne les coordonnées du centre, le rayon du bouton, le grand rayon, la taille du choix, la sélection. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cursor_polygon_selector&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(small_radius:int)&nbsp;(max_radius:int)&nbsp;(button_color:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(selection_color:int)&nbsp;(cursor_color:int)&nbsp;(text:string&nbsp;array)&nbsp;(selection:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;center&nbsp;=&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;succ&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n_n&nbsp;=&nbsp;n&nbsp;+&nbsp;nn&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;(&nbsp;(&nbsp;max&nbsp;w&nbsp;h&nbsp;)&nbsp;*&nbsp;(&nbsp;30&nbsp;+&nbsp;5&nbsp;*&nbsp;n&nbsp;)&nbsp;)&nbsp;/&nbsp;(&nbsp;30&nbsp;+&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;radius&nbsp;=&nbsp;min&nbsp;(&nbsp;small_radius&nbsp;+&nbsp;wh&nbsp;)&nbsp;max_radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;ring_split&nbsp;nn&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;p&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;button_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;position&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;2&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;follower&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;i&nbsp;=&nbsp;selection&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;cursor_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;[|&nbsp;center&nbsp;;&nbsp;p.(&nbsp;n&nbsp;-&nbsp;i&nbsp;)&nbsp;;&nbsp;p.(&nbsp;n&nbsp;-&nbsp;i&nbsp;-&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;n&nbsp;)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;selection_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;fst&nbsp;position,&nbsp;snd&nbsp;position&nbsp;)&nbsp;;&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;fst&nbsp;follower,&nbsp;snd&nbsp;follower&nbsp;)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;place&nbsp;=&nbsp;triangle_barycentre&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;99&nbsp;*&nbsp;n&nbsp;+&nbsp;wh&nbsp;)&nbsp;)&nbsp;**&nbsp;(-0.25)&nbsp;)&nbsp;center&nbsp;position&nbsp;follower&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;place.(0)&nbsp;-&nbsp;(&nbsp;2&nbsp;*&nbsp;widths.(i)&nbsp;/&nbsp;5&nbsp;)&nbsp;)&nbsp;(&nbsp;place.(1)&nbsp;-&nbsp;(&nbsp;3&nbsp;*&nbsp;heights.(i)&nbsp;)&nbsp;/&nbsp;5&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;small_radius&nbsp;;&nbsp;radius&nbsp;;&nbsp;n&nbsp;;&nbsp;selection&nbsp;|]&nbsp;;;&nbsp;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>round_selector center_abscissa center_ordinate small_radius button_color color text_color selection_color text selection</pre> The function returns 
the coordinates of the center, the radius of the button, the big radius, the size of the choice, the selection.
<p>

La fonction retourne les coordonnées du centre, le rayon du bouton, le grand rayon, la taille du choix, la sélection. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;round_selector&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(small_radius:int)&nbsp;(max_radius:int)&nbsp;(button_color:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(selection_color:int)&nbsp;(text:string&nbsp;array)&nbsp;(selection:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;center&nbsp;=&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;succ&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n_n&nbsp;=&nbsp;n&nbsp;+&nbsp;nn&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;(&nbsp;(&nbsp;max&nbsp;w&nbsp;h&nbsp;)&nbsp;*&nbsp;(&nbsp;30&nbsp;+&nbsp;5&nbsp;*&nbsp;n&nbsp;)&nbsp;)&nbsp;/&nbsp;(&nbsp;30&nbsp;+&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;radius&nbsp;=&nbsp;min&nbsp;(&nbsp;small_radius&nbsp;+&nbsp;wh&nbsp;)&nbsp;max_radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;ring_split&nbsp;nn&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;button_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;i&nbsp;=&nbsp;selection&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;selection_color<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;position&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;2&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;follower&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;place&nbsp;=&nbsp;triangle_barycentre&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;99&nbsp;*&nbsp;n&nbsp;+&nbsp;wh&nbsp;)&nbsp;)&nbsp;**&nbsp;(-0.25)&nbsp;)&nbsp;center&nbsp;position&nbsp;follower&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;place.(0)&nbsp;-&nbsp;(&nbsp;2&nbsp;*&nbsp;widths.(i)&nbsp;/&nbsp;5&nbsp;)&nbsp;)&nbsp;(&nbsp;place.(1)&nbsp;-&nbsp;(&nbsp;3&nbsp;*&nbsp;heights.(i)&nbsp;)&nbsp;/&nbsp;5&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;small_radius&nbsp;;&nbsp;radius&nbsp;;&nbsp;n&nbsp;;&nbsp;selection&nbsp;|]&nbsp;;;&nbsp;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>cursor_round_selector center_abscissa center_ordinate small_radius button_color color text_color selection_color text selection</pre> The function returns 
the coordinates of the center, the radius of the button, the big radius, the size of the choice, the selection.
<p>

La fonction retourne les coordonnées du centre, le rayon du bouton, le grand rayon, la taille du choix, la sélection. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cursor_round_selector&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(small_radius:int)&nbsp;(max_radius:int)&nbsp;(button_color:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(selection_color:int)&nbsp;(cursor_color:int)&nbsp;(text:string&nbsp;array)&nbsp;(selection:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text<br>
&nbsp;<span class="keyword">and</span>&nbsp;center&nbsp;=&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;succ&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n_n&nbsp;=&nbsp;n&nbsp;+&nbsp;nn&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;(&nbsp;(&nbsp;max&nbsp;w&nbsp;h&nbsp;)&nbsp;*&nbsp;(&nbsp;30&nbsp;+&nbsp;5&nbsp;*&nbsp;n&nbsp;)&nbsp;)&nbsp;/&nbsp;(&nbsp;30&nbsp;+&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;radius&nbsp;=&nbsp;min&nbsp;(&nbsp;small_radius&nbsp;+&nbsp;wh&nbsp;)&nbsp;max_radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;ring_split&nbsp;nn&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;button_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;position&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;2&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;follower&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;i&nbsp;=&nbsp;selection&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;cursor_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;[|&nbsp;center&nbsp;;&nbsp;p.(&nbsp;n&nbsp;-&nbsp;i&nbsp;)&nbsp;;&nbsp;p.(&nbsp;n&nbsp;-&nbsp;i&nbsp;-&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;n&nbsp;)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;selection_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;fst&nbsp;position,&nbsp;snd&nbsp;position&nbsp;)&nbsp;;&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;fst&nbsp;follower,&nbsp;snd&nbsp;follower&nbsp;)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;place&nbsp;=&nbsp;triangle_barycentre&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;99&nbsp;*&nbsp;n&nbsp;+&nbsp;wh&nbsp;)&nbsp;)&nbsp;**&nbsp;(-0.25)&nbsp;)&nbsp;center&nbsp;position&nbsp;follower&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;place.(0)&nbsp;-&nbsp;(&nbsp;2&nbsp;*&nbsp;widths.(i)&nbsp;/&nbsp;5&nbsp;)&nbsp;)&nbsp;(&nbsp;place.(1)&nbsp;-&nbsp;(&nbsp;3&nbsp;*&nbsp;heights.(i)&nbsp;)&nbsp;/&nbsp;5&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;small_radius&nbsp;;&nbsp;radius&nbsp;;&nbsp;n&nbsp;;&nbsp;selection&nbsp;|]&nbsp;;;&nbsp;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>over_selector button_position x y</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;over_selector&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:int&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;dx&nbsp;=&nbsp;x&nbsp;-&nbsp;button.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;dy&nbsp;=&nbsp;y&nbsp;-&nbsp;button.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;small_radius&nbsp;=&nbsp;button.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;radius&nbsp;=&nbsp;button.(3)<br>
&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;button.(4)<br>
&nbsp;<span class="keyword">and</span>&nbsp;selection&nbsp;=&nbsp;button.(5)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ddx&nbsp;=&nbsp;float&nbsp;dx<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ddy&nbsp;=&nbsp;float&nbsp;dy<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;pred&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;distance&nbsp;=&nbsp;dx&nbsp;*&nbsp;dx&nbsp;+&nbsp;dy&nbsp;*&nbsp;dy&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;distance&nbsp;&lt;=&nbsp;small_radius&nbsp;*&nbsp;small_radius&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;dx&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min&nbsp;(&nbsp;succ&nbsp;selection&nbsp;)&nbsp;nn<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;0&nbsp;(&nbsp;pred&nbsp;selection&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;distance&nbsp;&lt;=&nbsp;radius&nbsp;*&nbsp;radius&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;angle&nbsp;=&nbsp;positive_argument&nbsp;(&nbsp;-.&nbsp;ddy&nbsp;)&nbsp;(&nbsp;-.&nbsp;ddx&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;sector&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.pi&nbsp;/.&nbsp;(&nbsp;1.&nbsp;+.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;position&nbsp;=&nbsp;floor&nbsp;(&nbsp;angle&nbsp;/.&nbsp;sector&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min&nbsp;nn&nbsp;(&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;position&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;/&nbsp;2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;selection&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>polygon_folded_selector center_abscissa center_ordinate small_radius button_color color text_color selection_color text selection</pre> The function returns 
the coordinates of the center, the radius of the button, the big radius, the size of the choice, the selection.
<p>

La fonction retourne les coordonnées du centre, le rayon du bouton, le grand rayon, la taille du choix, la sélection. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;polygon_folded_selector&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(small_radius:int)&nbsp;(max_radius:int)&nbsp;(button_color:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(selection_color:int)&nbsp;(cursor_color:int)&nbsp;(text:string&nbsp;array)&nbsp;(max_number:int)&nbsp;(selection:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;tt&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text&nbsp;<br>
&nbsp;<span class="keyword">and</span>&nbsp;center&nbsp;=&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;select&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;selection&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;pred&nbsp;(&nbsp;-&nbsp;selection&nbsp;)&nbsp;)&nbsp;<span class="keyword">else</span>&nbsp;(&nbsp;<span class="keyword">if</span>&nbsp;selection&nbsp;&gt;=&nbsp;tt&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;selection&nbsp;-&nbsp;tt&nbsp;)&nbsp;<span class="keyword">else</span>&nbsp;selection&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;beginning&nbsp;=&nbsp;max_number&nbsp;*&nbsp;(&nbsp;select&nbsp;/&nbsp;max_number&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;min&nbsp;max_number&nbsp;(&nbsp;tt&nbsp;-&nbsp;beginning&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;succ&nbsp;n<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n_n&nbsp;=&nbsp;n&nbsp;+&nbsp;nn<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;wh&nbsp;=&nbsp;(&nbsp;(&nbsp;max&nbsp;w&nbsp;h&nbsp;)&nbsp;*&nbsp;(&nbsp;30&nbsp;+&nbsp;5&nbsp;*&nbsp;n&nbsp;)&nbsp;)&nbsp;/&nbsp;(&nbsp;30&nbsp;+&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;radius&nbsp;=&nbsp;min&nbsp;(&nbsp;small_radius&nbsp;+&nbsp;wh&nbsp;)&nbsp;max_radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;ring_split&nbsp;nn&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;p&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;button_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;i&nbsp;=&nbsp;select&nbsp;<span class="keyword">mod</span>&nbsp;max_number&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;selection_color<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;position&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;2&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;follower&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;place&nbsp;=&nbsp;triangle_barycentre&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;99&nbsp;*&nbsp;n&nbsp;+&nbsp;wh&nbsp;)&nbsp;)&nbsp;**&nbsp;(-0.25)&nbsp;)&nbsp;center&nbsp;position&nbsp;follower&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;place.(0)&nbsp;-&nbsp;(&nbsp;2&nbsp;*&nbsp;widths.(i)&nbsp;/&nbsp;5&nbsp;)&nbsp;)&nbsp;(&nbsp;place.(1)&nbsp;-&nbsp;(&nbsp;3&nbsp;*&nbsp;heights.(i)&nbsp;)&nbsp;/&nbsp;5&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(&nbsp;i&nbsp;+&nbsp;beginning&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;small_radius&nbsp;;&nbsp;radius&nbsp;;&nbsp;n&nbsp;;&nbsp;select&nbsp;;&nbsp;tt&nbsp;;&nbsp;max_number&nbsp;;&nbsp;beginning&nbsp;|]&nbsp;;;&nbsp;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>cursor_polygon_folded_selector center_abscissa center_ordinate small_radius button_color color text_color selection_color text selection</pre> The function returns 
the coordinates of the center, the radius of the button, the big radius, the size of the choice, the selection.
<p>

La fonction retourne les coordonnées du centre, le rayon du bouton, le grand rayon, la taille du choix, la sélection. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cursor_polygon_folded_selector&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(small_radius:int)&nbsp;(max_radius:int)&nbsp;(button_color:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(selection_color:int)&nbsp;(cursor_color:int)&nbsp;(text:string&nbsp;array)&nbsp;(max_number:int)&nbsp;(selection:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;tt&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text&nbsp;<br>
&nbsp;<span class="keyword">and</span>&nbsp;center&nbsp;=&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;select&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;selection&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;pred&nbsp;(&nbsp;-&nbsp;selection&nbsp;)&nbsp;)&nbsp;<span class="keyword">else</span>&nbsp;(&nbsp;<span class="keyword">if</span>&nbsp;selection&nbsp;&gt;=&nbsp;tt&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;selection&nbsp;-&nbsp;tt&nbsp;)&nbsp;<span class="keyword">else</span>&nbsp;selection&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;beginning&nbsp;=&nbsp;max_number&nbsp;*&nbsp;(&nbsp;select&nbsp;/&nbsp;max_number&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;min&nbsp;max_number&nbsp;(&nbsp;tt&nbsp;-&nbsp;beginning&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;succ&nbsp;n<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n_n&nbsp;=&nbsp;n&nbsp;+&nbsp;nn<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;wh&nbsp;=&nbsp;(&nbsp;(&nbsp;max&nbsp;w&nbsp;h&nbsp;)&nbsp;*&nbsp;(&nbsp;30&nbsp;+&nbsp;5&nbsp;*&nbsp;n&nbsp;)&nbsp;)&nbsp;/&nbsp;(&nbsp;30&nbsp;+&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;radius&nbsp;=&nbsp;min&nbsp;(&nbsp;small_radius&nbsp;+&nbsp;wh&nbsp;)&nbsp;max_radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;ring_split&nbsp;nn&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;p&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;button_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;position&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;2&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;follower&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;i&nbsp;=&nbsp;select&nbsp;<span class="keyword">mod</span>&nbsp;max_number&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;cursor_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;[|&nbsp;center&nbsp;;&nbsp;p.(&nbsp;n&nbsp;-&nbsp;i&nbsp;)&nbsp;;&nbsp;p.(&nbsp;n&nbsp;-&nbsp;i&nbsp;-&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;n&nbsp;)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;selection_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;fst&nbsp;position,&nbsp;snd&nbsp;position&nbsp;)&nbsp;;&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;fst&nbsp;follower,&nbsp;snd&nbsp;follower&nbsp;)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;place&nbsp;=&nbsp;triangle_barycentre&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;99&nbsp;*&nbsp;n&nbsp;+&nbsp;wh&nbsp;)&nbsp;)&nbsp;**&nbsp;(-0.25)&nbsp;)&nbsp;center&nbsp;position&nbsp;follower&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;place.(0)&nbsp;-&nbsp;(&nbsp;2&nbsp;*&nbsp;widths.(i)&nbsp;/&nbsp;5&nbsp;)&nbsp;)&nbsp;(&nbsp;place.(1)&nbsp;-&nbsp;(&nbsp;3&nbsp;*&nbsp;heights.(i)&nbsp;)&nbsp;/&nbsp;5&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(&nbsp;i&nbsp;+&nbsp;beginning&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;small_radius&nbsp;;&nbsp;radius&nbsp;;&nbsp;n&nbsp;;&nbsp;select&nbsp;;&nbsp;tt&nbsp;;&nbsp;max_number&nbsp;;&nbsp;beginning&nbsp;|]&nbsp;;;&nbsp;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>round_folded_selector center_abscissa center_ordinate small_radius button_color color text_color selection_color text selection</pre> The function returns 
the coordinates of the center, the radius of the button, the big radius, the size of the choice, the selection.
<p>

La fonction retourne les coordonnées du centre, le rayon du bouton, le grand rayon, la taille du choix, la sélection. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;round_folded_selector&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(small_radius:int)&nbsp;(max_radius:int)&nbsp;(button_color:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(selection_color:int)&nbsp;(cursor_color:int)&nbsp;(text:string&nbsp;array)&nbsp;(max_number:int)&nbsp;(selection:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;tt&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text&nbsp;<br>
&nbsp;<span class="keyword">and</span>&nbsp;center&nbsp;=&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;select&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;selection&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;pred&nbsp;(&nbsp;-&nbsp;selection&nbsp;)&nbsp;)&nbsp;<span class="keyword">else</span>&nbsp;(&nbsp;<span class="keyword">if</span>&nbsp;selection&nbsp;&gt;=&nbsp;tt&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;selection&nbsp;-&nbsp;tt&nbsp;)&nbsp;<span class="keyword">else</span>&nbsp;selection&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;beginning&nbsp;=&nbsp;max_number&nbsp;*&nbsp;(&nbsp;select&nbsp;/&nbsp;max_number&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;min&nbsp;max_number&nbsp;(&nbsp;tt&nbsp;-&nbsp;beginning&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;succ&nbsp;n<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n_n&nbsp;=&nbsp;n&nbsp;+&nbsp;nn<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;wh&nbsp;=&nbsp;(&nbsp;(&nbsp;max&nbsp;w&nbsp;h&nbsp;)&nbsp;*&nbsp;(&nbsp;30&nbsp;+&nbsp;5&nbsp;*&nbsp;n&nbsp;)&nbsp;)&nbsp;/&nbsp;(&nbsp;30&nbsp;+&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;radius&nbsp;=&nbsp;min&nbsp;(&nbsp;small_radius&nbsp;+&nbsp;wh&nbsp;)&nbsp;max_radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;ring_split&nbsp;nn&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;button_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;i&nbsp;=&nbsp;select&nbsp;<span class="keyword">mod</span>&nbsp;max_number&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;selection_color<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;position&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;2&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;follower&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;place&nbsp;=&nbsp;triangle_barycentre&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;99&nbsp;*&nbsp;n&nbsp;+&nbsp;wh&nbsp;)&nbsp;)&nbsp;**&nbsp;(-0.25)&nbsp;)&nbsp;center&nbsp;position&nbsp;follower&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;place.(0)&nbsp;-&nbsp;(&nbsp;2&nbsp;*&nbsp;widths.(i)&nbsp;/&nbsp;5&nbsp;)&nbsp;)&nbsp;(&nbsp;place.(1)&nbsp;-&nbsp;(&nbsp;3&nbsp;*&nbsp;heights.(i)&nbsp;)&nbsp;/&nbsp;5&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(&nbsp;i&nbsp;+&nbsp;beginning&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;small_radius&nbsp;;&nbsp;radius&nbsp;;&nbsp;n&nbsp;;&nbsp;select&nbsp;;&nbsp;tt&nbsp;;&nbsp;max_number&nbsp;;&nbsp;beginning&nbsp;|]&nbsp;;;&nbsp;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>cursor_round_folded_selector center_abscissa center_ordinate small_radius button_color color text_color selection_color text selection</pre> The function returns 
the coordinates of the center, the radius of the button, the big radius, the size of the choice, the selection.
<p>

La fonction retourne les coordonnées du centre, le rayon du bouton, le grand rayon, la taille du choix, la sélection. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cursor_round_folded_selector&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(small_radius:int)&nbsp;(max_radius:int)&nbsp;(button_color:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(selection_color:int)&nbsp;(cursor_color:int)&nbsp;(text:string&nbsp;array)&nbsp;(max_number:int)&nbsp;(selection:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;tt&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;text&nbsp;<br>
&nbsp;<span class="keyword">and</span>&nbsp;center&nbsp;=&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;select&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;selection&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;pred&nbsp;(&nbsp;-&nbsp;selection&nbsp;)&nbsp;)&nbsp;<span class="keyword">else</span>&nbsp;(&nbsp;<span class="keyword">if</span>&nbsp;selection&nbsp;&gt;=&nbsp;tt&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;selection&nbsp;-&nbsp;tt&nbsp;)&nbsp;<span class="keyword">else</span>&nbsp;selection&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;beginning&nbsp;=&nbsp;max_number&nbsp;*&nbsp;(&nbsp;select&nbsp;/&nbsp;max_number&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;min&nbsp;max_number&nbsp;(&nbsp;tt&nbsp;-&nbsp;beginning&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;succ&nbsp;n<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n_n&nbsp;=&nbsp;n&nbsp;+&nbsp;nn<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;wh&nbsp;=&nbsp;(&nbsp;(&nbsp;max&nbsp;w&nbsp;h&nbsp;)&nbsp;*&nbsp;(&nbsp;30&nbsp;+&nbsp;5&nbsp;*&nbsp;n&nbsp;)&nbsp;)&nbsp;/&nbsp;(&nbsp;30&nbsp;+&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;radius&nbsp;=&nbsp;min&nbsp;(&nbsp;small_radius&nbsp;+&nbsp;wh&nbsp;)&nbsp;max_radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;ring_split&nbsp;nn&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;radius&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;button_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;position&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;2&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;follower&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;n_n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;i&nbsp;=&nbsp;select&nbsp;<span class="keyword">mod</span>&nbsp;max_number&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;cursor_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_poly&nbsp;[|&nbsp;center&nbsp;;&nbsp;p.(&nbsp;n&nbsp;-&nbsp;i&nbsp;)&nbsp;;&nbsp;p.(&nbsp;n&nbsp;-&nbsp;i&nbsp;-&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;n&nbsp;)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;selection_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;fst&nbsp;position,&nbsp;snd&nbsp;position&nbsp;)&nbsp;;&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;fst&nbsp;follower,&nbsp;snd&nbsp;follower&nbsp;)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;place&nbsp;=&nbsp;triangle_barycentre&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;99&nbsp;*&nbsp;n&nbsp;+&nbsp;wh&nbsp;)&nbsp;)&nbsp;**&nbsp;(-0.25)&nbsp;)&nbsp;center&nbsp;position&nbsp;follower&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;place.(0)&nbsp;-&nbsp;(&nbsp;2&nbsp;*&nbsp;widths.(i)&nbsp;/&nbsp;5&nbsp;)&nbsp;)&nbsp;(&nbsp;place.(1)&nbsp;-&nbsp;(&nbsp;3&nbsp;*&nbsp;heights.(i)&nbsp;)&nbsp;/&nbsp;5&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(&nbsp;i&nbsp;+&nbsp;beginning&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;small_radius&nbsp;;&nbsp;radius&nbsp;;&nbsp;n&nbsp;;&nbsp;select&nbsp;;&nbsp;tt&nbsp;;&nbsp;max_number&nbsp;;&nbsp;beginning&nbsp;|]&nbsp;;;&nbsp;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>over_folded_selector button_position x y</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;over_folded_selector&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:int&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;dx&nbsp;=&nbsp;x&nbsp;-&nbsp;button.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;dy&nbsp;=&nbsp;y&nbsp;-&nbsp;button.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;small_radius&nbsp;=&nbsp;button.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;radius&nbsp;=&nbsp;button.(3)<br>
&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;button.(4)<br>
&nbsp;<span class="keyword">and</span>&nbsp;selection&nbsp;=&nbsp;button.(5)<br>
&nbsp;<span class="keyword">and</span>&nbsp;tt&nbsp;=&nbsp;button.(6)<br>
&nbsp;<span class="keyword">and</span>&nbsp;max_number&nbsp;=&nbsp;button.(7)<br>
&nbsp;<span class="keyword">and</span>&nbsp;beginning&nbsp;=&nbsp;button.(8)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ddx&nbsp;=&nbsp;float&nbsp;dx<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ddy&nbsp;=&nbsp;float&nbsp;dy<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;pred&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;distance&nbsp;=&nbsp;dx&nbsp;*&nbsp;dx&nbsp;+&nbsp;dy&nbsp;*&nbsp;dy&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;distance&nbsp;&lt;=&nbsp;small_radius&nbsp;*&nbsp;small_radius&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;dx&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min&nbsp;(&nbsp;selection&nbsp;+&nbsp;max_number&nbsp;+&nbsp;tt&nbsp;)&nbsp;(&nbsp;2&nbsp;*&nbsp;tt&nbsp;-&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;-&nbsp;(&nbsp;max&nbsp;1&nbsp;(&nbsp;selection&nbsp;-&nbsp;max_number&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;distance&nbsp;&lt;=&nbsp;radius&nbsp;*&nbsp;radius&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;angle&nbsp;=&nbsp;positive_argument&nbsp;(&nbsp;-.&nbsp;ddy&nbsp;)&nbsp;(&nbsp;-.&nbsp;ddx&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;sector&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.pi&nbsp;/.&nbsp;(&nbsp;1.&nbsp;+.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;position&nbsp;=&nbsp;floor&nbsp;(&nbsp;angle&nbsp;/.&nbsp;sector&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beginning&nbsp;+&nbsp;(&nbsp;min&nbsp;nn&nbsp;(&nbsp;(&nbsp;(&nbsp;int_of_float&nbsp;position&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;/&nbsp;2&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;selection&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Verniers"><h1>Verniers</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_vernier center_abscissa center_ordinate small_radius button_color color text_color selection_color cursor_color steps range selection</pre> The function returns 
the coordinates of the center, the radius of the button, the big radius, the number of steps, the range, the selection.
<p>

La fonction retourne les coordonnées du centre, le rayon du bouton, le grand rayon, le nombre de pas, l'ambitus, la sélection. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_vernier&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(small_radius:int)&nbsp;(button_color:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(selection_color:int)&nbsp;(cursor_color:int)&nbsp;(n:int)&nbsp;(range:float&nbsp;array)&nbsp;(selection:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;beginning&nbsp;=&nbsp;range.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ending&nbsp;=&nbsp;range.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;succ&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;n_n&nbsp;=&nbsp;2&nbsp;*&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;marks&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_closed_equal_subdivision&nbsp;beginning&nbsp;nn&nbsp;ending<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;sector&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.doublepi&nbsp;/.&nbsp;(&nbsp;1.&nbsp;+.&nbsp;(&nbsp;float&nbsp;nn&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;angle&nbsp;=&nbsp;sector&nbsp;*.&nbsp;(&nbsp;0.5&nbsp;+.&nbsp;(&nbsp;float&nbsp;nn&nbsp;)&nbsp;*.&nbsp;(&nbsp;min&nbsp;1.&nbsp;(&nbsp;(&nbsp;max&nbsp;0.&nbsp;(&nbsp;selection&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;)&nbsp;/.&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;text&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;string_of_float&nbsp;marks<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nnn&nbsp;=&nbsp;n_n&nbsp;-&nbsp;2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;(&nbsp;(&nbsp;max&nbsp;w&nbsp;h&nbsp;)&nbsp;*&nbsp;707&nbsp;)&nbsp;/&nbsp;500&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;radius&nbsp;=&nbsp;small_radius&nbsp;+&nbsp;wh&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;float&nbsp;radius<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;p&nbsp;=&nbsp;ring_split&nbsp;nn&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;radius<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;pp&nbsp;=&nbsp;ring_split&nbsp;nn&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;(&nbsp;radius&nbsp;/&nbsp;2&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;position&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;nnn&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;point&nbsp;=&nbsp;pp.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;nnn&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;selection_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;fst&nbsp;point,&nbsp;snd&nbsp;point&nbsp;)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;place&nbsp;=&nbsp;[|&nbsp;(&nbsp;(&nbsp;fst&nbsp;point&nbsp;)&nbsp;+&nbsp;(&nbsp;fst&nbsp;position&nbsp;)&nbsp;)&nbsp;/&nbsp;2&nbsp;-&nbsp;widths.(i)&nbsp;/&nbsp;3&nbsp;;&nbsp;(&nbsp;(&nbsp;snd&nbsp;point&nbsp;)&nbsp;+&nbsp;(&nbsp;snd&nbsp;position&nbsp;)&nbsp;-&nbsp;heights.(i)&nbsp;)&nbsp;/&nbsp;2&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;place.(0)&nbsp;place.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;x&nbsp;-&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;r&nbsp;*.&nbsp;(&nbsp;sin&nbsp;angle&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;y&nbsp;-&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;r&nbsp;*.&nbsp;(&nbsp;cos&nbsp;angle&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;cursor_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;button_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;float&nbsp;x&nbsp;;&nbsp;float&nbsp;y&nbsp;;&nbsp;float&nbsp;small_radius&nbsp;;&nbsp;float&nbsp;radius&nbsp;;&nbsp;float&nbsp;n&nbsp;;&nbsp;beginning&nbsp;;&nbsp;ending&nbsp;;&nbsp;selection&nbsp;|]&nbsp;;;&nbsp;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>over_float_vernier button_position x y</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;over_float_vernier&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:float&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;float&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;float&nbsp;y<br>
&nbsp;<span class="keyword">and</span>&nbsp;small_radius&nbsp;=&nbsp;button.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;radius&nbsp;=&nbsp;button.(3)<br>
&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;button.(4)<br>
&nbsp;<span class="keyword">and</span>&nbsp;beginning&nbsp;=&nbsp;button.(5)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ending&nbsp;=&nbsp;button.(6)<br>
&nbsp;<span class="keyword">and</span>&nbsp;selection&nbsp;=&nbsp;button.(7)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dx&nbsp;=&nbsp;xx&nbsp;-.&nbsp;button.(0)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dy&nbsp;=&nbsp;yy&nbsp;-.&nbsp;button.(1)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;sector&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.doublepi&nbsp;/.&nbsp;(&nbsp;n&nbsp;+.&nbsp;2.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;half_sector&nbsp;=&nbsp;0.5&nbsp;*.&nbsp;sector<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;course&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.doublepi&nbsp;-.&nbsp;sector<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;distance&nbsp;=&nbsp;dx&nbsp;*.&nbsp;dx&nbsp;+.&nbsp;dy&nbsp;*.&nbsp;dy&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;distance&nbsp;&gt;=&nbsp;small_radius&nbsp;*.&nbsp;small_radius&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;distance&nbsp;&lt;=&nbsp;radius&nbsp;*.&nbsp;radius&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;angle&nbsp;=&nbsp;positive_argument&nbsp;(&nbsp;-.&nbsp;dy&nbsp;)&nbsp;(&nbsp;-.&nbsp;dx&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;alpha&nbsp;=&nbsp;max&nbsp;0.&nbsp;(&nbsp;angle&nbsp;-.&nbsp;half_sector&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;beta&nbsp;=&nbsp;min&nbsp;alpha&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.doublepi&nbsp;-.&nbsp;sector&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beginning&nbsp;+.&nbsp;beta&nbsp;*.&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;course<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;selection&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_vernier center_abscissa center_ordinate small_radius button_color color text_color selection_color cursor_color steps range selection</pre> The function returns 
the coordinates of the center, the radius of the button, the big radius, the number of steps, the range, the selection.
<p>

La fonction retourne les coordonnées du centre, le rayon du bouton, le grand rayon, le nombre de pas, l'ambitus, la sélection. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_vernier&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;(small_radius:int)&nbsp;(button_color:int)&nbsp;(color:int)&nbsp;(text_color:int)&nbsp;(selection_color:int)&nbsp;(cursor_color:int)&nbsp;(n:int)&nbsp;(range:int&nbsp;array)&nbsp;(selection:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;beginning&nbsp;=&nbsp;range.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ending&nbsp;=&nbsp;range.(1)<br>
&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;succ&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;n_n&nbsp;=&nbsp;2&nbsp;*&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;marks&nbsp;=&nbsp;<span class="constructor">Matrix</span>.int_equal_range&nbsp;beginning&nbsp;(&nbsp;1&nbsp;+&nbsp;(&nbsp;ending&nbsp;-&nbsp;beginning&nbsp;)&nbsp;/&nbsp;n&nbsp;)&nbsp;nn<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;sector&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.doublepi&nbsp;/.&nbsp;(&nbsp;1.&nbsp;+.&nbsp;(&nbsp;float&nbsp;nn&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;angle&nbsp;=&nbsp;sector&nbsp;*.&nbsp;(&nbsp;0.5&nbsp;+.&nbsp;(&nbsp;float&nbsp;nn&nbsp;)&nbsp;*.&nbsp;(&nbsp;float&nbsp;(&nbsp;selection&nbsp;-&nbsp;beginning&nbsp;)&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;(&nbsp;ending&nbsp;-&nbsp;beginning&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;text&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;string_of_int&nbsp;marks<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nnn&nbsp;=&nbsp;n_n&nbsp;-&nbsp;2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ts&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;widths&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;ts<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;heights&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;ts&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;widths<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_int_max&nbsp;heights&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wh&nbsp;=&nbsp;(&nbsp;(&nbsp;max&nbsp;w&nbsp;h&nbsp;)&nbsp;*&nbsp;707&nbsp;)&nbsp;/&nbsp;500&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;radius&nbsp;=&nbsp;small_radius&nbsp;+&nbsp;wh&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;float&nbsp;radius<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;p&nbsp;=&nbsp;ring_split&nbsp;nn&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;radius<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;pp&nbsp;=&nbsp;ring_split&nbsp;nn&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;(&nbsp;radius&nbsp;/&nbsp;2&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;position&nbsp;=&nbsp;p.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;nnn&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;point&nbsp;=&nbsp;pp.(&nbsp;n&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">mod</span>&nbsp;nnn&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;selection_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;fst&nbsp;point,&nbsp;snd&nbsp;point&nbsp;)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;place&nbsp;=&nbsp;[|&nbsp;(&nbsp;(&nbsp;fst&nbsp;point&nbsp;)&nbsp;+&nbsp;(&nbsp;fst&nbsp;position&nbsp;)&nbsp;)&nbsp;/&nbsp;2&nbsp;-&nbsp;widths.(i)&nbsp;/&nbsp;3&nbsp;;&nbsp;(&nbsp;(&nbsp;snd&nbsp;point&nbsp;)&nbsp;+&nbsp;(&nbsp;snd&nbsp;position&nbsp;)&nbsp;-&nbsp;heights.(i)&nbsp;)&nbsp;/&nbsp;2&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;place.(0)&nbsp;place.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;text.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;x&nbsp;-&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;r&nbsp;*.&nbsp;(&nbsp;sin&nbsp;angle&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;y&nbsp;-&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;r&nbsp;*.&nbsp;(&nbsp;cos&nbsp;angle&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;cursor_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_segments&nbsp;[|&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;xx&nbsp;,&nbsp;yy&nbsp;)&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;button_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_circle&nbsp;x&nbsp;y&nbsp;small_radius&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;;&nbsp;small_radius&nbsp;;&nbsp;radius&nbsp;;&nbsp;n&nbsp;;&nbsp;beginning&nbsp;;&nbsp;ending&nbsp;;&nbsp;selection&nbsp;|]&nbsp;;;&nbsp;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>over_int_vernier button_position x y</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;over_int_vernier&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(button:int&nbsp;array)&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;small_radius&nbsp;=&nbsp;button.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;radius&nbsp;=&nbsp;button.(3)<br>
&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;button.(4)<br>
&nbsp;<span class="keyword">and</span>&nbsp;beginning&nbsp;=&nbsp;float&nbsp;button.(5)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ending&nbsp;=&nbsp;float&nbsp;button.(6)<br>
&nbsp;<span class="keyword">and</span>&nbsp;selection&nbsp;=&nbsp;button.(7)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dx&nbsp;=&nbsp;x&nbsp;-&nbsp;button.(0)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dy&nbsp;=&nbsp;y&nbsp;-&nbsp;button.(1)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;sector&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.doublepi&nbsp;/.&nbsp;(&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;+.&nbsp;2.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;half_sector&nbsp;=&nbsp;0.5&nbsp;*.&nbsp;sector<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;course&nbsp;=&nbsp;<span class="constructor">Infinitesimal</span>.doublepi&nbsp;-.&nbsp;sector<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;distance&nbsp;=&nbsp;dx&nbsp;*&nbsp;dx&nbsp;+&nbsp;dy&nbsp;*&nbsp;dy&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;distance&nbsp;&gt;=&nbsp;small_radius&nbsp;*&nbsp;small_radius&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;distance&nbsp;&lt;=&nbsp;radius&nbsp;*&nbsp;radius&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;angle&nbsp;=&nbsp;positive_argument&nbsp;(&nbsp;-.&nbsp;(&nbsp;float&nbsp;dy&nbsp;)&nbsp;)&nbsp;(&nbsp;-.&nbsp;(&nbsp;float&nbsp;dx&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;alpha&nbsp;=&nbsp;max&nbsp;0.&nbsp;(&nbsp;angle&nbsp;-.&nbsp;half_sector&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;beta&nbsp;=&nbsp;min&nbsp;alpha&nbsp;(&nbsp;<span class="constructor">Infinitesimal</span>.doublepi&nbsp;-.&nbsp;sector&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int_of_float&nbsp;(&nbsp;beginning&nbsp;+.&nbsp;beta&nbsp;*.&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;course&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;selection&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Modelagedechanesdecaractres"><h1>Modelage de chaînes de caractères</h1></span>
<span id="1_Characterstringedition"><h1>Character string edition</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>string_treatment left_string right_string escaped_character</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;string_treatment&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(l:string)&nbsp;(r:string)&nbsp;(c:string)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">String</span>.length&nbsp;c&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;l&nbsp;^&nbsp;c&nbsp;;&nbsp;r&nbsp;|]<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;c&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\000"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;<span class="constructor">String</span>.sub&nbsp;l&nbsp;0&nbsp;(&nbsp;max&nbsp;0&nbsp;(&nbsp;pred&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;l&nbsp;)&nbsp;)&nbsp;)&nbsp;;&nbsp;r&nbsp;|]&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-Space *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\001"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;<span class="string">""</span>&nbsp;;&nbsp;l&nbsp;^&nbsp;r&nbsp;|]&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-A *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\002"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-B *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pos&nbsp;=&nbsp;pred&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;l&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;pos&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;[|&nbsp;<span class="string">""</span>&nbsp;;&nbsp;l&nbsp;^&nbsp;r&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;[|&nbsp;<span class="constructor">String</span>.sub&nbsp;l&nbsp;0&nbsp;pos&nbsp;;&nbsp;(&nbsp;<span class="constructor">Char</span>.escaped&nbsp;l.[pos]&nbsp;)&nbsp;^&nbsp;r&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\005"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;l&nbsp;^&nbsp;r&nbsp;;&nbsp;<span class="string">""</span>&nbsp;|]&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-E *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\006"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-F *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;length&nbsp;=&nbsp;pred&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;r&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;length&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;[|&nbsp;l&nbsp;^&nbsp;r&nbsp;;&nbsp;<span class="string">""</span>&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;[|&nbsp;l&nbsp;^&nbsp;(&nbsp;<span class="constructor">Char</span>.escaped&nbsp;r.[0]&nbsp;)&nbsp;;&nbsp;<span class="constructor">String</span>.sub&nbsp;r&nbsp;1&nbsp;length&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\008"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;<span class="constructor">String</span>.sub&nbsp;l&nbsp;0&nbsp;(&nbsp;max&nbsp;0&nbsp;(&nbsp;pred&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;l&nbsp;)&nbsp;)&nbsp;)&nbsp;;&nbsp;r&nbsp;|]&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-H *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\011"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;l&nbsp;;&nbsp;<span class="string">""</span>&nbsp;|]&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-K *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\014"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-N *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;length&nbsp;=&nbsp;pred&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;r&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;length&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;[|&nbsp;l&nbsp;^&nbsp;r&nbsp;;&nbsp;<span class="string">""</span>&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;[|&nbsp;l&nbsp;^&nbsp;(&nbsp;<span class="constructor">Char</span>.escaped&nbsp;r.[0]&nbsp;)&nbsp;;&nbsp;<span class="constructor">String</span>.sub&nbsp;r&nbsp;1&nbsp;length&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\016"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-P *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pos&nbsp;=&nbsp;pred&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;l&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;pos&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;[|&nbsp;<span class="string">""</span>&nbsp;;&nbsp;l&nbsp;^&nbsp;r&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;[|&nbsp;<span class="constructor">String</span>.sub&nbsp;l&nbsp;0&nbsp;pos&nbsp;;&nbsp;(&nbsp;<span class="constructor">Char</span>.escaped&nbsp;l.[pos]&nbsp;)&nbsp;^&nbsp;r&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\018"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;<span class="constructor">String</span>.sub&nbsp;l&nbsp;0&nbsp;(&nbsp;max&nbsp;0&nbsp;(&nbsp;pred&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;l&nbsp;)&nbsp;)&nbsp;)&nbsp;;&nbsp;r&nbsp;|]&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-R *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\019"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;l&nbsp;;&nbsp;<span class="constructor">String</span>.sub&nbsp;r&nbsp;1&nbsp;(&nbsp;max&nbsp;0&nbsp;(&nbsp;pred&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;r&nbsp;)&nbsp;)&nbsp;)&nbsp;|]&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-S *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\021"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;<span class="string">""</span>&nbsp;;&nbsp;r&nbsp;|]&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-U *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\024"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;<span class="constructor">String</span>.sub&nbsp;l&nbsp;0&nbsp;(&nbsp;max&nbsp;0&nbsp;(&nbsp;pred&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;l&nbsp;)&nbsp;)&nbsp;)&nbsp;;&nbsp;r&nbsp;|]&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-X *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"\\026"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;l&nbsp;;&nbsp;<span class="constructor">String</span>.sub&nbsp;r&nbsp;1&nbsp;(&nbsp;max&nbsp;0&nbsp;(&nbsp;pred&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;r&nbsp;)&nbsp;)&nbsp;)&nbsp;|]&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** Ctl-Z *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;l&nbsp;;&nbsp;r&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>string_edit bottom_left_corner_abscissa bottom_left_corner_ordinate width background_color left_text_color right_text_color left_string right_string</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;string_edit&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(abscissa:int)&nbsp;(ordinate:int)&nbsp;(width:int)&nbsp;(color:int)&nbsp;(left_text_color:int)&nbsp;(right_text_color:int)&nbsp;(initial:string)&nbsp;(final:string)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;offset&nbsp;=&nbsp;<span class="constructor">String</span>.length&nbsp;initial<br>
&nbsp;<span class="keyword">and</span>&nbsp;setoff&nbsp;=&nbsp;<span class="constructor">String</span>.length&nbsp;final<br>
&nbsp;<span class="keyword">and</span>&nbsp;text&nbsp;=&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;initial&nbsp;^&nbsp;final&nbsp;^&nbsp;<span class="string">"&nbsp;"</span><br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;abscissa&nbsp;-&nbsp;width&nbsp;/&nbsp;2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;size&nbsp;=&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;text<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;length&nbsp;=&nbsp;2&nbsp;+&nbsp;offset&nbsp;+&nbsp;setoff&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;(&nbsp;length&nbsp;*&nbsp;width&nbsp;)&nbsp;/&nbsp;(&nbsp;fst&nbsp;size&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;snd&nbsp;size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;n&nbsp;/&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ordinate&nbsp;-&nbsp;h&nbsp;/&nbsp;2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;beginning&nbsp;=&nbsp;max&nbsp;0&nbsp;(&nbsp;offset&nbsp;-&nbsp;nn&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;left_length&nbsp;=&nbsp;offset&nbsp;-&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;left&nbsp;=&nbsp;<span class="constructor">String</span>.sub&nbsp;initial&nbsp;beginning&nbsp;left_length<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;right_length&nbsp;=&nbsp;min&nbsp;(&nbsp;n&nbsp;-&nbsp;left_length&nbsp;)&nbsp;setoff&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;right&nbsp;=&nbsp;<span class="constructor">String</span>.sub&nbsp;final&nbsp;0&nbsp;right_length&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_rect&nbsp;x&nbsp;y&nbsp;width&nbsp;h&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;x&nbsp;(&nbsp;y&nbsp;+&nbsp;h&nbsp;/&nbsp;10&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;left_text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;left&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;right_text_color&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;right&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;string_of_int&nbsp;abscissa&nbsp;;&nbsp;string_of_int&nbsp;ordinate&nbsp;;&nbsp;string_of_int&nbsp;width&nbsp;;&nbsp;string_of_int&nbsp;x&nbsp;;&nbsp;string_of_int&nbsp;y&nbsp;;&nbsp;initial&nbsp;;&nbsp;final&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>is_over_string_edit bottom_left_corner_abscissa bottom_left_corner_ordinate width abscissa ordinate</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;is_over_string_edit&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(zone:string&nbsp;array)&nbsp;(abscissa:int)&nbsp;(ordinate:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;int_of_string&nbsp;zone.(3)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;int_of_string&nbsp;zone.(4)<br>
&nbsp;<span class="keyword">and</span>&nbsp;width&nbsp;=&nbsp;int_of_string&nbsp;zone.(2)<br>
&nbsp;<span class="keyword">and</span>&nbsp;height&nbsp;=&nbsp;snd&nbsp;(&nbsp;<span class="constructor">Graphics</span>.text_size&nbsp;<span class="string">"W"</span>&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;[|&nbsp;abscissa&nbsp;&gt;=&nbsp;x&nbsp;;&nbsp;ordinate&nbsp;&gt;=&nbsp;y&nbsp;;&nbsp;abscissa&nbsp;&lt;=&nbsp;x&nbsp;+&nbsp;width&nbsp;;&nbsp;ordinate&nbsp;&lt;=&nbsp;y&nbsp;+&nbsp;height&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;)&nbsp;<span class="keyword">true</span>&nbsp;v&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Divers"><h1>Divers</h1></span>
<span id="1_Miscellaneous"><h1>Miscellaneous</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** sand_glass *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sand_glass&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(hori_size:int)&nbsp;(verti_size:int)&nbsp;&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Graphics</span>.open_graph&nbsp;&nbsp;(&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;string_of_int&nbsp;hori_size&nbsp;)&nbsp;^&nbsp;<span class="string">"x"</span>&nbsp;^&nbsp;(&nbsp;string_of_int&nbsp;verti_size&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;center&nbsp;=&nbsp;[|&nbsp;hori_size&nbsp;/&nbsp;2&nbsp;;&nbsp;verti_size&nbsp;/&nbsp;2&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;hat_switch&nbsp;center.(0)&nbsp;center.(1)&nbsp;<span class="constructor">Graphics</span>.white&nbsp;<span class="constructor">Graphics</span>.black&nbsp;[|&nbsp;<span class="string">"&nbsp;&nbsp;Wait&nbsp;&nbsp;"</span>&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;verti_shift&nbsp;=&nbsp;(&nbsp;t.(5)&nbsp;-&nbsp;t.(3)&nbsp;)&nbsp;*&nbsp;2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;ignore&nbsp;(&nbsp;cup_switch&nbsp;center.(0)&nbsp;(&nbsp;center.(1)&nbsp;+&nbsp;verti_shift&nbsp;)&nbsp;<span class="constructor">Graphics</span>.black&nbsp;<span class="constructor">Graphics</span>.white&nbsp;[|&nbsp;<span class="string">"Attendre"</span>&nbsp;|]&nbsp;)&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Interactions"><h1>Interactions</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The interaction loop comes from E. Chailloux, P. Manoury, B. Pagano : Developing Applications With Objective Caml, O'Reilly &amp; associates.
<p>

La boucle d'interaction provient de E. Chailloux, P. Manoury, B. Pagano : Developing Applications With Objective Caml, O'Reilly &amp; associates. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>End</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">exception</span>&nbsp;<span class="constructor">End</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>skeleton f_init f_end f_key f_mouse f_except </pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;skeleton&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;f_init&nbsp;f_end&nbsp;f_key&nbsp;f_mouse&nbsp;f_except&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;f_init&nbsp;()&nbsp;;<br>
&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="keyword">true</span>&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;<span class="constructor">Graphics</span>.wait_next_event&nbsp;[<span class="constructor">Graphics</span>.<span class="constructor">Button_down</span>;&nbsp;<span class="constructor">Graphics</span>.<span class="constructor">Key_pressed</span>]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;s.<span class="constructor">Graphics</span>.keypressed&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_key&nbsp;s.<span class="constructor">Graphics</span>.key<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;s.<span class="constructor">Graphics</span>.button&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_mouse&nbsp;s.<span class="constructor">Graphics</span>.mouse_x&nbsp;s.<span class="constructor">Graphics</span>.mouse_y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">End</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;raise&nbsp;<span class="constructor">End</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;e&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f_except&nbsp;e<br>
&nbsp;&nbsp;<span class="keyword">done</span><br>
&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">End</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f_end&nbsp;()<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f_end&nbsp;()&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>choose_directory approx_hori_size approx_verti_size max_number_display address</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;choose_directory&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(approx_hori_size:int)&nbsp;(approx_verti_size:int)&nbsp;(max_number:int)&nbsp;(dname:string)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;beginning&nbsp;=&nbsp;<span class="constructor">Sys</span>.getcwd&nbsp;()&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Sys</span>.chdir&nbsp;dname&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;wd&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Sys</span>.getcwd&nbsp;()&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;obsolete&nbsp;=&nbsp;ref&nbsp;[&nbsp;!wd&nbsp;]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;choice&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;sub_directories_list&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Readwrite</span>.sub_directories_with_parent&nbsp;dname&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hori_size&nbsp;=&nbsp;approx_hori_size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;verti_size&nbsp;=&nbsp;approx_verti_size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;first_time&nbsp;=&nbsp;ref&nbsp;<span class="keyword">true</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;refresh_message&nbsp;=&nbsp;[|&nbsp;<span class="string">"Rafraîchir"</span>&nbsp;;&nbsp;<span class="string">"Refresh"</span>&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;current_character&nbsp;=&nbsp;ref&nbsp;<span class="string">"0"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;sd&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;sed&nbsp;=&nbsp;ref&nbsp;[|&nbsp;<span class="string">""</span>&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;address_initial&nbsp;=&nbsp;ref&nbsp;dname&nbsp;<span class="keyword">and</span>&nbsp;address_final&nbsp;=&nbsp;ref&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ok&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;cancel&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;back&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;seek_out&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;refresh&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;hori_shift&nbsp;=&nbsp;hori_size&nbsp;/&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;verti_shift&nbsp;=&nbsp;verti_size&nbsp;/&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;!sub_directories_list&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;small_radius&nbsp;=&nbsp;max&nbsp;10&nbsp;(&nbsp;approx_verti_size&nbsp;/&nbsp;40&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f_init&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** f_init *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Gc</span>.compact&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!first_time&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.open_graph&nbsp;(&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;string_of_int&nbsp;hori_size&nbsp;)&nbsp;^&nbsp;<span class="string">"x"</span>&nbsp;^&nbsp;(&nbsp;string_of_int&nbsp;verti_size&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_window_title&nbsp;<span class="string">"Analogic.choose_directory"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address_initial&nbsp;:=&nbsp;!wd&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address_final&nbsp;:=&nbsp;<span class="string">""</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_directories_list&nbsp;:=&nbsp;<span class="constructor">Readwrite</span>.sub_directories_with_parent&nbsp;!wd&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;:=&nbsp;<span class="constructor">Array</span>.length&nbsp;!sub_directories_list&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.background&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_rect&nbsp;0&nbsp;0&nbsp;hori_size&nbsp;verti_size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sd&nbsp;:=&nbsp;cursor_round_folded_selector&nbsp;(&nbsp;10&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;small_radius&nbsp;(&nbsp;7&nbsp;*&nbsp;(&nbsp;min&nbsp;hori_shift&nbsp;verti_shift&nbsp;)&nbsp;)&nbsp;<span class="constructor">Graphics</span>.red&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;<span class="constructor">Graphics</span>.black&nbsp;<span class="constructor">Graphics</span>.green&nbsp;<span class="constructor">Graphics</span>.white&nbsp;!sub_directories_list&nbsp;max_number&nbsp;!choice&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed&nbsp;:=&nbsp;string_edit&nbsp;(&nbsp;10&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;verti_shift&nbsp;(&nbsp;16&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;dark_grey&nbsp;<span class="constructor">Graphics</span>.white&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;!address_initial&nbsp;!address_final&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;:=&nbsp;rect_switch&nbsp;(&nbsp;hori_size&nbsp;-&nbsp;hori_shift&nbsp;)&nbsp;verti_shift&nbsp;<span class="constructor">Graphics</span>.green&nbsp;<span class="constructor">Graphics</span>.black&nbsp;[|&nbsp;<span class="string">"&nbsp;OK&nbsp;"</span>&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cancel&nbsp;:=&nbsp;rect_switch&nbsp;hori_shift&nbsp;verti_shift&nbsp;<span class="constructor">Graphics</span>.red&nbsp;<span class="constructor">Graphics</span>.black&nbsp;[|&nbsp;<span class="string">"&nbsp;Annuler&nbsp;"</span>&nbsp;;&nbsp;<span class="string">"&nbsp;Cancel&nbsp;"</span>&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refresh&nbsp;:=&nbsp;rect_switch&nbsp;hori_shift&nbsp;(&nbsp;10&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;<span class="constructor">Graphics</span>.black&nbsp;refresh_message&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seek_out&nbsp;:=&nbsp;rect_switch&nbsp;hori_shift&nbsp;(&nbsp;verti_size&nbsp;-&nbsp;verti_shift&nbsp;)&nbsp;<span class="constructor">Graphics</span>.cyan&nbsp;<span class="constructor">Graphics</span>.black&nbsp;[|&nbsp;<span class="string">"Remonter"</span>&nbsp;;&nbsp;<span class="string">"Seek&nbsp;out"</span>&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;back&nbsp;:=&nbsp;rect_switch&nbsp;(&nbsp;hori_size&nbsp;-&nbsp;hori_shift&nbsp;)&nbsp;(&nbsp;verti_size&nbsp;-&nbsp;verti_shift&nbsp;)&nbsp;<span class="constructor">Graphics</span>.cyan&nbsp;<span class="constructor">Graphics</span>.black&nbsp;[|&nbsp;<span class="string">"Précédent"</span>&nbsp;;&nbsp;<span class="string">"Backward"</span>&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.foreground&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;18&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;(&nbsp;string_of_int&nbsp;!sd.(4)&nbsp;)&nbsp;^&nbsp;<span class="string">"&nbsp;/&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;string_of_int&nbsp;!l&nbsp;)&nbsp;^&nbsp;<span class="string">"&nbsp;:&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;string_of_int&nbsp;!sd.(5)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** f_init *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f_end&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;<span class="constructor">Sys</span>.chdir&nbsp;beginning&nbsp;;&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;&nbsp;raise&nbsp;<span class="constructor">End</span>&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f_key&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;c&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;current_character&nbsp;:=&nbsp;<span class="constructor">Char</span>.escaped&nbsp;c&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f_mouse&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** f_mouse *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_time&nbsp;:=&nbsp;<span class="keyword">false</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choice&nbsp;:=&nbsp;over_folded_selector&nbsp;!sd&nbsp;x&nbsp;y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;is_over_rect_button&nbsp;!cancel&nbsp;x&nbsp;y&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obsolete&nbsp;:=&nbsp;!wd&nbsp;::&nbsp;!obsolete&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wd&nbsp;:=&nbsp;dname&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_end&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;is_over_rect_button&nbsp;!ok&nbsp;x&nbsp;y&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_end&nbsp;()&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;is_over_rect_button&nbsp;!refresh&nbsp;x&nbsp;y&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_init&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;!choice&nbsp;!=&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;!choice&nbsp;&gt;=&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;!choice&nbsp;&lt;&nbsp;!l&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Sys</span>.chdir&nbsp;(&nbsp;!sub_directories_list&nbsp;).(!choice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obsolete&nbsp;:=&nbsp;!wd&nbsp;::&nbsp;!obsolete&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wd&nbsp;:=&nbsp;<span class="constructor">Sys</span>.getcwd&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choice&nbsp;:=&nbsp;0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_init&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;!choice&nbsp;&gt;=&nbsp;!l&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;(&nbsp;!choice&nbsp;&lt;&nbsp;0&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_init&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;!choice&nbsp;=&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;(&nbsp;is_over_rect_button&nbsp;!seek_out&nbsp;x&nbsp;y&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obsolete&nbsp;:=&nbsp;!wd&nbsp;::&nbsp;!obsolete&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wd&nbsp;:=&nbsp;<span class="constructor">Filename</span>.dirname&nbsp;(&nbsp;<span class="constructor">Sys</span>.getcwd&nbsp;()&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Sys</span>.chdir&nbsp;!wd&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_init&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;is_over_rect_button&nbsp;!back&nbsp;x&nbsp;y&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wd&nbsp;:=&nbsp;<span class="constructor">List</span>.hd&nbsp;!obsolete&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obsolete&nbsp;:=&nbsp;<span class="constructor">List</span>.tl&nbsp;!obsolete&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">List</span>.length&nbsp;!obsolete&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obsolete&nbsp;:=&nbsp;[&nbsp;beginning&nbsp;]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Sys</span>.chdir&nbsp;!wd&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_init&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** f_mouse *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f_except&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;&nbsp;raise&nbsp;<span class="constructor">End</span>&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skeleton&nbsp;f_init&nbsp;f_end&nbsp;f_key&nbsp;f_mouse&nbsp;f_except&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!wd<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">End</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Gc</span>.compact&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Sys</span>.chdir&nbsp;beginning&nbsp;;<br>
&nbsp;&nbsp;!wd&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>choose_regular_file approx_hori_size approx_verti_size max_number_display address</pre>  *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;choose_regular_file&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(approx_hori_size:int)&nbsp;(approx_verti_size:int)&nbsp;(max_number:int)&nbsp;(dname:string)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;beginning&nbsp;=&nbsp;<span class="constructor">Sys</span>.getcwd&nbsp;()&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Sys</span>.chdir&nbsp;dname&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;address&nbsp;=&nbsp;ref&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;choice&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;regular_files_list&nbsp;=&nbsp;<span class="constructor">Readwrite</span>.regular_files&nbsp;dname<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;hori_size&nbsp;=&nbsp;approx_hori_size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;verti_size&nbsp;=&nbsp;approx_verti_size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;first_time&nbsp;=&nbsp;ref&nbsp;<span class="keyword">true</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;refresh_message&nbsp;=&nbsp;[|&nbsp;<span class="string">"Rafraîchir"</span>&nbsp;;&nbsp;<span class="string">"Refresh"</span>&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;current_character&nbsp;=&nbsp;ref&nbsp;<span class="string">"0"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;sf&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;sef&nbsp;=&nbsp;ref&nbsp;[|&nbsp;<span class="string">""</span>&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;address_initial&nbsp;=&nbsp;ref&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">and</span>&nbsp;address_final&nbsp;=&nbsp;ref&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ok&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;cancel&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;refresh&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;hori_shift&nbsp;=&nbsp;hori_size&nbsp;/&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;verti_shift&nbsp;=&nbsp;verti_size&nbsp;/&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;regular_files_list<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;small_radius&nbsp;=&nbsp;max&nbsp;10&nbsp;(&nbsp;approx_verti_size&nbsp;/&nbsp;30&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f_init&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** f_init *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Gc</span>.compact&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!first_time&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.open_graph&nbsp;(&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;string_of_int&nbsp;hori_size&nbsp;)&nbsp;^&nbsp;<span class="string">"x"</span>&nbsp;^&nbsp;(&nbsp;string_of_int&nbsp;verti_size&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_window_title&nbsp;<span class="string">"Analogic.choose_regular_file"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address_initial&nbsp;:=&nbsp;!address&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address_final&nbsp;:=&nbsp;<span class="string">""</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.background&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.fill_rect&nbsp;0&nbsp;0&nbsp;hori_size&nbsp;verti_size&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sf&nbsp;:=&nbsp;cursor_round_folded_selector&nbsp;(&nbsp;10&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;small_radius&nbsp;(&nbsp;7&nbsp;*&nbsp;(&nbsp;min&nbsp;hori_shift&nbsp;verti_shift&nbsp;)&nbsp;)&nbsp;<span class="constructor">Graphics</span>.red&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;<span class="constructor">Graphics</span>.black&nbsp;<span class="constructor">Graphics</span>.green&nbsp;<span class="constructor">Graphics</span>.white&nbsp;regular_files_list&nbsp;max_number&nbsp;!choice&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sef&nbsp;:=&nbsp;string_edit&nbsp;(&nbsp;10&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;verti_shift&nbsp;(&nbsp;16&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;<span class="constructor">Graphics</span>.black&nbsp;<span class="constructor">Graphics</span>.white&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;!address_initial&nbsp;!address_final&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;:=&nbsp;rect_switch&nbsp;(&nbsp;hori_size&nbsp;-&nbsp;hori_shift&nbsp;)&nbsp;verti_shift&nbsp;<span class="constructor">Graphics</span>.green&nbsp;<span class="constructor">Graphics</span>.black&nbsp;[|&nbsp;<span class="string">"&nbsp;OK&nbsp;"</span>&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cancel&nbsp;:=&nbsp;rect_switch&nbsp;hori_shift&nbsp;verti_shift&nbsp;<span class="constructor">Graphics</span>.red&nbsp;<span class="constructor">Graphics</span>.black&nbsp;[|&nbsp;<span class="string">"&nbsp;Annuler&nbsp;"</span>&nbsp;;&nbsp;<span class="string">"&nbsp;Cancel&nbsp;"</span>&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refresh&nbsp;:=&nbsp;rect_switch&nbsp;hori_shift&nbsp;(&nbsp;10&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;<span class="constructor">Graphics</span>.black&nbsp;refresh_message&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_color&nbsp;<span class="constructor">Graphics</span>.foreground&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.moveto&nbsp;(&nbsp;18&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.draw_string&nbsp;(&nbsp;(&nbsp;string_of_int&nbsp;!sf.(4)&nbsp;)&nbsp;^&nbsp;<span class="string">"&nbsp;/&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;string_of_int&nbsp;l&nbsp;)&nbsp;^&nbsp;<span class="string">"&nbsp;:&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;string_of_int&nbsp;!sf.(5)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** f_init *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f_end&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;<span class="constructor">Sys</span>.chdir&nbsp;beginning&nbsp;;&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;&nbsp;raise&nbsp;<span class="constructor">End</span>&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f_key&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;c&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;current_character&nbsp;:=&nbsp;<span class="constructor">Char</span>.escaped&nbsp;c&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f_mouse&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** f_mouse *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_time&nbsp;:=&nbsp;<span class="keyword">false</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;choice&nbsp;:=&nbsp;over_folded_selector&nbsp;!sf&nbsp;x&nbsp;y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;is_over_rect_button&nbsp;!cancel&nbsp;x&nbsp;y&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address&nbsp;:=&nbsp;<span class="string">""</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_end&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;is_over_rect_button&nbsp;!ok&nbsp;x&nbsp;y&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_end&nbsp;()&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;is_over_rect_button&nbsp;!refresh&nbsp;x&nbsp;y&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_init&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;is_over_string_edit&nbsp;!sef&nbsp;x&nbsp;y&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ev&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Graphics</span>.wait_next_event&nbsp;[&nbsp;<span class="constructor">Graphics</span>.<span class="constructor">Key_pressed</span>&nbsp;;&nbsp;<span class="constructor">Graphics</span>.<span class="constructor">Button_down</span>&nbsp;]&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;!ev.<span class="constructor">Graphics</span>.keypressed&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;not&nbsp;(&nbsp;<span class="constructor">Graphics</span>.button_down&nbsp;()&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_key&nbsp;(&nbsp;!ev.<span class="constructor">Graphics</span>.key&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;res&nbsp;=&nbsp;string_treatment&nbsp;!address_initial&nbsp;!address_final&nbsp;!current_character&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address_initial&nbsp;:=&nbsp;res.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address_final&nbsp;:=&nbsp;res.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address&nbsp;:=&nbsp;!address_initial&nbsp;^&nbsp;!address_final&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sef&nbsp;:=&nbsp;string_edit&nbsp;(&nbsp;int_of_string&nbsp;!sef.(0)&nbsp;)&nbsp;(&nbsp;int_of_string&nbsp;!sef.(1)&nbsp;)&nbsp;(&nbsp;int_of_string&nbsp;!sef.(2)&nbsp;)&nbsp;<span class="constructor">Graphics</span>.black&nbsp;<span class="constructor">Graphics</span>.white&nbsp;<span class="constructor">Graphics</span>.green&nbsp;!address_initial&nbsp;!address_final&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ev&nbsp;:=&nbsp;<span class="constructor">Graphics</span>.wait_next_event&nbsp;[&nbsp;<span class="constructor">Graphics</span>.<span class="constructor">Key_pressed</span>&nbsp;;&nbsp;<span class="constructor">Graphics</span>.<span class="constructor">Button_down</span>&nbsp;]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;!choice&nbsp;&gt;=&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;!choice&nbsp;&lt;&nbsp;l&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address&nbsp;:=&nbsp;(&nbsp;regular_files_list&nbsp;).(!choice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_init&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;!choice&nbsp;&gt;=&nbsp;l&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;(&nbsp;!choice&nbsp;&lt;&nbsp;0&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_init&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** f_mouse *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f_except&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;&nbsp;raise&nbsp;<span class="constructor">End</span>&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skeleton&nbsp;f_init&nbsp;f_end&nbsp;f_key&nbsp;f_mouse&nbsp;f_except&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!address<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">End</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Gc</span>.compact&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Sys</span>.chdir&nbsp;beginning&nbsp;;<br>
&nbsp;&nbsp;!address&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>choose_real hori_size verti_size range value</pre> The float vector <code class="code">value</code> is modified in place.
<p>

Le vecteur réel <code class="code">value</code> est modifié en place. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;choose_real&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(hori_size:int)&nbsp;(verti_size:int)&nbsp;(range:float&nbsp;array)&nbsp;(value:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">assert</span>&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;value&nbsp;&gt;=&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;<span class="keyword">assert</span>&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;range&nbsp;&gt;=&nbsp;2&nbsp;)&nbsp;;<br>
&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;obsolete&nbsp;=&nbsp;ref&nbsp;value.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;first_time&nbsp;=&nbsp;ref&nbsp;<span class="keyword">true</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f_string&nbsp;=&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;s&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">String</span>.sub&nbsp;s&nbsp;0&nbsp;(&nbsp;min&nbsp;16&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;s&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cancel_message&nbsp;=&nbsp;[|&nbsp;<span class="string">"Annuler"</span>&nbsp;;&nbsp;<span class="string">"Cancel"</span>&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;ok_message&nbsp;=&nbsp;[|&nbsp;<span class="string">"&nbsp;OK&nbsp;"</span>&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;refresh_message&nbsp;=&nbsp;[|&nbsp;<span class="string">"Rafraîchir"</span>&nbsp;;&nbsp;<span class="string">"Refresh"</span>&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;current_character&nbsp;=&nbsp;ref&nbsp;<span class="string">"0"</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;sr&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;ser&nbsp;=&nbsp;ref&nbsp;[|&nbsp;<span class="string">""</span>&nbsp;|]<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ok&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;cancel&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">and</span>&nbsp;refresh&nbsp;=&nbsp;ref&nbsp;[|&nbsp;0&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;hori_shift&nbsp;=&nbsp;hori_size&nbsp;/&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;verti_shift&nbsp;=&nbsp;verti_size&nbsp;/&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient_initial&nbsp;=&nbsp;ref&nbsp;(&nbsp;f_string&nbsp;(&nbsp;string_of_float&nbsp;value.(0)&nbsp;)&nbsp;)&nbsp;<span class="keyword">and</span>&nbsp;coefficient_final&nbsp;=&nbsp;ref&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;small_radius&nbsp;=&nbsp;max&nbsp;10&nbsp;(&nbsp;verti_size&nbsp;/&nbsp;50&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f_init&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** f_init *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Gc</span>.compact&nbsp;()&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!first_time&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.open_graph&nbsp;(&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;(&nbsp;string_of_int&nbsp;hori_size&nbsp;)&nbsp;^&nbsp;<span class="string">"x"</span>&nbsp;^&nbsp;(&nbsp;string_of_int&nbsp;verti_size&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphics</span>.set_window_title&nbsp;<span class="string">"Analogic.choose_real"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;:=&nbsp;rect_switch&nbsp;(&nbsp;15&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;(&nbsp;5&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;<span class="constructor">Graphics</span>.green&nbsp;<span class="constructor">Graphics</span>.black&nbsp;ok_message&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cancel&nbsp;:=&nbsp;rect_switch&nbsp;(&nbsp;5&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;(&nbsp;5&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;<span class="constructor">Graphics</span>.red&nbsp;<span class="constructor">Graphics</span>.black&nbsp;cancel_message&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refresh&nbsp;:=&nbsp;rect_switch&nbsp;(&nbsp;5&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;<span class="constructor">Graphics</span>.black&nbsp;refresh_message&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sr&nbsp;:=&nbsp;float_vernier&nbsp;(&nbsp;10&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;(&nbsp;8&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;small_radius&nbsp;<span class="constructor">Graphics</span>.red&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;<span class="constructor">Graphics</span>.black&nbsp;<span class="constructor">Graphics</span>.green&nbsp;<span class="constructor">Graphics</span>.white&nbsp;10&nbsp;range&nbsp;value.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ser&nbsp;:=&nbsp;string_edit&nbsp;(&nbsp;10&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;(&nbsp;15&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;(&nbsp;10&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;<span class="constructor">Graphics</span>.black&nbsp;<span class="constructor">Graphics</span>.white&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;!coefficient_initial&nbsp;!coefficient_final&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** f_init *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f_end&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;&nbsp;raise&nbsp;<span class="constructor">End</span>&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f_key&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;c&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;current_character&nbsp;:=&nbsp;<span class="constructor">Char</span>.escaped&nbsp;c&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f_mouse&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** f_mouse *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_time&nbsp;:=&nbsp;<span class="keyword">false</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value.(0)&nbsp;&lt;-&nbsp;over_float_vernier&nbsp;!sr&nbsp;x&nbsp;y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;is_over_rect_button&nbsp;!cancel&nbsp;x&nbsp;y&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value.(0)&nbsp;&lt;-&nbsp;!obsolete&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_end&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;is_over_rect_button&nbsp;!ok&nbsp;x&nbsp;y&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_end&nbsp;()&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;is_over_rect_button&nbsp;!refresh&nbsp;x&nbsp;y&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coefficient_initial&nbsp;:=&nbsp;!coefficient_initial&nbsp;^&nbsp;!coefficient_final&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coefficient_final&nbsp;:=&nbsp;<span class="string">""</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_init&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;is_over_string_edit&nbsp;!ser&nbsp;x&nbsp;y&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ev&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Graphics</span>.wait_next_event&nbsp;[&nbsp;<span class="constructor">Graphics</span>.<span class="constructor">Key_pressed</span>&nbsp;;&nbsp;<span class="constructor">Graphics</span>.<span class="constructor">Button_down</span>&nbsp;]&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;old_real&nbsp;=&nbsp;f_string&nbsp;(&nbsp;string_of_float&nbsp;value.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;old_initial&nbsp;=&nbsp;!coefficient_initial<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;old_final&nbsp;=&nbsp;!coefficient_final&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;!ev.<span class="constructor">Graphics</span>.keypressed&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;not&nbsp;(&nbsp;<span class="constructor">Graphics</span>.button_down&nbsp;()&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_key&nbsp;(&nbsp;!ev.<span class="constructor">Graphics</span>.key&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;res&nbsp;=&nbsp;string_treatment&nbsp;!coefficient_initial&nbsp;!coefficient_final&nbsp;!current_character&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coefficient_initial&nbsp;:=&nbsp;res.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coefficient_final&nbsp;:=&nbsp;res.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value.(0)&nbsp;&lt;-&nbsp;float_of_string&nbsp;(&nbsp;!coefficient_initial&nbsp;^&nbsp;!coefficient_final&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Failure</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;value.(0)&nbsp;&lt;-&nbsp;float_of_string&nbsp;old_real&nbsp;;&nbsp;coefficient_initial&nbsp;:=&nbsp;old_initial&nbsp;;&nbsp;coefficient_final&nbsp;:=&nbsp;old_final&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ser&nbsp;:=&nbsp;string_edit&nbsp;(&nbsp;int_of_string&nbsp;!ser.(0)&nbsp;)&nbsp;(&nbsp;int_of_string&nbsp;!ser.(1)&nbsp;)&nbsp;(&nbsp;int_of_string&nbsp;!ser.(2)&nbsp;)&nbsp;<span class="constructor">Graphics</span>.black&nbsp;<span class="constructor">Graphics</span>.white&nbsp;<span class="constructor">Graphics</span>.green&nbsp;!coefficient_initial&nbsp;!coefficient_final&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sr&nbsp;:=&nbsp;float_vernier&nbsp;(&nbsp;10&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;(&nbsp;8&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;small_radius&nbsp;<span class="constructor">Graphics</span>.red&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;<span class="constructor">Graphics</span>.black&nbsp;<span class="constructor">Graphics</span>.green&nbsp;<span class="constructor">Graphics</span>.white&nbsp;10&nbsp;range&nbsp;value.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ev&nbsp;:=&nbsp;<span class="constructor">Graphics</span>.wait_next_event&nbsp;[&nbsp;<span class="constructor">Graphics</span>.<span class="constructor">Key_pressed</span>&nbsp;;&nbsp;<span class="constructor">Graphics</span>.<span class="constructor">Button_down</span>&nbsp;]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;value.(0)&nbsp;!=&nbsp;float_of_string&nbsp;(&nbsp;!coefficient_initial&nbsp;^&nbsp;!coefficient_final&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sr&nbsp;:=&nbsp;float_vernier&nbsp;(&nbsp;10&nbsp;*&nbsp;hori_shift&nbsp;)&nbsp;(&nbsp;8&nbsp;*&nbsp;verti_shift&nbsp;)&nbsp;small_radius&nbsp;<span class="constructor">Graphics</span>.red&nbsp;<span class="constructor">Graphics</span>.yellow&nbsp;<span class="constructor">Graphics</span>.black&nbsp;<span class="constructor">Graphics</span>.green&nbsp;<span class="constructor">Graphics</span>.white&nbsp;10&nbsp;range&nbsp;value.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coefficient_initial&nbsp;:=&nbsp;f_string&nbsp;(&nbsp;string_of_float&nbsp;value.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coefficient_final&nbsp;:=&nbsp;<span class="string">""</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f_init&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;</code><table><tr><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><span class="comment">(** f_mouse *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;f_except&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;unknown&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;<span class="constructor">Graphics</span>.close_graph&nbsp;()&nbsp;;&nbsp;raise&nbsp;<span class="constructor">End</span>&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skeleton&nbsp;f_init&nbsp;f_end&nbsp;f_key&nbsp;f_mouse&nbsp;f_except&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">End</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Gc</span>.compact&nbsp;()&nbsp;;<br>
&nbsp;value&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ § § </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<span class="keyword">end</span></code></body></html>