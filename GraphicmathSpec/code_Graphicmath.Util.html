<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Graphicmath" rel="Chapter" href="Graphicmath.html"><title>Graphicmath.Util</title>
</head>
<body>
<code class="code"><span class="keyword">struct</span><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Introduction"><h1>Introduction</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(**
The mathematician will find in this module several elementary tools
used in the other modules of the <code class="code">ocamlmath</code> library.
<p>

<span id="2_Comments"><h2>Comments</h2></span>
<p>

This module is distributed under the same licence as Ocaml.
<p>

<center>§ </center>
<p>

La mathématicienne ou le mathématicien trouvera dans ce module différents outils
élémentaires utilisés dans les autres modules de la bibliothèque <code class="code">ocamlmath</code>.
<p>

<span id="2_Commentaires"><h2>Commentaires</h2></span>
<p>

Ce module est distribué selon la même licence qu'Ocaml.
<p>

<center>Copyright Stéphane Grognet </center>
<center>Laboratoire de mathématiques Jean Leray UMR 6629 CNRS </center>
<center>Fédération de recherche mathématique des Pays de la Loire </center>
<center>IREM des Pays de la Loire - Université de Nantes </center>
<center>version 0.2</center>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@version 0.2
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@author Stéphane Grognet
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@since 2012, 2013
*)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Constructionsminimalessurlesentiersetrels"><h1>Constructions minimales sur les entiers et réels</h1></span>
<span id="1_Minimalconstructionsonintegerandrealnumbers"><h1>Minimal constructions on integer and real numbers</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_copy integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_copy&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>big_int_copy big_integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;big_int_copy&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Big_int</span>.big_int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Big_int</span>.add_big_int&nbsp;<span class="constructor">Big_int</span>.zero_big_int&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>big integer integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;big&nbsp;=&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>small big_integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;small&nbsp;=&nbsp;<span class="constructor">Big_int</span>.int_of_big_int&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>round_num number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;round_num&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:<span class="constructor">Num</span>.num)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Num</span>.integer_num&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Num</span>.mult_num&nbsp;(&nbsp;<span class="constructor">Num</span>.num_of_int&nbsp;2&nbsp;)&nbsp;(&nbsp;<span class="constructor">Num</span>.sub_num&nbsp;x&nbsp;xx&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Num</span>.integer_num&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Num</span>.add_num&nbsp;xx&nbsp;yy&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>adhoc_division integer1 integer2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;adhoc_division&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;y&nbsp;&lt;&gt;&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;/&nbsp;y<br>
&nbsp;<span class="keyword">else</span>&nbsp;0&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_sign integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_sign&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;compare&nbsp;x&nbsp;0&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_truncate base number</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_truncate&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(b:int)&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&gt;&nbsp;b&nbsp;<span class="keyword">then</span>&nbsp;b<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&lt;&nbsp;-&nbsp;b&nbsp;<span class="keyword">then</span>&nbsp;-&nbsp;b<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;x<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_gcd integer1 integer2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_gcd&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(p:int)&nbsp;(q:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Big_int</span>.int_of_big_int&nbsp;&nbsp;(&nbsp;<span class="constructor">Big_int</span>.gcd_big_int&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;p&nbsp;)&nbsp;(&nbsp;<span class="constructor">Big_int</span>.big_int_of_int&nbsp;q&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_identity integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_identity&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_sqrt integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_sqrt&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;small&nbsp;(&nbsp;<span class="constructor">Big_int</span>.sqrt_big_int&nbsp;(&nbsp;big&nbsp;x&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_power exponent integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;int_power&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;compare&nbsp;n&nbsp;0&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;negative&nbsp;<span class="keyword">when</span>&nbsp;negative&nbsp;&lt;&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Negative&nbsp;exponent&nbsp;in&nbsp;Util.int_power."</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;n&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;2&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x&nbsp;*&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;n&nbsp;<span class="keyword">mod</span>&nbsp;2&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;int_power&nbsp;(&nbsp;n&nbsp;/&nbsp;2&nbsp;)&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;*&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x&nbsp;*&nbsp;(&nbsp;int_power&nbsp;(&nbsp;pred&nbsp;n&nbsp;)&nbsp;x&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
&nbsp;<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>ilog integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;ilog&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;result&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;!y&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;incr&nbsp;result&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;<span class="keyword">lsr</span>&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!result&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_zero float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_zero&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;0.&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_one float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_one&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1.&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>ulp real</pre> Unit in the last place. This function is described by William Kahan in <code class="code">http://www.cs.berkeley.edu/~wkahan/<span class="constructor">LOG10HAF</span>.<span class="constructor">TXT</span></code>.
<p>

Unité dans la position la moins significative. Cette fonction est décrite par William Kahan dans <code class="code">http://www.cs.berkeley.edu/~wkahan/<span class="constructor">LOG10HAF</span>.<span class="constructor">TXT</span></code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;ulp&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;u&nbsp;=&nbsp;abs_float&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;u&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;v&nbsp;<span class="keyword">when</span>&nbsp;v&nbsp;&lt;&nbsp;5.0e-308&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;5.0e-324<br>
</code><table><tr><td></td><td><span class="comment">(** 1024. -. 53. = 971. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;v&nbsp;<span class="keyword">when</span>&nbsp;v&nbsp;&gt;&nbsp;9.0e307&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;2.**&nbsp;971.<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;(&nbsp;0.7&nbsp;*.&nbsp;epsilon_float&nbsp;)&nbsp;*.&nbsp;u&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min&nbsp;(&nbsp;(&nbsp;v&nbsp;+.&nbsp;u&nbsp;)&nbsp;-.&nbsp;u&nbsp;)&nbsp;(&nbsp;(&nbsp;v&nbsp;-.&nbsp;u&nbsp;)&nbsp;+.&nbsp;u&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_sign float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_sign&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;float&nbsp;(&nbsp;compare&nbsp;x&nbsp;0.&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_identity float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_identity&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>round real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;round&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;int_of_float&nbsp;(&nbsp;x&nbsp;+.&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;n&nbsp;/&nbsp;2&nbsp;+&nbsp;n&nbsp;<span class="keyword">mod</span>&nbsp;2&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>frac real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;frac&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;fst&nbsp;(&nbsp;modf&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_pos_part float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_pos_part&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;x&nbsp;+.&nbsp;(&nbsp;abs_float&nbsp;x&nbsp;)&nbsp;)&nbsp;/.&nbsp;2.&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_float_power integer float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;int_float_power&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;compare&nbsp;n&nbsp;0&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1.<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;negative&nbsp;<span class="keyword">when</span>&nbsp;negative&nbsp;&lt;&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int_float_power&nbsp;(&nbsp;abs&nbsp;n&nbsp;)&nbsp;(&nbsp;1.&nbsp;/.&nbsp;x&nbsp;)<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;n&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;2&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x&nbsp;*.&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;int_float_power&nbsp;(&nbsp;n&nbsp;/&nbsp;2&nbsp;)&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;n&nbsp;<span class="keyword">mod</span>&nbsp;2&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y&nbsp;*.&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x&nbsp;*.&nbsp;y&nbsp;*.&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
&nbsp;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The factorial function is defined in a tail recursive way.
<p>

La factorielle est définie de manière récursive terminale. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>fact_aux stack init</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;fact_aux&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;fact_aux&nbsp;(&nbsp;x&nbsp;*&nbsp;y&nbsp;)&nbsp;(&nbsp;pred&nbsp;y&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>fact integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;fact&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;fact_aux&nbsp;1&nbsp;(&nbsp;abs&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_max real1 real2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_max&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:float)&nbsp;(y:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&gt;&nbsp;y&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;<span class="keyword">else</span>&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_min real1 real2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_min&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:float)&nbsp;(y:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">if</span>&nbsp;y&nbsp;&gt;&nbsp;x&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;<span class="keyword">else</span>&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_max int1 int2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_max&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&gt;&nbsp;y&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;<span class="keyword">else</span>&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_min int1 int2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_min&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:int)&nbsp;(y:int)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">if</span>&nbsp;y&nbsp;&gt;&nbsp;x&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;<span class="keyword">else</span>&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Constructionsminimalessurlesvecteursrels"><h1>Constructions minimales sur les vecteurs réels</h1></span>
<span id="1_Minimalconstructionsonrealvectors"><h1>Minimal constructions on real vectors</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_zero dimension</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_zero&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;n&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Array</span>.make&nbsp;n&nbsp;0.&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_one dimension float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_one&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;n&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Array</span>.make&nbsp;n&nbsp;1.&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_float_prod_3 vector1 vector2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_float_prod_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v1:float&nbsp;array)&nbsp;(v2:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;[|&nbsp;v1.(1)&nbsp;*.&nbsp;v2.(2)&nbsp;-.&nbsp;v1.(2)&nbsp;*.&nbsp;v2.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;v1.(2)&nbsp;*.&nbsp;v2.(0)&nbsp;-.&nbsp;v1.(0)&nbsp;*.&nbsp;v2.(2)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;v1.(0)&nbsp;*.&nbsp;v2.(1)&nbsp;-.&nbsp;v1.(1)&nbsp;*.&nbsp;v2.(0)&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Constructionsdiverses"><h1>Constructions diverses</h1></span>
<span id="1_Miscellaneousconstructions"><h1>Miscellaneous constructions</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>print_bool boolean</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;print_bool&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:bool)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;print_string&nbsp;(&nbsp;string_of_bool&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>append_char string character</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;append_char&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(s:string)&nbsp;(c:char)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;s&nbsp;^&nbsp;(&nbsp;<span class="constructor">String</span>.make&nbsp;1&nbsp;c&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>string_eq string1 string2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;string_eq&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;(&nbsp;<span class="constructor">String</span>.compare&nbsp;x&nbsp;y&nbsp;)&nbsp;=&nbsp;0&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>string_tail string</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;string_tail&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(s:string)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">String</span>.sub&nbsp;s&nbsp;1&nbsp;(&nbsp;pred&nbsp;(&nbsp;<span class="constructor">String</span>.length&nbsp;s&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>deverminage ()</pre> L'erreur <code class="code"><span class="constructor">Exception</span>: <span class="constructor">Invalid_argument</span> <span class="string">"index out of bounds"</span>.</code> arrive fréquemment
quand on fait de mauvais dimensionnenments de matrices ou de vecteurs. Placer cette instruction 
à différents endroits du code peut permettre de localiser le problème. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;deverminage&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;print_string&nbsp;<span class="string">"Jusqu'ici,&nbsp;tout&nbsp;va&nbsp;bien&nbsp;!"</span>&nbsp;;<br>
&nbsp;print_newline&nbsp;()&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>degugging ()</pre> The error <code class="code"><span class="constructor">Exception</span>: <span class="constructor">Invalid_argument</span> <span class="string">"index out of bounds"</span>.</code>
is frequently seen when matrices or vectors are ill-dimensioned. Placing this instruction 
at different places in the code may help to situate the issue. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;debugging&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;print_string&nbsp;<span class="string">"So&nbsp;far&nbsp;so&nbsp;good&nbsp;!"</span>&nbsp;;<br>
&nbsp;print_newline&nbsp;()&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_ConstructionspolymorphessurlesstructureslmentairesdOcaml"><h1>Constructions polymorphes sur les structures élémentaires d'Ocaml</h1></span>
<span id="1_PolymorphicconstructionsonelementarystructuresofOcaml"><h1>Polymorphic constructions on elementary structures of Ocaml</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** Polymorphic functions are reputed to be slow.
<p>

Les fonctions polymorphes sont réputés lentes.*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** primo triple *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;primo&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;z&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** secundo triple *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;secundo&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;z&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** tertio triple *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;tertio&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(&nbsp;x&nbsp;,&nbsp;y&nbsp;,&nbsp;z&nbsp;)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_print coeff_print vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_print&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coeff_print:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;unit)&nbsp;(v:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;rr&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;print_string&nbsp;<span class="string">"[|&nbsp;"</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;rr&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;coeff_print&nbsp;v.(i)&nbsp;;&nbsp;print_string&nbsp;<span class="string">"&nbsp;;&nbsp;"</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;coeff_print&nbsp;v.(rr)&nbsp;;<br>
&nbsp;&nbsp;print_string&nbsp;<span class="string">"&nbsp;|]"</span>&nbsp;;<br>
&nbsp;&nbsp;print_newline&nbsp;()&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>bare_vector_print coeff_print vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;bare_vector_print&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coeff_print:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;unit)&nbsp;(v:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;rr&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;print_string&nbsp;<span class="string">"[|"</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;rr&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;coeff_print&nbsp;v.(i)&nbsp;;&nbsp;print_string&nbsp;<span class="string">"&nbsp;"</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;coeff_print&nbsp;v.(rr)&nbsp;;<br>
&nbsp;&nbsp;print_string&nbsp;<span class="string">"|]"</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_to_string coeff_to_string beginning separator ending vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_to_string&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coeff_to_string:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;string)&nbsp;(beginning:string)&nbsp;(separator:string)&nbsp;(ending:string)&nbsp;(v:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;rr&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;s&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;rr&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;!s&nbsp;^&nbsp;(&nbsp;coeff_to_string&nbsp;v.(i)&nbsp;)&nbsp;^&nbsp;separator<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;!s&nbsp;^&nbsp;(&nbsp;coeff_to_string&nbsp;v.(rr)&nbsp;)&nbsp;^&nbsp;ending&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;!s<br>
&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;beginning&nbsp;^&nbsp;ending&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>bare_vector_to_string coeff_to_string vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;bare_vector_to_string&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coeff_to_string:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;string)&nbsp;(v:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;vector_to_string&nbsp;coeff_to_string&nbsp;<span class="string">"[|"</span>&nbsp;<span class="string">"&nbsp;"</span>&nbsp;<span class="string">"|]"</span>&nbsp;v&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_of_string coeff_of_string beginning separator ending string</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_of_string&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coeff_of_string:string&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a)&nbsp;(beginning:string)&nbsp;(separator:string)&nbsp;(ending:string)&nbsp;(s:string)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ls&nbsp;=&nbsp;<span class="constructor">String</span>.length&nbsp;s<br>
&nbsp;<span class="keyword">and</span>&nbsp;lb&nbsp;=&nbsp;<span class="constructor">String</span>.length&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;le&nbsp;=&nbsp;<span class="constructor">String</span>.length&nbsp;ending&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;st&nbsp;=&nbsp;<span class="constructor">String</span>.sub&nbsp;s&nbsp;lb&nbsp;(&nbsp;ls&nbsp;-&nbsp;lb&nbsp;-&nbsp;le&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;listing&nbsp;=&nbsp;<span class="constructor">Str</span>.split&nbsp;(&nbsp;<span class="constructor">Str</span>.regexp_string&nbsp;separator&nbsp;)&nbsp;st&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;<span class="constructor">Array</span>.of_list&nbsp;listing&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;coeff_of_string&nbsp;a&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>bare_vector_of_string coeff_of_string string</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;bare_vector_of_string&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coeff_of_string:string&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a)&nbsp;(s:string)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;vector_of_string&nbsp;coeff_of_string&nbsp;<span class="string">"[|"</span>&nbsp;<span class="string">"&nbsp;"</span>&nbsp;<span class="string">"|]"</span>&nbsp;s&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>extract_even table</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;extract_even&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(table:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;table&nbsp;)&nbsp;/&nbsp;2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;result&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;table.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;result.(i)&nbsp;&lt;-&nbsp;table.(&nbsp;2&nbsp;*&nbsp;i&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;result&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>extract_odd table</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;extract_odd&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(table:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;(&nbsp;1&nbsp;+&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;table&nbsp;)&nbsp;)&nbsp;/&nbsp;2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;result&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;table.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;result.(i)&nbsp;&lt;-&nbsp;table.(&nbsp;2&nbsp;*&nbsp;i&nbsp;+&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;result&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>extract_every_other number table</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;extract_every_other&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(table:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;table&nbsp;)&nbsp;/&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;result&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;table.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;result.(i)&nbsp;&lt;-&nbsp;table.(&nbsp;n&nbsp;*&nbsp;i&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;result&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_combine array1 array2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_combine&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;s&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;b&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;r&nbsp;!=&nbsp;s&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Different&nbsp;array&nbsp;lengths&nbsp;in&nbsp;Util.array_combine."</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;r&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;[|&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;a.(0)&nbsp;,&nbsp;b.(0)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v.(i)&nbsp;&lt;-&nbsp;(&nbsp;a.(i)&nbsp;,&nbsp;b.(i)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_split array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_split&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;a&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;fst&nbsp;a&nbsp;,&nbsp;<span class="constructor">Array</span>.map&nbsp;snd&nbsp;a&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>list_non_empty list</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;list_non_empty&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(l:<span class="keywordsign">'</span>a&nbsp;list)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;l&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">false</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">true</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>list_is_empty list</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;list_is_empty&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(l:<span class="keywordsign">'</span>a&nbsp;list)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;l&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">true</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">false</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_is_empty array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_is_empty&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;=&nbsp;0&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>reverse_array array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;reverse_array&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;a&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pr&nbsp;=&nbsp;pred&nbsp;r&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.init&nbsp;r&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;i&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;a.(&nbsp;pr&nbsp;-&nbsp;i&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>lexico_compare comparison array1 array2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;lexico_compare&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(x:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;(y:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;lx&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;ly&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y<br>
&nbsp;<span class="keyword">and</span>&nbsp;result&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ll&nbsp;=&nbsp;min&nbsp;lx&nbsp;ly<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;!result&nbsp;=&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;!i&nbsp;&lt;&nbsp;ll&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;cmp&nbsp;x.(!i)&nbsp;y.(!i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;i<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;!result&nbsp;=&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;lx&nbsp;&lt;&nbsp;ly&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;-1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;!result&nbsp;=&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;lx&nbsp;&gt;&nbsp;ly&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!result&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_eq coeff_equality array1 array2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_eq&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(eq:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;bool)&nbsp;(v:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;(w:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;i&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;eq&nbsp;v.(i)&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;test&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;f&nbsp;w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;)&nbsp;<span class="keyword">true</span>&nbsp;test&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_eq_zero coeff_nullity array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_eq_zero&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(eq_zero:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;bool)&nbsp;(v:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;test&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;eq_zero&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;)&nbsp;<span class="keyword">true</span>&nbsp;test&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_max vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_max&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;max&nbsp;v.(0)&nbsp;v&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_min vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_min&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;min&nbsp;v.(0)&nbsp;v&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>maximum comparison x y</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;maximum&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(x:<span class="keywordsign">'</span>a)&nbsp;(y:<span class="keywordsign">'</span>a)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;cmp&nbsp;x&nbsp;y&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;y<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>minimum comparison x y</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;minimum&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(x:<span class="keywordsign">'</span>a)&nbsp;(y:<span class="keywordsign">'</span>a)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;cmp&nbsp;x&nbsp;y&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;y<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_maximum comparison array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_maximum&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(v:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Empty&nbsp;array&nbsp;in&nbsp;Util.array_maximum."</span>&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;v.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;cmp&nbsp;y&nbsp;!x&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;y<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_minimum comparison array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_minimum&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(v:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Empty&nbsp;array&nbsp;in&nbsp;Util.array_minimum."</span>&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;v.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;cmp&nbsp;y&nbsp;!x&nbsp;&lt;&nbsp;0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;y<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>list_maximum comparison list</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;list_maximum&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(l:<span class="keywordsign">'</span>a&nbsp;list)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;aux&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;cmp&nbsp;accu&nbsp;m&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;m&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;accu<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;x&nbsp;::&nbsp;n&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;aux&nbsp;cmp&nbsp;(&nbsp;maximum&nbsp;cmp&nbsp;x&nbsp;accu&nbsp;)&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;l&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Empty&nbsp;list&nbsp;in&nbsp;Util.list_maximum."</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;x&nbsp;::&nbsp;m&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;aux&nbsp;cmp&nbsp;x&nbsp;m&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>list_minimum comparison list</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;list_minimum&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(l:<span class="keywordsign">'</span>a&nbsp;list)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;aux&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;cmp&nbsp;accu&nbsp;m&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;m&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;accu<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;x&nbsp;::&nbsp;n&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;aux&nbsp;cmp&nbsp;(&nbsp;minimum&nbsp;cmp&nbsp;x&nbsp;accu&nbsp;)&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;l&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Empty&nbsp;list&nbsp;in&nbsp;Util.list_minimum."</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;x&nbsp;::&nbsp;m&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;aux&nbsp;cmp&nbsp;x&nbsp;m&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_find_first predicate vector</pre> This function returns <code class="code">-1</code> if it does not find:
<p>

Cette fonction retourne <code class="code">-1</code> s'il ne trouve pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_find_first&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(p:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;bool)&nbsp;(v:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">and</span>&nbsp;index&nbsp;=&nbsp;ref&nbsp;(-1)&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;&nbsp;!i&nbsp;&lt;&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;p&nbsp;v.(!i)&nbsp;<span class="keyword">then</span>&nbsp;(index&nbsp;:=&nbsp;!i&nbsp;;&nbsp;i&nbsp;:=&nbsp;r)&nbsp;<span class="keyword">else</span>&nbsp;i&nbsp;:=&nbsp;!i&nbsp;+&nbsp;1&nbsp;;&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!index&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_find_last predicate vector</pre> This function returns <code class="code">-1</code> if it does not find:
<p>

Cette fonction retourne <code class="code">-1</code> s'il ne trouve pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_find_last&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(p:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;bool)&nbsp;(v:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">and</span>&nbsp;index&nbsp;=&nbsp;ref&nbsp;(-1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;(&nbsp;pred&nbsp;r&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;&nbsp;!i&nbsp;&gt;=&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;p&nbsp;v.(!i)&nbsp;<span class="keyword">then</span>&nbsp;(index&nbsp;:=&nbsp;!i&nbsp;;&nbsp;i&nbsp;:=&nbsp;-1)&nbsp;<span class="keyword">else</span>&nbsp;i&nbsp;:=&nbsp;!i&nbsp;-&nbsp;1&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!index&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_find_last equality element vector</pre> vector_find_last returns <code class="code">-1</code> if it does not find:
<p>

vector_find_last retourne <code class="code">-1</code> s'il ne trouve pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_find_last&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;eq&nbsp;x&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">and</span>&nbsp;index&nbsp;=&nbsp;ref&nbsp;(-1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;(r&nbsp;-&nbsp;1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;&nbsp;!i&nbsp;&gt;=&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq&nbsp;x&nbsp;v.(!i)&nbsp;<span class="keyword">then</span>&nbsp;(index&nbsp;:=&nbsp;!i&nbsp;;&nbsp;i&nbsp;:=&nbsp;-1)&nbsp;<span class="keyword">else</span>&nbsp;i&nbsp;:=&nbsp;!i&nbsp;-&nbsp;1&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!index&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_find_first equality element vector</pre> vector_find_first returns <code class="code">-1</code> if it does not find:
<p>

vector_find_first retourne <code class="code">-1</code> s'il ne trouve pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_find_first&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;eq&nbsp;x&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">and</span>&nbsp;index&nbsp;=&nbsp;ref&nbsp;(-1)&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;&nbsp;!i&nbsp;&lt;&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq&nbsp;x&nbsp;v.(!i)&nbsp;<span class="keyword">then</span>&nbsp;(index&nbsp;:=&nbsp;!i&nbsp;;&nbsp;i&nbsp;:=&nbsp;r)&nbsp;<span class="keyword">else</span>&nbsp;i&nbsp;:=&nbsp;!i&nbsp;+&nbsp;1&nbsp;;&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;!index&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_find_twin equality element vector</pre> vector_find_first returns <code class="code">-1</code> if it does not find:
<p>

vector_find_twin retourne <code class="code">-1</code> s'il ne trouve pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_find_twin&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;eq&nbsp;x&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">and</span>&nbsp;index&nbsp;=&nbsp;ref&nbsp;(-1)&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;&nbsp;!i&nbsp;&lt;=&nbsp;int_min&nbsp;(r&nbsp;-&nbsp;1)&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;ceil&nbsp;(&nbsp;(float&nbsp;r)&nbsp;/.&nbsp;2.&nbsp;)&nbsp;)&nbsp;)&nbsp;&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;=&nbsp;v.(!i)&nbsp;<span class="keyword">then</span>&nbsp;(index&nbsp;:=&nbsp;!i&nbsp;;&nbsp;i&nbsp;:=&nbsp;1&nbsp;+&nbsp;r)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;j&nbsp;=&nbsp;r&nbsp;-&nbsp;1&nbsp;-&nbsp;!i&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq&nbsp;x&nbsp;v.(j)&nbsp;<span class="keyword">then</span>&nbsp;(index&nbsp;:=&nbsp;j&nbsp;;&nbsp;i&nbsp;:=&nbsp;1&nbsp;+&nbsp;r)&nbsp;<span class="keyword">else</span>&nbsp;i&nbsp;:=&nbsp;!i&nbsp;+&nbsp;1&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;!index&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_find_all equality element vector</pre> vector_find_all returns <code class="code">[||]</code>  if it does not find:
<p>

vector_find_all retourne <code class="code">[||]</code> s'il ne trouve pas.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_find_all&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;eq&nbsp;x&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">and</span>&nbsp;index&nbsp;=&nbsp;ref&nbsp;[||]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;eq&nbsp;x&nbsp;v.(i)&nbsp;<span class="keyword">then</span>&nbsp;(index&nbsp;:=&nbsp;<span class="constructor">Array</span>.append&nbsp;!index&nbsp;[|i|]&nbsp;;&nbsp;())<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;!index&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_filter predicate vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_filter&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(p:int&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;bool)&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;result&nbsp;=&nbsp;ref&nbsp;[]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;p&nbsp;i&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;(&nbsp;i&nbsp;,&nbsp;v.(i)&nbsp;)&nbsp;::&nbsp;!result<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!result&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>list_accumulate first_factor_comparison second_factor_addition combined_element ordered_combined_list</pre> The list <code class="code">lis</code> is supposed
to be sorted according to <code class="code">cmp</code> with respect to the first factors.
<p>

La liste <code class="code">lis</code> est supposée triée selon <code class="code">cmp</code> par rapport aux premiers facteurs. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;list_accumulate&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(add:<span class="keywordsign">'</span>b&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>b&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>b)&nbsp;((&nbsp;i&nbsp;,&nbsp;x&nbsp;)&nbsp;<span class="keyword">as</span>&nbsp;y:<span class="keywordsign">'</span>a&nbsp;*&nbsp;<span class="keywordsign">'</span>b)&nbsp;(lis:(<span class="keywordsign">'</span>a&nbsp;*&nbsp;<span class="keywordsign">'</span>b)&nbsp;list)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;cmp&nbsp;i&nbsp;(&nbsp;fst&nbsp;z&nbsp;)&nbsp;=&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;comparison&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;z&nbsp;zz&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;cmp&nbsp;(&nbsp;fst&nbsp;z&nbsp;)&nbsp;(&nbsp;fst&nbsp;zz&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;add_ad_hoc&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;b&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;fst&nbsp;a&nbsp;,&nbsp;add&nbsp;(&nbsp;snd&nbsp;a&nbsp;)&nbsp;(&nbsp;snd&nbsp;b&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;(&nbsp;with_i&nbsp;,&nbsp;without_i&nbsp;)&nbsp;=&nbsp;<span class="constructor">List</span>.partition&nbsp;p&nbsp;lis&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">List</span>.fold_left&nbsp;add_ad_hoc&nbsp;y&nbsp;with_i&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">List</span>.merge&nbsp;comparison&nbsp;[&nbsp;z&nbsp;]&nbsp;without_i&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The collision functions take two ordered families Y and Z into argument and provide four such ones.
The first value is Y \ Z and the second is Z \ Y and the third is Y inter Z as seen from Y, the last is Y inter Z as seen from Z.
The order is either globally reversed or globally respected. A total preorder is enough.
These functions are tail-recursive.
<p>

Les fonctions de collisions prennent deux familles ordonnées Y et Z en argument et en renvoient quatre.
La première valeur est Y \ Z, la deuxième est Z \ Y, la troisième est Y inter Z vu par Y et la dernière est Y inter Z vu par Z.
L'ordre est soit globalement renversé soit globalement respecté. Un préordre total suffit.
Ces fonctions sont récursives terminales. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>list_collision_aux comparison accumulator list1 list2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;list_collision_aux&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(accu:<span class="keywordsign">'</span>a&nbsp;list&nbsp;array)&nbsp;(y:<span class="keywordsign">'</span>a&nbsp;list)&nbsp;(z:<span class="keywordsign">'</span>a&nbsp;list)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;list_is_empty&nbsp;y&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;(&nbsp;list_is_empty&nbsp;z&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;[|&nbsp;<span class="constructor">List</span>.append&nbsp;y&nbsp;accu.(0)&nbsp;;&nbsp;<span class="constructor">List</span>.rev_append&nbsp;z&nbsp;accu.(1)&nbsp;;&nbsp;accu.(2)&nbsp;;&nbsp;accu.(3)&nbsp;|]<br>
&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xy&nbsp;=&nbsp;<span class="constructor">List</span>.hd&nbsp;y<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xz&nbsp;=&nbsp;<span class="constructor">List</span>.hd&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;cmp&nbsp;xy&nbsp;xz&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;list_collision_aux&nbsp;cmp&nbsp;[|&nbsp;accu.(0)&nbsp;;&nbsp;accu.(1)&nbsp;;&nbsp;xy&nbsp;::&nbsp;accu.(2)&nbsp;;&nbsp;xz&nbsp;::&nbsp;accu.(3)|]&nbsp;(&nbsp;<span class="constructor">List</span>.tl&nbsp;y&nbsp;)&nbsp;(&nbsp;<span class="constructor">List</span>.tl&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;list_collision_aux&nbsp;cmp&nbsp;[|&nbsp;accu.(0)&nbsp;;&nbsp;xz&nbsp;::&nbsp;accu.(1)&nbsp;;&nbsp;accu.(2)&nbsp;;&nbsp;accu.(3)&nbsp;|]&nbsp;y&nbsp;(&nbsp;<span class="constructor">List</span>.tl&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;list_collision_aux&nbsp;cmp&nbsp;[|&nbsp;xy&nbsp;::&nbsp;accu.(0)&nbsp;;&nbsp;accu.(1)&nbsp;;&nbsp;accu.(2)&nbsp;;&nbsp;accu.(3)&nbsp;|]&nbsp;(&nbsp;<span class="constructor">List</span>.tl&nbsp;y&nbsp;)&nbsp;z<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>reverse_list_collision comparison list1 list2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;reverse_list_collision&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(y:<span class="keywordsign">'</span>a&nbsp;list)&nbsp;(z:<span class="keywordsign">'</span>a&nbsp;list)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;cmp&nbsp;y&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">List</span>.fast_sort&nbsp;c&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;f&nbsp;(&nbsp;list_collision_aux&nbsp;cmp&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;4&nbsp;[]&nbsp;)&nbsp;y&nbsp;z&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>list_collision comparison list1 list2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;list_collision&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(y:<span class="keywordsign">'</span>a&nbsp;list)&nbsp;(z:<span class="keywordsign">'</span>a&nbsp;list)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">List</span>.rev&nbsp;(&nbsp;reverse_list_collision&nbsp;cmp&nbsp;y&nbsp;z&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>reverse_array_collision comparison array1 array2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;reverse_array_collision&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(y:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;(z:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Array</span>.of_list&nbsp;(&nbsp;reverse_list_collision&nbsp;cmp&nbsp;(&nbsp;<span class="constructor">Array</span>.to_list&nbsp;y&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.to_list&nbsp;z&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_collision comparison array1 array2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_collision&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(cmp:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int)&nbsp;(y:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;(z:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Array</span>.of_list&nbsp;(&nbsp;<span class="constructor">List</span>.rev&nbsp;x&nbsp;)&nbsp;)&nbsp;(&nbsp;reverse_list_collision&nbsp;cmp&nbsp;(&nbsp;<span class="constructor">Array</span>.to_list&nbsp;y&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.to_list&nbsp;z&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>transpose matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;transpose&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;m&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;r&nbsp;=&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;(&nbsp;c&nbsp;=&nbsp;0&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;[|&nbsp;[|&nbsp;|]&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;c&nbsp;r&nbsp;m.(0).(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;rr&nbsp;=&nbsp;pred&nbsp;r&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;c&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_output&nbsp;=&nbsp;mm.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(j)&nbsp;&lt;-&nbsp;m.(j).(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mm<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_first</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_first&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;a&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;a.(0)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_last array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_last&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;a&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Empty&nbsp;array&nbsp;in&nbsp;Util.array_last."</span>&nbsp;;<br>
&nbsp;a.(&nbsp;pred&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_tail array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_tail&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.sub&nbsp;a&nbsp;1&nbsp;(&nbsp;pred&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_end index array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_end&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(i:int)&nbsp;(a:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;)&nbsp;-&nbsp;i&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.sub&nbsp;a&nbsp;i&nbsp;r<br>
&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_forget index array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_forget&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(k:int)&nbsp;(a:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;k&nbsp;&lt;&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;(&nbsp;k&nbsp;&gt;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;index&nbsp;in&nbsp;Util.array_forget."</span>&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">Array</span>.sub&nbsp;a&nbsp;0&nbsp;k<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;array_end&nbsp;(&nbsp;succ&nbsp;k&nbsp;)&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Array</span>.append&nbsp;b&nbsp;c&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_insert index value array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_insert&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(k:int)&nbsp;(x:<span class="keywordsign">'</span>a)&nbsp;(a:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">Array</span>.sub&nbsp;a&nbsp;0&nbsp;k<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;array_end&nbsp;k&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.concat&nbsp;[&nbsp;b&nbsp;;&nbsp;[|&nbsp;x&nbsp;|]&nbsp;;&nbsp;c&nbsp;]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_cut table array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_cut&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(table:int&nbsp;array)&nbsp;(a:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;rr&nbsp;=&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;+&nbsp;)&nbsp;0&nbsp;table&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;&lt;&nbsp;rr&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Array&nbsp;of&nbsp;bad&nbsp;length&nbsp;in&nbsp;Util.array_cut."</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;table<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;0&nbsp;a.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;shift&nbsp;=&nbsp;table.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Array</span>.sub&nbsp;a&nbsp;!accu&nbsp;shift&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+&nbsp;shift&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_guarded_cut thickness table array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_guarded_cut&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(e:int)&nbsp;(table:int&nbsp;array)&nbsp;(a:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;table<br>
&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;e&nbsp;=&nbsp;0&nbsp;<span class="keyword">then</span>&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;1&nbsp;)&nbsp;a<br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;0&nbsp;a.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;!i&nbsp;&lt;&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;shift&nbsp;=&nbsp;table.(!i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.(!i)&nbsp;&lt;-&nbsp;<span class="constructor">Array</span>.sub&nbsp;a&nbsp;!accu&nbsp;shift<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.(!i)&nbsp;&lt;-&nbsp;array_end&nbsp;!accu&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+&nbsp;shift&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_cut table array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_cut&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(table:int&nbsp;array)&nbsp;(a:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;rr&nbsp;=&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;+&nbsp;)&nbsp;0&nbsp;table&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;&lt;&nbsp;rr&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Array&nbsp;of&nbsp;bad&nbsp;length&nbsp;in&nbsp;Util.array_cut."</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;table<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;0&nbsp;a.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;shift&nbsp;=&nbsp;table.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Array</span>.sub&nbsp;a&nbsp;!accu&nbsp;shift&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+&nbsp;shift&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_over_cut table array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_over_cut&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(table:int&nbsp;array)&nbsp;(a:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;succ&nbsp;table&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;array_cut&nbsp;t&nbsp;a&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_guarded_over_cut thickness table array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_guarded_over_cut&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(e:int)&nbsp;(table:int&nbsp;array)&nbsp;(a:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;t&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;succ&nbsp;table&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;array_guarded_cut&nbsp;e&nbsp;t&nbsp;a&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_map2 function array1 array2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_map2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;f&nbsp;(a:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;(b:<span class="keywordsign">'</span>b&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">assert</span>&nbsp;(&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;b&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;(&nbsp;f&nbsp;a.(0)&nbsp;b.(0)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;f&nbsp;a.(i)&nbsp;b.(i)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;c&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>array_center_add copy addition array1 array2</pre> The lengths of the arrays are supposed to be odd.
The coefficients are added whith alignment of the center of the arrays.
<p>

Les tailles des tableaux sont supposées impaires. Les coefficients sont additionnés en alignant les centres des tableaux.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;array_center_add&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;copy&nbsp;add&nbsp;(a:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;(b:<span class="keywordsign">'</span>a&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;alength&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;blength&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;b&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;clength&nbsp;=&nbsp;max&nbsp;alength&nbsp;blength<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;(&nbsp;short&nbsp;,&nbsp;long&nbsp;)&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;alength&nbsp;&lt;&nbsp;blength&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;a&nbsp;,&nbsp;b&nbsp;)&nbsp;<span class="keyword">else</span>&nbsp;(&nbsp;b&nbsp;,&nbsp;a&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;shift&nbsp;=&nbsp;(&nbsp;abs&nbsp;(&nbsp;blength&nbsp;-&nbsp;alength&nbsp;)&nbsp;)&nbsp;/&nbsp;2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;clength&nbsp;a.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;p_c_l&nbsp;=&nbsp;pred&nbsp;clength&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;shift&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;copy&nbsp;long.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;shift&nbsp;<span class="keyword">to</span>&nbsp;p_c_l&nbsp;-&nbsp;shift&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;add&nbsp;long.(i)&nbsp;short.(&nbsp;i&nbsp;-&nbsp;shift&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;clength&nbsp;-&nbsp;shift&nbsp;<span class="keyword">to</span>&nbsp;p_c_l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;copy&nbsp;long.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_spray integer vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_spray&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;a&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;l&nbsp;<span class="keyword">mod</span>&nbsp;n&nbsp;!=&nbsp;0&nbsp;)&nbsp;<span class="keywordsign">||</span>&nbsp;(&nbsp;l&nbsp;&lt;&nbsp;n&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Problem&nbsp;of&nbsp;length&nbsp;in&nbsp;Readwrite.vector_spray."</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;/&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;lll&nbsp;=&nbsp;pred&nbsp;ll<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;n&nbsp;ll&nbsp;a.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_output&nbsp;=&nbsp;m.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;lll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(j)&nbsp;&lt;-&nbsp;a.(&nbsp;i&nbsp;+&nbsp;j&nbsp;*&nbsp;n&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_interlace vector_array</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_interlace&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;a&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ll&nbsp;=&nbsp;n&nbsp;*&nbsp;l&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;ll&nbsp;a.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v.(i)&nbsp;&lt;-&nbsp;a.(&nbsp;i&nbsp;<span class="keyword">mod</span>&nbsp;n&nbsp;).(&nbsp;i&nbsp;/&nbsp;n&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_to_matrix rows columns vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_to_matrix&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(r:int)&nbsp;(c:int)&nbsp;a&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;l&nbsp;!=&nbsp;r&nbsp;*&nbsp;c&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;dimensions&nbsp;in&nbsp;Readwrite.vector_to_matrix."</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;c&nbsp;a.(0)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;pred&nbsp;c&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;r&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_output&nbsp;=&nbsp;m.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ii&nbsp;=&nbsp;c&nbsp;*&nbsp;i&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(j)&nbsp;&lt;-&nbsp;a.(&nbsp;ii&nbsp;+&nbsp;j&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;m&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Numration"><h1>Numération</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>bits_of_byte int_byte</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;bits_of_byte&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;x&nbsp;<span class="keyword">land</span>&nbsp;y&nbsp;)&nbsp;&lt;&gt;&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;[|&nbsp;128&nbsp;;&nbsp;64&nbsp;;&nbsp;32&nbsp;;&nbsp;16&nbsp;;&nbsp;8&nbsp;;&nbsp;4&nbsp;;&nbsp;2&nbsp;;&nbsp;1&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_bits_of_byte int_byte</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_bits_of_byte&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;<span class="keyword">then</span>&nbsp;1&nbsp;<span class="keyword">else</span>&nbsp;0&nbsp;)&nbsp;(&nbsp;bits_of_byte&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>reverse_int_sequence integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;reverse_int_sequence&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;succ&nbsp;n&nbsp;)&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;a.(i)&nbsp;&lt;-&nbsp;n&nbsp;-&nbsp;i<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;a&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>standard_reverse_int_sequence</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;standard_reverse_int_sequence&nbsp;=&nbsp;reverse_int_sequence&nbsp;62&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>standard_reverse_binary_powers_sequence</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;standard_reverse_binary_powers_sequence&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int_power&nbsp;x&nbsp;2&nbsp;)&nbsp;standard_reverse_int_sequence&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_sequence integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_sequence&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;succ&nbsp;n&nbsp;)&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;a.(i)&nbsp;&lt;-&nbsp;i<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;a&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>standard_int_sequence</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;standard_int_sequence&nbsp;=&nbsp;int_sequence&nbsp;62&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>binary_powers_sequence integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;binary_powers_sequence&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int_power&nbsp;x&nbsp;2&nbsp;)&nbsp;(&nbsp;int_sequence&nbsp;n&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>standard_binary_powers_sequence</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;standard_binary_powers_sequence&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int_power&nbsp;x&nbsp;2&nbsp;)&nbsp;standard_int_sequence&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>bits_of_int integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;bits_of_int&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;x&nbsp;<span class="keyword">land</span>&nbsp;y&nbsp;)&nbsp;&lt;&gt;&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;standard_reverse_binary_powers_sequence&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>next_binary_exponent integer</pre> This functions shifts from one unit if the integer is a power of two.
<p>

Cette fonction décale d'un cran si l'entier est une puissance de deux. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;next_binary_exponent&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;bits_of_int&nbsp;(&nbsp;abs&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;b<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;result&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;!i&nbsp;&lt;&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;b.(!i)&nbsp;&lt;&gt;&nbsp;<span class="keyword">false</span>&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;n&nbsp;-&nbsp;!i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;n&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;!result&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>truncated_bits_of_int exponent integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;truncated_bits_of_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;x&nbsp;<span class="keyword">land</span>&nbsp;y&nbsp;)&nbsp;&lt;&gt;&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;sequence&nbsp;=&nbsp;array_end&nbsp;(&nbsp;63&nbsp;-&nbsp;n&nbsp;)&nbsp;standard_reverse_binary_powers_sequence&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;sequence&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_bits_of_int integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_bits_of_int&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;<span class="keyword">then</span>&nbsp;1&nbsp;<span class="keyword">else</span>&nbsp;0&nbsp;)&nbsp;(&nbsp;bits_of_int&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>truncated_int_bits_of_int exponent integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;truncated_int_bits_of_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;<span class="keyword">then</span>&nbsp;1&nbsp;<span class="keyword">else</span>&nbsp;0&nbsp;)&nbsp;(&nbsp;truncated_bits_of_int&nbsp;n&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>digits_of_int radix integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;digits_of_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(p:int)&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">assert</span>&nbsp;(&nbsp;x&nbsp;&gt;&nbsp;0&nbsp;)&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;[]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;!y&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;remain&nbsp;=&nbsp;!y&nbsp;<span class="keyword">mod</span>&nbsp;p&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;(&nbsp;!y&nbsp;-&nbsp;remain&nbsp;)&nbsp;/&nbsp;p&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;remain&nbsp;::&nbsp;!accu&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Array</span>.of_list&nbsp;!accu&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>truncated_digits_of_int radix exponent integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;truncated_digits_of_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(p:int)&nbsp;(n:int)&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">assert</span>&nbsp;(&nbsp;x&nbsp;&gt;=&nbsp;0&nbsp;)&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;i&nbsp;=&nbsp;ref&nbsp;(&nbsp;pred&nbsp;n&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;n&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;!y&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;remain&nbsp;=&nbsp;!y&nbsp;<span class="keyword">mod</span>&nbsp;p&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;(&nbsp;!y&nbsp;-&nbsp;remain&nbsp;)&nbsp;/&nbsp;p&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(!i)&nbsp;&lt;-&nbsp;remain&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decr&nbsp;i&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;()<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>naive_reverse_int_of_bits bool_bits</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;naive_reverse_int_of_bits&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:bool&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;(&nbsp;<span class="keyword">fun</span>&nbsp;i&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;<span class="keyword">then</span>&nbsp;int_power&nbsp;i&nbsp;2&nbsp;<span class="keyword">else</span>&nbsp;0&nbsp;)&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;(&nbsp;+&nbsp;)&nbsp;0&nbsp;b&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>reverse_int_of_bits bool_bits</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;reverse_int_of_bits&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:bool&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;naive_reverse_int_of_bits&nbsp;a&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>naive_int_of_bits bool_bits</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;naive_int_of_bits&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:bool&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;reverse_array&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;reverse_int_of_bits&nbsp;b&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>other_int_of_bits bool_bits</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;other_int_of_bits&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:bool&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;pred&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sequence&nbsp;=&nbsp;array_end&nbsp;(&nbsp;62&nbsp;-&nbsp;n&nbsp;)&nbsp;standard_reverse_binary_powers_sequence&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;a.(i)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+&nbsp;sequence.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_of_bits bool_bits</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_of_bits&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(a:bool&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;pred&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;a.(i)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;incr&nbsp;accu&nbsp;;<br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;2&nbsp;*&nbsp;!accu&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;a.(n)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;incr&nbsp;accu&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_of_digits radix integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_of_digits&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(p:int)&nbsp;(a:int&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;pred&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;digit&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;digit&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+&nbsp;digit&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;p&nbsp;*&nbsp;!accu&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;digit&nbsp;=&nbsp;a.(n)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;digit&nbsp;&gt;&nbsp;0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+&nbsp;digit&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>bit_reversal integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;bit_reversal&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;bits_of_int&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;reverse_array&nbsp;a&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;int_of_bits&nbsp;b&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>truncated_bit_reversal exponent integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;truncated_bit_reversal&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;truncated_bits_of_int&nbsp;n&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;reverse_array&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;int_of_bits&nbsp;b&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>digit_reversal radix integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;digit_reversal&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(p:int)&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;digits_of_int&nbsp;p&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;reverse_array&nbsp;a&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;int_of_digits&nbsp;p&nbsp;b&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>truncated_digit_reversal radix exponent integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;truncated_digit_reversal&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(p:int)&nbsp;(n:int)&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;truncated_digits_of_int&nbsp;p&nbsp;n&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;reverse_array&nbsp;a&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;int_of_digits&nbsp;p&nbsp;b&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ § § </center> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">end</span></code></body></html>