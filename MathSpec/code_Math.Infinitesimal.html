<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Math" rel="Chapter" href="Math.html"><title>Math.Infinitesimal</title>
</head>
<body>
<code class="code"><span class="keyword">struct</span><br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Introduction"><h1>Introduction</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(**
The mathematician will find in this module methods in order to:
<p>
<ul>
<li>calculate derivatives of functions and samples,</li>
</ul>
<ul>
<li>calculate Serret-Frenet frames and multi-curvatures of whatever parameterized or sampled curves,</li>
</ul>
<ul>
<li>calculate curvature of surfaces embedded in R^3,</li>
</ul>
<ul>
<li>interpolate samples,</li>
</ul>
<ul>
<li>calculate zeros of functions,</li>
</ul>
<ul>
<li>calculate critical points of functions,</li>
</ul>
<ul>
<li>calculate integrals of functions and samples,</li>
</ul>
<ul>
<li>calculate transforms of functions and samples,</li>
</ul>
<ul>
<li>solve ordinary differential equations,</li>
</ul>
<ul>
<li>calculate the exponential of a real square matrix.</li>
</ul>

Thanks to curryfication, the mathematician will be able to multiply and complexify the variants of calculus methods ad libitum and therefore to chose various tradeoffs between speed and accuracy.
<p>

<span id="2_Conventions"><h2>Conventions</h2></span>
<p>

Vectors are rows of scalars (<code class="code">float</code> or <code class="code">int</code>), of type <code class="code">float array</code> or <code class="code">int array</code>.
<p>

A (bidimensional) matrix is a row vector,
each element of which being a row of the matrix.
Matrices are of type <code class="code">float array array</code> or <code class="code">int array array</code>.
<p>

<span id="2_Warning"><h2>Warning</h2></span>
<p>

When using local inversion, an exception probably means that some process 
of local inversion passed through a critical point.
The problem may arise during search of zeros or of critical points.
In this case, the start point has to be changed, or some method of zero finding 
should differentiate up to a lower order, or some parameters have to be tuned.
Sometimes diminishing the maximum number of steps might avoid the difficulty.
<p>

<span id="2_Sources"><h2>Sources</h2></span>
<p>

Most of the data and algorithms have been harvested on the internet.
Among the sites, one may quote <code class="code">wikipedia.org</code> about the derivatives, the ordinary differential equations, the miscellaneous transforms
and <code class="code">http://people.sc.fsu.edu/~jburkardt</code> and ACM algorithms <code class="code">http://www.netlib.org/toms/index.html</code> about integration.
For the differential calculus, much comes from E. Ramis, C. Deschamps, J. Odoux : Cours de mathématiques spéciales tome 5, Masson, Paris 1981 ;
J Lelong_Ferrand, J.-M. Arnaudiès : Cours de mathématiques tome 3, Dunod, Paris.
For elliptic integrals, the definitions follow V. Prasolov, Y. Solovyev : Elliptic functions and elliptic integrals, AMS mathematical monographs, Providence 1997.
For the distributions, the curious reader will find a study of the links with the lambda-calculus in O. P. Misra : Distribution htoery in computer science, SCI TECH publishing, Houston 2002 ;
nevertheless we limit ourselves to the definitions of L. Schwartz : Théorie des distributions, Hermann, Paris 1966.
<p>

This module is distributed under the same licence as Ocaml.
<p>

<center>§ </center>
<p>

La mathématicienne ou le mathématicien trouvera dans ce module des méthodes pour :
<p>
<ul>
<li>calculer des dérivées de fonctions et d'échantillons,</li>
</ul>
<ul>
<li>calculer des repères de Serret-Frenet et multicourbures sur des courbes qu'elles soient paramétrées ou échantillonnées,</li>
</ul>
<ul>
<li>calculer des courbures de surfaces plongées dans R^3,</li>
</ul>
<ul>
<li>interpoler des échantillons,</li>
</ul>
<ul>
<li>calculer des points d'annulations de fonctions,</li>
</ul>
<ul>
<li>calculer des points critiques de fonctions,</li>
</ul>
<ul>
<li>calculer des intégrales de fonctions et d'échantillons,</li>
</ul>
<ul>
<li>calculer des transformées de fonctions et d'échantillons,</li>
</ul>
<ul>
<li>résoudre des équations différentielles ordinaires,</li>
</ul>
<ul>
<li>calculer l'exponentielle d'une matrice carrée réelle.</li>
</ul>

Grâce à la curryfication, le mathématicien ou la mathématicienne pourra multiplier et complexifier les variantes de méthodes de calcul à volonté, et donc choisir différents compromis entre vitesse et précision.
<p>

<span id="2_Conventions"><h2>Conventions</h2></span>
<p>

Les vecteurs sont des lignes de scalaires (<code class="code">float</code> ou <code class="code">int</code>), de type <code class="code">float array</code> ou <code class="code">int array</code>.
<p>

Une matrice (bidimensionnelle) est un vecteur ligne 
dont chaque élément est une ligne de la matrice. 
Les matrices sont de type <code class="code">float array array</code> ou <code class="code">int array array</code>.
<p>

<span id="2_Avertissement"><h2>Avertissement</h2></span>
<p>

En utilisant des inversions locales, une exception signifie probablement 
qu'un procédé d'inversion locale est passé par un point critique.
Le problème peut se produire aussi pendant la recherhe d'un zéro ou d'un point critique.
Dans ce cas, il faut changer le point de départ, ou prendre une méthode de recherche de zéro
qui dérive moins, ou ajuster divers paramètres.
Parfois, diminuer le nombre maximal de pas suffit à contourner la difficulté.
<p>

<span id="2_Sources"><h2>Sources</h2></span>
<p>

La plupart des données et algorithmes ont été glanés sur internet.
Parmi les sites, on peut citer <code class="code">wikipedia.org</code> concernant la dérivation, les équations différentielles ordinaires,
les transformées diverses et <code class="code">http://people.sc.fsu.edu/~jburkardt</code> concernant l'intégration.
Pour le calcul différentiel, beaucoup provient de E. Ramis, C. Deschamps, J. Odoux : Cours de mathématiques spéciales tome 5, Masson, Paris 1981 ; 
J Lelong_Ferrand, J.-M. Arnaudiès : Cours de mathématiques tome 3, Dunod, Paris .
Pour les intégrales elliptiques, les définitions suivent V. Prasolov, Y. Solovyev : Elliptic functions and elliptic integrals, AMS mathematical monographs, Providence 1997.
Pour les distributions, le lecteur curieux trouvera une étude des liens avec le lambda-calcul dans O. P. Misra : Distribution htoery in computer science, SCI TECH publishing, Houston 2002 ;
néanmoins nous nous limitons aux définitions de L. Schwartz : Théorie des distributions, Hermann, Paris 1966.
<p>

Ce module est distribué selon la même licence qu'Ocaml.
<p>

<center>Copyright Stéphane Grognet </center>
<center>Laboratoire de mathématiques Jean Leray UMR 6629 CNRS </center>
<center>Fédération de recherche mathématique des Pays de la Loire </center>
<center>IREM des Pays de la Loire - Université de Nantes </center>
<center>version 0.4</center>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@version 0.4
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@author Stéphane Grognet
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(**
@since 2011, 2012, 2013
*)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Constructions"><h1>Constructions</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Util</span>&nbsp;;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Matrix</span>&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Constantes"><h2>Constantes</h2></span>
<span id="2_Constants"><h2>Constants</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;sqrt_of_2&nbsp;=&nbsp;sqrt&nbsp;2.&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;sqrt_of_3&nbsp;=&nbsp;sqrt&nbsp;3.&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;sqrt_of_5&nbsp;=&nbsp;sqrt&nbsp;5.&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;sqrt_of_6&nbsp;=&nbsp;sqrt&nbsp;6.&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;sqrt_of_15&nbsp;=&nbsp;sqrt&nbsp;15.&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;inv_sqrt_of_2&nbsp;=&nbsp;1.&nbsp;/.&nbsp;sqrt&nbsp;2.&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;inv_sqrt_of_3&nbsp;=&nbsp;1.&nbsp;/.&nbsp;sqrt&nbsp;3.&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;pi&nbsp;=&nbsp;atan2&nbsp;0.&nbsp;(-1.)&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;halfpi&nbsp;=&nbsp;atan2&nbsp;1.&nbsp;0.&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;quarterpi&nbsp;=&nbsp;atan&nbsp;1.&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;doublepi&nbsp;=&nbsp;2.&nbsp;*.&nbsp;atan2&nbsp;0.&nbsp;(-1.)&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;inv_sqrt_pi&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;sqrt&nbsp;pi&nbsp;)&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;inv_doublepi&nbsp;=&nbsp;1.&nbsp;/.&nbsp;doublepi&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;inv_sqrt_doublepi&nbsp;=&nbsp;sqrt&nbsp;inv_doublepi&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;log_of_2&nbsp;=&nbsp;log&nbsp;2.&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctions"><h2>Fonctions</h2></span>
<span id="2_Functions"><h2>Functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>heaviside_step float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;heaviside_step&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;x&nbsp;-.&nbsp;abs_float&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0.&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1.<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;0.&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>unit_bowl_indic vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;unit_bowl_indic&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;heaviside_step&nbsp;(&nbsp;1.&nbsp;-.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;x&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>bowl_indic center radius vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;bowl_indic&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x0:float&nbsp;array)&nbsp;(r:float)&nbsp;(x:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;x&nbsp;x0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;r&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;unit_bowl_indic&nbsp;(&nbsp;y&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_sign float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_sign&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;float&nbsp;(&nbsp;compare&nbsp;x&nbsp;0.&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>int_sign float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;int_sign&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;compare&nbsp;x&nbsp;0&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>low_stirling real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;low_stirling&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;sqrt&nbsp;(&nbsp;doublepi&nbsp;*.&nbsp;x&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;x&nbsp;*.&nbsp;(&nbsp;(&nbsp;log&nbsp;x&nbsp;)&nbsp;-.&nbsp;1.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;a&nbsp;*.&nbsp;exp&nbsp;b&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>up_stirling real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;up_stirling&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;sqrt&nbsp;(&nbsp;doublepi&nbsp;*.&nbsp;x&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;x&nbsp;*.&nbsp;(&nbsp;(&nbsp;log&nbsp;x&nbsp;)&nbsp;-.&nbsp;1.&nbsp;)&nbsp;+.&nbsp;1.&nbsp;/.&nbsp;(&nbsp;12.&nbsp;*.&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;a&nbsp;*.&nbsp;exp&nbsp;b&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>stirling_bis</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;stirling_bis&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;sqrt&nbsp;(&nbsp;doublepi&nbsp;*.&nbsp;x&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;x&nbsp;*.&nbsp;(&nbsp;(&nbsp;log&nbsp;x&nbsp;)&nbsp;-.&nbsp;1.&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;12.&nbsp;*.&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;1.&nbsp;+.&nbsp;y&nbsp;*.&nbsp;(&nbsp;1.&nbsp;+.&nbsp;y&nbsp;*.&nbsp;(&nbsp;0.5&nbsp;-.&nbsp;y&nbsp;*.&nbsp;(&nbsp;139.&nbsp;+.&nbsp;y&nbsp;*.&nbsp;571.&nbsp;/.&nbsp;4.&nbsp;)&nbsp;/.&nbsp;30.&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;a&nbsp;*.&nbsp;c&nbsp;*.&nbsp;exp&nbsp;b&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>half_unit_circle float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;half_unit_circle&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sqrt&nbsp;(&nbsp;1.&nbsp;-.&nbsp;x&nbsp;*.&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>gauss_bell float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;gauss_bell&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;exp&nbsp;(&nbsp;-.&nbsp;x&nbsp;*.&nbsp;x&nbsp;/.&nbsp;2.&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sin_inv float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sin_inv&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0.&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;0.<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sin&nbsp;(1.&nbsp;/.&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sinc float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sinc&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0.&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1.<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;sin&nbsp;x&nbsp;)&nbsp;/.&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>nsinc float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;nsinc&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0.&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1.<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;pi&nbsp;*.&nbsp;x&nbsp;<span class="keyword">in</span>&nbsp;(&nbsp;sin&nbsp;xx&nbsp;)&nbsp;/.&nbsp;xx&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>real_float_solve_degree_2 a b c</pre> Gives the two solutions of <code class="code">a x ^ 2 + b x + c = 0</code>.
<p>

Donne les deux solutions x de <code class="code">a x ^ 2 + b x + c = 0</code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;real_float_solve_degree_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float)&nbsp;(b:float)&nbsp;(c:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;bb&nbsp;=&nbsp;b&nbsp;/.&nbsp;(-2.)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;delta&nbsp;=&nbsp;bb&nbsp;*.&nbsp;bb&nbsp;-.&nbsp;a&nbsp;*.&nbsp;c&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;delta&nbsp;&lt;&nbsp;0.&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Strictly&nbsp;negative&nbsp;discriminant&nbsp;in&nbsp;Infinitesimal.real_float_solve_degree_2."</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">let</span>&nbsp;dd&nbsp;=&nbsp;sqrt&nbsp;delta&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;(&nbsp;bb&nbsp;+.&nbsp;dd&nbsp;)&nbsp;/.&nbsp;a&nbsp;;&nbsp;(&nbsp;bb&nbsp;-.&nbsp;dd&nbsp;)&nbsp;/.&nbsp;a&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>unit_circle angle</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;unit_circle&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;cos&nbsp;x&nbsp;;&nbsp;sin&nbsp;x&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>ellipse a b t</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;ellipse&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float)&nbsp;(b:float)&nbsp;(t:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;[|&nbsp;a&nbsp;*.&nbsp;(&nbsp;cos&nbsp;t&nbsp;)&nbsp;;&nbsp;b&nbsp;*.&nbsp;(&nbsp;sin&nbsp;t&nbsp;)&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>hyperbola a b t</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;hyperbola&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float)&nbsp;(b:float)&nbsp;(t:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;[|&nbsp;a&nbsp;*.&nbsp;(&nbsp;cosh&nbsp;t&nbsp;)&nbsp;;&nbsp;b&nbsp;*.&nbsp;(&nbsp;sinh&nbsp;t&nbsp;)&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>polar_curve function angle</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;polar_curve&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(r:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(angle:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;[|&nbsp;(&nbsp;r&nbsp;angle&nbsp;)&nbsp;*.&nbsp;(&nbsp;cos&nbsp;angle&nbsp;)&nbsp;;&nbsp;(&nbsp;r&nbsp;angle&nbsp;)&nbsp;*.&nbsp;(&nbsp;sin&nbsp;angle&nbsp;)&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>polar_curve_bis function angle</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;polar_curve_bis&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(angle:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(r:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;[|&nbsp;r&nbsp;*.&nbsp;cos&nbsp;(&nbsp;angle&nbsp;r&nbsp;)&nbsp;;&nbsp;r&nbsp;*.&nbsp;sin&nbsp;(&nbsp;angle&nbsp;r&nbsp;)&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>rotating_frame function angle</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rotating_frame&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(angle:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;cos&nbsp;angle<br>
&nbsp;<span class="keyword">and</span>&nbsp;s&nbsp;=&nbsp;sin&nbsp;angle&nbsp;<span class="keyword">in</span><br>
&nbsp;[|&nbsp;(&nbsp;v&nbsp;angle&nbsp;).(0)&nbsp;*.&nbsp;c&nbsp;-.&nbsp;(&nbsp;v&nbsp;angle&nbsp;).(1)&nbsp;*.&nbsp;s&nbsp;;<br>
&nbsp;(&nbsp;v&nbsp;angle&nbsp;).(0)&nbsp;*.&nbsp;s&nbsp;+.&nbsp;(&nbsp;v&nbsp;angle&nbsp;).(1)&nbsp;*.&nbsp;c&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>cycloid rotating_radius drawing_radius time</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cycloid&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(rotating_radius:float)&nbsp;(drawing_radius:float)&nbsp;(t:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;[|&nbsp;rotating_radius&nbsp;*.&nbsp;t&nbsp;-.&nbsp;drawing_radius&nbsp;*.&nbsp;sin&nbsp;t&nbsp;;&nbsp;rotating_radius&nbsp;-.&nbsp;drawing_radius&nbsp;*.&nbsp;cos&nbsp;t&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>trochoid big_radius signed_rotating_radius time</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;trochoid&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float)&nbsp;(alpha:float)&nbsp;(t0:float)&nbsp;(b:float)&nbsp;(beta:float)&nbsp;(t1:float)&nbsp;(t:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;a&nbsp;(&nbsp;unit_circle&nbsp;(&nbsp;alpha&nbsp;*.&nbsp;(&nbsp;t&nbsp;-.&nbsp;t0&nbsp;)&nbsp;)&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;b&nbsp;(&nbsp;unit_circle&nbsp;(&nbsp;beta&nbsp;*.&nbsp;(&nbsp;t&nbsp;-.&nbsp;t1&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;v&nbsp;w&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>epicycloid big_radius signed_rotating_radius time</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;epicycloid&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(r:float)&nbsp;(a:float)&nbsp;(t:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;parameter&nbsp;=&nbsp;1.&nbsp;+.&nbsp;r&nbsp;/.&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;parameter&nbsp;(&nbsp;unit_circle&nbsp;t&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;unit_circle&nbsp;(&nbsp;parameter&nbsp;*.&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;a&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;v&nbsp;w&nbsp;)&nbsp;;;<br>
&nbsp;&nbsp;<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>cardioid time</pre> *)</span></td></tr></table><code class="code"><br>
&nbsp;<span class="keyword">let</span>&nbsp;cardioid&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(t:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;epicycloid&nbsp;1.&nbsp;1.&nbsp;t&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>nephroid time</pre> *)</span></td></tr></table><code class="code"><br>
&nbsp;<span class="keyword">let</span>&nbsp;nephroid&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(t:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;epicycloid&nbsp;1.&nbsp;0.5&nbsp;t&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>hypocycloid_3 time</pre> *)</span></td></tr></table><code class="code"><br>
&nbsp;<span class="keyword">let</span>&nbsp;hypocycloid_3&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(t:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;epicycloid&nbsp;3.&nbsp;(-1.)&nbsp;t&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>astroid time</pre> *)</span></td></tr></table><code class="code"><br>
&nbsp;<span class="keyword">let</span>&nbsp;astroid&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(t:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;epicycloid&nbsp;1.&nbsp;(-0.25)&nbsp;t&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>conic excentricity parameter time</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;conic&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(e:float)&nbsp;(p:float)&nbsp;(t:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;p&nbsp;/.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;e&nbsp;*.&nbsp;cos&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;[|&nbsp;r&nbsp;*.&nbsp;cos&nbsp;t&nbsp;;&nbsp;r&nbsp;*.&nbsp;sin&nbsp;t&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>tractrix parameter time</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;tractrix&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float)&nbsp;(t:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;u&nbsp;=&nbsp;t&nbsp;/.&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;[|&nbsp;t&nbsp;-.&nbsp;a&nbsp;*.&nbsp;tanh&nbsp;u&nbsp;;&nbsp;a&nbsp;/.&nbsp;cosh&nbsp;u&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>helicoid radius step float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;helicoid&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float)&nbsp;(b:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;[|&nbsp;a&nbsp;*.&nbsp;cos&nbsp;x&nbsp;;&nbsp;a&nbsp;*.&nbsp;sin&nbsp;x&nbsp;;&nbsp;b&nbsp;*.&nbsp;x&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>spherical_loxodromy radius parameter angle</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;spherical_loxodromy&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(radius:float)&nbsp;(parameter:float)&nbsp;(angle:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;u&nbsp;=&nbsp;parameter&nbsp;*.&nbsp;angle&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;radius&nbsp;/.&nbsp;(&nbsp;cosh&nbsp;u&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;[|&nbsp;r&nbsp;*.&nbsp;cos&nbsp;angle&nbsp;;&nbsp;r&nbsp;*.&nbsp;sin&nbsp;angle&nbsp;;&nbsp;r&nbsp;*.&nbsp;tanh&nbsp;u&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>revolution_surface function parameters</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;revolution_surface&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;angle&nbsp;=&nbsp;v.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;v.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;f&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;[|&nbsp;r&nbsp;*.&nbsp;(&nbsp;cos&nbsp;angle&nbsp;)&nbsp;;&nbsp;r&nbsp;*.&nbsp;(&nbsp;sin&nbsp;angle&nbsp;)&nbsp;;&nbsp;z&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>pseudo_sphere parameters</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;pseudo_sphere&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;angle&nbsp;=&nbsp;v.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;t&nbsp;=&nbsp;v.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;tractrix&nbsp;1.&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;w.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;w.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;r&nbsp;*.&nbsp;cos&nbsp;angle&nbsp;;&nbsp;r&nbsp;*.&nbsp;sin&nbsp;angle&nbsp;;&nbsp;z&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>cyl_coord_unit_sphere parameters</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cyl_coord_unit_sphere&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;v.(0)&nbsp;<span class="keyword">and</span>&nbsp;angle&nbsp;=&nbsp;v.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;[|&nbsp;r&nbsp;*.&nbsp;(&nbsp;cos&nbsp;angle&nbsp;)&nbsp;;&nbsp;r&nbsp;*.&nbsp;(&nbsp;sin&nbsp;angle&nbsp;)&nbsp;;&nbsp;sqrt&nbsp;(&nbsp;1.&nbsp;-.&nbsp;r&nbsp;*.&nbsp;r&nbsp;)&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sph_coord_unit_sphere parameters</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sph_coord_unit_sphere&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;site&nbsp;=&nbsp;v.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;azimut&nbsp;=&nbsp;v.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;cos&nbsp;site&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;[|&nbsp;r&nbsp;*.&nbsp;cos&nbsp;azimut&nbsp;;&nbsp;r&nbsp;*.&nbsp;sin&nbsp;azimut&nbsp;;&nbsp;sin&nbsp;site&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>cyl_coord_ellipsoid a b c parameters</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cyl_coord_ellipsoid&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float)&nbsp;(b:float)&nbsp;(c:float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Matrix</span>.vector_float_coeff_prod&nbsp;[|&nbsp;a&nbsp;;&nbsp;b&nbsp;;&nbsp;c&nbsp;|]&nbsp;(&nbsp;cyl_coord_unit_sphere&nbsp;v&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sph_coord_ellipsoid a b c parameters</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sph_coord_ellipsoid&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float)&nbsp;(b:float)&nbsp;(c:float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="constructor">Matrix</span>.vector_float_coeff_prod&nbsp;[|&nbsp;a&nbsp;;&nbsp;b&nbsp;;&nbsp;c&nbsp;|]&nbsp;(&nbsp;sph_coord_unit_sphere&nbsp;v&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_ellipsoid a b c parameters</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_ellipsoid&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float)&nbsp;(b:float)&nbsp;(c:float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;v.(0)&nbsp;/.&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;v.(1)&nbsp;/.&nbsp;b&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;c&nbsp;*.&nbsp;sqrt&nbsp;(&nbsp;1.&nbsp;-.&nbsp;(&nbsp;x&nbsp;*.&nbsp;x&nbsp;+.&nbsp;y&nbsp;*.&nbsp;y&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>ln float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;ln&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">match</span>&nbsp;x&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0.&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;x&nbsp;-.&nbsp;abs_float&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0.&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;log&nbsp;x&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;log&nbsp;(&nbsp;abs_float&nbsp;x&nbsp;)&nbsp;;&nbsp;pi&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>log_bin float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;log_bin&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;(&nbsp;log&nbsp;x&nbsp;)&nbsp;/.&nbsp;log_of_2&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The four following smoothing functions are symmetric. 
Their derivatives are null in zero up to the order equal to the number in the name minus 1.
They are flat at x=1.
They satisfy to the three following conditions.
<p>

f(0) = 0 ; f(0.5) = 0.5 ; |x| &gt;= 1 ===&gt; f( x ) = 0.
<p>

Les quatre fonctions régularisantes qui suivent sont paires.
Leurs dérivées s'annulent en zéro jusqu'à l'ordre égal au nombre du nom moins un.
Elles sont plates en x=1.
Elles satisfont aux trois conditions précédentes. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_decay_16 real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_decay_16&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;1.95470663435444503&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;x&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;*.&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;*.&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;*.&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;*.&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;exp&nbsp;(&nbsp;-.&nbsp;!y&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_decay_8 real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_decay_8&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;abs_float&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;1.91043901319464093&nbsp;*.&nbsp;xx&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;*.&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;*.&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;*.&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;exp&nbsp;(&nbsp;-.&nbsp;!y&nbsp;*.&nbsp;(&nbsp;exp&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;4.&nbsp;*.&nbsp;xx&nbsp;-.&nbsp;2.&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_decay_4 real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_decay_4&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;abs_float&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;1.82488861156805693&nbsp;*.&nbsp;xx&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;*.&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;*.&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;exp&nbsp;(&nbsp;-.&nbsp;!y&nbsp;*.&nbsp;(&nbsp;exp&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;xx&nbsp;*.&nbsp;(&nbsp;9.&nbsp;*.&nbsp;xx&nbsp;-.&nbsp;4.5&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_decay_2 real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_decay_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;abs_float&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;1.66510922231539538&nbsp;*.&nbsp;xx&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;*.&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;exp&nbsp;(&nbsp;-.&nbsp;!y&nbsp;*.&nbsp;(&nbsp;exp&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;xx&nbsp;*.&nbsp;xx&nbsp;*.&nbsp;(&nbsp;12.&nbsp;*.&nbsp;xx&nbsp;-.&nbsp;6.&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>regular_truncature_right function cliff beach real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;regular_truncature_right&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;a&nbsp;&gt;=&nbsp;b&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;order&nbsp;in&nbsp;Infinitesimal.regular_truncature_right."</span>&nbsp;;<br>
&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&lt;=&nbsp;a&nbsp;<span class="keyword">then</span>&nbsp;1.<br>
&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&gt;=&nbsp;b&nbsp;<span class="keyword">then</span>&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;x&nbsp;-.&nbsp;a&nbsp;)&nbsp;/.&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>regular_truncature_left function cliff beach real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;regular_truncature_left&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;a&nbsp;&gt;=&nbsp;b&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;order&nbsp;in&nbsp;Infinitesimal.regular_truncature_left."</span>&nbsp;;<br>
&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&lt;=&nbsp;a&nbsp;<span class="keyword">then</span>&nbsp;0.<br>
&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&gt;=&nbsp;b&nbsp;<span class="keyword">then</span>&nbsp;1.<br>
&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;f&nbsp;(&nbsp;(&nbsp;b&nbsp;-.&nbsp;x&nbsp;)&nbsp;/.&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>partition_of_1_table function left_foot left_cliff right_cliff right_foot</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;partition_of_1_table&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;(c:float)&nbsp;(d:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;(&nbsp;a&nbsp;&gt;=&nbsp;b&nbsp;)&nbsp;<span class="keyword">or</span>&nbsp;(&nbsp;b&nbsp;&gt;=&nbsp;c&nbsp;)&nbsp;<span class="keyword">or</span>&nbsp;(&nbsp;c&nbsp;&gt;=&nbsp;d&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;order&nbsp;in&nbsp;Infinitesimal.partition_of_1_table."</span>&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;regular_truncature_left&nbsp;f&nbsp;a&nbsp;b&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;regular_truncature_right&nbsp;f&nbsp;c&nbsp;d&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;y&nbsp;*.&nbsp;z&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>partition_of_1_gap function left_cliff left_bottom right_bottom right_cliff</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;partition_of_1_gap&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;(c:float)&nbsp;(d:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;(&nbsp;a&nbsp;&gt;=&nbsp;b&nbsp;)&nbsp;<span class="keyword">or</span>&nbsp;(&nbsp;b&nbsp;&gt;=&nbsp;c&nbsp;)&nbsp;<span class="keyword">or</span>&nbsp;(&nbsp;c&nbsp;&gt;=&nbsp;d&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;order&nbsp;in&nbsp;Infinitesimal.partition_of_1_gap."</span>&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;regular_truncature_right&nbsp;f&nbsp;a&nbsp;b&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;regular_truncature_left&nbsp;f&nbsp;c&nbsp;d&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;y&nbsp;+.&nbsp;z&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_polynomial_1 coefficients real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_polynomial_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(c:float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;deg&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;c&nbsp;)&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;c.(deg)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;deg&nbsp;-&nbsp;1&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;*.&nbsp;x&nbsp;+.&nbsp;c.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_polynomial_2 coefficients x y</pre> The coefficients are given in a matrix.
The columns match the increasing powers of the second varaible y, the rows match the increasing powers of the first variable x. 
<p>

Les coefficients sont stockés dans une matrice. Les colonnes correspondent aux puissances croissantes de la deuxième variable y,
les lignes aux puissances croissantes de la première variable x. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_polynomial_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(c:float&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;(y:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;deg_x&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;c&nbsp;)&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;accu_row&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;last&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;deg_x&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;c.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last&nbsp;:=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;row&nbsp;)&nbsp;-&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu_row&nbsp;:=&nbsp;row.(!last)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;!last&nbsp;-&nbsp;1&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu_row&nbsp;:=&nbsp;!accu_row&nbsp;*.&nbsp;y&nbsp;+.&nbsp;row.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;*.&nbsp;x&nbsp;+.&nbsp;!accu_row&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_rational_1 coefficients_up coefficients_down real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_rational_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(num:float&nbsp;array)&nbsp;(denom:float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;numer&nbsp;=&nbsp;float_polynomial_1&nbsp;num&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;denomin&nbsp;=&nbsp;float_polynomial_1&nbsp;denom&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;numer&nbsp;/.&nbsp;denomin&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_rational_2 coefficients_up coefficients_down real</pre> The coefficients of the dividend and of the divisor are given
by matrices as in the case of polynomials in two variables.
<p>

Les coefficients du numérateur et du dénominateur sont donnés dans des matrices comme pour les polynômes à deux variables. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_rational_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(num:float&nbsp;array&nbsp;array)&nbsp;(denom:float&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;(y:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;numer&nbsp;=&nbsp;float_polynomial_2&nbsp;num&nbsp;x&nbsp;y<br>
&nbsp;<span class="keyword">and</span>&nbsp;denomin&nbsp;=&nbsp;float_polynomial_2&nbsp;denom&nbsp;x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;numer&nbsp;/.&nbsp;denomin&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Drivation"><h1>Dérivation</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsdrives"><h2>Fonctions dérivées</h2></span>
<span id="2_Derivatedfunctions"><h2>Derivated functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_approx_deriv step function float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_approx_deriv&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(step:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;(&nbsp;(&nbsp;f&nbsp;(&nbsp;x&nbsp;+.&nbsp;step&nbsp;)&nbsp;)&nbsp;-.&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;/.&nbsp;step&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_richardson_binary_deriv degree step function float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_richardson_binary_deriv&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(degree:int)&nbsp;(step:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;degree&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_approx_deriv&nbsp;step&nbsp;f&nbsp;x<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;4.&nbsp;*.&nbsp;f&nbsp;(&nbsp;x&nbsp;+.&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;)&nbsp;-.&nbsp;3.&nbsp;*.&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;-.&nbsp;f&nbsp;(&nbsp;x&nbsp;+.&nbsp;step&nbsp;)&nbsp;)&nbsp;/.&nbsp;step<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;2&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;32.&nbsp;*.&nbsp;f&nbsp;(&nbsp;x&nbsp;+.&nbsp;step&nbsp;/.&nbsp;4.&nbsp;)&nbsp;-.&nbsp;21.&nbsp;*.&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;-.&nbsp;12.&nbsp;*.&nbsp;f&nbsp;(&nbsp;x&nbsp;+.&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;)&nbsp;+.&nbsp;f&nbsp;(&nbsp;x&nbsp;+.&nbsp;step&nbsp;)&nbsp;)&nbsp;/.&nbsp;(&nbsp;3.&nbsp;*.&nbsp;step&nbsp;)<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;2.&nbsp;**&nbsp;(&nbsp;float&nbsp;degree&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;oo&nbsp;=&nbsp;degree&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;(&nbsp;coeff&nbsp;*.&nbsp;(&nbsp;float_richardson_binary_deriv&nbsp;oo&nbsp;(&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;)&nbsp;f&nbsp;x&nbsp;)&nbsp;-.&nbsp;(&nbsp;float_richardson_binary_deriv&nbsp;oo&nbsp;step&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;/.&nbsp;(&nbsp;coeff&nbsp;-.&nbsp;1.&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>compensated_float_richardson_binary_deriv degree step function float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;compensated_float_richardson_binary_deriv&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(degree:int)&nbsp;(step:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;seq&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;succ&nbsp;degree&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;degree&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;seq.(i)&nbsp;&lt;-&nbsp;float_richardson_binary_deriv&nbsp;i&nbsp;step&nbsp;f&nbsp;x&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Matrix</span>.float_approx&nbsp;seq&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_richardson_deriv radix degree step function real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_richardson_deriv&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(radix:float)&nbsp;(degree:int)&nbsp;(step:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;degree&nbsp;<span class="keyword">with</span><br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_approx_deriv&nbsp;step&nbsp;f&nbsp;x<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;radix&nbsp;*.&nbsp;radix&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;(&nbsp;coeff&nbsp;*.&nbsp;f&nbsp;(&nbsp;x&nbsp;+.&nbsp;step&nbsp;/.&nbsp;radix&nbsp;)&nbsp;+.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;coeff&nbsp;)&nbsp;*.&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;-.&nbsp;f&nbsp;(&nbsp;x&nbsp;+.&nbsp;step&nbsp;)&nbsp;)&nbsp;/.&nbsp;(&nbsp;step&nbsp;*.&nbsp;(&nbsp;radix&nbsp;-.&nbsp;1.&nbsp;)&nbsp;)<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;radix&nbsp;**&nbsp;(&nbsp;float&nbsp;degree&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;oo&nbsp;=&nbsp;degree&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;(&nbsp;coeff&nbsp;*.&nbsp;(&nbsp;float_richardson_deriv&nbsp;radix&nbsp;oo&nbsp;(&nbsp;step&nbsp;/.&nbsp;radix&nbsp;)&nbsp;f&nbsp;x&nbsp;)&nbsp;-.&nbsp;(&nbsp;float_richardson_deriv&nbsp;radix&nbsp;oo&nbsp;step&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;/.&nbsp;(&nbsp;coeff&nbsp;-.&nbsp;1.&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>compensated_float_richardson_deriv accelerator radix degree step function float</pre> A convergence accelerator for real sequences
must be provided, like for instance <code class="code"><span class="constructor">Matrix</span>.float_approx</code>.
<p>

Il faut fournir un accélérateur de convergence de suites réelles, comme par exemple <code class="code"><span class="constructor">Matrix</span>.float_approx</code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;compensated_float_richardson_deriv&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;accelerator&nbsp;(radix:float)&nbsp;(degree:int)&nbsp;(step:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;seq&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;succ&nbsp;degree&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;degree&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;seq.(i)&nbsp;&lt;-&nbsp;float_richardson_deriv&nbsp;radix&nbsp;i&nbsp;step&nbsp;f&nbsp;x&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;accelerator&nbsp;seq&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_speed methode function real</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_speed&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;i&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(f&nbsp;z).(i)&nbsp;)&nbsp;y&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;<span class="constructor">Array</span>.mapi&nbsp;g&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;(f&nbsp;x)&nbsp;)&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_speed methode function real</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_speed&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;i&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;vector_speed&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(f&nbsp;z).(i)&nbsp;)&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Array</span>.mapi&nbsp;g&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;(f&nbsp;x)&nbsp;)&nbsp;x&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>acceleration methode function float</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;acceleration&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;vector_speed&nbsp;methode&nbsp;g&nbsp;x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_acceleration methode function real</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_acceleration&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;matrix_speed&nbsp;methode&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;matrix_speed&nbsp;methode&nbsp;g&nbsp;x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>partial index vector float</pre> This function replaces the coordinate number <code class="code">i</code> by the variable <code class="code">x</code> inside of the vector <code class="code">v</code>.
<p>

Cette fonction remplace la coordonnée numéro <code class="code">i</code> par la variable <code class="code">x</code> dans le vecteur <code class="code">v</code>.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;partial&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(i:int)&nbsp;(v:float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;w.(j)&nbsp;&lt;-&nbsp;v.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;i&nbsp;+&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;w.(j)&nbsp;&lt;-&nbsp;v.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;w&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_partial index vector float</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_partial&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(i:int)&nbsp;(j:int)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;w.(i).(j)&nbsp;&lt;-&nbsp;x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>gradient methode function vector</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;gradient&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;i&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;partial&nbsp;i&nbsp;v&nbsp;z&nbsp;)&nbsp;)&nbsp;y&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;<span class="constructor">Array</span>.mapi&nbsp;g&nbsp;v&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>tlm methode function vector</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;tlm&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;i&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;gradient&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(f&nbsp;z).(i)&nbsp;)&nbsp;y&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;<span class="constructor">Array</span>.mapi&nbsp;g&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;(f&nbsp;v)&nbsp;)&nbsp;v&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>div methode function vector</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;div&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;tlm&nbsp;methode&nbsp;f&nbsp;v<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;min&nbsp;l&nbsp;c&nbsp;)&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;m.(i).(i)&nbsp;+.&nbsp;!accu<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>det_jac methode function vector</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;det_jac&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;tlm&nbsp;methode&nbsp;f&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Matrix</span>.float_slow_det&nbsp;m&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>rot_curl methode function vector</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rot_curl&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;(f&nbsp;v)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;[|&nbsp;l&nbsp;;&nbsp;c&nbsp;|]&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[|&nbsp;3&nbsp;;&nbsp;3&nbsp;|]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;tlm&nbsp;methode&nbsp;f&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;[|&nbsp;m.(2).(1)&nbsp;-.&nbsp;m.(1).(2)&nbsp;;&nbsp;m.(0).(2)&nbsp;-.&nbsp;m.(2).(0)&nbsp;;&nbsp;m.(1).(0)&nbsp;-.&nbsp;m.(0).(1)&nbsp;|]<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Bad&nbsp;dimensions&nbsp;in&nbsp;Infinitesimal.rot_curl."</span>&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>hess methode function vector</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;hess&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;gradient&nbsp;methode&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;tlm&nbsp;methode&nbsp;g&nbsp;v&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_jet methode order function</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_jet&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(order:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;order&nbsp;+&nbsp;1&nbsp;)&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;order&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;v.(i&nbsp;-&nbsp;1)&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;v.(i)&nbsp;&lt;-&nbsp;g<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;h&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;h&nbsp;x&nbsp;)&nbsp;v&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_poly_coeff methode order function</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_poly_coeff&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(order:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;float_jet&nbsp;methode&nbsp;order&nbsp;f&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;1.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;order&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;*.&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;v.(i)&nbsp;&lt;-&nbsp;v.(i)&nbsp;/.&nbsp;!accu&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;v&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_jet methode order function real</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_jet&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(order:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;order&nbsp;+&nbsp;1&nbsp;)&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;order&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;vector_speed&nbsp;methode&nbsp;v.(i&nbsp;-&nbsp;1)&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;v.(i)&nbsp;&lt;-&nbsp;g<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;h&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;h&nbsp;x&nbsp;)&nbsp;v&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_jet methode order function real</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_jet&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(order:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;order&nbsp;+&nbsp;1&nbsp;)&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;order&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;matrix_speed&nbsp;methode&nbsp;v.(i&nbsp;-&nbsp;1)&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;v.(i)&nbsp;&lt;-&nbsp;g<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;h&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;h&nbsp;x&nbsp;)&nbsp;v&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_curvature methode function real</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_curvature&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;methode&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;methode&nbsp;g<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;g&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;h&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;u&nbsp;=&nbsp;1.&nbsp;+.&nbsp;y&nbsp;*.&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;sqrt&nbsp;u&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;/.&nbsp;(u&nbsp;*.&nbsp;v&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>curvature_2 methode function real</pre> The fonction must take its values in R^2. 
The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas.
La fonction doit être à valeurs dans R^2.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;curvature_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;g<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v&nbsp;=&nbsp;g&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;h&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v0&nbsp;=&nbsp;v.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v1&nbsp;=&nbsp;v.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;u&nbsp;=&nbsp;v0&nbsp;*.&nbsp;v0&nbsp;+.&nbsp;v1&nbsp;*.&nbsp;v1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;v0&nbsp;*.&nbsp;a.(1)&nbsp;-.&nbsp;v1&nbsp;*.&nbsp;a.(0)&nbsp;)&nbsp;/.&nbsp;(&nbsp;u&nbsp;*.&nbsp;(&nbsp;sqrt&nbsp;u&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>developpee_2 methode function real</pre> The fonction must take its values in R^2. 
The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas.
La fonction doit être à valeurs dans R^2.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;developpee_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;g<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v&nbsp;=&nbsp;g&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;h&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v0&nbsp;=&nbsp;v.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v1&nbsp;=&nbsp;v.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;u&nbsp;=&nbsp;v0&nbsp;*.&nbsp;v0&nbsp;+.&nbsp;v1&nbsp;*.&nbsp;v1<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;a0&nbsp;=&nbsp;a.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;a1&nbsp;=&nbsp;a.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;a0&nbsp;*.&nbsp;v0&nbsp;+.&nbsp;a1&nbsp;*.&nbsp;v1&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;uu&nbsp;=&nbsp;1.&nbsp;/.&nbsp;u&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kappa&nbsp;=&nbsp;(&nbsp;v0&nbsp;*.&nbsp;a1&nbsp;-.&nbsp;v1&nbsp;*.&nbsp;a0&nbsp;)&nbsp;*.&nbsp;(&nbsp;uu&nbsp;*.&nbsp;(&nbsp;sqrt&nbsp;uu&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;1.&nbsp;/.&nbsp;kappa&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n0&nbsp;=&nbsp;(&nbsp;a0&nbsp;-.&nbsp;p&nbsp;*.&nbsp;v0&nbsp;/.&nbsp;u&nbsp;)&nbsp;*.&nbsp;r&nbsp;*.&nbsp;uu<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n1&nbsp;=&nbsp;(&nbsp;a1&nbsp;-.&nbsp;p&nbsp;*.&nbsp;v1&nbsp;/.&nbsp;u&nbsp;)&nbsp;*.&nbsp;r&nbsp;*.&nbsp;uu<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;position&nbsp;=&nbsp;f&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;position.(0)&nbsp;+.&nbsp;r&nbsp;*.&nbsp;n0&nbsp;;&nbsp;position.(1)&nbsp;+.&nbsp;r&nbsp;*.&nbsp;n1&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>parallel_arc_2 methode function real</pre> The fonction must take its values in R^2. 
The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas.
La fonction doit être à valeurs dans R^2.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;parallel_arc_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(parameter:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;g<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v&nbsp;=&nbsp;g&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;h&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v0&nbsp;=&nbsp;v.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v1&nbsp;=&nbsp;v.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;u&nbsp;=&nbsp;v0&nbsp;*.&nbsp;v0&nbsp;+.&nbsp;v1&nbsp;*.&nbsp;v1<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;a0&nbsp;=&nbsp;a.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;a1&nbsp;=&nbsp;a.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;a0&nbsp;*.&nbsp;v0&nbsp;+.&nbsp;a1&nbsp;*.&nbsp;v1&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;uu&nbsp;=&nbsp;1.&nbsp;/.&nbsp;u&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kappa&nbsp;=&nbsp;(&nbsp;v0&nbsp;*.&nbsp;a1&nbsp;-.&nbsp;v1&nbsp;*.&nbsp;a0&nbsp;)&nbsp;*.&nbsp;(&nbsp;uu&nbsp;*.&nbsp;(&nbsp;sqrt&nbsp;uu&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;1.&nbsp;/.&nbsp;kappa&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n0&nbsp;=&nbsp;(&nbsp;a0&nbsp;-.&nbsp;p&nbsp;*.&nbsp;v0&nbsp;/.&nbsp;u&nbsp;)&nbsp;*.&nbsp;r&nbsp;*.&nbsp;uu<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n1&nbsp;=&nbsp;(&nbsp;a1&nbsp;-.&nbsp;p&nbsp;*.&nbsp;v1&nbsp;/.&nbsp;u&nbsp;)&nbsp;*.&nbsp;r&nbsp;*.&nbsp;uu<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;position&nbsp;=&nbsp;f&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;position.(0)&nbsp;+.&nbsp;parameter&nbsp;*.&nbsp;n0&nbsp;;&nbsp;position.(1)&nbsp;+.&nbsp;parameter&nbsp;*.&nbsp;n1&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>curvature methode function real</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;curvature&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;g&nbsp;x<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v&nbsp;=&nbsp;g&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;a&nbsp;v<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_square_norm_2&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;nn&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;p&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;z&nbsp;zz&nbsp;)&nbsp;)&nbsp;/.&nbsp;(&nbsp;nn&nbsp;*.&nbsp;nn&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>serret_frenet_3 methode function real</pre> The fonction must take its values in R^3. 
The (unidimensional) derivating method must contain the parameters, including the step.
The output gives the (curvature;torsion) vector, then the tangent vector,
then the normal vector, then the binormal vector.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas.
La fonction doit être à valeurs dans R^3. La sortie comporte le vecteur (courbure;torsion),
puis le vecteur tangent, puis le vecteur normal, puis le vecteur binormal. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;serret_frenet_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;g<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v&nbsp;=&nbsp;g&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;h<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;a&nbsp;=&nbsp;h&nbsp;x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;v<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_square_norm_2&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dertier&nbsp;=&nbsp;k&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;tangent&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;n&nbsp;v<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;product&nbsp;=&nbsp;<span class="constructor">Util</span>.vector_float_prod_3&nbsp;v&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;product&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;binormal&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;p&nbsp;product<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;curvature&nbsp;=&nbsp;p&nbsp;/.&nbsp;(&nbsp;n&nbsp;*.&nbsp;nn&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;normal&nbsp;=&nbsp;<span class="constructor">Util</span>.vector_float_prod_3&nbsp;binormal&nbsp;tangent<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;torsion&nbsp;=&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;binormal&nbsp;dertier&nbsp;)&nbsp;/.&nbsp;p&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;[|&nbsp;curvature&nbsp;;&nbsp;torsion&nbsp;|]&nbsp;;&nbsp;tangent&nbsp;;&nbsp;normal&nbsp;;&nbsp;binormal&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>curvature_center_3 methode function real</pre> The fonction must take its values in R^3. 
The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas.
La fonction prend ses valeurs dans R^3. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;curvature_center_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;resultat&nbsp;=&nbsp;serret_frenet_3&nbsp;methode&nbsp;f&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;1.&nbsp;/.&nbsp;resultat.(0).(0)&nbsp;)&nbsp;resultat.(2)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>parallel_arc_3 methode function parameter real</pre> The fonction must take its values in R^3. 
The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas.
La fonction prend ses valeurs dans R^3. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;parallel_arc_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(parameter:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;resultat&nbsp;=&nbsp;serret_frenet_3&nbsp;methode&nbsp;f&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;parameter&nbsp;resultat.(2)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>serret_frenet methode function real</pre> The (unidimensional) derivating method must contain the parameters, including the step.
The output gives the multi-curvature vector in a one-row matrix, then the Serret-Frenet frame presented row-by-row, 
then the product of all the curvatures in a matrix reduced to a scalar.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas.
La sortie comporte le vecteur multicourbure dans une matrice uniligne, puis le repère de Serret-Frenet ligne par ligne,
puis le produit de toutes les courbures dans une matrice réduite à un scalaire. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;serret_frenet&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;(&nbsp;f&nbsp;x&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;1.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;vector_jet&nbsp;methode&nbsp;dim&nbsp;f&nbsp;x<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;dim&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_sub_matrix&nbsp;m&nbsp;1&nbsp;dim&nbsp;0&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;frame&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_trans_orthonormalize&nbsp;mm<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;curvature&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;n&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;celer&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;mm.(0)&nbsp;frame.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curvature.(0)&nbsp;&lt;-&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;mm.(1)&nbsp;frame.(1)&nbsp;)&nbsp;/.&nbsp;(&nbsp;celer&nbsp;*.&nbsp;celer&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;curvature.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curvature.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;mm.(i)&nbsp;frame.(i)&nbsp;)&nbsp;/.&nbsp;(&nbsp;!accu&nbsp;*.&nbsp;(&nbsp;celer&nbsp;**&nbsp;(&nbsp;float&nbsp;(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;*.&nbsp;curvature.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;[|&nbsp;curvature&nbsp;|]&nbsp;;&nbsp;frame&nbsp;;&nbsp;[|&nbsp;[|&nbsp;!accu&nbsp;|]&nbsp;|]&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>curvature_center methode function real</pre> The fonction must take its values in R^2. 
The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas.
La fonction doit être à valeurs dans R^2.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;curvature_center&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;g&nbsp;x<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v&nbsp;=&nbsp;g&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;a&nbsp;v<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_square_norm_2&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;nn&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;p&nbsp;v<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;u&nbsp;=&nbsp;1.&nbsp;/.&nbsp;nn&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;u&nbsp;*.&nbsp;u&nbsp;)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;z&nbsp;zz&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kappa&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;1.&nbsp;/.&nbsp;(&nbsp;kappa&nbsp;*.&nbsp;kappa&nbsp;)&nbsp;)&nbsp;w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;ww&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>parallel_arc methode function parameter real</pre> The fonction must take its values in R^2. 
The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas.
La fonction doit être à valeurs dans R^2.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;parallel_arc&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(parameter:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;vector_speed&nbsp;methode&nbsp;g&nbsp;x<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v&nbsp;=&nbsp;g&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;a&nbsp;v<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_square_norm_2&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;nn&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;p&nbsp;v<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;u&nbsp;=&nbsp;1.&nbsp;/.&nbsp;nn&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;u&nbsp;*.&nbsp;u&nbsp;)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;z&nbsp;zz&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kappa&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;parameter&nbsp;/.&nbsp;kappa&nbsp;)&nbsp;w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;ww&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>fond_form_I methode function position vector1 vector2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;fond_form_I&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;(vector1:float&nbsp;array)&nbsp;(vector2:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;tlm&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w1&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_vector_float_prod&nbsp;a&nbsp;vector1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w2&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_vector_float_prod&nbsp;a&nbsp;vector2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;w1&nbsp;w2&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_normal_3 methode f position</pre> The function must take its varaiables in R^2 and its values in R^3.
<p>

La fonction doit aller de R^2 dans R^3. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_normal_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;tlm&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Util</span>.vector_float_prod_3&nbsp;b.(0)&nbsp;b.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;l&nbsp;v&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_area_element_3 methode f position</pre> The function must take its varaiables in R^2 and its values in R^3.
<p>

La fonction doit aller de R^2 dans R^3. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_area_element_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;tlm&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Util</span>.vector_float_prod_3&nbsp;b.(0)&nbsp;b.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;v&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_area_vector_3 methode f position</pre> The function must take its varaiables in R^2 and its values in R^3.
<p>

La fonction doit aller de R^2 dans R^3. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_area_vector_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;tlm&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Util</span>.vector_float_prod_3&nbsp;b.(0)&nbsp;b.(1)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_weingarten_3 methode f position</pre> The function must take its varaiables in R^2 and its values in R^3.
<p>

La fonction doit aller de R^2 dans R^3. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_weingarten_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;surface_normal_3&nbsp;methode&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;tlm&nbsp;methode&nbsp;n&nbsp;position<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;tlm&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;www&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;ww&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w_ww&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_trans_orthonormalize&nbsp;www&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;w_ww&nbsp;ww&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w_inv&nbsp;=&nbsp;<span class="constructor">Matrix</span>.clean_inv&nbsp;w_w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_triple_prod&nbsp;w_ww&nbsp;w&nbsp;w_inv&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_fond_form_II_3 methode function position vector1 vector2</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_fond_form_II_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;(vector1:float&nbsp;array)&nbsp;(vector2:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;fond_form_I&nbsp;methode&nbsp;f&nbsp;position&nbsp;vector1&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_vector_float_prod&nbsp;(surface_weingarten_3&nbsp;methode&nbsp;f&nbsp;position&nbsp;)&nbsp;vector2&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_principal_curvatures_3 methode function position</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_principal_curvatures_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;surface_weingarten_3&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;s.(0).(0)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;0.5&nbsp;*.&nbsp;(&nbsp;s.(0).(1)&nbsp;+.&nbsp;s.(1).(0)&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;s.(1).(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;real_float_solve_degree_2&nbsp;1.&nbsp;(&nbsp;-.&nbsp;(&nbsp;a&nbsp;+.&nbsp;d&nbsp;)&nbsp;)&nbsp;(&nbsp;a&nbsp;*.&nbsp;d&nbsp;-.&nbsp;b&nbsp;*.&nbsp;b&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_principal_curvatures_3_bis threshold max_steps methode function position</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_principal_curvatures_3_bis&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(max_steps:int)&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;surface_weingarten_3&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_sym&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;(&nbsp;<span class="constructor">Matrix</span>.sym_float_tune_reduc&nbsp;threshold&nbsp;max_steps&nbsp;s&nbsp;).(0).(0)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_ombilic_deviation_3 methode function position</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_ombilic_deviation_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;k&nbsp;=&nbsp;surface_principal_curvatures_3&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;k.(0)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;k.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;(&nbsp;abs_float&nbsp;a&nbsp;)&nbsp;+.&nbsp;(&nbsp;abs_float&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;z&nbsp;=&nbsp;0.&nbsp;<span class="keyword">then</span>&nbsp;0.&nbsp;<span class="keyword">else</span>&nbsp;(&nbsp;a&nbsp;-.&nbsp;b&nbsp;)&nbsp;/.&nbsp;z&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_ombilic_deviation_3_bis threshold max_steps methode function position</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_ombilic_deviation_3_bis&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(max_steps:int)&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;k&nbsp;=&nbsp;surface_principal_curvatures_3_bis&nbsp;threshold&nbsp;max_steps&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;a&nbsp;=&nbsp;k.(0)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;b&nbsp;=&nbsp;k.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;(&nbsp;abs_float&nbsp;a&nbsp;)&nbsp;+.&nbsp;(&nbsp;abs_float&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;z&nbsp;=&nbsp;0.&nbsp;<span class="keyword">then</span>&nbsp;0.&nbsp;<span class="keyword">else</span>&nbsp;(&nbsp;a&nbsp;-.&nbsp;b&nbsp;)&nbsp;/.&nbsp;z&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_mean_curvature_3 methode function position</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_mean_curvature_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;surface_weingarten_3&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;0.5&nbsp;*.&nbsp;(&nbsp;s.(0).(0)&nbsp;+.&nbsp;s.(1).(1)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_mean_curvature_3_bis threshold max_steps methode function position</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_mean_curvature_3_bis&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(max_steps:int)&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;k&nbsp;=&nbsp;surface_principal_curvatures_3_bis&nbsp;threshold&nbsp;max_steps&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;0.5&nbsp;*.&nbsp;(&nbsp;k.(0)&nbsp;+.&nbsp;k.(1)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_gauss_curvature_3 methode function position</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_gauss_curvature_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;surface_weingarten_3&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;s.(0).(0)&nbsp;*.&nbsp;s.(1).(1)&nbsp;-.&nbsp;s.(0).(1)&nbsp;*.&nbsp;s.(1).(0)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_gauss_curvature_3_bis threshold max_steps methode function position</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_gauss_curvature_3_bis&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(max_steps:int)&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;k&nbsp;=&nbsp;surface_principal_curvatures_3_bis&nbsp;threshold&nbsp;max_steps&nbsp;methode&nbsp;f&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;k.(0)&nbsp;*.&nbsp;k.(1)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_surface_3 function position</pre> The function must take its variables in R^2 and its values in R.
<p>

La fonction doit aller de R^2 dans R. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_surface_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.append&nbsp;v&nbsp;[|&nbsp;f&nbsp;v&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_principal_curvatures_3 function position</pre> The function must take its variables in R^2 and its values in R.
<p>

La fonction doit aller de R^2 dans R. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_principal_curvatures_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;surface_principal_curvatures_3&nbsp;methode&nbsp;(&nbsp;graph_surface_3&nbsp;f&nbsp;)&nbsp;position&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_principal_curvatures_3_bis threshold max_steps function position</pre> The function must take its variables in R^2 and its values in R.
<p>

La fonction doit aller de R^2 dans R. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_principal_curvatures_3_bis&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(max_steps:int)&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;surface_principal_curvatures_3_bis&nbsp;threshold&nbsp;max_steps&nbsp;methode&nbsp;(&nbsp;graph_surface_3&nbsp;f&nbsp;)&nbsp;position&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_mean_curvature_3 function position</pre> The function must take its variables in R^2 and its values in R.
<p>

La fonction doit aller de R^2 dans R. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_mean_curvature_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;surface_mean_curvature_3&nbsp;methode&nbsp;(&nbsp;graph_surface_3&nbsp;f&nbsp;)&nbsp;position&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_mean_curvature_3_bis threshold max_steps function position</pre> The function must take its variables in R^2 and its values in R.
<p>

La fonction doit aller de R^2 dans R. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_mean_curvature_3_bis&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(threshold:float)&nbsp;(max_steps:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;surface_mean_curvature_3_bis&nbsp;threshold&nbsp;max_steps&nbsp;methode&nbsp;(&nbsp;graph_surface_3&nbsp;f&nbsp;)&nbsp;position&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_gauss_curvature_3 function position</pre> The function must take its variables in R^2 and its values in R.
<p>

La fonction doit aller de R^2 dans R. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_gauss_curvature_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;surface_gauss_curvature_3&nbsp;methode&nbsp;(&nbsp;graph_surface_3&nbsp;f&nbsp;)&nbsp;position&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>graph_gauss_curvature_3_bis threshold max_steps function position</pre> The function must take its variables in R^2 and its values in R.
<p>

La fonction doit aller de R^2 dans R. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;graph_gauss_curvature_3_bis&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(max_steps:int)&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;surface_gauss_curvature_3_bis&nbsp;threshold&nbsp;max_steps&nbsp;methode&nbsp;(&nbsp;graph_surface_3&nbsp;f&nbsp;)&nbsp;position&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Drivesdiscrtes"><h2>Dérivées discrètes</h2></span>
<span id="2_Discretederivatives"><h2>Discrete derivatives</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_discrete_diff scale vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_discrete_diff&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;scale&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v<br>
&nbsp;<span class="keyword">and</span>&nbsp;inv_scale&nbsp;=&nbsp;1.&nbsp;/.&nbsp;scale&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;n&nbsp;-&nbsp;1&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;n&nbsp;-&nbsp;2&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;(&nbsp;v.(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;-.&nbsp;v.(i)&nbsp;)&nbsp;*.&nbsp;inv_scale&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_discrete_richardson_binary_diff degree scale vector</pre> The maximum degree taken into account is two.
<p>

Le degré plafonne à 2. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_discrete_richardson_binary_diff&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(degree:int)&nbsp;(scale:float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;degree&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_discrete_diff&nbsp;scale&nbsp;v<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;n&nbsp;-&nbsp;2&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;inv_doublescale&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;2.&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;n&nbsp;-&nbsp;3&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;(&nbsp;4.&nbsp;*.&nbsp;v.(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;-.&nbsp;3.&nbsp;*.&nbsp;v.(i)&nbsp;-.&nbsp;v.(&nbsp;i&nbsp;+&nbsp;2&nbsp;)&nbsp;)&nbsp;*.&nbsp;inv_doublescale&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;w<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;n&nbsp;-&nbsp;4&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;inv_otherscale&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;12.&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;n&nbsp;-&nbsp;5&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;(&nbsp;32.&nbsp;*.&nbsp;v.(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;-.&nbsp;21.&nbsp;*.&nbsp;v.(i)&nbsp;-.&nbsp;12.&nbsp;*.&nbsp;v.(&nbsp;i&nbsp;+&nbsp;2&nbsp;)&nbsp;+.&nbsp;v.(&nbsp;i&nbsp;+&nbsp;4&nbsp;)&nbsp;)&nbsp;*.&nbsp;inv_otherscale&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_discrete_richardson_diff radix scale vector</pre> The degree is equal to one.
<p>

Le degré vaut 1. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_discrete_richardson_diff&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(radix:int)&nbsp;(scale:float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;float&nbsp;radix&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;n&nbsp;-&nbsp;radix&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;rr&nbsp;=&nbsp;r&nbsp;*.&nbsp;r<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;inv_otherscale&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;r&nbsp;*.&nbsp;(&nbsp;r&nbsp;-.&nbsp;1.&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;n&nbsp;-&nbsp;radix&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;(&nbsp;rr&nbsp;*.&nbsp;v.(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;-.&nbsp;(&nbsp;rr&nbsp;-.&nbsp;1.&nbsp;)&nbsp;*.&nbsp;v.(i)&nbsp;-.&nbsp;v.(&nbsp;i&nbsp;+&nbsp;radix&nbsp;)&nbsp;)&nbsp;*.&nbsp;inv_otherscale&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>mean_float_discrete_diff scale vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;mean_float_discrete_diff&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;scale&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v<br>
&nbsp;<span class="keyword">and</span>&nbsp;inv_scale&nbsp;=&nbsp;1.&nbsp;/.&nbsp;scale&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;n&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;n&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;inv_otherscale&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;(&nbsp;float&nbsp;nn&nbsp;)&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;w.(0)&nbsp;&lt;-&nbsp;(&nbsp;v.(1)&nbsp;-.&nbsp;v.(0)&nbsp;)&nbsp;*.&nbsp;inv_scale&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;n&nbsp;-&nbsp;2&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;nn&nbsp;-&nbsp;i&nbsp;)&nbsp;)&nbsp;*.&nbsp;v.(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;+.&nbsp;(&nbsp;float&nbsp;(&nbsp;2&nbsp;*&nbsp;i&nbsp;-&nbsp;nn&nbsp;)&nbsp;)&nbsp;*.&nbsp;v.(i)&nbsp;-.&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;*.&nbsp;v.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;)&nbsp;*.&nbsp;inv_otherscale&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;w.(&nbsp;nn&nbsp;)&nbsp;&lt;-&nbsp;(&nbsp;v.(&nbsp;nn&nbsp;)&nbsp;-.&nbsp;v.(&nbsp;nn&nbsp;-&nbsp;1&nbsp;)&nbsp;)&nbsp;*.&nbsp;inv_scale&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>mean_float_discrete_richardson_binary_diff scale vector</pre> The degree is equal to 1.
<p>

Le degré vaut 1. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;mean_float_discrete_richardson_binary_diff&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(scale:float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v<br>
&nbsp;<span class="keyword">and</span>&nbsp;inv_doublescale&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;2.&nbsp;*.&nbsp;scale&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;inv_quadscale&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;4.&nbsp;*.&nbsp;scale&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;inv_otherscale&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;8.&nbsp;*.&nbsp;scale&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;n&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;n&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;w.(0)&nbsp;&lt;-&nbsp;(&nbsp;4.&nbsp;*.&nbsp;v.(1)&nbsp;-.&nbsp;3.&nbsp;*.&nbsp;v.(0)&nbsp;-.&nbsp;v.(2)&nbsp;)&nbsp;*.&nbsp;inv_doublescale&nbsp;;<br>
&nbsp;&nbsp;&nbsp;w.(1)&nbsp;&lt;-&nbsp;(&nbsp;(-3.)&nbsp;*.&nbsp;v.(0)&nbsp;+.&nbsp;v.(1)&nbsp;+.&nbsp;3.&nbsp;*.&nbsp;v.(2)&nbsp;-.&nbsp;v.(3)&nbsp;)&nbsp;*.&nbsp;inv_quadscale&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;n&nbsp;-&nbsp;3&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;(&nbsp;(-3.)&nbsp;*.&nbsp;v.(&nbsp;i&nbsp;-&nbsp;2&nbsp;)&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;v.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;+.&nbsp;4.&nbsp;*.&nbsp;v.(i)&nbsp;+.&nbsp;2.&nbsp;*.&nbsp;v.(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;-.&nbsp;v.(&nbsp;i&nbsp;+&nbsp;2&nbsp;)&nbsp;)&nbsp;*.&nbsp;inv_otherscale&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;w.(&nbsp;n&nbsp;-&nbsp;2&nbsp;)&nbsp;&lt;-&nbsp;(&nbsp;(-3.)&nbsp;*.&nbsp;v.(&nbsp;nn&nbsp;-&nbsp;3&nbsp;)&nbsp;+.&nbsp;v.(&nbsp;nn&nbsp;-&nbsp;2&nbsp;)&nbsp;+.&nbsp;3.&nbsp;*.&nbsp;v.(&nbsp;nn&nbsp;-&nbsp;1&nbsp;)&nbsp;-.&nbsp;v.(nn)&nbsp;)&nbsp;*.&nbsp;inv_quadscale&nbsp;;<br>
&nbsp;&nbsp;&nbsp;w.(&nbsp;nn&nbsp;)&nbsp;&lt;-&nbsp;(&nbsp;4.&nbsp;*.&nbsp;v.(&nbsp;nn&nbsp;-&nbsp;1&nbsp;)&nbsp;-.&nbsp;3.&nbsp;*.&nbsp;v.(&nbsp;nn&nbsp;-&nbsp;2&nbsp;)&nbsp;-.&nbsp;v.(&nbsp;nn&nbsp;)&nbsp;)&nbsp;*.&nbsp;inv_doublescale&nbsp;;<br>
&nbsp;&nbsp;&nbsp;w&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_vector_speed methode scale position_matrix</pre> The data must be presented by coordinates.
<p>

Les données doivent être présentées coordonnées par coordonnées. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_vector_speed&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(scale:float)&nbsp;(position:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;d&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;vitesse&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;d&nbsp;1&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;d&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;vitesse.(i)&nbsp;&lt;-&nbsp;methode&nbsp;scale&nbsp;position.(i)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;vitesse&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_vector_speed methode scale position_matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_vector_speed&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(scale:float)&nbsp;(position:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;(&nbsp;discrete_trans_vector_speed&nbsp;methode&nbsp;scale&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;position&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_acceleration methode scale position_matrix</pre> The data must be presented by coordinates.
<p>

Les données doivent être présentées coordonnées par coordonnées. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_acceleration&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(scale:float)&nbsp;(position:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;d&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;vitesse&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;d&nbsp;1&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;acceleration&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;d&nbsp;1&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;d&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;methode&nbsp;scale&nbsp;position.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acceleration.(i)&nbsp;&lt;-&nbsp;methode&nbsp;scale&nbsp;w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vitesse.(i)&nbsp;&lt;-&nbsp;w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;acceleration&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_acceleration methode scale position_matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_acceleration&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(scale:float)&nbsp;(position:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;(&nbsp;discrete_trans_acceleration&nbsp;methode&nbsp;scale&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;position&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_jet methode order scale position_matrix</pre> The data must be presented by coordinates.
<p>

Les données doivent être présentées coordonnées par coordonnées. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_jet&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(order:int)&nbsp;(scale:float)&nbsp;(position:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;d&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;jet&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;order&nbsp;+&nbsp;1&nbsp;)&nbsp;d&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;d&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;ref&nbsp;position.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jet.(0).(i)&nbsp;&lt;-&nbsp;!w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;o&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;order&nbsp;<span class="keyword">do</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;methode&nbsp;scale&nbsp;!w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jet.(o).(i)&nbsp;&lt;-&nbsp;!w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;jet&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_jet methode order scale position_matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_jet&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(order:int)&nbsp;(scale:float)&nbsp;(position:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Util</span>.transpose&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;(&nbsp;discrete_trans_jet&nbsp;methode&nbsp;order&nbsp;scale&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;position&nbsp;)&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_graph_curvature methode scale vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_graph_curvature&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(scale:float)&nbsp;(position:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;methode&nbsp;scale&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;methode&nbsp;scale&nbsp;first&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;second&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;curvature&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;n&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;first.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coefficient&nbsp;=&nbsp;1.&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;coeff&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curvature.(i)&nbsp;&lt;-&nbsp;second.(i)&nbsp;/.&nbsp;(&nbsp;coefficient&nbsp;*.&nbsp;(&nbsp;sqrt&nbsp;coefficient&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curvature&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_curvature_2 methode scale position_matrix</pre> The data must be presented by coordinates.
<p>

Les données doivent être présentées coordonnées par coordonnées. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_curvature_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(scale:float)&nbsp;(position:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;second_jet&nbsp;=&nbsp;discrete_trans_jet&nbsp;methode&nbsp;2&nbsp;scale&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;second_jet.(1)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;second&nbsp;=&nbsp;second_jet.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xdot&nbsp;=&nbsp;first.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ydot&nbsp;=&nbsp;first.(1)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xsec&nbsp;=&nbsp;second.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ysec&nbsp;=&nbsp;second.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;xsec&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;curvature&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;n&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v0&nbsp;=&nbsp;xdot.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v1&nbsp;=&nbsp;ydot.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;a0&nbsp;=&nbsp;xsec.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;a1&nbsp;=&nbsp;ysec.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;v0&nbsp;*.&nbsp;v0&nbsp;+.&nbsp;v1&nbsp;*.&nbsp;v1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curvature.(i)&nbsp;&lt;-&nbsp;(&nbsp;v0&nbsp;*.&nbsp;a1&nbsp;-.&nbsp;v1&nbsp;*.&nbsp;a0&nbsp;)&nbsp;/.&nbsp;(&nbsp;coeff&nbsp;*.&nbsp;(&nbsp;sqrt&nbsp;coeff&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curvature&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_curvature_2 methode scale position_matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_curvature_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(scale:float)&nbsp;(position:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_trans_curvature_2&nbsp;methode&nbsp;scale&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;position&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_curvature methode scale position_matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_curvature&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(scale:float)&nbsp;(position:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;second_jet&nbsp;=&nbsp;discrete_jet&nbsp;methode&nbsp;2&nbsp;scale&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;second_jet.(1)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;second&nbsp;=&nbsp;second_jet.(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.vector_float_square_norm_2&nbsp;first<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;size&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;second&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;p&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;size&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;curvature&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;size&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;size&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;second.(i)&nbsp;first.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;nn.(i)&nbsp;second.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;p.(i)&nbsp;first.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curvature.(i)&nbsp;&lt;-&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;z&nbsp;zz&nbsp;)&nbsp;)&nbsp;/.&nbsp;(&nbsp;nn.(i)&nbsp;*.&nbsp;nn.(i)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curvature&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_curvature methode scale position_matrix</pre> The data must be presented by coordinates.
<p>

Les données doivent être présentées coordonnées par coordonnées. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_curvature&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(scale:float)&nbsp;(position:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_curvature&nbsp;methode&nbsp;scale&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;position&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_trans_serret_frenet methode scale position_matrix</pre> The samples at the input must be presented by coordinates.
The output gives the samples of the multi-curvature vector, then the samples of the Serret-Frenet frame, 
then the samples of the product of all the curvatures.
<p>

Les échantillons doivent être entrés coordonnée par coordonnée.
La sortie comporte les échantillons du vecteur multicourbure, puis les échantillons du repère de Serret-Frenet,
puis les échantillons du produit de toutes les courbures. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_trans_serret_frenet&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(scale:float)&nbsp;(position:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;position&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dim_jet&nbsp;=&nbsp;discrete_trans_jet&nbsp;methode&nbsp;dim&nbsp;scale&nbsp;position<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;dim&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;size&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;dim_jet.(dim).(n)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;size&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;celer&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;size&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;curvature&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;size&nbsp;n&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;frame&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;size&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim&nbsp;dim&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;information&nbsp;=&nbsp;<span class="constructor">Array</span>.sub&nbsp;dim_jet&nbsp;1&nbsp;dim&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;information&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Util</span>.transpose&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;size&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;repere&nbsp;=&nbsp;mm.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frame.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.float_trans_orthonormalize&nbsp;repere&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;celer.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;repere.(0)&nbsp;frame.(i).(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curvature.(i).(0)&nbsp;&lt;-&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;repere.(1)&nbsp;frame.(i).(1)&nbsp;)&nbsp;/.&nbsp;(&nbsp;celer.(i)&nbsp;*.&nbsp;celer.(i)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(i)&nbsp;&lt;-&nbsp;curvature.(i).(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curvature.(i).(&nbsp;j&nbsp;-&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;repere.(j)&nbsp;frame.(i).(j)&nbsp;)&nbsp;/.&nbsp;(&nbsp;accu.(i)&nbsp;*.&nbsp;(&nbsp;celer.(i)&nbsp;**&nbsp;(&nbsp;float&nbsp;(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(i)&nbsp;&lt;-&nbsp;accu.(i)&nbsp;*.&nbsp;curvature.(i).(&nbsp;j&nbsp;-&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;[|&nbsp;curvature&nbsp;|]&nbsp;;&nbsp;frame&nbsp;;&nbsp;[|&nbsp;[|&nbsp;accu&nbsp;|]&nbsp;|]&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_serret_frenet methode scale position_matrix</pre> The output gives the samples of the multi-curvature vector, 
then the samples of the Serret-Frenet frame, then the samples of the product of all the curvatures.
<p>

La sortie comporte les échantillons du vecteur multicourbure, puis les échantillons du repère de Serret-Frenet,
puis les échantillons du produit de toutes les courbures. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_serret_frenet&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(scale:float)&nbsp;(position:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;position.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;dim_jet&nbsp;=&nbsp;discrete_jet&nbsp;methode&nbsp;dim&nbsp;scale&nbsp;position<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;dim&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;size&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;dim_jet&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;size&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;celer&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;size&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;curvature&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;size&nbsp;n&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;frame&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;size&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim&nbsp;dim&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;size&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;repere&nbsp;=&nbsp;<span class="constructor">Array</span>.sub&nbsp;dim_jet.(i)&nbsp;1&nbsp;dim&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frame.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.float_trans_orthonormalize&nbsp;repere&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;celer.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;repere.(0)&nbsp;frame.(i).(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curvature.(i).(0)&nbsp;&lt;-&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;repere.(1)&nbsp;frame.(i).(1)&nbsp;)&nbsp;/.&nbsp;(&nbsp;celer.(i)&nbsp;*.&nbsp;celer.(i)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(i)&nbsp;&lt;-&nbsp;curvature.(i).(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curvature.(i).(&nbsp;j&nbsp;-&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;repere.(j)&nbsp;frame.(i).(j)&nbsp;)&nbsp;/.&nbsp;(&nbsp;accu.(i)&nbsp;*.&nbsp;(&nbsp;celer.(i)&nbsp;**&nbsp;(&nbsp;float&nbsp;(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(i)&nbsp;&lt;-&nbsp;accu.(i)&nbsp;*.&nbsp;curvature.(i).(&nbsp;j&nbsp;-&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;[|&nbsp;curvature&nbsp;|]&nbsp;;&nbsp;frame&nbsp;;&nbsp;[|&nbsp;[|&nbsp;accu&nbsp;|]&nbsp;|]&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_partial_diff_x methode matrix</pre> The column numbers of the matrix correspond to the abscissae.
The method <code class="code">methode</code> is that of one_dimensional discrete derivation.
<p>

Les numéros de colonnes de la matrice représentent les abscisses. La méthode <code class="code">methode</code> est celle de dérivation discrète unidimensionnelle.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_partial_diff_x&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Array</span>.map&nbsp;methode&nbsp;m&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_partial_diff_y methode matrix</pre> The column numbers of the matrix correspond to the abscissae.
The method <code class="code">methode</code> is that of one_dimensional discrete derivation.
<p>

Les numéros de colonnes de la matrice représentent les abscisses. La méthode <code class="code">methode</code> est celle de dérivation discrète unidimensionnelle.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_partial_diff_y&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;(&nbsp;discrete_partial_diff_x&nbsp;methode&nbsp;w&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_area_element methode matrix</pre> The column numbers of the matrix correspond to the abscissae.
The method <code class="code">methode</code> is that of one_dimensional discrete derivation.
<p>

Les numéros de colonnes de la matrice représentent les abscisses. La méthode <code class="code">methode</code> est celle de dérivation discrète unidimensionnelle.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_area_element&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;discrete_partial_diff_x&nbsp;methode&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;discrete_partial_diff_y&nbsp;methode&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sqrt&nbsp;(&nbsp;1.&nbsp;+.&nbsp;x&nbsp;*.&nbsp;x&nbsp;+.&nbsp;y&nbsp;*.&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_apply2&nbsp;f&nbsp;w&nbsp;ww&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_gauss_curvature methode matrix</pre> The column numbers of the matrix correspond to the abscissae.
The method <code class="code">methode</code> is that of one_dimensional discrete derivation.
<p>

Les numéros de colonnes de la matrice représentent les abscisses. La méthode <code class="code">methode</code> est celle de dérivation discrète unidimensionnelle.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_gauss_curvature&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;discrete_partial_diff_x&nbsp;methode&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;discrete_partial_diff_y&nbsp;methode&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1.&nbsp;/.&nbsp;(&nbsp;1.&nbsp;+.&nbsp;x&nbsp;*.&nbsp;x&nbsp;+.&nbsp;y&nbsp;*.&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w_xx&nbsp;=&nbsp;discrete_partial_diff_x&nbsp;methode&nbsp;w<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w_xy&nbsp;=&nbsp;discrete_partial_diff_x&nbsp;methode&nbsp;ww<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w_yy&nbsp;=&nbsp;discrete_partial_diff_y&nbsp;methode&nbsp;ww<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w1&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_apply2&nbsp;f&nbsp;w&nbsp;ww&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w2&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_coeff_prod&nbsp;w_xx&nbsp;w_yy<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w3&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_coeff_prod&nbsp;w_xy&nbsp;w_xy&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w4&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;w2&nbsp;w3&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_coeff_prod&nbsp;w4&nbsp;w1&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_mean_curvature methode matrix</pre> The column numbers of the matrix correspond to the abscissae.
The method <code class="code">methode</code> is that of one_dimensional discrete derivation.
<p>

Les numéros de colonnes de la matrice représentent les abscisses. La méthode <code class="code">methode</code> est celle de dérivation discrète unidimensionnelle.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_mean_curvature&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;discrete_partial_diff_x&nbsp;methode&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;discrete_partial_diff_y&nbsp;methode&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;1.&nbsp;+.&nbsp;x&nbsp;*.&nbsp;x&nbsp;+.&nbsp;y&nbsp;*.&nbsp;y&nbsp;<span class="keyword">in</span>&nbsp;0.5&nbsp;/.&nbsp;(&nbsp;z&nbsp;*.&nbsp;(&nbsp;sqrt&nbsp;z&nbsp;)&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;1.&nbsp;+.&nbsp;x&nbsp;*.&nbsp;x&nbsp;)&nbsp;*.&nbsp;y<br>
&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(-2.)&nbsp;*.&nbsp;x&nbsp;*.&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w_xx&nbsp;=&nbsp;discrete_partial_diff_x&nbsp;methode&nbsp;w<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w_xy&nbsp;=&nbsp;discrete_partial_diff_x&nbsp;methode&nbsp;ww<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w_yy&nbsp;=&nbsp;discrete_partial_diff_y&nbsp;methode&nbsp;ww<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w0&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_coeff_prod&nbsp;w&nbsp;ww<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w1&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_apply2&nbsp;f&nbsp;w&nbsp;ww&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w2&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_apply2&nbsp;g&nbsp;ww&nbsp;w_xx<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w3&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_apply2&nbsp;g&nbsp;w&nbsp;w_yy<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w4&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_apply2&nbsp;h&nbsp;w0&nbsp;w_xy&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w5&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;w2&nbsp;w3&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w6&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;w5&nbsp;w4&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_coeff_prod&nbsp;w6&nbsp;w1&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_principal_curvatures methode matrix</pre> The column numbers of the matrix correspond to the abscissae.
The method <code class="code">methode</code> is that of one_dimensional discrete derivation.
<p>

Les numéros de colonnes de la matrice représentent les abscisses. La méthode <code class="code">methode</code> est celle de dérivation discrète unidimensionnelle.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_principal_curvatures&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;discrete_mean_curvature&nbsp;methode&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;discrete_gauss_curvature&nbsp;methode&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;real_float_solve_degree_2&nbsp;1.&nbsp;(&nbsp;-.&nbsp;x&nbsp;)&nbsp;&nbsp;y&nbsp;).(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;real_float_solve_degree_2&nbsp;1.&nbsp;(&nbsp;-.&nbsp;x&nbsp;)&nbsp;y&nbsp;).(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w1&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_apply2&nbsp;f&nbsp;w&nbsp;ww<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w2&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_apply2&nbsp;g&nbsp;w&nbsp;ww&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;[|&nbsp;w1&nbsp;;&nbsp;w2&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Interpolation"><h2>Interpolation</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_linear_interpol vector real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_linear_interpol&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ll&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;)&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;x&nbsp;&lt;=&nbsp;0.&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;v.(0)&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&gt;=&nbsp;float&nbsp;ll&nbsp;<span class="keyword">then</span>&nbsp;v.(ll)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">let</span>&nbsp;e&nbsp;=&nbsp;floor&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;index&nbsp;=&nbsp;int_of_float&nbsp;e<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;x&nbsp;-.&nbsp;e&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;*.&nbsp;v.(&nbsp;index&nbsp;+&nbsp;1&nbsp;)&nbsp;+.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;y&nbsp;)&nbsp;*.&nbsp;v.(index)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_regular_stair_interpol function vector real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_regular_stair_interpol&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ll&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;)&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;x&nbsp;&lt;=&nbsp;0.&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;v.(0)&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&gt;=&nbsp;float&nbsp;ll&nbsp;<span class="keyword">then</span>&nbsp;v.(ll)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">let</span>&nbsp;e&nbsp;=&nbsp;floor&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;index&nbsp;=&nbsp;int_of_float&nbsp;e<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;x&nbsp;-.&nbsp;e&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;*.&nbsp;v.(index)&nbsp;+.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;z&nbsp;)&nbsp;*.&nbsp;v.(&nbsp;index+&nbsp;1&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_medium_interpol function vector real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_medium_interpol&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ll&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;)&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;x&nbsp;&lt;=&nbsp;0.&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;v.(0)&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&gt;=&nbsp;float&nbsp;ll&nbsp;<span class="keyword">then</span>&nbsp;v.(ll)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">let</span>&nbsp;e&nbsp;=&nbsp;floor&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;index&nbsp;=&nbsp;int_of_float&nbsp;e<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;x&nbsp;-.&nbsp;e&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;0.5&nbsp;*.&nbsp;(&nbsp;z&nbsp;+.&nbsp;1.&nbsp;-.&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;*.&nbsp;v.(index)&nbsp;+.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;w&nbsp;)&nbsp;*.&nbsp;v.(&nbsp;index+&nbsp;1&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_fit_interpol methode function parameter vector real</pre> The absolute value of the <code class="code">parameter</code>
conditions the importance of the differentiable stair interpolation against the importance of the linear
interpolation. The method <code class="code">methode</code> is that of differentiation, and must preserve the size of the sample.
<p>

La valeur absolue du paramètre <code class="code">parameter</code> dose l'importance de l'interpolation en escalier dérivable
contre l'importance de l'interpolation linéaire.
La méthode <code class="code">methode</code> est celle de dérivation, et doit préserver la taille de l'échantillon. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_fit_interpol&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(parameter:float)&nbsp;(v:float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ll&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;)&nbsp;-&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;discrete_graph_curvature&nbsp;methode&nbsp;1.&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;x&nbsp;&lt;=&nbsp;0.&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;v.(0)&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&gt;=&nbsp;float&nbsp;ll&nbsp;<span class="keyword">then</span>&nbsp;v.(ll)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">let</span>&nbsp;e&nbsp;=&nbsp;floor&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;index&nbsp;=&nbsp;int_of_float&nbsp;e<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;x&nbsp;-.&nbsp;e&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;abs_float&nbsp;(&nbsp;tanh&nbsp;(&nbsp;parameter&nbsp;*.&nbsp;c.(index)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;coeff&nbsp;*.&nbsp;z&nbsp;+.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;coeff&nbsp;)&nbsp;*.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;*.&nbsp;v.(index)&nbsp;+.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;w&nbsp;)&nbsp;*.&nbsp;v.(&nbsp;index&nbsp;+&nbsp;1&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_tune_interpol methode function vector real</pre> The parameter <code class="code">scale</code> is
used in the discrete differential method <code class="code">methode</code>. 
It may be used here in order to tune the smoothing effect. In case of doubt, use 1.0.
The <code class="code">parameter</code> is used for the interpolation <code class="code">float_fit_interpol</code> applied to the
derivative. A value of 0.1 seems convenient.
<p>

Le paramètre <code class="code">scale</code> est utilisé dans la méthode <code class="code">methode</code> de différentiation discrète.
Il peut servir à doser l'effet de régularisation ici. Dans le doute, prendre 1.0.
Le paramètre <code class="code">parameter</code> sert pour l'interpolation <code class="code">float_fit_interpol</code>
appliquée à la dérivée. Une valeur de 0.1 paraît raisonnable. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_tune_interpol&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(v:float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ll&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;)&nbsp;-&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;discrete_graph_curvature&nbsp;methode&nbsp;1e0&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;x&nbsp;&lt;=&nbsp;0.&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;v.(0)&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">if</span>&nbsp;x&nbsp;&gt;=&nbsp;float&nbsp;ll&nbsp;<span class="keyword">then</span>&nbsp;v.(ll)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">let</span>&nbsp;parameter&nbsp;=&nbsp;1e1&nbsp;*.&nbsp;sinh&nbsp;(&nbsp;float_medium_interpol&nbsp;f&nbsp;c&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float_fit_interpol&nbsp;methode&nbsp;f&nbsp;parameter&nbsp;v&nbsp;x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_trans_interpol methode vector_sample</pre> The data must be presented by coordinates.
<p>

Les données doivent être présentées coordonnées par coordonnées. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_trans_interpol&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;methode&nbsp;v.(i)&nbsp;x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;w&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_interpol methode vector_sample</pre>  *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_interpol&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;vector_trans_interpol&nbsp;methode&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;v&nbsp;)&nbsp;x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_trans_interpol methode matrix_sample</pre> The data must be presented by coefficients.
<p>

Les données doivent être présentées coefficients par coefficients. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_trans_interpol&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;l&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;vector_trans_interpol&nbsp;methode&nbsp;m.(i)&nbsp;x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;w&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_interpol methode matrix_sample</pre>  *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_interpol&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(m:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;matrix_trans_interpol&nbsp;methode&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;(&nbsp;<span class="constructor">Util</span>.transpose&nbsp;m&nbsp;)&nbsp;)&nbsp;x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The following multi-variables interpolations are polymorphic.
<p>

Les interpolations à plusieurs variables qui suivent sont polymorphes. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>interpol_2 methode matrix abscissa ordinate</pre> The row numbers correspond to the ordinates
and the column numbers correspond to the abscissae. The method <code class="code">methode</code> is that of the chosen interpolation.
<p>

Les numéros de lignes correspondent aux ordonnées et les numéros de colonnes aux abscisses.
La méthode <code class="code">methode</code> est la méthode d'interpolation choisie. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;interpol_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(m:<span class="keywordsign">'</span>a&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;(y:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;intermed&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;i&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;m.(i)&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;m&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;vv&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;intermed&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;methode&nbsp;vv&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>interpol_3 methode matrix abscissa ordinate</pre> The row numbers correspond to the altitudes
and the following numbers correspond to the ordinates then the abscissae. The method <code class="code">methode</code> is that of the chosen interpolation.
<p>

Les numéros de lignes correspondent aux cotes et les numéros suivants aux ordonnées puis abscisses.
La méthode <code class="code">methode</code> est la méthode d'interpolation choisie. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;interpol_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(m:<span class="keywordsign">'</span>a&nbsp;array&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;(y:float)&nbsp;(z:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;intermed&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;i&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;interpol_2&nbsp;methode&nbsp;m.(i)&nbsp;x&nbsp;y<br>
&nbsp;<span class="keyword">and</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;m&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;vv&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;intermed&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;methode&nbsp;vv&nbsp;z&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>interpol methode multi_vector abscissa ordinate</pre> The row numbers correspond to the last coordinate
and the following numbers correspond to the coordinates in reverse order. The method <code class="code">methode</code> is that of the chosen interpolation.
<p>

Les numéros de lignes correspondent à la dernière coordonnée et les numéros suivants aux coordonnées en ordre inverse.
La méthode <code class="code">methode</code> est la méthode d'interpolation choisie. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;interpol&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(m:<span class="constructor">Matrix</span>.float_or_array)&nbsp;(x:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;d&nbsp;=&nbsp;<span class="constructor">Matrix</span>.foa_thickness&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;d&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_demakeup&nbsp;m&nbsp;<span class="keyword">in</span>&nbsp;methode&nbsp;mm&nbsp;x.(0)<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_foa_demakeup&nbsp;m&nbsp;<span class="keyword">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;mm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;rr&nbsp;=&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;intermed&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;i&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;interpol&nbsp;methode&nbsp;mm.(i)&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;x&nbsp;0&nbsp;rr&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;vv&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;intermed&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;methode&nbsp;vv&nbsp;x.(rr)&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Zros"><h1>Zéros</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_zero_secant maxstep function start</pre> This method may work for a root of order one.
<p>

Cette méthode peut fonctionner pour une racine d'ordre un.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_zero_secant&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;a&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;a&nbsp;+.&nbsp;<span class="constructor">Random</span>.float&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;a&nbsp;/.&nbsp;10.&nbsp;)&nbsp;+.&nbsp;sqrt&nbsp;epsilon_float&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;!y&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xxx&nbsp;=&nbsp;ref&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;!xx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;ref&nbsp;(&nbsp;abs_float&nbsp;!yy&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zzz&nbsp;=&nbsp;ref&nbsp;(&nbsp;abs_float&nbsp;!zz&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;[|&nbsp;!xxx&nbsp;;&nbsp;!yyy&nbsp;;&nbsp;!zzz&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;!xx&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pente&nbsp;=&nbsp;(&nbsp;!x&nbsp;-.&nbsp;!y&nbsp;)&nbsp;/.&nbsp;(&nbsp;!yy&nbsp;-.&nbsp;!xx&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!y&nbsp;+.&nbsp;!yy&nbsp;*.&nbsp;pente&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;f&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zzz&nbsp;:=&nbsp;abs_float&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v.(2)&nbsp;&lt;-&nbsp;!zzz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.fast_sort&nbsp;compare&nbsp;v&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;v.(0)&nbsp;=&nbsp;!zzz&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;&nbsp;yy&nbsp;:=&nbsp;!zz&nbsp;;&nbsp;yyy&nbsp;:=&nbsp;!zzz&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;v.(0)&nbsp;=&nbsp;!xxx&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;y&nbsp;:=&nbsp;!x&nbsp;;&nbsp;yy&nbsp;:=&nbsp;!xx&nbsp;;&nbsp;yyy&nbsp;:=&nbsp;!xxx&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;v.(1)&nbsp;=&nbsp;!zzz&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!z&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!zz&nbsp;;&nbsp;xxx&nbsp;:=&nbsp;!zzz&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;v.(1)&nbsp;=&nbsp;!yyy&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;;&nbsp;xxx&nbsp;:=&nbsp;!yyy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_zero_newton methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_zero_newton&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;f&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pente&nbsp;=&nbsp;methode&nbsp;f&nbsp;!x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ordonnee&nbsp;=&nbsp;f&nbsp;!x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!x&nbsp;-.&nbsp;ordonnee&nbsp;/.&nbsp;pente&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!y&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;&nbsp;x&nbsp;:=&nbsp;!y<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_zero_halley methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_zero_halley&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1.&nbsp;/.&nbsp;(&nbsp;f&nbsp;x&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;!x<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;j&nbsp;=&nbsp;float_jet&nbsp;methode&nbsp;2&nbsp;g&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;f&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;num&nbsp;=&nbsp;(&nbsp;j&nbsp;!x&nbsp;).(1)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;denom&nbsp;=&nbsp;(&nbsp;j&nbsp;!x&nbsp;).(2)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;2.&nbsp;*.&nbsp;num&nbsp;/.&nbsp;denom&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!y&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;&nbsp;x&nbsp;:=&nbsp;!y<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_zero_householder methode order maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_zero_householder&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(order:int)&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1.&nbsp;/.&nbsp;(&nbsp;f&nbsp;x&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;!x<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;j&nbsp;=&nbsp;float_jet&nbsp;methode&nbsp;order&nbsp;g&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;f&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;num&nbsp;=&nbsp;(&nbsp;j&nbsp;!x&nbsp;).(&nbsp;order&nbsp;-&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;denom&nbsp;=&nbsp;(&nbsp;j&nbsp;!x&nbsp;).(order)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;(&nbsp;float&nbsp;order&nbsp;)&nbsp;*.&nbsp;num&nbsp;/.&nbsp;denom&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!y&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;&nbsp;x&nbsp;:=&nbsp;!y<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_zero_pot_pourri methode maxorder maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_zero_pot_pourri&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxorder:int)&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;a&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;!xx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;!xx&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_zero_secant&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_zero_newton&nbsp;methode&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_zero_halley&nbsp;methode&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;maxorder&nbsp;&gt;=&nbsp;3&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;order&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;maxorder&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_zero_householder&nbsp;methode&nbsp;order&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_zero_pot_pourri_alea methode maxorder maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_zero_pot_pourri_alea&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxorder:int)&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;excursion&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;float&nbsp;maxstep&nbsp;)&nbsp;*.&nbsp;epsilon_float&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;a&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;!xx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;!xx&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_zero_secant&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_zero_newton&nbsp;methode&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_zero_halley&nbsp;methode&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;excursion&nbsp;:=&nbsp;2.&nbsp;*.&nbsp;(&nbsp;!y&nbsp;-.&nbsp;!x&nbsp;)&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!excursion&nbsp;=&nbsp;0.&nbsp;<span class="keyword">then</span>&nbsp;excursion&nbsp;:=&nbsp;(&nbsp;float&nbsp;maxstep&nbsp;)&nbsp;*.&nbsp;epsilon_float&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;maxorder&nbsp;&gt;=&nbsp;3&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;order&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;maxorder&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_zero_householder&nbsp;methode&nbsp;order&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!x&nbsp;*.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;<span class="constructor">Random</span>.float&nbsp;!excursion)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!x&nbsp;*.&nbsp;(&nbsp;1.&nbsp;+.&nbsp;<span class="constructor">Random</span>.float&nbsp;!excursion)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_zero_general methode maxorder maxstep function start</pre> The idea of the auxiliary function
comes from the HP journal of december 1979 about the HP34C calculator.
 The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas.
L'idée de la fonction auxiliaire provient du journal HP de décembre 1979 concernant la calculette HP34C.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_zero_general&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxorder:int)&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;exp&nbsp;(&nbsp;-.&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;-.&nbsp;1.&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;a&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xxx&nbsp;=&nbsp;ref&nbsp;(&nbsp;g&nbsp;a&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;!xx<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yyy&nbsp;=&nbsp;ref&nbsp;!xxx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;!xx&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_zero_pot_pourri&nbsp;methode&nbsp;maxorder&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;;&nbsp;xxx&nbsp;:=&nbsp;g&nbsp;!y&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_zero_pot_pourri&nbsp;methode&nbsp;maxorder&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yyy&nbsp;:=&nbsp;g&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xxx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yyy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;&nbsp;xxx&nbsp;:=&nbsp;!yyy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_zero_general_alea methode maxorder maxstep function start</pre> The idea of the auxiliary function
comes from the HP journal of december 1979 about the HP34C calculator.
 The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas.
L'idée de la fonction auxiliaire provient du journal HP de décembre 1979 concernant la calculette HP34C.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_zero_general_alea&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxorder:int)&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;exp&nbsp;(&nbsp;-.&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;-.&nbsp;1.&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;a&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xxx&nbsp;=&nbsp;ref&nbsp;(&nbsp;g&nbsp;a&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;!xx<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yyy&nbsp;=&nbsp;ref&nbsp;!xxx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;!xx&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_zero_pot_pourri_alea&nbsp;methode&nbsp;maxorder&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;;&nbsp;xxx&nbsp;:=&nbsp;g&nbsp;!y&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_zero_pot_pourri_alea&nbsp;methode&nbsp;maxorder&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yyy&nbsp;:=&nbsp;g&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;!xxx&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;!yyy&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;f&nbsp;!y&nbsp;;&nbsp;xxx&nbsp;:=&nbsp;!yyy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_float_zero_secant maxstep function start</pre> This method may work for a root of order one.
<p>

Cette méthode peut fonctionner pour une racine d'ordre un.*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_float_zero_secant&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;a&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;a&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_bal_random&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;)&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;a&nbsp;)&nbsp;/.&nbsp;10.&nbsp;)&nbsp;+.&nbsp;sqrt&nbsp;epsilon_float&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;!y&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xxx&nbsp;=&nbsp;ref&nbsp;(&nbsp;abs_float&nbsp;!xx&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;!xx&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;ref&nbsp;(&nbsp;abs_float&nbsp;!yy&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zzz&nbsp;=&nbsp;ref&nbsp;(&nbsp;abs_float&nbsp;!zz&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;[|&nbsp;!xxx&nbsp;;&nbsp;!yyy&nbsp;;&nbsp;!zzz&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;!xx&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pente&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;(&nbsp;!yy&nbsp;-.&nbsp;!xx&nbsp;)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;!x&nbsp;!y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;!y&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;!yy&nbsp;pente&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;f&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zzz&nbsp;:=&nbsp;abs_float&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v.(2)&nbsp;&lt;-&nbsp;!zzz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.fast_sort&nbsp;compare&nbsp;v&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;v.(0)&nbsp;=&nbsp;!zzz&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;&nbsp;yy&nbsp;:=&nbsp;!zz&nbsp;;&nbsp;yyy&nbsp;:=&nbsp;!zzz&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;v.(0)&nbsp;=&nbsp;!xxx&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;y&nbsp;:=&nbsp;!x&nbsp;;&nbsp;yy&nbsp;:=&nbsp;!xx&nbsp;;&nbsp;yyy&nbsp;:=&nbsp;!xxx&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;v.(1)&nbsp;=&nbsp;!zzz&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!z&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!zz&nbsp;;&nbsp;xxx&nbsp;:=&nbsp;!zzz&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;v.(1)&nbsp;=&nbsp;!yyy&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;&nbsp;xx&nbsp;:=&nbsp;!yy&nbsp;;&nbsp;xxx&nbsp;:=&nbsp;!yyy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>desc_grad_zero methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;desc_grad_zero&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;f&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pente&nbsp;=&nbsp;gradient&nbsp;methode&nbsp;f&nbsp;!x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ordonnee&nbsp;=&nbsp;f&nbsp;!x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;!x&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_right_div&nbsp;ordonnee&nbsp;pente&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!y&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;:=&nbsp;!y<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_float_halley_zero methode_reduc methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
The parameter <code class="code">n</code> is the maximum number of steps for the pseudo-inverse of symmetric matrices.
The reduction method <code class="code">methode_reduc</code> applies to real symmetric matrices.
<p>

La méthode de réduction <code class="code">methode_reduc</code> s'applique aux matrices symétriques réelles.
La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas.
La paramètre <code class="code">n</code> est le nombre maximal de pas pour le pseudo-inverse des matrices symétriques. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_float_halley_zero&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_reduc&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;f&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pente&nbsp;=&nbsp;gradient&nbsp;methode&nbsp;f&nbsp;!x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;quadra&nbsp;=&nbsp;<span class="constructor">Matrix</span>.sym_float_pinv&nbsp;methode_reduc&nbsp;1e-3&nbsp;(&nbsp;hess&nbsp;methode&nbsp;f&nbsp;!x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;!x&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_vector_float_prod&nbsp;quadra&nbsp;pente&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!y&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;:=&nbsp;!y<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_float_zero_general methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_float_zero_general&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;exp&nbsp;(&nbsp;-.&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;-.&nbsp;1.&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;f&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_zero_secant&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;desc_grad_zero&nbsp;methode&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_zero_secant&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;desc_grad_zero&nbsp;methode&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_float_zero_general_alea methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_float_zero_general_alea&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;exp&nbsp;(&nbsp;-.&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;-.&nbsp;1.&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;excursion&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;float&nbsp;maxstep&nbsp;)&nbsp;*.&nbsp;epsilon_float&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;f&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_zero_secant&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;desc_grad_zero&nbsp;methode&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_zero_secant&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;desc_grad_zero&nbsp;methode&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;excursion&nbsp;:=&nbsp;2.&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;!y&nbsp;!x&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!excursion&nbsp;=&nbsp;0.&nbsp;<span class="keyword">then</span>&nbsp;excursion&nbsp;:=&nbsp;(&nbsp;float&nbsp;maxstep&nbsp;)&nbsp;*.&nbsp;epsilon_float&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!y&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_bal_random&nbsp;l&nbsp;!excursion&nbsp;;<br>
&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;!z&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!z&nbsp;)&nbsp;&lt;&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!y&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!z&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_float_zero_general_2 methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
The reduction method <code class="code">methode_reduc</code> applies to real symmetric matrices.
<p>

La méthode de réduction <code class="code">methode_reduc</code> s'applique aux matrices symétriques réelles.
La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_float_zero_general_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_reduc&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;exp&nbsp;(&nbsp;-.&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;-.&nbsp;1.&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;f&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_zero_secant&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;desc_grad_zero&nbsp;methode&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_halley_zero&nbsp;methode_reduc&nbsp;methode&nbsp;maxstep&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_zero_secant&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;desc_grad_zero&nbsp;methode&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_halley_zero&nbsp;methode_reduc&nbsp;methode&nbsp;maxstep&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_float_zero_general_2_alea methode_reduc methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
The reduction method <code class="code">methode_reduc</code> applies to real symmetric matrices.
<p>

La méthode de réduction <code class="code">methode_reduc</code> s'applique aux matrices symétriques réelles.
La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_float_zero_general_2_alea&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_reduc&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;exp&nbsp;(&nbsp;-.&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;-.&nbsp;1.&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;excursion&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;float&nbsp;maxstep&nbsp;)&nbsp;*.&nbsp;epsilon_float&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;f&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_zero_secant&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;desc_grad_zero&nbsp;methode&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_halley_zero&nbsp;methode_reduc&nbsp;methode&nbsp;maxstep&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_zero_secant&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;desc_grad_zero&nbsp;methode&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_halley_zero&nbsp;methode_reduc&nbsp;methode&nbsp;maxstep&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;excursion&nbsp;:=&nbsp;2.&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;!y&nbsp;!x&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!excursion&nbsp;=&nbsp;0.&nbsp;<span class="keyword">then</span>&nbsp;excursion&nbsp;:=&nbsp;(&nbsp;float&nbsp;maxstep&nbsp;)&nbsp;*.&nbsp;epsilon_float&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;&gt;&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!y&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_bal_random&nbsp;l&nbsp;!excursion&nbsp;;<br>
&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;!z&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!z&nbsp;)&nbsp;&lt;&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!z&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_zero_newton methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_zero_newton&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pente&nbsp;=&nbsp;tlm&nbsp;methode&nbsp;f&nbsp;!x<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ordonnee&nbsp;=&nbsp;f&nbsp;!x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;inverse&nbsp;=&nbsp;<span class="constructor">Matrix</span>.clean_inv&nbsp;pente&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;!x&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_vector_float_prod&nbsp;inverse&nbsp;ordonnee&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;&gt;&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;f&nbsp;!y&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;:=&nbsp;!y<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
&nbsp;&nbsp;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_zero_general methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_zero_general&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;vector&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;f&nbsp;vector&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;g&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_zero_newton&nbsp;methode&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_zero_general&nbsp;methode&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_zero_general_alea methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_zero_general_alea&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;vector&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;f&nbsp;vector&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;excursion&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;float&nbsp;maxstep&nbsp;)&nbsp;*.&nbsp;epsilon_float&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;g&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_zero_newton&nbsp;methode&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_zero_general_alea&nbsp;methode&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;excursion&nbsp;:=&nbsp;2.&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;!y&nbsp;!x&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!excursion&nbsp;=&nbsp;0.&nbsp;<span class="keyword">then</span>&nbsp;excursion&nbsp;:=&nbsp;(&nbsp;float&nbsp;maxstep&nbsp;)&nbsp;*.&nbsp;epsilon_float&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;(&nbsp;g&nbsp;!x&nbsp;)&nbsp;&gt;&nbsp;(&nbsp;g&nbsp;!y&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_bal_random&nbsp;l&nbsp;!excursion&nbsp;;<br>
&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;!z&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;(&nbsp;g&nbsp;!z&nbsp;)&nbsp;&lt;&nbsp;(&nbsp;g&nbsp;!x&nbsp;)&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!z&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_zero_general_2 methode_reduc methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
The reduction method <code class="code">methode_reduc</code> applies to real symmetric matrices.
<p>

La méthode de réduction <code class="code">methode_reduc</code> s'applique aux matrices symétriques réelles.
La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_zero_general_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_reduc&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;vector&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;f&nbsp;vector&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;g&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_zero_newton&nbsp;methode&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_zero_general_2&nbsp;methode_reduc&nbsp;methode&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_zero_general_2_alea methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
The reduction method <code class="code">methode_reduc</code> applies to real symmetric matrices.
<p>

La méthode de réduction <code class="code">methode_reduc</code> s'applique aux matrices symétriques réelles.
La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_zero_general_2_alea&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_reduc&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;vector&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;f&nbsp;vector&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;excursion&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;float&nbsp;maxstep&nbsp;)&nbsp;*.&nbsp;epsilon_float&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;(&nbsp;(&nbsp;!step&nbsp;&lt;=&nbsp;maxstep&nbsp;)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(&nbsp;g&nbsp;!x&nbsp;&lt;&gt;&nbsp;0.&nbsp;)&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_zero_newton&nbsp;methode&nbsp;1&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;vector_float_zero_general_2_alea&nbsp;methode_reduc&nbsp;methode&nbsp;1&nbsp;g&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;excursion&nbsp;:=&nbsp;2.&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;!y&nbsp;!x&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;!excursion&nbsp;=&nbsp;0.&nbsp;<span class="keyword">then</span>&nbsp;excursion&nbsp;:=&nbsp;(&nbsp;float&nbsp;maxstep&nbsp;)&nbsp;*.&nbsp;epsilon_float&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;g&nbsp;!y&nbsp;&lt;&nbsp;g&nbsp;!x&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!y&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_bal_random&nbsp;l&nbsp;!excursion&nbsp;;<br>
&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;!z&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;g&nbsp;!z&nbsp;&lt;&nbsp;g&nbsp;!x&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;(&nbsp;x&nbsp;:=&nbsp;!z&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;step&nbsp;:=&nbsp;!step&nbsp;+&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_matrix_zero_general methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_matrix_zero_general&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;vector&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;f&nbsp;vector&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;vector_zero_general&nbsp;methode&nbsp;maxstep&nbsp;g&nbsp;a&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_matrix_zero_general_alea methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
<p>

La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_matrix_zero_general_alea&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;vector&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;f&nbsp;vector&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;vector_zero_general_alea&nbsp;methode&nbsp;maxstep&nbsp;g&nbsp;a&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_matrix_zero_general_2 methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
The reduction method <code class="code">methode_reduc</code> applies to real symmetric matrices.
<p>

La méthode de réduction <code class="code">methode_reduc</code> s'applique aux matrices symétriques réelles.
La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_matrix_zero_general_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_reduc&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;vector&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;f&nbsp;vector&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;vector_zero_general_2&nbsp;methode_reduc&nbsp;methode&nbsp;maxstep&nbsp;g&nbsp;a&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_matrix_zero_general_2_alea methode maxstep function start</pre> The (unidimensional) derivating method must contain the parameters, including the step.
The reduction method <code class="code">methode_reduc</code> applies to real symmetric matrices.
<p>

La méthode de réduction <code class="code">methode_reduc</code> s'applique aux matrices symétriques réelles.
La méthode de dérivation (unidimensionnelle) doit contenir les paramètres, y compris le pas. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_matrix_zero_general_2_alea&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_reduc&nbsp;methode&nbsp;(maxstep:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;vector&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;f&nbsp;vector&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;vector_zero_general_2_alea&nbsp;methode_reduc&nbsp;methode&nbsp;maxstep&nbsp;g&nbsp;a&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_zero methode function start</pre> The zeroing method 
(of a function which associates a matrix to a vector) must contain all the parameters.
<p>

La méthode d'annulation (d'une fonction qui à un vecteur associe une matrice) doit contenir tous les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_zero&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;vector&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.vector_float_demakeup&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_foa_demakeup&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_foa_cut&nbsp;l&nbsp;(&nbsp;<span class="constructor">Matrix</span>.<span class="constructor">Float_vector_cons</span>&nbsp;vector&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.vector_float_demakeup&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_foa_demakeup&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_foa_cut&nbsp;l&nbsp;(&nbsp;<span class="constructor">Matrix</span>.<span class="constructor">Float_vector_cons</span>&nbsp;(&nbsp;methode&nbsp;g&nbsp;(&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;<span class="constructor">Array</span>.append&nbsp;[|&nbsp;|]&nbsp;a&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_vector_zero methode function start</pre> The zeroing method 
(of a function which associates a vector to a vector) must contain all the parameters.
<p>

La méthode d'annulation (d'une fonction qui à un vecteur associe un vecteur) doit contenir tous les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_vector_zero&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;vector&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.vector_float_demakeup&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_foa_demakeup&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_foa_cut&nbsp;l&nbsp;(&nbsp;<span class="constructor">Matrix</span>.<span class="constructor">Float_vector_cons</span>&nbsp;vector&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.vector_float_demakeup&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_foa_demakeup&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_foa_cut&nbsp;l&nbsp;(&nbsp;<span class="constructor">Matrix</span>.<span class="constructor">Float_vector_cons</span>&nbsp;(&nbsp;methode&nbsp;g&nbsp;(&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;<span class="constructor">Array</span>.append&nbsp;[|&nbsp;|]&nbsp;a&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_float_zero methode function start</pre> The zeroing method 
(of a function which associates a real to a vector) must contain all the parameters.
<p>

La méthode d'annulation (d'une fonction qui à un vecteur associe un réel) doit contenir tous les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_float_zero&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;vector&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.vector_float_demakeup&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_foa_demakeup&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_foa_cut&nbsp;l&nbsp;(&nbsp;<span class="constructor">Matrix</span>.<span class="constructor">Float_vector_cons</span>&nbsp;vector&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Matrix</span>.vector_float_demakeup&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_foa_demakeup&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_foa_cut&nbsp;l&nbsp;(&nbsp;<span class="constructor">Matrix</span>.<span class="constructor">Float_vector_cons</span>&nbsp;(&nbsp;methode&nbsp;g&nbsp;(&nbsp;<span class="constructor">Array</span>.fold_left&nbsp;<span class="constructor">Array</span>.append&nbsp;[|&nbsp;|]&nbsp;a&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="3_Remarque"><h3>Remarque</h3></span>
<span id="3_Remark"><h3>Remark</h3></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** When searching for zeros on discrete data via the interpolation, be aware of the
<code class="code">float_regular_stair_interpol</code> and of the other methods of interpolation which use it.
<p>

En cas de recherche de zéros sur des données discrètes via l'interpolation,
se méfier de l'interpolation par escalier dérivable <code class="code">float_regular_stair_interpol</code> et
des autres méthodes d'interpolation qui l'utilisent. *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Intgration"><h1>Intégration</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctionsintgres"><h2>Fonctions intégrées</h2></span>
<span id="2_Integratedfunctions"><h2>Integrated functions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_rect nintervals function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_rect&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;length&nbsp;=&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;n&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nn&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;(&nbsp;f&nbsp;(&nbsp;a&nbsp;+.&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;*.&nbsp;length&nbsp;)&nbsp;)&nbsp;*.&nbsp;length<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_incr_rect ratio nintervals function a b</pre> The step increases exponentially 
from <code class="code">a</code> to <code class="code">b</code>. The ratio <code class="code">ratio</code> is the decreasing ratio, situated strictly between 0 and 1.
<p>

Le pas croît exponentiellement de <code class="code">a</code> vers <code class="code">b</code>. Le taux <code class="code">ratio</code> est le taux de décroissance, 
compris strictement entre 0 et 1. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_incr_rect&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(ratio:float)&nbsp;(n:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;b<br>
&nbsp;<span class="keyword">and</span>&nbsp;length&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;*.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;ratio&nbsp;)&nbsp;/.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;ratio&nbsp;**&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;-.&nbsp;!length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;*.&nbsp;!length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;length&nbsp;:=&nbsp;ratio&nbsp;*.&nbsp;!length&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_decr_rect ratio nintervals function a b</pre> The step decreases exponentially 
from <code class="code">a</code> to <code class="code">b</code>. The ratio <code class="code">ratio</code> is the decreasing ratio, situated strictly between 0 and 1.
<p>

Le pas décroît exponentiellement de <code class="code">a</code> vers <code class="code">b</code>. Le taux <code class="code">ratio</code> est le taux de décroissance, 
compris strictement entre 0 et 1. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_decr_rect&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(ratio:float)&nbsp;(n:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;length&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;*.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;ratio&nbsp;)&nbsp;/.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;ratio&nbsp;**&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;!length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;*.&nbsp;!length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;length&nbsp;:=&nbsp;ratio&nbsp;*.&nbsp;!length&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_trapez nintervals function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_trapez&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;length&nbsp;=&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;n&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nn&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;(&nbsp;f&nbsp;(&nbsp;a&nbsp;+.&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;*.&nbsp;length&nbsp;)&nbsp;)&nbsp;*.&nbsp;length<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;(&nbsp;f&nbsp;a&nbsp;+.&nbsp;f&nbsp;b&nbsp;)&nbsp;*.&nbsp;length&nbsp;*.&nbsp;0.5&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_incr_trapez ratio nintervals function a b</pre> The step increases exponentially 
from <code class="code">a</code> to <code class="code">b</code>. The ratio <code class="code">ratio</code> is the decreasing ratio, situated strictly between 0 and 1.
<p>

Le pas croît exponentiellement de <code class="code">a</code> vers <code class="code">b</code>. Le taux <code class="code">ratio</code> est le taux de décroissance, 
compris strictement entre 0 et 1. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_incr_trapez&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(ratio:float)&nbsp;(n:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;b<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;b<br>
&nbsp;<span class="keyword">and</span>&nbsp;length&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;*.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;ratio&nbsp;)&nbsp;/.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;ratio&nbsp;**&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;-.&nbsp;!length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;(&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;+.&nbsp;(&nbsp;f&nbsp;!xx&nbsp;)&nbsp;)&nbsp;*.&nbsp;!length&nbsp;*.&nbsp;0.5&nbsp;;<br>
&nbsp;&nbsp;&nbsp;length&nbsp;:=&nbsp;ratio&nbsp;*.&nbsp;!length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_decr_trapez ratio nintervals function a b</pre> The step decreases exponentially 
from <code class="code">a</code> to <code class="code">b</code>. The ratio <code class="code">ratio</code> is the decreasing ratio, situated strictly between 0 and 1.
<p>

Le pas décroît exponentiellement de <code class="code">a</code> vers <code class="code">b</code>. Le taux <code class="code">ratio</code> est le taux de décroissance, 
compris strictement entre 0 et 1. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_decr_trapez&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(ratio:float)&nbsp;(n:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;length&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;*.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;ratio&nbsp;)&nbsp;/.&nbsp;(&nbsp;1.&nbsp;-.&nbsp;ratio&nbsp;**&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!xx&nbsp;+.&nbsp;!length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;(&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;+.&nbsp;(&nbsp;f&nbsp;!xx&nbsp;)&nbsp;)&nbsp;*.&nbsp;!length&nbsp;*.&nbsp;0.5&nbsp;;<br>
&nbsp;&nbsp;&nbsp;length&nbsp;:=&nbsp;ratio&nbsp;*.&nbsp;!length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_simpson nintervals function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_simpson&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;length&nbsp;=&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;/.&nbsp;(&nbsp;2.&nbsp;*.&nbsp;float&nbsp;n&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;n&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nn&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;(&nbsp;f&nbsp;(&nbsp;a&nbsp;+.&nbsp;(&nbsp;float&nbsp;(&nbsp;2&nbsp;*&nbsp;i&nbsp;)&nbsp;)&nbsp;*.&nbsp;length&nbsp;)&nbsp;+.&nbsp;2.&nbsp;*.&nbsp;f&nbsp;(&nbsp;a&nbsp;+.&nbsp;(&nbsp;float&nbsp;(&nbsp;2&nbsp;*&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;)&nbsp;*.&nbsp;length&nbsp;)&nbsp;)&nbsp;*.&nbsp;length&nbsp;*.&nbsp;2.&nbsp;/.&nbsp;3.<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;(&nbsp;f&nbsp;a&nbsp;+.&nbsp;f&nbsp;b&nbsp;+.&nbsp;4.&nbsp;*.&nbsp;f&nbsp;(&nbsp;a&nbsp;+.&nbsp;length&nbsp;)&nbsp;)&nbsp;*.&nbsp;length&nbsp;/.&nbsp;3.&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_romberg order degree function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_romberg&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(k:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;kk&nbsp;=&nbsp;abs&nbsp;k<br>
&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;abs&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;kk&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_int_trapez&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;2.&nbsp;**&nbsp;(&nbsp;float&nbsp;nn&nbsp;)&nbsp;)&nbsp;)&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_int_simpson&nbsp;(&nbsp;int_of_float&nbsp;(&nbsp;2.&nbsp;**&nbsp;(&nbsp;float&nbsp;nn&nbsp;)&nbsp;)&nbsp;)&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kkk&nbsp;=&nbsp;kk&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;4.&nbsp;**&nbsp;(&nbsp;float&nbsp;kk&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;aa&nbsp;=&nbsp;float_int_romberg&nbsp;(&nbsp;nn&nbsp;+&nbsp;1&nbsp;)&nbsp;kkk&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;float_int_romberg&nbsp;nn&nbsp;kkk&nbsp;f&nbsp;a&nbsp;b&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;coeff&nbsp;*.&nbsp;aa&nbsp;-.&nbsp;bb&nbsp;)&nbsp;/.&nbsp;(&nbsp;coeff&nbsp;-.&nbsp;1.&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int order degree function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(k:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;(&nbsp;2&nbsp;*&nbsp;n&nbsp;)&nbsp;/&nbsp;3&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;seq&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;succ&nbsp;nn&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nnn&nbsp;=&nbsp;n&nbsp;-&nbsp;nn&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nn&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;seq.(i)&nbsp;&lt;-&nbsp;float_int_romberg&nbsp;(&nbsp;nnn&nbsp;+&nbsp;i&nbsp;)&nbsp;k&nbsp;f&nbsp;a&nbsp;b&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.float_approx&nbsp;seq&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_monte_carlo nsamples function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_monte_carlo&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;range&nbsp;=&nbsp;b&nbsp;-.&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;length&nbsp;=&nbsp;range&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;(&nbsp;f&nbsp;(&nbsp;a&nbsp;+.&nbsp;<span class="constructor">Random</span>.float&nbsp;range&nbsp;)&nbsp;)&nbsp;*.&nbsp;length<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_romberg_step_trapez function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_romberg_step_trapez&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;(&nbsp;f&nbsp;a&nbsp;+.&nbsp;f&nbsp;b&nbsp;)&nbsp;*.&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_romberg_trapez_adapt tolerance function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_romberg_trapez_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;float_romberg_step_trapez&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;ref&nbsp;(&nbsp;float_romberg_step_trapez&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_romberg_step_trapez&nbsp;f&nbsp;c&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;!second&nbsp;-.&nbsp;first&nbsp;)&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;!second&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;float_int_romberg_trapez_adapt&nbsp;tol&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_int_romberg_trapez_adapt&nbsp;tol&nbsp;f&nbsp;c&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;!second&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_romberg_trapez_bounded maxstages tolerance function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_romberg_trapez_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_romberg_step_trapez&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;float_romberg_step_trapez&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;ref&nbsp;(&nbsp;float_romberg_step_trapez&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_romberg_step_trapez&nbsp;f&nbsp;c&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;!second&nbsp;-.&nbsp;first&nbsp;)&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;!second&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;float_int_romberg_trapez_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;tol&nbsp;f&nbsp;a&nbsp;c<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+.&nbsp;float_int_romberg_trapez_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;tol&nbsp;f&nbsp;c&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!second&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_romberg_step_simpson function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_romberg_step_simpson&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;(&nbsp;f&nbsp;a&nbsp;+.&nbsp;f&nbsp;b&nbsp;+.&nbsp;4.&nbsp;*.&nbsp;f&nbsp;(&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;)&nbsp;)&nbsp;*.&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;/.&nbsp;6.&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_romberg_simpson_adapt tolerance function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_romberg_simpson_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;float_romberg_step_simpson&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;ref&nbsp;(&nbsp;float_romberg_step_simpson&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_romberg_step_simpson&nbsp;f&nbsp;c&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;!second&nbsp;-.&nbsp;first&nbsp;)&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;!second&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;float_int_romberg_simpson_adapt&nbsp;tol&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_int_romberg_simpson_adapt&nbsp;tol&nbsp;f&nbsp;c&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;!second&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_romberg_simpson_bounded maxstages tolerance function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_romberg_simpson_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_romberg_step_simpson&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;float_romberg_step_simpson&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;ref&nbsp;(&nbsp;float_romberg_step_simpson&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_romberg_step_simpson&nbsp;f&nbsp;c&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;!second&nbsp;-.&nbsp;first&nbsp;)&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;!second&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;float_int_romberg_simpson_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;tol&nbsp;f&nbsp;a&nbsp;c<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+.&nbsp;float_int_romberg_simpson_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;tol&nbsp;f&nbsp;c&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!second&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_romberg_step_3_8 function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_romberg_step_3_8&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;/.&nbsp;3.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;(&nbsp;f&nbsp;a&nbsp;+.&nbsp;f&nbsp;b&nbsp;+.&nbsp;3.&nbsp;*.&nbsp;(&nbsp;f&nbsp;(&nbsp;a&nbsp;+.&nbsp;step&nbsp;)&nbsp;+.&nbsp;f&nbsp;(&nbsp;b&nbsp;-.&nbsp;step&nbsp;)&nbsp;)&nbsp;)&nbsp;*.&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;*.&nbsp;0.125&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_romberg_3_8_adapt tolerance function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_romberg_3_8_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;float_romberg_step_3_8&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;ref&nbsp;(&nbsp;float_romberg_step_3_8&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_romberg_step_3_8&nbsp;f&nbsp;c&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;!second&nbsp;-.&nbsp;first&nbsp;)&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;!second&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;float_int_romberg_3_8_adapt&nbsp;tol&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_int_romberg_3_8_adapt&nbsp;tol&nbsp;f&nbsp;c&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;!second&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_romberg_3_8_bounded maxstages tolerance function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_romberg_3_8_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_romberg_step_3_8&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;float_romberg_step_3_8&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;ref&nbsp;(&nbsp;float_romberg_step_3_8&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_romberg_step_3_8&nbsp;f&nbsp;c&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;!second&nbsp;-.&nbsp;first&nbsp;)&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;!second&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;float_int_romberg_3_8_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;tol&nbsp;f&nbsp;a&nbsp;c<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+.&nbsp;float_int_romberg_3_8_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;tol&nbsp;f&nbsp;c&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!second&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_romberg_step_milne function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_romberg_step_milne&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;*.&nbsp;0.25&nbsp;<span class="keyword">in</span><br>
&nbsp;(&nbsp;7.&nbsp;*.&nbsp;(&nbsp;(&nbsp;f&nbsp;a&nbsp;)&nbsp;+.&nbsp;(&nbsp;f&nbsp;b&nbsp;)&nbsp;)&nbsp;+.&nbsp;32.&nbsp;*.&nbsp;(&nbsp;(&nbsp;f&nbsp;(&nbsp;a&nbsp;+.&nbsp;step&nbsp;)&nbsp;)&nbsp;+.&nbsp;(&nbsp;f&nbsp;(&nbsp;b&nbsp;-.&nbsp;step&nbsp;)&nbsp;)&nbsp;)&nbsp;+.&nbsp;12.&nbsp;*.&nbsp;(&nbsp;f&nbsp;(&nbsp;0.5&nbsp;*.&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;*.&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;/.&nbsp;90.&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_romberg_milne_adapt tolerance function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_romberg_milne_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;float_romberg_step_milne&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;ref&nbsp;(&nbsp;float_romberg_step_milne&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_romberg_step_milne&nbsp;f&nbsp;c&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;!second&nbsp;-.&nbsp;first&nbsp;)&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;!second&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;float_int_romberg_milne_adapt&nbsp;tol&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_int_romberg_milne_adapt&nbsp;tol&nbsp;f&nbsp;c&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;!second&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_romberg_milne_bounded maxstages tolerance function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_romberg_milne_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_romberg_step_milne&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;float_romberg_step_milne&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;ref&nbsp;(&nbsp;float_romberg_step_milne&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_romberg_step_milne&nbsp;f&nbsp;c&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;!second&nbsp;-.&nbsp;first&nbsp;)&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;!second&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;float_int_romberg_milne_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;tol&nbsp;f&nbsp;a&nbsp;c<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+.&nbsp;float_int_romberg_milne_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;tol&nbsp;f&nbsp;c&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!second&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The following vectors are coefficients to use with <code class="code">float_simple_step_gauss_kronrod_generic</code> 
and to define <code class="code">float_romberg_step_gauss_kronrod</code>.
<p>

Les vecteurs ci-dessous sont des coefficients pour <code class="code">float_simple_step_gauss_kronrod_generic</code> 
et définissant <code class="code">float_romberg_step_gauss_kronrod</code>. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_abscissae_7_bis&nbsp;=&nbsp;[|&nbsp;0.949107912342759&nbsp;;&nbsp;0.741531185599394&nbsp;;&nbsp;0.405845151377397&nbsp;;&nbsp;&nbsp;0.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_weights_7_bis&nbsp;=&nbsp;[|&nbsp;0.129484966168870&nbsp;;&nbsp;0.279705391489277&nbsp;;&nbsp;0.381830050505119&nbsp;;&nbsp;0.417959183673469&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;kronrod_abscissae_15_bis&nbsp;=&nbsp;[|&nbsp;0.991455371120813&nbsp;;&nbsp;0.949107912342759&nbsp;;&nbsp;0.864864423359769&nbsp;;&nbsp;<br>
&nbsp;0.741531185599394&nbsp;;&nbsp;0.586087235467691&nbsp;;&nbsp;0.405845151377397&nbsp;;&nbsp;0.207784955007898&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;kronrod_weights_15_bis&nbsp;=&nbsp;[|&nbsp;0.022935322010529&nbsp;;&nbsp;0.063092092629979&nbsp;;&nbsp;0.104790010322250&nbsp;;&nbsp;0.140653259715525&nbsp;;&nbsp;<br>
&nbsp;0.169004726639267&nbsp;;&nbsp;0.190350578064785&nbsp;;&nbsp;0.204432940075298&nbsp;;&nbsp;0.209482141084728&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_weights_7&nbsp;=&nbsp;[|&nbsp;0.129484966168869693270611432679082&nbsp;;&nbsp;0.279705391489276667901467771423780&nbsp;;<br>
&nbsp;0.381830050505118944950369775488975&nbsp;;&nbsp;0.417959183673469387755102040816327&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_abscissae_7&nbsp;=&nbsp;[|&nbsp;0.949107912342758524526189684047851&nbsp;;<br>
&nbsp;0.741531185599394439863864773280788&nbsp;;&nbsp;0.405845151377397166906606412076961&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;kronrod_abscissae_15&nbsp;=&nbsp;[|&nbsp;0.991455371120812639206854697526329&nbsp;;&nbsp;0.949107912342758524526189684047851&nbsp;;&nbsp;0.864864423359769072789712788640926&nbsp;;<br>
&nbsp;0.741531185599394439863864773280788&nbsp;;&nbsp;0.586087235467691130294144838258730&nbsp;;&nbsp;0.405845151377397166906606412076961&nbsp;;&nbsp;0.207784955007898467600689403773245&nbsp;;&nbsp;0.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;kronrod_weights_15&nbsp;=&nbsp;[|&nbsp;0.022935322010529224963732008058970;&nbsp;0.063092092629978553290700663189204&nbsp;;<br>
&nbsp;0.104790010322250183839876322541518&nbsp;;&nbsp;0.140653259715525918745189590510238&nbsp;;&nbsp;0.169004726639267902826583426598550&nbsp;;<br>
&nbsp;0.190350578064785409913256402421014&nbsp;;&nbsp;0.204432940075298892414161999234649&nbsp;;&nbsp;0.209482141084727828012999174891714&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_abscissae_7&nbsp;=&nbsp;[|&nbsp;0.960491&nbsp;;&nbsp;0.774597&nbsp;;&nbsp;0.434244&nbsp;;&nbsp;0.000000&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_weights_7&nbsp;=&nbsp;[|&nbsp;0.104656&nbsp;;&nbsp;0.268488&nbsp;;&nbsp;0.401397&nbsp;;&nbsp;0.450917&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_weights_5to7&nbsp;=&nbsp;[|&nbsp;0.0&nbsp;;&nbsp;0.555556&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.888889&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_abscissae_9&nbsp;=&nbsp;[|&nbsp;0.976560&nbsp;;&nbsp;0.861136&nbsp;;&nbsp;0.640286&nbsp;;&nbsp;0.339981&nbsp;;&nbsp;0.0&nbsp;|]<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_weights_9&nbsp;=&nbsp;[|&nbsp;0.062977&nbsp;;&nbsp;0.170054&nbsp;;&nbsp;0.266798&nbsp;;&nbsp;0.326949&nbsp;;&nbsp;0.346443&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_weights_7to9&nbsp;=&nbsp;[|&nbsp;0.0&nbsp;;&nbsp;0.347855&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.652145&nbsp;;&nbsp;0.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_abscissae_15&nbsp;=&nbsp;[|&nbsp;0.2077849550789850&nbsp;;&nbsp;0.4058451513773972&nbsp;;&nbsp;0.5860872354676911&nbsp;;<br>
&nbsp;0.7415311855993944&nbsp;;&nbsp;0.8648644233597691&nbsp;;&nbsp;0.9491079123427585&nbsp;;&nbsp;0.9914553711208126&nbsp;;&nbsp;0.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_weights_15&nbsp;=&nbsp;[|&nbsp;0.2044329400752989&nbsp;;&nbsp;0.1903505780647854&nbsp;;&nbsp;0.1690047266392679&nbsp;;<br>
&nbsp;0.1406532597155259&nbsp;;&nbsp;0.1047900103222502&nbsp;;&nbsp;0.06309209262997855&nbsp;;&nbsp;0.02293532201052922&nbsp;;&nbsp;0.2094821410847278&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_abscissae_21&nbsp;=&nbsp;[|&nbsp;0.99565716302580808073552728070&nbsp;;&nbsp;0.97390652851717172007796401210&nbsp;;&nbsp;&nbsp;0.93015749135570822600120718010&nbsp;;&nbsp;<br>
&nbsp;0.86506336668898451073209668840&nbsp;;&nbsp;0.78081772658641689706371757830&nbsp;;&nbsp;0.67940956829902440623432736510&nbsp;;&nbsp;0.56275713466860468333900009930&nbsp;;<br>
&nbsp;0.43339539412924719079926594320&nbsp;;&nbsp;0.29439286270146019813112660310&nbsp;;&nbsp;0.14887433898163121088482600110&nbsp;;&nbsp;0.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_weights_21&nbsp;=&nbsp;[|&nbsp;0.11694638867371874278064396060e-1&nbsp;;&nbsp;0.32558162307964727478818972460e-1&nbsp;;&nbsp;0.54755896574351996031381300240e-1&nbsp;;&nbsp;<br>
&nbsp;0.75039674810919952767043140920e-1&nbsp;;&nbsp;0.93125454583697605535065465080e-1&nbsp;;&nbsp;0.10938715880229764189921059030&nbsp;;&nbsp;0.12349197626206585107795810980&nbsp;;&nbsp;<br>
&nbsp;0.13470921731147332592805400180&nbsp;;&nbsp;0.14277593857706008079709427310&nbsp;;&nbsp;0.14773910490133849137484151600&nbsp;;&nbsp;0.14944555400291690566493646840&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_weights_11to21&nbsp;=&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.66671344308688137593568809890e-1&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.14945134915058059314577633970&nbsp;;&nbsp;0.&nbsp;;&nbsp;<br>
&nbsp;0.21908636251598204399553493420&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.26926671930999635509122692160&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.29552422471475287017389299470&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_abscissae_31&nbsp;=&nbsp;[|&nbsp;0.1011420669187175&nbsp;;&nbsp;0.2011940939974345&nbsp;;&nbsp;0.2991800071531688&nbsp;;&nbsp;0.3941513470775634&nbsp;;&nbsp;<br>
0.4850818636402397&nbsp;;&nbsp;0.5709721726085388&nbsp;;&nbsp;0.6509967412974170&nbsp;;&nbsp;0.7244177313601700&nbsp;;&nbsp;0.7904185014424659&nbsp;;&nbsp;0.8482065834104272&nbsp;;<br>
&nbsp;0.8972645323440819&nbsp;;&nbsp;0.9372733924007059&nbsp;;&nbsp;0.9677390756791391&nbsp;;&nbsp;0.9879925180204854&nbsp;;&nbsp;0.9980022986933971&nbsp;;&nbsp;0.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_weights_31&nbsp;=&nbsp;[|&nbsp;0.1007698455238756&nbsp;;&nbsp;0.09917359872179196&nbsp;;&nbsp;0.09664272698362368&nbsp;;&nbsp;0.09312659817082532&nbsp;;<br>
&nbsp;0.08856444305621177&nbsp;;&nbsp;0.08308050282313302&nbsp;;&nbsp;0.07684968075772038&nbsp;;&nbsp;0.06985412131872826&nbsp;;&nbsp;0.06200956780067064&nbsp;;&nbsp;0.05348152469092809&nbsp;;<br>
&nbsp;0.04458975132476488&nbsp;;&nbsp;0.03534636079137585&nbsp;;&nbsp;0.02546084732671532&nbsp;;&nbsp;0.01500794732931612&nbsp;;&nbsp;0.05377479872923349&nbsp;;&nbsp;0.001013300070147915&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_abscissae_41&nbsp;=&nbsp;[|&nbsp;0.07652652113349733&nbsp;;&nbsp;0.1526054652409227&nbsp;;&nbsp;0.2277858511416451&nbsp;;&nbsp;0.3016278681149130&nbsp;;<br>
&nbsp;0.3737060887154196&nbsp;;&nbsp;0.4435931752387251&nbsp;;&nbsp;0.5108670019508271&nbsp;;&nbsp;0.5751404468197103&nbsp;;&nbsp;0.6360536807265150&nbsp;;&nbsp;0.6932376563347514&nbsp;;<br>
&nbsp;0.7463319064601508&nbsp;;&nbsp;0.7950414288375512&nbsp;;&nbsp;0.8391169718222188&nbsp;;&nbsp;0.8782768112522820&nbsp;;&nbsp;0.9122344282513259&nbsp;;&nbsp;0.9408226338317548&nbsp;;<br>
&nbsp;0.9639719272779138&nbsp;;&nbsp;0.9815078774502503&nbsp;;&nbsp;0.9931285991850949&nbsp;;&nbsp;0.9988590315882777&nbsp;;&nbsp;0.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_kronrod_weights_41&nbsp;=&nbsp;[|&nbsp;0.07637786767208074&nbsp;;&nbsp;0.07570449768455667&nbsp;;&nbsp;0.07458287540049919&nbsp;;&nbsp;0.07303069033278667&nbsp;;<br>
&nbsp;0.07105442355344407&nbsp;;&nbsp;0.06864867292852162&nbsp;;&nbsp;0.06583459713361842&nbsp;;&nbsp;0.06265323755478117&nbsp;;&nbsp;0.05911140088063957&nbsp;;&nbsp;0.05519510534828599&nbsp;;<br>
&nbsp;0.05094457392372869&nbsp;;&nbsp;0.04643482186749767&nbsp;;&nbsp;0.04166887332797369&nbsp;;&nbsp;0.03660016975820080&nbsp;;&nbsp;0.03128730677703280&nbsp;;&nbsp;0.02588213360495116&nbsp;;<br>
&nbsp;0.02038837346126652&nbsp;;&nbsp;0.01462616925697125&nbsp;;&nbsp;0.008600269855642942&nbsp;;&nbsp;0.003073583718520532&nbsp;;&nbsp;0.07660071191799966&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_romberg_step_gauss_kronrod function a b</pre> The data come from the source code of <code class="code">scilab</code>, 
which quotes <code class="code">quadpack</code>.
<p>

Les données proviennent du cose source de <code class="code">scilab</code>, qui cite <code class="code">quadpack</code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_romberg_step_gauss_kronrod&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;gauss_kronrod_abscissae_21<br>
&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;gauss_kronrod_weights_21<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;gauss_kronrod_weights_11to21<br>
&nbsp;<span class="keyword">and</span>&nbsp;delta&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;valueplus&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;valueminus&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;halflength&nbsp;=&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;*.&nbsp;0.5<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5<br>
&nbsp;<span class="keyword">and</span>&nbsp;accumul&nbsp;=&nbsp;ref&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;(&nbsp;w.(10)&nbsp;*.&nbsp;f&nbsp;c&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;9&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;delta&nbsp;:=&nbsp;halflength&nbsp;*.&nbsp;x.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;valueplus&nbsp;:=&nbsp;f&nbsp;(&nbsp;c&nbsp;+.&nbsp;!delta&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;valueminus&nbsp;:=&nbsp;f&nbsp;(&nbsp;c&nbsp;-.&nbsp;!delta&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;w.(i)&nbsp;*.&nbsp;!valueplus&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;w.(i)&nbsp;*.&nbsp;!valueminus&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accumul&nbsp;:=&nbsp;!accumul&nbsp;+.&nbsp;ww.(i)&nbsp;*.&nbsp;!valueplus&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accumul&nbsp;:=&nbsp;!accumul&nbsp;+.&nbsp;ww.(i)&nbsp;*.&nbsp;!valueminus&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;[|&nbsp;halflength&nbsp;*.&nbsp;!accu&nbsp;;&nbsp;halflength&nbsp;*.&nbsp;!accumul&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_simple_step_gauss_kronrod_generic abscissae weights function a b</pre>  *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_simple_step_gauss_kronrod_generic&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:float&nbsp;array)&nbsp;(w:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;ll&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;w&nbsp;)&nbsp;-&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;delta&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;valueplus&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;valueminus&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;halflength&nbsp;=&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;*.&nbsp;0.5<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;(&nbsp;w.(ll)&nbsp;*.&nbsp;f&nbsp;c&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;delta&nbsp;:=&nbsp;halflength&nbsp;*.&nbsp;x.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;valueplus&nbsp;:=&nbsp;f&nbsp;(&nbsp;c&nbsp;+.&nbsp;!delta&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;valueminus&nbsp;:=&nbsp;f&nbsp;(&nbsp;c&nbsp;-.&nbsp;!delta&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;w.(i)&nbsp;*.&nbsp;!valueplus&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;w.(i)&nbsp;*.&nbsp;!valueminus&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;halflength&nbsp;*.&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_simple_step_gauss_kronrod function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_simple_step_gauss_kronrod&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;(&nbsp;float_romberg_step_gauss_kronrod&nbsp;f&nbsp;a&nbsp;b&nbsp;).(0)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_romberg_gauss_kronrod_adapt tolerance function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_romberg_gauss_kronrod_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;float_romberg_step_gauss_kronrod&nbsp;f&nbsp;a&nbsp;b&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;first.(0)&nbsp;-.&nbsp;first.(1)&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;abs_float&nbsp;(&nbsp;first.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">then</span>&nbsp;first.(0)<br>
&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;(&nbsp;float_int_romberg_gauss_kronrod_adapt&nbsp;tol&nbsp;f&nbsp;a&nbsp;c&nbsp;)&nbsp;+.&nbsp;(&nbsp;float_int_romberg_gauss_kronrod_adapt&nbsp;tol&nbsp;f&nbsp;c&nbsp;b&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_romberg_gauss_kronrod_bounded maxstages tolerance function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_romberg_gauss_kronrod_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_simple_step_gauss_kronrod&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;float_romberg_step_gauss_kronrod&nbsp;f&nbsp;a&nbsp;b&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;first.(0)&nbsp;-.&nbsp;first.(1)&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;abs_float&nbsp;(&nbsp;first.(0)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">then</span>&nbsp;first.(0)<br>
&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;(&nbsp;float_int_romberg_gauss_kronrod_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;tol&nbsp;f&nbsp;a&nbsp;c&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;+.&nbsp;(&nbsp;float_int_romberg_gauss_kronrod_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;tol&nbsp;f&nbsp;c&nbsp;b&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_tanh nintervals function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_tanh&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nnn&nbsp;=&nbsp;float&nbsp;n<br>
&nbsp;<span class="keyword">and</span>&nbsp;halflength&nbsp;=&nbsp;0.5&nbsp;*.&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;center&nbsp;=&nbsp;0.5&nbsp;*.&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;halfpi&nbsp;*.&nbsp;sqrt&nbsp;(&nbsp;2.&nbsp;/.&nbsp;nnn&nbsp;)&nbsp;-.&nbsp;(&nbsp;1.&nbsp;/.&nbsp;nnn&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;2&nbsp;*&nbsp;n&nbsp;+&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;(&nbsp;<span class="keyword">fun</span>&nbsp;i&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;tanh&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;i&nbsp;-&nbsp;n&nbsp;)&nbsp;)&nbsp;*.&nbsp;h&nbsp;)&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;nn&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;h&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_right_sub&nbsp;1.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_coeff_prod&nbsp;x&nbsp;x&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nn&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;w.(i)&nbsp;*.&nbsp;(&nbsp;f&nbsp;(&nbsp;center&nbsp;+.&nbsp;halflength&nbsp;*.&nbsp;x.(i)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!accu&nbsp;*.&nbsp;halflength&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_tanh_sinh parameter function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_tanh_sinh&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(m:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;float&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;halflength&nbsp;=&nbsp;0.5&nbsp;*.&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;center&nbsp;=&nbsp;0.5&nbsp;*.&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;2.&nbsp;**&nbsp;mm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;8&nbsp;*&nbsp;(&nbsp;int_of_float&nbsp;coeff&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;1.&nbsp;/.&nbsp;coeff<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;2&nbsp;*&nbsp;n&nbsp;+&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;(&nbsp;<span class="keyword">fun</span>&nbsp;i&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;tanh&nbsp;(&nbsp;halfpi&nbsp;*.&nbsp;sinh&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;i&nbsp;-&nbsp;n&nbsp;)&nbsp;)&nbsp;*.&nbsp;h&nbsp;)&nbsp;)&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;nn&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;<span class="constructor">Array</span>.mapi&nbsp;(&nbsp;<span class="keyword">fun</span>&nbsp;i&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;cosh&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;i&nbsp;-&nbsp;n&nbsp;)&nbsp;)&nbsp;*.&nbsp;h&nbsp;)&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;nn&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_coeff_prod&nbsp;xx&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;h&nbsp;*.&nbsp;halfpi&nbsp;)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_right_sub&nbsp;1.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_coeff_prod&nbsp;x&nbsp;x&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;nn&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;w.(i)&nbsp;*.&nbsp;(&nbsp;f&nbsp;(&nbsp;center&nbsp;+.&nbsp;halflength&nbsp;*.&nbsp;x.(i)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!accu&nbsp;*.&nbsp;halflength&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The following vectors are used to calculate the <code class="code">float_weighted_int_0_1</code> method of integration.
<p>

Les vecteurs suivants servent à calculer la méthode d'intégration <code class="code">float_weighted_int_0_1</code>. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_1_w&nbsp;=&nbsp;[|&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_2_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;2.&nbsp;[|&nbsp;3.&nbsp;;&nbsp;-1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_3_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;12.&nbsp;[|&nbsp;23.&nbsp;;&nbsp;-16.&nbsp;;&nbsp;5.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_4_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;24.&nbsp;[|&nbsp;55.&nbsp;;&nbsp;-59.&nbsp;;&nbsp;37.&nbsp;;&nbsp;-9.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_5_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;720.&nbsp;[|&nbsp;1901.&nbsp;;&nbsp;-2774.&nbsp;;&nbsp;2616.&nbsp;;&nbsp;-1274.&nbsp;;&nbsp;251.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_6_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;1440.&nbsp;[|&nbsp;4277.&nbsp;;&nbsp;-7923.&nbsp;;&nbsp;9982.&nbsp;;&nbsp;-7298.&nbsp;;&nbsp;2877.&nbsp;;&nbsp;-475.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_7_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;60480.&nbsp;[|&nbsp;198721.&nbsp;;&nbsp;-447288.&nbsp;;&nbsp;705549.&nbsp;;&nbsp;-688256.&nbsp;;&nbsp;407139.&nbsp;;&nbsp;-134472.&nbsp;;&nbsp;19087.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_8_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;120960.&nbsp;[|&nbsp;434241.&nbsp;;&nbsp;-1152169.&nbsp;;&nbsp;2183877.&nbsp;;&nbsp;-2664477.&nbsp;;&nbsp;2102243.&nbsp;;&nbsp;-1041723.&nbsp;;&nbsp;295767.&nbsp;;&nbsp;-36799.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_9_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;3628800.&nbsp;[|&nbsp;14097247.&nbsp;;&nbsp;-43125206.&nbsp;;<br>
&nbsp;95476786.&nbsp;;&nbsp;-139855262.&nbsp;;&nbsp;137968480.&nbsp;;&nbsp;-91172642.&nbsp;;&nbsp;38833486.&nbsp;;&nbsp;-9664106.&nbsp;;&nbsp;1070017.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_10_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;7257600.&nbsp;[|&nbsp;30277247.&nbsp;;&nbsp;-104995189.&nbsp;;&nbsp;265932680.&nbsp;;&nbsp;-454661776.&nbsp;;&nbsp;538363838.&nbsp;;<br>
&nbsp;-444772162.&nbsp;;&nbsp;252618224.&nbsp;;&nbsp;-94307320.&nbsp;;&nbsp;20884811.&nbsp;;&nbsp;-2082753.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_12_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;958003200.&nbsp;[|&nbsp;4527766399.&nbsp;;&nbsp;-19433810163.&nbsp;;&nbsp;61633227185.&nbsp;;&nbsp;-135579356757.&nbsp;;<br>
&nbsp;214139355366.&nbsp;;&nbsp;-247741639374.&nbsp;;&nbsp;211103573298.&nbsp;;&nbsp;-131365867290.&nbsp;;&nbsp;58189107627.&nbsp;;&nbsp;-17410248271.&nbsp;;&nbsp;3158642445.&nbsp;;&nbsp;-262747265.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_14_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;5230697472e3&nbsp;[|&nbsp;27511554976875.&nbsp;;&nbsp;-140970750679621.&nbsp;;&nbsp;537247052515662.&nbsp;;&nbsp;-1445313351681906.&nbsp;;&nbsp;2854429571790805.&nbsp;;&nbsp;-4246767353305755.&nbsp;;&nbsp;4825671323488452.&nbsp;;<br>
&nbsp;-4204551925534524.&nbsp;;&nbsp;2793869602879077.&nbsp;;&nbsp;-1393306307155755.&nbsp;;&nbsp;505586141196430.&nbsp;;&nbsp;-126174972681906.&nbsp;;&nbsp;19382853593787.&nbsp;;&nbsp;-1382741929621.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_16_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;62768369664e3&nbsp;[|&nbsp;362555126427073.&nbsp;;&nbsp;-2161567671248849.&nbsp;;&nbsp;9622096909515337.&nbsp;;<br>
&nbsp;-30607373860520569.&nbsp;;&nbsp;72558117072259733.&nbsp;;&nbsp;-131963191940828581.&nbsp;;&nbsp;187463140112902893.&nbsp;;&nbsp;-210020588912321949.&nbsp;;&nbsp;186087544263596643.&nbsp;;<br>
&nbsp;-129930094104237331.&nbsp;;&nbsp;70724351582843483.&nbsp;;&nbsp;-29417910911251819.&nbsp;;&nbsp;9038571752734087.&nbsp;;&nbsp;-1934443196892599.&nbsp;;&nbsp;257650275915823.&nbsp;;&nbsp;-16088129229375.&nbsp;&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_18_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;6402373705728e4&nbsp;[|&nbsp;401972381695456831.&nbsp;;&nbsp;-2735437642844079789.&nbsp;;&nbsp;13930159965811142228.&nbsp;;&nbsp;<br>
&nbsp;-51150187791975812900.&nbsp;;&nbsp;141500575026572531760.&nbsp;;&nbsp;-304188128232928718008.&nbsp;;&nbsp;518600355541383671092.&nbsp;;&nbsp;-710171024091234303204.&nbsp;;&nbsp;<br>
&nbsp;786600875277595877750.&nbsp;;&nbsp;-706174326992944287370.&nbsp;;&nbsp;512538584122114046748.&nbsp;;&nbsp;-298477260353977522892.&nbsp;;&nbsp;137563142659866897224.&nbsp;;<br>
&nbsp;-49070094880794267600.&nbsp;;&nbsp;13071639236569712860.&nbsp;;&nbsp;-2448689255584545196.&nbsp;;&nbsp;287848942064256339.&nbsp;;&nbsp;-15980174332775873.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_20_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;10218188434341888e4&nbsp;[|&nbsp;691668239157222107697.&nbsp;;&nbsp;-5292843584961252933125.&nbsp;;<br>
&nbsp;30349492858024727686755.&nbsp;;&nbsp;-126346544855927856134295.&nbsp;;&nbsp;399537307669842150996468.&nbsp;;&nbsp;-991168450545135070835076.&nbsp;;&nbsp;1971629028083798845750380.&nbsp;;<br>
&nbsp;-3191065388846318679544380.&nbsp;;&nbsp;4241614331208149947151790.&nbsp;;&nbsp;-4654326468801478894406214.&nbsp;;&nbsp;4222756879776354065593786.&nbsp;;&nbsp;-3161821089800186539248210.&nbsp;;<br>
&nbsp;1943018818982002395655620.&nbsp;;&nbsp;-970350191086531368649620.&nbsp;;&nbsp;387739787034699092364924.&nbsp;;&nbsp;-121059601023985433003532.&nbsp;;&nbsp;28462032496476316665705.&nbsp;;<br>
&nbsp;-4740335757093710713245.&nbsp;;&nbsp;498669220956647866875.&nbsp;;&nbsp;-24919383499187492303.&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_m&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;<span class="constructor">Util</span>.reverse_array&nbsp;[|&nbsp;adams_bashforth_1_w&nbsp;;&nbsp;adams_bashforth_2_w&nbsp;;&nbsp;adams_bashforth_3_w&nbsp;;&nbsp;adams_bashforth_4_w&nbsp;;&nbsp;adams_bashforth_5_w&nbsp;;<br>
&nbsp;adams_bashforth_6_w&nbsp;;&nbsp;adams_bashforth_7_w&nbsp;;&nbsp;adams_bashforth_8_w&nbsp;;&nbsp;adams_bashforth_9_w&nbsp;;&nbsp;adams_bashforth_10_w&nbsp;;&nbsp;<span class="constructor">Array</span>.append&nbsp;adams_bashforth_10_w&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;;&nbsp;<br>
&nbsp;adams_bashforth_12_w&nbsp;;&nbsp;<span class="constructor">Array</span>.append&nbsp;adams_bashforth_12_w&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;;&nbsp;adams_bashforth_14_w&nbsp;;&nbsp;<span class="constructor">Array</span>.append&nbsp;adams_bashforth_14_w&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;;<br>
&nbsp;adams_bashforth_16_w&nbsp;;&nbsp;<span class="constructor">Array</span>.append&nbsp;adams_bashforth_16_w&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;;&nbsp;adams_bashforth_18_w&nbsp;;&nbsp;<span class="constructor">Array</span>.append&nbsp;adams_bashforth_18_w&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;;&nbsp;adams_bashforth_20_w&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;adams_bashforth_x&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.float_closed_equal_subdivision&nbsp;1.&nbsp;n&nbsp;0.&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_x&nbsp;=&nbsp;adams_bashforth_x&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_1_w&nbsp;=&nbsp;[|&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_2_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;2.0&nbsp;[|&nbsp;1.0&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_3_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;12.0&nbsp;<br>
&nbsp;[|&nbsp;5.0&nbsp;;&nbsp;8.0&nbsp;;&nbsp;-&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_4_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;24.0&nbsp;<br>
&nbsp;[|&nbsp;9.0&nbsp;;&nbsp;19.0&nbsp;;&nbsp;-&nbsp;5.0&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_5_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;720.0&nbsp;<br>
&nbsp;[|&nbsp;251.0&nbsp;;&nbsp;646.0&nbsp;;&nbsp;-&nbsp;264.0&nbsp;;&nbsp;106.0&nbsp;;&nbsp;-&nbsp;19.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_6_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;1440.0&nbsp;<br>
&nbsp;[|&nbsp;475.0&nbsp;;&nbsp;1427.0&nbsp;;&nbsp;-&nbsp;798.0&nbsp;;&nbsp;482.0&nbsp;;&nbsp;-&nbsp;173.0&nbsp;;&nbsp;27.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_7_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;60480.0&nbsp;<br>
&nbsp;[|&nbsp;19087.0&nbsp;;&nbsp;65112.0&nbsp;;&nbsp;-&nbsp;46461.0&nbsp;;&nbsp;37504.0&nbsp;;&nbsp;-&nbsp;20211.0&nbsp;;&nbsp;6312.0&nbsp;;&nbsp;-&nbsp;863.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_8_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;120960.0&nbsp;<br>
&nbsp;[|&nbsp;36799.0&nbsp;;&nbsp;139849.0&nbsp;;&nbsp;-&nbsp;121797.0&nbsp;;&nbsp;123133.0&nbsp;;&nbsp;-&nbsp;88547.0&nbsp;;&nbsp;41499.0&nbsp;;&nbsp;-&nbsp;11351.0&nbsp;;&nbsp;1375.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_9_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;3628800.0&nbsp;<br>
[|&nbsp;1070017.0&nbsp;;&nbsp;4467094.0&nbsp;;&nbsp;-&nbsp;4604594.0&nbsp;;&nbsp;5595358.0&nbsp;;&nbsp;-&nbsp;5033120.0&nbsp;;&nbsp;3146338.0&nbsp;;&nbsp;-&nbsp;1291214.0&nbsp;;&nbsp;312874.0&nbsp;;&nbsp;-&nbsp;33953.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_10_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;7257600.0&nbsp;<br>
&nbsp;[|&nbsp;2082753.0&nbsp;;&nbsp;9449717.0&nbsp;;&nbsp;-&nbsp;11271304.0&nbsp;;&nbsp;16002320.0&nbsp;;&nbsp;-&nbsp;17283646.0&nbsp;;&nbsp;13510082.0&nbsp;;&nbsp;-&nbsp;7394032.0&nbsp;;&nbsp;2687864.0&nbsp;;&nbsp;-&nbsp;583435.0&nbsp;;&nbsp;57281.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_12_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;958003200.0&nbsp;<br>
&nbsp;[|&nbsp;262747265.0&nbsp;;&nbsp;1374799219.0&nbsp;;&nbsp;-2092490673.0&nbsp;;&nbsp;3828828885.0&nbsp;;&nbsp;-5519460582.0&nbsp;;<br>
&nbsp;6043521486.0&nbsp;;&nbsp;-4963166514.0&nbsp;;&nbsp;3007739418.0&nbsp;;&nbsp;-1305971115.0&nbsp;;&nbsp;384709327.0&nbsp;;&nbsp;-68928781.0&nbsp;;&nbsp;5675265.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_14_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;5230697472000.0&nbsp;<br>
&nbsp;[|&nbsp;1382741929621.0&nbsp;;&nbsp;8153167962181.0&nbsp;;&nbsp;-15141235084110.0&nbsp;;&nbsp;33928990133618.0&nbsp;;&nbsp;-61188680131285.0&nbsp;;&nbsp;86180228689563.0&nbsp;;<br>
&nbsp;-94393338653892.0&nbsp;;&nbsp;80101021029180.0&nbsp;;&nbsp;-52177910882661.0&nbsp;;&nbsp;25620259777835.0&nbsp;;&nbsp;-9181635605134.0&nbsp;;&nbsp;2268078814386.0&nbsp;;&nbsp;-345457086395.0&nbsp;;&nbsp;24466579093.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_16_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;62768369664000.0&nbsp;<br>
[|&nbsp;16088129229375.0&nbsp;;&nbsp;105145058757073.0&nbsp;;&nbsp;-230992163723849.0&nbsp;;&nbsp;612744541065337.0&nbsp;;&nbsp;-1326978663058069.0&nbsp;;&nbsp;2285168598349733.0&nbsp;;<br>
&nbsp;-3129453071993581.0&nbsp;;&nbsp;3414941728852893.0&nbsp;;&nbsp;-2966365730265699.0&nbsp;;&nbsp;2039345879546643.0&nbsp;;&nbsp;-1096355235402331.0&nbsp;;&nbsp;451403108933483.0&nbsp;;&nbsp;-137515713789319.0&nbsp;;<br>
&nbsp;29219384284087.0&nbsp;;&nbsp;-3867689367599.0&nbsp;;&nbsp;240208245823.0&nbsp;|]&nbsp;;;<br>
&nbsp;<br>
<span class="keyword">let</span>&nbsp;adams_moulton_18_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;64023737057280000.0&nbsp;<br>
[|&nbsp;15980174332775873.0&nbsp;;&nbsp;114329243705491117.0&nbsp;;&nbsp;-290470969929371220.0&nbsp;;&nbsp;890337710266029860.0&nbsp;;&nbsp;-2250854333681641520.0&nbsp;;<br>
&nbsp;4582441343348851896.0&nbsp;;&nbsp;-7532171919277411636.0&nbsp;;&nbsp;10047287575124288740.0&nbsp;;&nbsp;-10910555637627652470.0&nbsp;;&nbsp;9644799218032932490.0&nbsp;;&nbsp;-6913858539337636636.0&nbsp;;<br>
&nbsp;3985516155854664396.0&nbsp;;&nbsp;-1821304040326216520.0&nbsp;;&nbsp;645008976643217360.0&nbsp;;&nbsp;-170761422500096220.0&nbsp;;&nbsp;31816981024600492.0&nbsp;;&nbsp;-3722582669836627.0&nbsp;;<br>
&nbsp;205804074290625.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;adams_moulton_20_w&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;102181884343418880000.0<br>
[|&nbsp;24919383499187492303.0&nbsp;;&nbsp;193280569173472261637.0&nbsp;;&nbsp;-558160720115629395555.0&nbsp;;&nbsp;1941395668950986461335.0&nbsp;;&nbsp;-5612131802364455926260.0&nbsp;;<br>
&nbsp;13187185898439270330756.0&nbsp;;&nbsp;-25293146116627869170796.0&nbsp;;&nbsp;39878419226784442421820.0&nbsp;;&nbsp;-51970649453670274135470.0&nbsp;;&nbsp;56154678684618739939910.0&nbsp;;<br>
&nbsp;-50320851025594566473146.0&nbsp;;&nbsp;37297227252822858381906.0&nbsp;;&nbsp;-22726350407538133839300.0&nbsp;;&nbsp;11268210124987992327060.0&nbsp;;&nbsp;-4474886658024166985340.0&nbsp;;<br>
&nbsp;1389665263296211699212.0&nbsp;;&nbsp;-325187970422032795497.0&nbsp;;&nbsp;53935307402575440285.0&nbsp;;&nbsp;-5652892248087175675.0&nbsp;;&nbsp;281550972898020815.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_1_x&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_1_w&nbsp;=&nbsp;[|&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_2_x&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;-.&nbsp;sqrt_of_3&nbsp;/.&nbsp;6.&nbsp;;&nbsp;0.5&nbsp;+.&nbsp;sqrt_of_3&nbsp;/.&nbsp;6.&nbsp;|]<br>
</code><table><tr><td></td><td><span class="comment">(** <code class="code"><span class="keywordsign">|</span> 0.2113248654 ; 0.7886751346 <span class="keywordsign">|</span></code> *)</span></td></tr></table><code class="code">&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_2_w&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_3_x&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;-.&nbsp;0.1&nbsp;*.&nbsp;(&nbsp;sqrt_of_15&nbsp;)&nbsp;;&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;+.&nbsp;0.1&nbsp;*.&nbsp;(&nbsp;sqrt_of_15&nbsp;)&nbsp;|]<br>
</code><table><tr><td></td><td><span class="comment">(** <code class="code"><span class="keywordsign">|</span> 0.1127016654 ; 0.5 ; 0.887298334 <span class="keywordsign">|</span></code> *)</span></td></tr></table><code class="code">&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_3_w&nbsp;=&nbsp;[|&nbsp;5.&nbsp;/.&nbsp;18.&nbsp;;&nbsp;8.&nbsp;/.&nbsp;18.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;18.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_4_x&nbsp;=&nbsp;[|&nbsp;0.0694318442&nbsp;;&nbsp;0.3300094782&nbsp;;&nbsp;0.6699905218&nbsp;;&nbsp;0.9305681558&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_4_w&nbsp;=&nbsp;[|&nbsp;0.1739274226&nbsp;;&nbsp;0.3260725774&nbsp;;&nbsp;0.3260725774&nbsp;;&nbsp;0.1739274226&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_5_x&nbsp;=&nbsp;[|&nbsp;0.0469100770&nbsp;;&nbsp;0.2307653449&nbsp;;&nbsp;0.5&nbsp;;&nbsp;0.7692346551&nbsp;;&nbsp;0.9530899230&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_5_w&nbsp;=&nbsp;[|&nbsp;0.1184634425&nbsp;;&nbsp;0.2393143352&nbsp;;&nbsp;0.2844444444&nbsp;;&nbsp;0.2393143352&nbsp;;&nbsp;0.1184634425&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_6_x&nbsp;=&nbsp;[|&nbsp;0.0337652429&nbsp;;&nbsp;0.1693953068&nbsp;;&nbsp;0.3806904070&nbsp;;&nbsp;0.6193095930&nbsp;;&nbsp;0.8306046932&nbsp;;&nbsp;0.9662347571&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_6_w&nbsp;=&nbsp;[|&nbsp;0.0856622462&nbsp;;&nbsp;0.1803807865&nbsp;;&nbsp;0.2339569673&nbsp;;&nbsp;0.2339569673&nbsp;;&nbsp;0.1803807865&nbsp;;&nbsp;0.0856622462&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_7_x&nbsp;=&nbsp;[|&nbsp;0.0254460438&nbsp;;&nbsp;0.1292344072&nbsp;;&nbsp;0.2970774243&nbsp;;&nbsp;0.5000000000&nbsp;;&nbsp;0.7029225757&nbsp;;&nbsp;0.8707655928&nbsp;;&nbsp;0.9745539562&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_7_w&nbsp;=&nbsp;[|&nbsp;0.0647424831&nbsp;;&nbsp;0.1398526957&nbsp;;&nbsp;0.1909150253&nbsp;;&nbsp;0.2089795918&nbsp;;&nbsp;0.1909150253&nbsp;;&nbsp;0.1398526957&nbsp;;&nbsp;0.0647424831&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_8_x&nbsp;=&nbsp;[|&nbsp;0.0198550718&nbsp;;&nbsp;0.1016667613&nbsp;;&nbsp;0.2372337950&nbsp;;&nbsp;0.4082826788&nbsp;;&nbsp;0.5917173212&nbsp;;&nbsp;0.7627662050&nbsp;;&nbsp;0.8983332387&nbsp;;&nbsp;0.9801449282&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_0_1_8_w&nbsp;=&nbsp;[|&nbsp;0.0506142681&nbsp;;&nbsp;0.1111905172&nbsp;;&nbsp;0.1568533229&nbsp;;&nbsp;0.1813418917&nbsp;;&nbsp;0.1813418917&nbsp;;&nbsp;0.1568533229&nbsp;;&nbsp;0.1111905172&nbsp;;&nbsp;0.0506142681&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_weighted_int_0_1 abscissae weights function</pre> The standard abscissae are spread over the interval [0 ; 1].
<p>

Les abscisses normalisées sont réparties sur l'interavlle [0 ; 1]. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_weighted_int_0_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:float&nbsp;array)&nbsp;(w:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;w.(i)&nbsp;*.&nbsp;(&nbsp;f&nbsp;x.(i)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The following vectors are used to calculate the <code class="code">float_weighted_int_minus1_1</code> method of integration.
<p>

Les vecteurs suivants servent à calculer la méthode d'intégration <code class="code">float_weighted_int_minus1_1</code>. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_1_x&nbsp;=&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_1_w&nbsp;=&nbsp;[|&nbsp;2.&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_2_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_2_w&nbsp;=&nbsp;[|&nbsp;1.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_3_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_3_w&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;4.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_4_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.5&nbsp;;&nbsp;0.5&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_4_w&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;8.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;8.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_x_5_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.70710678118654752440&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.70710678118654752440&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_5_w&nbsp;=&nbsp;[|&nbsp;0.06666666666666666667&nbsp;;&nbsp;0.53333333333333333333&nbsp;;&nbsp;0.80000000000000000000&nbsp;;&nbsp;0.53333333333333333333&nbsp;;&nbsp;0.06666666666666666667&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_6_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.80901699437494742410&nbsp;;&nbsp;-0.30901699437494742410&nbsp;;&nbsp;0.30901699437494742410&nbsp;;&nbsp;0.80901699437493732410&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_6_w&nbsp;=&nbsp;[|&nbsp;0.04&nbsp;;&nbsp;0.36074304120001121619&nbsp;;&nbsp;0.59925695879998878381&nbsp;;&nbsp;0.59925695879998878381&nbsp;;&nbsp;0.36074304120001121619&nbsp;;&nbsp;0.04&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_7_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.86602540378443864676&nbsp;;&nbsp;-0.5&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.5&nbsp;;&nbsp;0.86602540378443864676&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_7_w&nbsp;=&nbsp;[|&nbsp;0.02857142857142857143&nbsp;;&nbsp;0.25396825396825396825&nbsp;;&nbsp;0.45714285714285714286&nbsp;;<br>
&nbsp;0.52063492063492063492&nbsp;;&nbsp;0.45714285714285714286&nbsp;;&nbsp;0.25396825396825396825&nbsp;;&nbsp;0.02857142857142857143&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_8_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.90096886790241912624&nbsp;;&nbsp;-0.62348980185873353053&nbsp;;&nbsp;-0.22252093395631440429&nbsp;;<br>
&nbsp;0.22252093395631440429&nbsp;;&nbsp;0.62348980185873353053&nbsp;;&nbsp;0.90096886790241910624&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_8_w&nbsp;=&nbsp;[|&nbsp;0.02040816326530612245&nbsp;;&nbsp;0.19014100721820835178&nbsp;;&nbsp;0.35224242371815911533&nbsp;;&nbsp;0.43720840579832641044&nbsp;;<br>
&nbsp;0.43720840579832641044&nbsp;;&nbsp;0.35224242371815911533&nbsp;;&nbsp;0.19014100721820835178&nbsp;;&nbsp;0.02040816326530612245&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_9_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.92387953251128675613&nbsp;;&nbsp;-0.70710678118654752440&nbsp;;&nbsp;-0.38268343236508977173&nbsp;;&nbsp;0.00000000000000000000&nbsp;;<br>
&nbsp;0.38268343236508977173&nbsp;;&nbsp;0.70710678118654752440&nbsp;;&nbsp;0.92387953251128675613&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_9_w&nbsp;=&nbsp;[|&nbsp;0.01587301587301587302&nbsp;;&nbsp;0.14621864921601815501&nbsp;;&nbsp;0.27936507936507936508&nbsp;;&nbsp;0.36171785872048978150&nbsp;;<br>
&nbsp;0.39365079365079365079&nbsp;;&nbsp;0.36171785872048978150&nbsp;;&nbsp;0.27936507936507936508&nbsp;;&nbsp;0.14621864921601815501&nbsp;;&nbsp;0.01587301587301587302&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_10_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.93969262078590838405&nbsp;;&nbsp;-0.76604444311897903520&nbsp;;&nbsp;-0.50000000000000000000&nbsp;;&nbsp;-0.17364817766693034885&nbsp;;<br>
&nbsp;0.17364817766693034885&nbsp;;&nbsp;0.50000000000000000000&nbsp;;&nbsp;0.76604444311897903520&nbsp;;&nbsp;0.93969262078590838405&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_10_w&nbsp;=&nbsp;[|&nbsp;0.01234567901234567901&nbsp;;&nbsp;0.11656745657203712296&nbsp;;&nbsp;0.22528432333810440813&nbsp;;&nbsp;0.30194003527336860670&nbsp;;&nbsp;0.34386250580414418320&nbsp;;<br>
&nbsp;0.34386250580414418320&nbsp;;&nbsp;0.30194003527336860670&nbsp;;&nbsp;0.22528432333810440813&nbsp;;&nbsp;0.11656745657203712296&nbsp;;&nbsp;0.01234567901234567901&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_11_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.95105651629515357212&nbsp;;&nbsp;-0.80901699437494742410&nbsp;;&nbsp;-0.58778525229247312917&nbsp;;&nbsp;-0.30901699437494742410&nbsp;;&nbsp;0.&nbsp;;<br>
&nbsp;0.30901699437494742410&nbsp;;&nbsp;0.58778525229247312917&nbsp;;&nbsp;0.80901699437494742410&nbsp;;&nbsp;0.95105651629515357212&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_11_w&nbsp;=&nbsp;[|&nbsp;0.01010101010101010101&nbsp;;&nbsp;0.09457905488370156116&nbsp;;&nbsp;0.18563521442424776529&nbsp;;&nbsp;0.25358833328368660623&nbsp;;&nbsp;0.29921327042423708320&nbsp;;<br>
&nbsp;0.31376623376623376623&nbsp;;&nbsp;0.29921327042423708320&nbsp;;&nbsp;0.25358833328368660623&nbsp;;&nbsp;0.18563521442424776529&nbsp;;&nbsp;0.09457905488370156116&nbsp;;&nbsp;0.01010101010101010101&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_12_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.95949297361449738989&nbsp;;&nbsp;-0.84125353283118116886&nbsp;;&nbsp;-0.65486073394528506406&nbsp;;&nbsp;-0.41541501300188642553&nbsp;;<br>
&nbsp;-0.14231483827328514044&nbsp;;&nbsp;0.14231483827328514044&nbsp;;&nbsp;0.41541501300188642553&nbsp;;&nbsp;0.65486073394528506406&nbsp;;&nbsp;0.84125353283118116886&nbsp;;&nbsp;0.95949297361449738989&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_12_w&nbsp;=&nbsp;[|&nbsp;0.00826446280991735537&nbsp;;&nbsp;0.07856015374620000543&nbsp;;&nbsp;0.15504045508256136552&nbsp;;&nbsp;0.21556254600086858099&nbsp;;<br>
&nbsp;0.25991734106691617602&nbsp;;&nbsp;0.28265504129353651666&nbsp;;&nbsp;0.28265504129353651666&nbsp;;&nbsp;0.25991734106691617602&nbsp;;&nbsp;0.21556254600086858099&nbsp;;<br>
&nbsp;0.15504045508256136552&nbsp;;&nbsp;0.07856015374620000543&nbsp;;&nbsp;0.00826446280991735537&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_13_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.96592582628906828675&nbsp;;&nbsp;-0.86602540378443864676&nbsp;;&nbsp;-0.70710678118654752440&nbsp;;&nbsp;-0.5&nbsp;;&nbsp;-0.25881904510252076235&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;0.25881904510252076235&nbsp;;&nbsp;0.5&nbsp;;&nbsp;0.70710678118654752440&nbsp;;&nbsp;0.86602540378443864676&nbsp;;&nbsp;0.96592582628906828675&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_13_w&nbsp;=&nbsp;[|&nbsp;0.00699300699300699301&nbsp;;&nbsp;0.06605742495207439452&nbsp;;&nbsp;0.13154253154253154253&nbsp;;&nbsp;0.18476338476338476338&nbsp;;<br>
&nbsp;0.22697302697302697303&nbsp;;&nbsp;0.25267569378104433860&nbsp;;&nbsp;0.26198986198986198986&nbsp;;&nbsp;0.25267569378104433860&nbsp;;&nbsp;0.22697302697302697303&nbsp;;<br>
&nbsp;0.18476338476338476338&nbsp;;&nbsp;0.13154253154253154253&nbsp;;&nbsp;0.06605742495207439452&nbsp;;&nbsp;0.00699300699300699301&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_14_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.97094181742605202716&nbsp;;&nbsp;-0.88545602565320989590&nbsp;;&nbsp;-0.74851074817110109863&nbsp;;&nbsp;-0.56806474673115580251&nbsp;;<br>
&nbsp;-0.35460488704253562597&nbsp;;&nbsp;-0.12053668025532305335&nbsp;;&nbsp;&nbsp;0.12053668025532305335&nbsp;;&nbsp;&nbsp;0.35460488704253562597&nbsp;;&nbsp;&nbsp;0.56806474673115580251&nbsp;;<br>
&nbsp;&nbsp;0.74851074817110109863&nbsp;;&nbsp;&nbsp;0.88545602565320989590&nbsp;;&nbsp;0.97094181742605202716&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_14_w&nbsp;=&nbsp;[|&nbsp;0.00591715976331360947&nbsp;;&nbsp;0.05646531376341444627&nbsp;;&nbsp;0.11276867248985655881&nbsp;;&nbsp;0.16003802611671868523&nbsp;;<br>
&nbsp;0.19899241036578321848&nbsp;;&nbsp;0.22590304977856444935&nbsp;;&nbsp;0.23991536772234903239&nbsp;;&nbsp;0.23991536772234903239&nbsp;;&nbsp;0.22590304977856444935&nbsp;;<br>
&nbsp;0.19899241036578321848&nbsp;;&nbsp;0.16003802611671868523&nbsp;;&nbsp;0.11276867248985655881&nbsp;;&nbsp;0.05646531376341444627&nbsp;;&nbsp;0.00591715976331360947&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_15_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.97492791218182360702&nbsp;;&nbsp;-0.90096886790241912624&nbsp;;&nbsp;-0.78183148246802980871&nbsp;;&nbsp;-0.62348980185873353053&nbsp;;<br>
&nbsp;-0.43388373911755812048&nbsp;;&nbsp;-0.22252093395631440429&nbsp;;&nbsp;&nbsp;0.&nbsp;;&nbsp;&nbsp;0.22252093395631440429&nbsp;;&nbsp;&nbsp;0.43388373911755812048&nbsp;;&nbsp;&nbsp;0.62348980185873353053&nbsp;;<br>
&nbsp;&nbsp;0.78183148246802980871&nbsp;;&nbsp;&nbsp;0.90096886790241912624&nbsp;;&nbsp;0.97492791218182360702&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_15_w&nbsp;=&nbsp;[|&nbsp;0.00512820512820512821&nbsp;;&nbsp;0.04869938729508823855&nbsp;;&nbsp;0.09782039167605215913&nbsp;;&nbsp;0.13966507849560431803&nbsp;;<br>
&nbsp;0.17560578900106674677&nbsp;;&nbsp;0.20205146748238357364&nbsp;;&nbsp;0.21888151163057340180&nbsp;;&nbsp;0.22429633858205286777&nbsp;;&nbsp;0.21888151163057340180&nbsp;;<br>
&nbsp;0.20205146748238357364&nbsp;;&nbsp;0.17560578900106674677&nbsp;;&nbsp;0.13966507849560431803&nbsp;;&nbsp;0.09782039167605215913&nbsp;;&nbsp;0.04869938729508823855&nbsp;;&nbsp;0.00512820512820512821&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_16_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.97814760073380563793&nbsp;;&nbsp;-0.91354545764260089550&nbsp;;&nbsp;-0.80901699437494742410&nbsp;;&nbsp;-0.66913060635885821383&nbsp;;<br>
&nbsp;-0.5&nbsp;;&nbsp;-0.30901699437494742410&nbsp;;&nbsp;-0.10452846326765347140&nbsp;;&nbsp;&nbsp;0.10452846326765347140&nbsp;;&nbsp;&nbsp;0.30901699437494742410&nbsp;;&nbsp;&nbsp;0.5&nbsp;;&nbsp;&nbsp;0.66913060635885821383&nbsp;;<br>
&nbsp;&nbsp;0.80901699437494742410&nbsp;;&nbsp;&nbsp;0.91354545764260089550&nbsp;;&nbsp;&nbsp;0.97814760073380563793&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_16_w&nbsp;=&nbsp;[|&nbsp;0.00444444444444444444&nbsp;;&nbsp;0.04251476624752508988&nbsp;;&nbsp;0.08553884025933288291&nbsp;;&nbsp;0.12294010082849361533&nbsp;;<br>
&nbsp;0.15573317603967369176&nbsp;;&nbsp;0.18132978132978132978&nbsp;;&nbsp;0.19921478132638853955&nbsp;;&nbsp;0.20828410952436040635&nbsp;;&nbsp;0.20828410952436040635&nbsp;;<br>
&nbsp;0.19921478132638853955&nbsp;;&nbsp;0.18132978132978132978&nbsp;;&nbsp;0.15573317603967369176&nbsp;;&nbsp;0.12294010082849361533&nbsp;;&nbsp;0.08553884025933288291&nbsp;;<br>
&nbsp;0.04251476624752508988&nbsp;;&nbsp;0.00444444444444444444&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_17_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.98078528040323044913&nbsp;;&nbsp;-0.92387953251128675613&nbsp;;&nbsp;-0.83146961230254523708&nbsp;;&nbsp;-0.70710678118654752440&nbsp;;<br>
&nbsp;-0.55557023301960222474&nbsp;;&nbsp;-0.38268343236508977173&nbsp;;&nbsp;-0.19509032201612826785&nbsp;;&nbsp;&nbsp;0.&nbsp;;&nbsp;&nbsp;0.19509032201612826785&nbsp;;&nbsp;&nbsp;0.38268343236508977173&nbsp;;<br>
&nbsp;&nbsp;0.55557023301960222474&nbsp;;&nbsp;&nbsp;0.70710678118654752440&nbsp;;&nbsp;&nbsp;0.83146961230254523708&nbsp;;&nbsp;&nbsp;0.92387953251128675613&nbsp;;&nbsp;&nbsp;0.98078528040323044913&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_17_w&nbsp;=&nbsp;[|&nbsp;0.00392156862745098039&nbsp;;&nbsp;0.03736870283720561032&nbsp;;&nbsp;0.07548233154315183441&nbsp;;&nbsp;0.10890555258189093044&nbsp;;<br>
&nbsp;0.13895646836823307412&nbsp;;&nbsp;0.16317266428170330256&nbsp;;&nbsp;0.18147378423649335700&nbsp;;&nbsp;0.19251386461292564687&nbsp;;&nbsp;0.19641012582189052777&nbsp;;<br>
&nbsp;0.19251386461292564687&nbsp;;&nbsp;0.18147378423649335700&nbsp;;&nbsp;0.16317266428170330256&nbsp;;&nbsp;0.13895646836823307412&nbsp;;&nbsp;0.10890555258189093044&nbsp;;<br>
&nbsp;0.07548233154315183441&nbsp;;&nbsp;0.03736870283720561032&nbsp;;&nbsp;0.00392156862745098039&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_33_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.99518472667219688624&nbsp;;&nbsp;-0.98078528040323044913&nbsp;;&nbsp;-0.95694033573220886494&nbsp;;&nbsp;-0.92387953251128675613&nbsp;;<br>
&nbsp;-0.88192126434835502971&nbsp;;&nbsp;-0.83146961230254523708&nbsp;;&nbsp;-0.77301045336273696081&nbsp;;&nbsp;-0.70710678118654752440&nbsp;;&nbsp;-0.63439328416364549822&nbsp;;<br>
&nbsp;-0.55557023301960222474&nbsp;;&nbsp;-0.47139673682599764856&nbsp;;&nbsp;-0.38268343236508977173&nbsp;;&nbsp;-0.29028467725446236764&nbsp;;&nbsp;-0.19509032201612826785&nbsp;;<br>
&nbsp;-0.098017140329560601994&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.098017140329560601994&nbsp;;&nbsp;0.19509032201612826785&nbsp;;&nbsp;0.29028467725446236764&nbsp;;&nbsp;0.38268343236508977173&nbsp;;<br>
&nbsp;0.47139673682599764856&nbsp;;&nbsp;0.55557023301960222474&nbsp;;&nbsp;0.63439328416364549822&nbsp;;&nbsp;0.70710678118654752440&nbsp;;&nbsp;0.77301045336273696081&nbsp;;<br>
&nbsp;0.83146961230254523708&nbsp;;&nbsp;0.88192126434835502971&nbsp;;&nbsp;0.92387953251128675613&nbsp;;&nbsp;0.95694033573220886494&nbsp;;&nbsp;0.98078528040323044913&nbsp;;&nbsp;0.99518472667219688624&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_33_w&nbsp;=&nbsp;[|&nbsp;0.00097751710654936461&nbsp;;&nbsp;0.00939319796295501470&nbsp;;&nbsp;0.01923424513268114918&nbsp;;&nbsp;0.02845791667723369009&nbsp;;<br>
&nbsp;0.03759434191404720602&nbsp;;&nbsp;0.04626276283775174949&nbsp;;&nbsp;0.05455501630398031044&nbsp;;&nbsp;0.06227210954529400455&nbsp;;&nbsp;0.06942757563043545090&nbsp;;<br>
&nbsp;0.07588380044138847048&nbsp;;&nbsp;0.08163481765493851023&nbsp;;&nbsp;0.08657753844182743544&nbsp;;&nbsp;0.09070611286772099874&nbsp;;&nbsp;0.09394324443876873573&nbsp;;<br>
&nbsp;0.09629232594548817919&nbsp;;&nbsp;0.09769818820805558182&nbsp;;&nbsp;0.09817857778176829677&nbsp;;&nbsp;0.09769818820805558182&nbsp;;&nbsp;0.09629232594548817919&nbsp;;<br>
&nbsp;0.09394324443876873573&nbsp;;&nbsp;0.09070611286772099874&nbsp;;&nbsp;0.08657753844182743544&nbsp;;&nbsp;0.08163481765493851023&nbsp;;&nbsp;0.07588380044138847048&nbsp;;<br>
&nbsp;0.06942757563043545090&nbsp;;&nbsp;0.06227210954529400455&nbsp;;&nbsp;0.05455501630398031044&nbsp;;&nbsp;0.04626276283775174949&nbsp;;&nbsp;0.03759434191404720602&nbsp;;<br>
&nbsp;0.02845791667723369009&nbsp;;&nbsp;0.01923424513268114918&nbsp;;&nbsp;0.00939319796295501470&nbsp;;&nbsp;0.00097751710654936461&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_65_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.99879545620517239271&nbsp;;&nbsp;-0.99518472667219688624&nbsp;;&nbsp;-0.98917650996478097345&nbsp;;&nbsp;-0.98078528040323044913&nbsp;;<br>
&nbsp;-0.97003125319454399260&nbsp;;&nbsp;-0.95694033573220886494&nbsp;;&nbsp;-0.94154406518302077841&nbsp;;&nbsp;-0.92387953251128675613&nbsp;;&nbsp;-0.90398929312344333159&nbsp;;<br>
&nbsp;-0.88192126434835502971&nbsp;;&nbsp;-0.85772861000027206990&nbsp;;&nbsp;-0.83146961230254523708&nbsp;;&nbsp;-0.80320753148064490981&nbsp;;&nbsp;-0.77301045336273696081&nbsp;;<br>
&nbsp;-0.74095112535495909118&nbsp;;&nbsp;-0.70710678118654752440&nbsp;;&nbsp;-0.67155895484701840063&nbsp;;&nbsp;-0.63439328416364549822&nbsp;;&nbsp;-0.59569930449243334347&nbsp;;<br>
&nbsp;-0.55557023301960222474&nbsp;;&nbsp;-0.51410274419322172659&nbsp;;&nbsp;-0.47139673682599764856&nbsp;;&nbsp;-0.42755509343028209432&nbsp;;&nbsp;-0.38268343236508977173&nbsp;;<br>
&nbsp;-0.33688985339222005069&nbsp;;&nbsp;-0.29028467725446236764&nbsp;;&nbsp;-0.24298017990326388995&nbsp;;&nbsp;-0.19509032201612826785&nbsp;;&nbsp;-0.14673047445536175166&nbsp;;<br>
&nbsp;-0.098017140329560601994&nbsp;;&nbsp;-0.049067674327418014255&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.049067674327418014255&nbsp;;&nbsp;0.098017140329560601994&nbsp;;<br>
&nbsp;0.14673047445536175166&nbsp;;&nbsp;0.19509032201612826785&nbsp;;&nbsp;0.24298017990326388995&nbsp;;&nbsp;0.29028467725446236764&nbsp;;&nbsp;0.33688985339222005069&nbsp;;<br>
&nbsp;0.38268343236508977173&nbsp;;&nbsp;0.42755509343028209432&nbsp;;&nbsp;0.47139673682599764856&nbsp;;&nbsp;0.51410274419322172659&nbsp;;&nbsp;0.55557023301960222474&nbsp;;<br>
&nbsp;0.59569930449243334347&nbsp;;&nbsp;0.63439328416364549822&nbsp;;&nbsp;0.67155895484701840063&nbsp;;&nbsp;0.70710678118654752440&nbsp;;&nbsp;0.74095112535495909118&nbsp;;<br>
&nbsp;0.77301045336273696081&nbsp;;&nbsp;0.80320753148064490981&nbsp;;&nbsp;0.83146961230254523708&nbsp;;&nbsp;0.85772861000027206990&nbsp;;&nbsp;0.88192126434835502971&nbsp;;<br>
&nbsp;0.90398929312344333159&nbsp;;&nbsp;0.92387953251128675613&nbsp;;&nbsp;0.94154406518302077841&nbsp;;&nbsp;0.95694033573220886494&nbsp;;&nbsp;0.97003125319454399260&nbsp;;<br>
&nbsp;0.98078528040323044913&nbsp;;&nbsp;0.98917650996478097345&nbsp;;&nbsp;0.99518472667219688624&nbsp;;&nbsp;0.99879545620517239271&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_65_w&nbsp;=&nbsp;[|&nbsp;0.00024420024420024420&nbsp;;&nbsp;0.00235149067531170332&nbsp;;&nbsp;0.00483146544879091264&nbsp;;&nbsp;0.00719269316173611402&nbsp;;<br>
&nbsp;0.00958233879528379039&nbsp;;&nbsp;0.01192339471421277160&nbsp;;&nbsp;0.01425206043235199679&nbsp;;&nbsp;0.01653498765728958965&nbsp;;&nbsp;0.01878652974179578354&nbsp;;<br>
&nbsp;0.02098627442973743378&nbsp;;&nbsp;0.02314069493435819848&nbsp;;&nbsp;0.02523506498175476590&nbsp;;&nbsp;0.02727225714146838686&nbsp;;&nbsp;0.02924065319746833770&nbsp;;<br>
&nbsp;0.03114129710406762447&nbsp;;&nbsp;0.03296454656997632997&nbsp;;&nbsp;0.03471049818092511427&nbsp;;&nbsp;0.03637092028663918309&nbsp;;&nbsp;0.03794545992128481711&nbsp;;<br>
&nbsp;0.03942698871295609976&nbsp;;&nbsp;0.04081501340035783384&nbsp;;&nbsp;0.04210333111141810203&nbsp;;&nbsp;0.04329151496169082935&nbsp;;&nbsp;0.04437417923925731580&nbsp;;<br>
&nbsp;0.04535110955166067221&nbsp;;&nbsp;0.04621766751092557684&nbsp;;&nbsp;0.04697395904661414870&nbsp;;&nbsp;0.04761604458525019296&nbsp;;&nbsp;0.04814443257251220341&nbsp;;<br>
&nbsp;0.04855584485714105274&nbsp;;&nbsp;0.04885125664306609371&nbsp;;&nbsp;0.04902801843102555294&nbsp;;&nbsp;0.04908762351494245585&nbsp;;&nbsp;0.04902801843102555294&nbsp;;<br>
&nbsp;0.04885125664306609371&nbsp;;&nbsp;0.04855584485714105274&nbsp;;&nbsp;0.04814443257251220341&nbsp;;&nbsp;0.04761604458525019296&nbsp;;&nbsp;0.04697395904661414870&nbsp;;<br>
&nbsp;0.04621766751092557684&nbsp;;&nbsp;0.04535110955166067221&nbsp;;&nbsp;0.04437417923925731580&nbsp;;&nbsp;0.04329151496169082935&nbsp;;&nbsp;0.04210333111141810203&nbsp;;<br>
&nbsp;0.04081501340035783384&nbsp;;&nbsp;0.03942698871295609976&nbsp;;&nbsp;0.03794545992128481711&nbsp;;&nbsp;0.03637092028663918309&nbsp;;&nbsp;0.03471049818092511427&nbsp;;<br>
&nbsp;0.03296454656997632997&nbsp;;&nbsp;0.03114129710406762447&nbsp;;&nbsp;0.02924065319746833770&nbsp;;&nbsp;0.02727225714146838686&nbsp;;&nbsp;0.02523506498175476590&nbsp;;<br>
&nbsp;0.02314069493435819848&nbsp;;&nbsp;0.02098627442973743378&nbsp;;&nbsp;0.01878652974179578354&nbsp;;&nbsp;0.01653498765728958965&nbsp;;&nbsp;0.01425206043235199679&nbsp;;<br>
&nbsp;0.01192339471421277160&nbsp;;&nbsp;0.00958233879528379039&nbsp;;&nbsp;0.00719269316173611402&nbsp;;&nbsp;0.00483146544879091264&nbsp;;&nbsp;0.00235149067531170332&nbsp;;<br>
&nbsp;0.00024420024420024420&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_129_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.99969881869620422012&nbsp;;&nbsp;-0.99879545620517239271&nbsp;;&nbsp;-0.99729045667869021614&nbsp;;&nbsp;-0.99518472667219688624&nbsp;;<br>
&nbsp;-0.99247953459870999816&nbsp;;&nbsp;-0.98917650996478097345&nbsp;;&nbsp;-0.98527764238894124477&nbsp;;&nbsp;-0.98078528040323044913&nbsp;;&nbsp;-0.97570213003852854446&nbsp;;<br>
&nbsp;-0.97003125319454399260&nbsp;;&nbsp;-0.96377606579543986669&nbsp;;&nbsp;-0.95694033573220886494&nbsp;;&nbsp;-0.94952818059303666720&nbsp;;&nbsp;-0.94154406518302077841&nbsp;;<br>
&nbsp;-0.93299279883473888771&nbsp;;&nbsp;-0.92387953251128675613&nbsp;;&nbsp;-0.91420975570353065464&nbsp;;&nbsp;-0.90398929312344333159&nbsp;;&nbsp;-0.89322430119551532034&nbsp;;<br>
&nbsp;-0.88192126434835502971&nbsp;;&nbsp;-0.87008699110871141865&nbsp;;&nbsp;-0.85772861000027206990&nbsp;;&nbsp;-0.84485356524970707326&nbsp;;&nbsp;-0.83146961230254523708&nbsp;;<br>
&nbsp;-0.81758481315158369650&nbsp;;&nbsp;-0.80320753148064490981&nbsp;;&nbsp;-0.78834642762660626201&nbsp;;&nbsp;-0.77301045336273696081&nbsp;;&nbsp;-0.75720884650648454758&nbsp;;<br>
&nbsp;-0.74095112535495909118&nbsp;;&nbsp;-0.72424708295146692094&nbsp;;&nbsp;-0.70710678118654752440&nbsp;;&nbsp;-0.68954054473706692462&nbsp;;&nbsp;-0.67155895484701840063&nbsp;;<br>
&nbsp;-0.65317284295377676408&nbsp;;&nbsp;-0.63439328416364549822&nbsp;;&nbsp;-0.61523159058062684548&nbsp;;&nbsp;-0.59569930449243334347&nbsp;;&nbsp;-0.57580819141784530075&nbsp;;<br>
&nbsp;-0.55557023301960222474&nbsp;;&nbsp;-0.53499761988709721066&nbsp;;&nbsp;-0.51410274419322172659&nbsp;;&nbsp;-0.49289819222978403687&nbsp;;&nbsp;-0.47139673682599764856&nbsp;;<br>
&nbsp;-0.44961132965460660005&nbsp;;&nbsp;-0.42755509343028209432&nbsp;;&nbsp;-0.40524131400498987091&nbsp;;&nbsp;-0.38268343236508977173&nbsp;;&nbsp;-0.35989503653498814878&nbsp;;<br>
&nbsp;-0.33688985339222005069&nbsp;;&nbsp;-0.31368174039889147666&nbsp;;&nbsp;-0.29028467725446236764&nbsp;;&nbsp;-0.26671275747489838633&nbsp;;&nbsp;-0.24298017990326388995&nbsp;;<br>
&nbsp;-0.21910124015686979723&nbsp;;&nbsp;-0.19509032201612826785&nbsp;;&nbsp;-0.17096188876030122636&nbsp;;&nbsp;-0.14673047445536175166&nbsp;;&nbsp;-0.12241067519921619850&nbsp;;<br>
&nbsp;-0.098017140329560601994&nbsp;;&nbsp;-0.073564563599667423529&nbsp;;&nbsp;-0.049067674327418014255&nbsp;;&nbsp;-0.024541228522912288032&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.024541228522912288032&nbsp;;<br>
&nbsp;0.049067674327418014255&nbsp;;&nbsp;0.073564563599667423529&nbsp;;&nbsp;0.098017140329560601994&nbsp;;&nbsp;0.12241067519921619850&nbsp;;&nbsp;0.14673047445536175166&nbsp;;<br>
&nbsp;0.17096188876030122636&nbsp;;&nbsp;0.19509032201612826785&nbsp;;&nbsp;0.21910124015686979723&nbsp;;&nbsp;0.24298017990326388995&nbsp;;&nbsp;0.26671275747489838633&nbsp;;<br>
&nbsp;0.29028467725446236764&nbsp;;&nbsp;0.31368174039889147666&nbsp;;&nbsp;0.33688985339222005069&nbsp;;&nbsp;0.35989503653498814878&nbsp;;&nbsp;0.38268343236508977173&nbsp;;<br>
&nbsp;0.40524131400498987091&nbsp;;&nbsp;0.42755509343028209432&nbsp;;&nbsp;0.44961132965460660005&nbsp;;&nbsp;0.47139673682599764856&nbsp;;&nbsp;0.49289819222978403687&nbsp;;<br>
&nbsp;0.51410274419322172659&nbsp;;&nbsp;0.53499761988709721066&nbsp;;&nbsp;0.55557023301960222474&nbsp;;&nbsp;0.57580819141784530075&nbsp;;&nbsp;0.59569930449243334347&nbsp;;<br>
&nbsp;0.61523159058062684548&nbsp;;&nbsp;0.63439328416364549822&nbsp;;&nbsp;0.65317284295377676408&nbsp;;&nbsp;0.67155895484701840063&nbsp;;&nbsp;0.68954054473706692462&nbsp;;<br>
&nbsp;0.70710678118654752440&nbsp;;&nbsp;0.72424708295146692094&nbsp;;&nbsp;0.74095112535495909118&nbsp;;&nbsp;0.75720884650648454758&nbsp;;&nbsp;0.77301045336273696081&nbsp;;<br>
&nbsp;0.78834642762660626201&nbsp;;&nbsp;0.80320753148064490981&nbsp;;&nbsp;0.81758481315158369650&nbsp;;&nbsp;0.83146961230254523708&nbsp;;&nbsp;0.84485356524970707326&nbsp;;<br>
&nbsp;0.85772861000027206990&nbsp;;&nbsp;0.87008699110871141865&nbsp;;&nbsp;0.88192126434835502971&nbsp;;&nbsp;0.89322430119551532034&nbsp;;&nbsp;0.90398929312344333159&nbsp;;<br>
&nbsp;0.91420975570353065464&nbsp;;&nbsp;0.92387953251128675613&nbsp;;&nbsp;0.93299279883473888771&nbsp;;&nbsp;0.94154406518302077841&nbsp;;&nbsp;0.94952818059303666720&nbsp;;<br>
&nbsp;0.95694033573220886494&nbsp;;&nbsp;0.96377606579543986669&nbsp;;&nbsp;0.97003125319454399260&nbsp;;&nbsp;0.97570213003852854446&nbsp;;&nbsp;0.98078528040323044913&nbsp;;<br>
&nbsp;0.98527764238894124477&nbsp;;&nbsp;0.98917650996478097345&nbsp;;&nbsp;0.99247953459870999816&nbsp;;&nbsp;0.99518472667219688624&nbsp;;&nbsp;0.99729045667869021614&nbsp;;<br>
&nbsp;0.99879545620517239271&nbsp;;&nbsp;0.99969881869620422012&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;clenshaw_curtis_129_w&nbsp;=&nbsp;[|&nbsp;0.00006103888176768602&nbsp;;&nbsp;0.00058807215382869754&nbsp;;&nbsp;0.00120930061875273991&nbsp;;&nbsp;0.00180308126695362360&nbsp;;<br>
&nbsp;0.00240715327877140915&nbsp;;&nbsp;0.00300345869904497128&nbsp;;&nbsp;0.00360197835812614147&nbsp;;&nbsp;0.00419553798718534675&nbsp;;&nbsp;0.00478862143341336763&nbsp;;<br>
&nbsp;0.00537724746840184621&nbsp;;&nbsp;0.00596388034730799521&nbsp;;&nbsp;0.00654590843862298928&nbsp;;&nbsp;0.00712483332325489785&nbsp;;&nbsp;0.00769875778896082811&nbsp;;<br>
&nbsp;0.00826865154203087108&nbsp;;&nbsp;0.00883303867470133581&nbsp;;&nbsp;0.00939256583934814871&nbsp;;&nbsp;0.00994602784923457905&nbsp;;&nbsp;0.01049386202576892125&nbsp;;<br>
&nbsp;0.01103504877427254184&nbsp;;&nbsp;0.01156988348290849967&nbsp;;&nbsp;0.01209748052807164113&nbsp;;&nbsp;0.01261803597977743271&nbsp;;&nbsp;0.01313076516693974630&nbsp;;<br>
&nbsp;0.01363579321293772047&nbsp;;&nbsp;0.01413241437853094133&nbsp;;&nbsp;0.01462070254634350205&nbsp;;&nbsp;0.01510001572479266783&nbsp;;&nbsp;0.01557039073899425960&nbsp;;<br>
&nbsp;0.01603123858745057916&nbsp;;&nbsp;0.01648256956220377909&nbsp;;&nbsp;0.01692383985846499368&nbsp;;&nbsp;0.01735504125411394958&nbsp;;&nbsp;0.01777566938875279997&nbsp;;<br>
&nbsp;0.01818570377926339481&nbsp;;&nbsp;0.01858467519566908661&nbsp;;&nbsp;0.01897255587067948426&nbsp;;&nbsp;0.01934890842392451844&nbsp;;&nbsp;0.01971370183700155725&nbsp;;<br>
&nbsp;0.02006652805198357604&nbsp;;&nbsp;0.02040735612003867863&nbsp;;&nbsp;0.02073580533490147816&nbsp;;&nbsp;0.02105184759002011131&nbsp;;&nbsp;0.02135512797425970725&nbsp;;<br>
&nbsp;0.02164562356712882440&nbsp;;&nbsp;0.02192300400598756892&nbsp;;&nbsp;0.02218725355897195088&nbsp;;&nbsp;0.02243806539722630184&nbsp;;&nbsp;0.02267543270456671718&nbsp;;<br>
&nbsp;0.02289907134390605882&nbsp;;&nbsp;0.02310898491627407168&nbsp;;&nbsp;0.02330491126131143273&nbsp;;&nbsp;0.02348686571193163505&nbsp;;&nbsp;0.02365460746057766523&nbsp;;<br>
&nbsp;0.02380816473024258975&nbsp;;&nbsp;0.02394731750476901502&nbsp;;&nbsp;0.02407210792327850000&nbsp;;&nbsp;0.02418233623893147567&nbsp;;&nbsp;0.02427805942075745923&nbsp;;<br>
&nbsp;0.02435909748927643184&nbsp;;&nbsp;0.02442552306156708690&nbsp;;&nbsp;0.02447717542743444284&nbsp;;&nbsp;0.02451414358881568292&nbsp;;&nbsp;0.02453628559651495473&nbsp;;<br>
&nbsp;0.02454370750551418263&nbsp;;&nbsp;0.02453628559651495473&nbsp;;&nbsp;0.02451414358881568292&nbsp;;&nbsp;0.02447717542743444284&nbsp;;&nbsp;0.02442552306156708690&nbsp;;<br>
&nbsp;0.02435909748927643184&nbsp;;&nbsp;0.02427805942075745923&nbsp;;&nbsp;0.02418233623893147567&nbsp;;&nbsp;0.02407210792327850000&nbsp;;&nbsp;0.02394731750476901502&nbsp;;<br>
&nbsp;0.02380816473024258975&nbsp;;&nbsp;0.02365460746057766523&nbsp;;&nbsp;0.02348686571193163505&nbsp;;&nbsp;0.02330491126131143273&nbsp;;&nbsp;0.02310898491627407168&nbsp;;<br>
&nbsp;0.02289907134390605882&nbsp;;&nbsp;0.02267543270456671718&nbsp;;&nbsp;0.02243806539722630184&nbsp;;&nbsp;0.02218725355897195088&nbsp;;&nbsp;0.02192300400598756892&nbsp;;<br>
&nbsp;0.02164562356712882440&nbsp;;&nbsp;0.02135512797425970725&nbsp;;&nbsp;0.02105184759002011131&nbsp;;&nbsp;0.02073580533490147816&nbsp;;&nbsp;0.02040735612003867863&nbsp;;<br>
&nbsp;0.02006652805198357604&nbsp;;&nbsp;0.01971370183700155725&nbsp;;&nbsp;0.01934890842392451844&nbsp;;&nbsp;0.01897255587067948426&nbsp;;&nbsp;0.01858467519566908661&nbsp;;<br>
&nbsp;0.01818570377926339481&nbsp;;&nbsp;0.01777566938875279997&nbsp;;&nbsp;0.01735504125411394958&nbsp;;&nbsp;0.01692383985846499368&nbsp;;&nbsp;0.01648256956220377909&nbsp;;<br>
&nbsp;0.01603123858745057916&nbsp;;&nbsp;0.01557039073899425960&nbsp;;&nbsp;0.01510001572479266783&nbsp;;&nbsp;0.01462070254634350205&nbsp;;&nbsp;0.01413241437853094133&nbsp;;<br>
&nbsp;0.01363579321293772047&nbsp;;&nbsp;0.01313076516693974630&nbsp;;&nbsp;0.01261803597977743271&nbsp;;&nbsp;0.01209748052807164113&nbsp;;&nbsp;0.01156988348290849967&nbsp;;<br>
&nbsp;0.01103504877427254184&nbsp;;&nbsp;0.01049386202576892125&nbsp;;&nbsp;0.00994602784923457905&nbsp;;&nbsp;0.00939256583934814871&nbsp;;&nbsp;0.00883303867470133581&nbsp;;<br>
&nbsp;0.00826865154203087108&nbsp;;&nbsp;0.00769875778896082811&nbsp;;&nbsp;0.00712483332325489785&nbsp;;&nbsp;0.00654590843862298928&nbsp;;&nbsp;0.00596388034730799521&nbsp;;<br>
&nbsp;0.00537724746840184621&nbsp;;&nbsp;0.00478862143341336763&nbsp;;&nbsp;0.00419553798718534675&nbsp;;&nbsp;0.00360197835812614147&nbsp;;&nbsp;0.00300345869904497128&nbsp;;<br>
&nbsp;0.00240715327877140915&nbsp;;&nbsp;0.00180308126695362360&nbsp;;&nbsp;0.00120930061875273991&nbsp;;&nbsp;0.00058807215382869754&nbsp;;&nbsp;0.00006103888176768602&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_1_x&nbsp;=&nbsp;[|&nbsp;0.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_1_w&nbsp;=&nbsp;[|&nbsp;2.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_2_x&nbsp;=&nbsp;[|&nbsp;-0.577350269189625764509148780502&nbsp;;&nbsp;0.577350269189625764509148780502&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_2_w&nbsp;=&nbsp;[|&nbsp;1.0&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_3_x&nbsp;=&nbsp;[|&nbsp;-0.774596669241483377035853079956&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.774596669241483377035853079956&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_3_w&nbsp;=&nbsp;[|&nbsp;0.555555555555555555555555555556&nbsp;;&nbsp;0.888888888888888888888888888889&nbsp;;&nbsp;0.555555555555555555555555555556&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_4_x&nbsp;=&nbsp;[|&nbsp;-0.861136311594052575223946488893&nbsp;;&nbsp;-0.339981043584856264802665759103&nbsp;;&nbsp;0.339981043584856264802665759103&nbsp;;&nbsp;0.861136311594052575223946488893&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_4_w&nbsp;=&nbsp;[|&nbsp;0.347854845137453857373063949222&nbsp;;&nbsp;0.652145154862546142626936050778&nbsp;;&nbsp;0.652145154862546142626936050778&nbsp;;&nbsp;0.347854845137453857373063949222&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_5_x&nbsp;=&nbsp;[|&nbsp;-0.906179845938663992797626878299&nbsp;;&nbsp;-0.538469310105683091036314420700&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;0.538469310105683091036314420700&nbsp;;&nbsp;0.906179845938663992797626878299&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_5_w&nbsp;=&nbsp;[|&nbsp;0.236926885056189087514264040720&nbsp;;&nbsp;0.478628670499366468041291514836&nbsp;;&nbsp;0.568888888888888888888888888889&nbsp;;<br>
&nbsp;0.478628670499366468041291514836&nbsp;;&nbsp;0.236926885056189087514264040720&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_6_x&nbsp;=&nbsp;[|&nbsp;-0.932469514203152027812301554494&nbsp;;&nbsp;-0.661209386466264513661399595020&nbsp;;&nbsp;-0.238619186083196908630501721681&nbsp;;<br>
&nbsp;0.238619186083196908630501721681&nbsp;;&nbsp;0.661209386466264513661399595020&nbsp;;&nbsp;0.932469514203152027812301554494&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_6_w&nbsp;=&nbsp;[|&nbsp;0.171324492379170345040296142173&nbsp;;&nbsp;0.360761573048138607569833513838&nbsp;;&nbsp;0.467913934572691047389870343990&nbsp;;<br>
&nbsp;0.467913934572691047389870343990&nbsp;;&nbsp;0.360761573048138607569833513838&nbsp;;&nbsp;0.171324492379170345040296142173&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_7_x&nbsp;=&nbsp;[|&nbsp;-0.949107912342758524526189684048&nbsp;;&nbsp;-0.741531185599394439863864773281&nbsp;;&nbsp;-0.405845151377397166906606412077&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;0.405845151377397166906606412077&nbsp;;&nbsp;0.741531185599394439863864773281&nbsp;;&nbsp;0.949107912342758524526189684048&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_7_w&nbsp;=&nbsp;[|&nbsp;0.129484966168869693270611432679&nbsp;;&nbsp;0.279705391489276667901467771424&nbsp;;&nbsp;0.381830050505118944950369775489&nbsp;;&nbsp;0.417959183673469387755102040816&nbsp;;<br>
&nbsp;0.381830050505118944950369775489&nbsp;;&nbsp;0.279705391489276667901467771424&nbsp;;&nbsp;0.129484966168869693270611432679&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_8_x&nbsp;=&nbsp;[|&nbsp;-0.960289856497536231683560868569&nbsp;;&nbsp;-0.796666477413626739591553936476&nbsp;;&nbsp;-0.525532409916328985817739049189&nbsp;;&nbsp;-0.183434642495649804939476142360&nbsp;;<br>
&nbsp;0.183434642495649804939476142360&nbsp;;&nbsp;0.525532409916328985817739049189&nbsp;;&nbsp;0.796666477413626739591553936476&nbsp;;&nbsp;0.960289856497536231683560868569&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_8_w&nbsp;=&nbsp;[|&nbsp;0.101228536290376259152531354310&nbsp;;&nbsp;0.222381034453374470544355994426&nbsp;;&nbsp;0.313706645877887287337962201987&nbsp;;&nbsp;0.362683783378361982965150449277&nbsp;;<br>
&nbsp;0.362683783378361982965150449277&nbsp;;&nbsp;0.313706645877887287337962201987&nbsp;;&nbsp;0.222381034453374470544355994426&nbsp;;&nbsp;0.101228536290376259152531354310&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_9_x&nbsp;=&nbsp;[|&nbsp;-0.968160239507626089835576203&nbsp;;&nbsp;-0.836031107326635794299429788&nbsp;;&nbsp;-0.613371432700590397308702039&nbsp;;&nbsp;-0.324253423403808929038538015&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;0.324253423403808929038538015&nbsp;;&nbsp;0.613371432700590397308702039&nbsp;;&nbsp;0.836031107326635794299429788&nbsp;;&nbsp;0.968160239507626089835576203&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_9_w&nbsp;=&nbsp;[|&nbsp;0.081274388361574411971892158111&nbsp;;&nbsp;0.18064816069485740405847203124&nbsp;;&nbsp;0.26061069640293546231874286942&nbsp;;&nbsp;0.31234707704000284006863040658&nbsp;;<br>
&nbsp;0.33023935500125976316452506929&nbsp;;&nbsp;0.31234707704000284006863040658&nbsp;;&nbsp;0.26061069640293546231874286942&nbsp;;&nbsp;0.18064816069485740405847203124&nbsp;;&nbsp;0.081274388361574411971892158111&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_10_x&nbsp;=&nbsp;[|&nbsp;-0.973906528517171720077964012&nbsp;;&nbsp;-0.865063366688984510732096688&nbsp;;&nbsp;-0.679409568299024406234327365&nbsp;;&nbsp;-0.433395394129247190799265943&nbsp;;<br>
&nbsp;-0.148874338981631210884826001&nbsp;;&nbsp;0.148874338981631210884826001&nbsp;;&nbsp;0.433395394129247190799265943&nbsp;;&nbsp;0.679409568299024406234327365&nbsp;;&nbsp;0.865063366688984510732096688&nbsp;;<br>
&nbsp;0.973906528517171720077964012&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_10_w&nbsp;=&nbsp;[|&nbsp;0.066671344308688137593568809893&nbsp;;&nbsp;0.14945134915058059314577633966&nbsp;;&nbsp;0.21908636251598204399553493423&nbsp;;&nbsp;0.26926671930999635509122692157&nbsp;;<br>
&nbsp;0.29552422471475287017389299465&nbsp;;&nbsp;0.29552422471475287017389299465&nbsp;;&nbsp;0.26926671930999635509122692157&nbsp;;&nbsp;0.21908636251598204399553493423&nbsp;;&nbsp;0.14945134915058059314577633966&nbsp;;<br>
&nbsp;0.066671344308688137593568809893&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_11_x&nbsp;=&nbsp;[|&nbsp;-0.978228658146056992803938001&nbsp;;&nbsp;-0.887062599768095299075157769&nbsp;;&nbsp;-0.730152005574049324093416252&nbsp;;&nbsp;-0.519096129206811815925725669&nbsp;;<br>
&nbsp;-0.269543155952344972331531985&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.269543155952344972331531985&nbsp;;&nbsp;0.519096129206811815925725669&nbsp;;&nbsp;0.730152005574049324093416252&nbsp;;<br>
&nbsp;0.887062599768095299075157769&nbsp;;&nbsp;0.978228658146056992803938001&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_11_w&nbsp;=&nbsp;[|&nbsp;0.055668567116173666482753720443&nbsp;;&nbsp;0.12558036946490462463469429922&nbsp;;&nbsp;0.18629021092773425142609764143&nbsp;;&nbsp;0.23319376459199047991852370484&nbsp;;<br>
&nbsp;0.26280454451024666218068886989&nbsp;;&nbsp;0.27292508677790063071448352834&nbsp;;&nbsp;0.26280454451024666218068886989&nbsp;;&nbsp;0.23319376459199047991852370484&nbsp;;&nbsp;0.18629021092773425142609764143&nbsp;;<br>
&nbsp;0.12558036946490462463469429922&nbsp;;&nbsp;0.055668567116173666482753720443&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_12_x&nbsp;=&nbsp;[|&nbsp;-0.981560634246719250690549090&nbsp;;&nbsp;-0.904117256370474856678465866&nbsp;;&nbsp;-0.769902674194304687036893833&nbsp;;&nbsp;-0.587317954286617447296702419&nbsp;;<br>
&nbsp;-0.367831498998180193752691537&nbsp;;&nbsp;-0.125233408511468915472441369&nbsp;;&nbsp;0.125233408511468915472441369&nbsp;;&nbsp;0.367831498998180193752691537&nbsp;;&nbsp;0.587317954286617447296702419&nbsp;;<br>
&nbsp;0.769902674194304687036893833&nbsp;;&nbsp;0.904117256370474856678465866&nbsp;;&nbsp;0.981560634246719250690549090&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_12_w&nbsp;=&nbsp;[|&nbsp;0.047175336386511827194615961485&nbsp;;&nbsp;0.10693932599531843096025471819&nbsp;;&nbsp;0.16007832854334622633465252954&nbsp;;&nbsp;0.20316742672306592174906445581&nbsp;;<br>
&nbsp;0.23349253653835480876084989892&nbsp;;&nbsp;0.24914704581340278500056243604&nbsp;;&nbsp;0.24914704581340278500056243604&nbsp;;&nbsp;0.23349253653835480876084989892&nbsp;;&nbsp;0.20316742672306592174906445581&nbsp;;<br>
&nbsp;0.16007832854334622633465252954&nbsp;;&nbsp;0.10693932599531843096025471819&nbsp;;&nbsp;0.047175336386511827194615961485&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_13_x&nbsp;=&nbsp;[|&nbsp;-0.984183054718588149472829449&nbsp;;&nbsp;-0.917598399222977965206547837&nbsp;;&nbsp;-0.801578090733309912794206490&nbsp;;&nbsp;-0.642349339440340220643984607&nbsp;;<br>
&nbsp;-0.448492751036446852877912852&nbsp;;&nbsp;-0.230458315955134794065528121&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.230458315955134794065528121&nbsp;;&nbsp;0.448492751036446852877912852&nbsp;;&nbsp;0.642349339440340220643984607&nbsp;;<br>
&nbsp;0.80157809073330991279420649&nbsp;;&nbsp;0.91759839922297796520654784&nbsp;;&nbsp;0.98418305471858814947282945&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_13_w&nbsp;=&nbsp;[|&nbsp;0.040484004765315879520021592201&nbsp;;&nbsp;0.092121499837728447914421775954&nbsp;;&nbsp;0.13887351021978723846360177687&nbsp;;&nbsp;0.17814598076194573828004669200&nbsp;;<br>
&nbsp;0.20781604753688850231252321931&nbsp;;&nbsp;0.22628318026289723841209018604&nbsp;;&nbsp;0.23255155323087391019458951527&nbsp;;&nbsp;0.22628318026289723841209018604&nbsp;;&nbsp;0.20781604753688850231252321931&nbsp;;<br>
&nbsp;0.17814598076194573828004669200&nbsp;;&nbsp;0.13887351021978723846360177687&nbsp;;&nbsp;0.092121499837728447914421775954&nbsp;;&nbsp;0.040484004765315879520021592201&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_14_x&nbsp;=&nbsp;[|&nbsp;-0.986283808696812338841597267&nbsp;;&nbsp;-0.928434883663573517336391139&nbsp;;&nbsp;-0.827201315069764993189794743&nbsp;;&nbsp;-0.687292904811685470148019803&nbsp;;<br>
&nbsp;-0.515248636358154091965290719&nbsp;;&nbsp;-0.319112368927889760435671824&nbsp;;&nbsp;-0.108054948707343662066244650&nbsp;;&nbsp;0.108054948707343662066244650&nbsp;;&nbsp;0.31911236892788976043567182&nbsp;;<br>
&nbsp;0.51524863635815409196529072&nbsp;;&nbsp;0.68729290481168547014801980&nbsp;;&nbsp;0.82720131506976499318979474&nbsp;;&nbsp;0.92843488366357351733639114&nbsp;;&nbsp;0.98628380869681233884159727&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_14_w&nbsp;=&nbsp;[|&nbsp;0.035119460331751863031832876138&nbsp;;&nbsp;0.08015808715976020980563327706&nbsp;;&nbsp;0.12151857068790318468941480907&nbsp;;&nbsp;0.15720316715819353456960193862&nbsp;;<br>
&nbsp;0.18553839747793781374171659013&nbsp;;&nbsp;0.20519846372129560396592406566&nbsp;;&nbsp;0.21526385346315779019587644332&nbsp;;&nbsp;0.21526385346315779019587644332&nbsp;;&nbsp;0.20519846372129560396592406566&nbsp;;<br>
&nbsp;0.18553839747793781374171659013&nbsp;;&nbsp;0.15720316715819353456960193862&nbsp;;&nbsp;0.12151857068790318468941480907&nbsp;;&nbsp;0.08015808715976020980563327706&nbsp;;&nbsp;0.035119460331751863031832876138&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_15_x&nbsp;=&nbsp;[|&nbsp;-0.987992518020485428489565719&nbsp;;&nbsp;-0.937273392400705904307758948&nbsp;;&nbsp;-0.848206583410427216200648321&nbsp;;&nbsp;-0.724417731360170047416186055&nbsp;;<br>
&nbsp;-0.570972172608538847537226737&nbsp;;&nbsp;-0.394151347077563369897207371&nbsp;;&nbsp;-0.201194093997434522300628303&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.20119409399743452230062830&nbsp;;&nbsp;0.39415134707756336989720737&nbsp;;<br>
&nbsp;0.57097217260853884753722674&nbsp;;&nbsp;0.72441773136017004741618605&nbsp;;&nbsp;0.84820658341042721620064832&nbsp;;&nbsp;0.93727339240070590430775895&nbsp;;&nbsp;0.98799251802048542848956572&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_15_w&nbsp;=&nbsp;[|&nbsp;0.030753241996117268354628393577&nbsp;;&nbsp;0.070366047488108124709267416451&nbsp;;&nbsp;0.107159220467171935011869546686&nbsp;;&nbsp;0.13957067792615431444780479451&nbsp;;<br>
&nbsp;0.16626920581699393355320086048&nbsp;;&nbsp;0.18616100001556221102680056187&nbsp;;&nbsp;0.19843148532711157645611832644&nbsp;;&nbsp;0.20257824192556127288062019997&nbsp;;&nbsp;0.19843148532711157645611832644&nbsp;;<br>
&nbsp;0.18616100001556221102680056187&nbsp;;&nbsp;0.16626920581699393355320086048&nbsp;;&nbsp;0.13957067792615431444780479451&nbsp;;&nbsp;0.107159220467171935011869546686&nbsp;;&nbsp;0.070366047488108124709267416451&nbsp;;<br>
&nbsp;0.030753241996117268354628393577&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_16_x&nbsp;=&nbsp;[|&nbsp;-0.989400934991649932596154173&nbsp;;&nbsp;-0.944575023073232576077988416&nbsp;;&nbsp;-0.865631202387831743880467898&nbsp;;&nbsp;-0.755404408355003033895101195&nbsp;;<br>
&nbsp;-0.617876244402643748446671764&nbsp;;&nbsp;-0.458016777657227386342419443&nbsp;;&nbsp;-0.281603550779258913230460501&nbsp;;&nbsp;-0.09501250983763744018531934&nbsp;;&nbsp;0.09501250983763744018531934&nbsp;;<br>
&nbsp;0.28160355077925891323046050&nbsp;;&nbsp;0.45801677765722738634241944&nbsp;;&nbsp;0.61787624440264374844667176&nbsp;;&nbsp;0.75540440835500303389510119&nbsp;;&nbsp;0.86563120238783174388046790&nbsp;;<br>
&nbsp;0.94457502307323257607798842&nbsp;;&nbsp;0.98940093499164993259615417&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_16_w&nbsp;=&nbsp;[|&nbsp;0.027152459411754094851780572456&nbsp;;&nbsp;0.062253523938647892862843836994&nbsp;;&nbsp;0.09515851168249278480992510760&nbsp;;&nbsp;0.12462897125553387205247628219&nbsp;;<br>
&nbsp;0.14959598881657673208150173055&nbsp;;&nbsp;0.16915651939500253818931207903&nbsp;;&nbsp;0.18260341504492358886676366797&nbsp;;&nbsp;0.18945061045506849628539672321&nbsp;;&nbsp;0.18945061045506849628539672321&nbsp;;<br>
&nbsp;0.18260341504492358886676366797&nbsp;;&nbsp;0.16915651939500253818931207903&nbsp;;&nbsp;0.14959598881657673208150173055&nbsp;;&nbsp;0.12462897125553387205247628219&nbsp;;&nbsp;0.09515851168249278480992510760&nbsp;;<br>
&nbsp;0.062253523938647892862843836994&nbsp;;&nbsp;0.027152459411754094851780572456&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_17_x&nbsp;=&nbsp;[|&nbsp;-0.990575475314417335675434020&nbsp;;&nbsp;-0.950675521768767761222716958&nbsp;;&nbsp;-0.880239153726985902122955694&nbsp;;&nbsp;-0.781514003896801406925230056&nbsp;;<br>
&nbsp;-0.657671159216690765850302217&nbsp;;&nbsp;-0.512690537086476967886246569&nbsp;;&nbsp;-0.35123176345387631529718552&nbsp;;&nbsp;-0.17848418149584785585067749&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.17848418149584785585067749&nbsp;;<br>
&nbsp;0.35123176345387631529718552&nbsp;;&nbsp;0.51269053708647696788624657&nbsp;;&nbsp;0.65767115921669076585030222&nbsp;;&nbsp;0.78151400389680140692523006&nbsp;;&nbsp;0.88023915372698590212295569&nbsp;;<br>
&nbsp;0.95067552176876776122271696&nbsp;;&nbsp;0.99057547531441733567543402&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_17_w&nbsp;=&nbsp;[|&nbsp;0.024148302868547931960110026288&nbsp;;&nbsp;0.055459529373987201129440165359&nbsp;;&nbsp;0.085036148317179180883535370191&nbsp;;&nbsp;0.111883847193403971094788385626&nbsp;;<br>
&nbsp;0.13513636846852547328631998170&nbsp;;&nbsp;0.15404576107681028808143159480&nbsp;;&nbsp;0.16800410215645004450997066379&nbsp;;&nbsp;0.17656270536699264632527099011&nbsp;;&nbsp;0.17944647035620652545826564426&nbsp;;<br>
&nbsp;0.17656270536699264632527099011&nbsp;;&nbsp;0.16800410215645004450997066379&nbsp;;&nbsp;0.15404576107681028808143159480&nbsp;;&nbsp;0.13513636846852547328631998170&nbsp;;&nbsp;0.111883847193403971094788385626&nbsp;;<br>
&nbsp;0.085036148317179180883535370191&nbsp;;&nbsp;0.055459529373987201129440165359&nbsp;;&nbsp;0.024148302868547931960110026288&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_18_x&nbsp;=&nbsp;[|&nbsp;-0.991565168420930946730016005&nbsp;;&nbsp;-0.955823949571397755181195893&nbsp;;&nbsp;-0.892602466497555739206060591&nbsp;;&nbsp;-0.803704958972523115682417455&nbsp;;<br>
&nbsp;-0.691687043060353207874891081&nbsp;;&nbsp;-0.55977083107394753460787155&nbsp;;&nbsp;-0.41175116146284264603593179&nbsp;;&nbsp;-0.25188622569150550958897285&nbsp;;&nbsp;-0.08477501304173530124226185&nbsp;;<br>
&nbsp;0.08477501304173530124226185&nbsp;;&nbsp;0.25188622569150550958897285&nbsp;;&nbsp;0.41175116146284264603593179&nbsp;;&nbsp;0.55977083107394753460787155&nbsp;;&nbsp;0.69168704306035320787489108&nbsp;;<br>
&nbsp;0.80370495897252311568241746&nbsp;;&nbsp;0.89260246649755573920606059&nbsp;;&nbsp;0.95582394957139775518119589&nbsp;;&nbsp;0.99156516842093094673001600&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_18_w&nbsp;=&nbsp;[|&nbsp;0.021616013526483310313342710266&nbsp;;&nbsp;0.049714548894969796453334946203&nbsp;;&nbsp;0.07642573025488905652912967762&nbsp;;&nbsp;0.10094204410628716556281398492&nbsp;;<br>
&nbsp;0.12255520671147846018451912680&nbsp;;&nbsp;0.14064291467065065120473130375&nbsp;;&nbsp;0.15468467512626524492541800384&nbsp;;&nbsp;0.16427648374583272298605377647&nbsp;;&nbsp;0.16914238296314359184065647013&nbsp;;<br>
&nbsp;0.16914238296314359184065647013&nbsp;;&nbsp;0.16427648374583272298605377647&nbsp;;&nbsp;0.15468467512626524492541800384&nbsp;;&nbsp;0.14064291467065065120473130375&nbsp;;&nbsp;0.12255520671147846018451912680&nbsp;;<br>
&nbsp;0.10094204410628716556281398492&nbsp;;&nbsp;0.07642573025488905652912967762&nbsp;;&nbsp;0.049714548894969796453334946203&nbsp;;&nbsp;0.021616013526483310313342710266&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_19_x&nbsp;=&nbsp;[|&nbsp;-0.992406843843584403189017670&nbsp;;&nbsp;-0.960208152134830030852778841&nbsp;;&nbsp;-0.903155903614817901642660929&nbsp;;&nbsp;-0.822714656537142824978922487&nbsp;;<br>
&nbsp;-0.72096617733522937861709586&nbsp;;&nbsp;-0.60054530466168102346963816&nbsp;;&nbsp;-0.46457074137596094571726715&nbsp;;&nbsp;-0.31656409996362983199011733&nbsp;;&nbsp;-0.16035864564022537586809612&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;0.16035864564022537586809612&nbsp;;&nbsp;0.31656409996362983199011733&nbsp;;&nbsp;0.46457074137596094571726715&nbsp;;&nbsp;0.60054530466168102346963816&nbsp;;&nbsp;0.72096617733522937861709586&nbsp;;<br>
&nbsp;0.82271465653714282497892249&nbsp;;&nbsp;0.90315590361481790164266093&nbsp;;&nbsp;0.96020815213483003085277884&nbsp;;&nbsp;0.99240684384358440318901767&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_19_w&nbsp;=&nbsp;[|&nbsp;0.019461788229726477036312041464&nbsp;;&nbsp;0.044814226765699600332838157402&nbsp;;&nbsp;0.069044542737641226580708258006&nbsp;;&nbsp;0.091490021622449999464462094124&nbsp;;<br>
&nbsp;0.111566645547333994716023901682&nbsp;;&nbsp;0.12875396253933622767551578486&nbsp;;&nbsp;0.14260670217360661177574610944&nbsp;;&nbsp;0.15276604206585966677885540090&nbsp;;&nbsp;0.15896884339395434764995643946&nbsp;;<br>
&nbsp;0.16105444984878369597916362532&nbsp;;&nbsp;0.15896884339395434764995643946&nbsp;;&nbsp;0.15276604206585966677885540090&nbsp;;&nbsp;0.14260670217360661177574610944&nbsp;;&nbsp;0.12875396253933622767551578486&nbsp;;<br>
&nbsp;0.111566645547333994716023901682&nbsp;;&nbsp;0.091490021622449999464462094124&nbsp;;&nbsp;0.069044542737641226580708258006&nbsp;;&nbsp;0.044814226765699600332838157402&nbsp;;&nbsp;0.019461788229726477036312041464&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_20_x&nbsp;=&nbsp;[|&nbsp;-0.993128599185094924786122388&nbsp;;&nbsp;-0.963971927277913791267666131&nbsp;;&nbsp;-0.912234428251325905867752441&nbsp;;&nbsp;-0.83911697182221882339452906&nbsp;;<br>
&nbsp;-0.74633190646015079261430507&nbsp;;&nbsp;-0.63605368072651502545283670&nbsp;;&nbsp;-0.51086700195082709800436405&nbsp;;&nbsp;-0.37370608871541956067254818&nbsp;;&nbsp;-0.22778585114164507808049620&nbsp;;<br>
&nbsp;-0.07652652113349733375464041&nbsp;;&nbsp;0.07652652113349733375464041&nbsp;;&nbsp;0.22778585114164507808049620&nbsp;;&nbsp;0.37370608871541956067254818&nbsp;;&nbsp;0.51086700195082709800436405&nbsp;;<br>
&nbsp;0.63605368072651502545283670&nbsp;;&nbsp;0.74633190646015079261430507&nbsp;;&nbsp;0.83911697182221882339452906&nbsp;;&nbsp;0.91223442825132590586775244&nbsp;;&nbsp;0.96397192727791379126766613&nbsp;;<br>
&nbsp;0.99312859918509492478612239&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_20_w&nbsp;=&nbsp;[|&nbsp;0.017614007139152118311861962352&nbsp;;&nbsp;0.040601429800386941331039952275&nbsp;;&nbsp;0.062672048334109063569506535187&nbsp;;&nbsp;0.08327674157670474872475814322&nbsp;;<br>
&nbsp;0.10193011981724043503675013548&nbsp;;&nbsp;0.11819453196151841731237737771&nbsp;;&nbsp;0.13168863844917662689849449975&nbsp;;&nbsp;0.14209610931838205132929832507&nbsp;;&nbsp;0.14917298647260374678782873700&nbsp;;<br>
&nbsp;0.15275338713072585069808433195&nbsp;;&nbsp;0.15275338713072585069808433195&nbsp;;&nbsp;0.14917298647260374678782873700&nbsp;;&nbsp;0.14209610931838205132929832507&nbsp;;&nbsp;0.13168863844917662689849449975&nbsp;;<br>
&nbsp;0.11819453196151841731237737771&nbsp;;&nbsp;0.10193011981724043503675013548&nbsp;;&nbsp;0.08327674157670474872475814322&nbsp;;&nbsp;0.062672048334109063569506535187&nbsp;;&nbsp;0.040601429800386941331039952275&nbsp;;<br>
&nbsp;0.017614007139152118311861962352&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_21_x&nbsp;=&nbsp;[|&nbsp;-0.99375217062038950026024204&nbsp;;&nbsp;-0.96722683856630629431662221&nbsp;;&nbsp;-0.92009933415040082879018713&nbsp;;&nbsp;-0.85336336458331728364725064&nbsp;;<br>
&nbsp;-0.76843996347567790861587785&nbsp;;&nbsp;-0.66713880419741231930596667&nbsp;;&nbsp;-0.55161883588721980705901880&nbsp;;&nbsp;-0.42434212020743878357366889&nbsp;;&nbsp;-0.28802131680240109660079252&nbsp;;<br>
&nbsp;-0.14556185416089509093703098&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.14556185416089509093703098&nbsp;;&nbsp;0.28802131680240109660079252&nbsp;;&nbsp;0.42434212020743878357366889&nbsp;;&nbsp;0.55161883588721980705901880&nbsp;;<br>
&nbsp;0.66713880419741231930596667&nbsp;;&nbsp;0.76843996347567790861587785&nbsp;;&nbsp;0.85336336458331728364725064&nbsp;;&nbsp;0.92009933415040082879018713&nbsp;;&nbsp;0.96722683856630629431662221&nbsp;;<br>
&nbsp;0.99375217062038950026024204&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_21_w&nbsp;=&nbsp;[|&nbsp;0.016017228257774333324224616858&nbsp;;&nbsp;0.036953789770852493799950668299&nbsp;;&nbsp;0.057134425426857208283635826472&nbsp;;&nbsp;0.076100113628379302017051653300&nbsp;;<br>
&nbsp;0.093444423456033861553289741114&nbsp;;&nbsp;0.108797299167148377663474578070&nbsp;;&nbsp;0.12183141605372853419536717713&nbsp;;&nbsp;0.13226893863333746178105257450&nbsp;;&nbsp;0.13988739479107315472213342387&nbsp;;<br>
&nbsp;0.14452440398997005906382716655&nbsp;;&nbsp;0.14608113364969042719198514768&nbsp;;&nbsp;0.14452440398997005906382716655&nbsp;;&nbsp;0.13988739479107315472213342387&nbsp;;&nbsp;&nbsp;0.13226893863333746178105257450&nbsp;;<br>
&nbsp;0.12183141605372853419536717713&nbsp;;&nbsp;0.108797299167148377663474578070&nbsp;;&nbsp;0.093444423456033861553289741114&nbsp;;&nbsp;0.076100113628379302017051653300&nbsp;;&nbsp;0.057134425426857208283635826472&nbsp;;<br>
&nbsp;0.036953789770852493799950668299&nbsp;;&nbsp;0.016017228257774333324224616858&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_22_x&nbsp;=&nbsp;[|&nbsp;-0.99429458548239929207303142&nbsp;;&nbsp;-0.97006049783542872712395099&nbsp;;&nbsp;-0.92695677218717400052069294&nbsp;;&nbsp;-0.86581257772030013653642564&nbsp;;<br>
&nbsp;-0.78781680597920816200427796&nbsp;;&nbsp;-0.69448726318668278005068984&nbsp;;&nbsp;-0.58764040350691159295887693&nbsp;;&nbsp;-0.46935583798675702640633071&nbsp;;&nbsp;-0.34193582089208422515814742&nbsp;;<br>
&nbsp;-0.20786042668822128547884653&nbsp;;&nbsp;-0.06973927331972222121384180&nbsp;;&nbsp;0.06973927331972222121384180&nbsp;;&nbsp;0.20786042668822128547884653&nbsp;;&nbsp;0.34193582089208422515814742&nbsp;;<br>
&nbsp;0.46935583798675702640633071&nbsp;;&nbsp;0.58764040350691159295887693&nbsp;;&nbsp;0.69448726318668278005068984&nbsp;;&nbsp;0.78781680597920816200427796&nbsp;;&nbsp;0.86581257772030013653642564&nbsp;;<br>
&nbsp;0.92695677218717400052069294&nbsp;;&nbsp;0.97006049783542872712395099&nbsp;;&nbsp;0.99429458548239929207303142&nbsp;|]&nbsp;;;<br>
&nbsp;<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_22_w&nbsp;=&nbsp;[|&nbsp;0.014627995298272200684991098047&nbsp;;&nbsp;0.033774901584814154793302246866&nbsp;;&nbsp;0.052293335152683285940312051273&nbsp;;&nbsp;0.06979646842452048809496141893&nbsp;;<br>
&nbsp;0.08594160621706772741444368137&nbsp;;&nbsp;0.10041414444288096493207883783&nbsp;;&nbsp;0.11293229608053921839340060742&nbsp;;&nbsp;0.12325237681051242428556098615&nbsp;;&nbsp;0.13117350478706237073296499253&nbsp;;<br>
&nbsp;0.13654149834601517135257383123&nbsp;;&nbsp;0.13925187285563199337541024834&nbsp;;&nbsp;0.13925187285563199337541024834&nbsp;;&nbsp;0.13654149834601517135257383123&nbsp;;&nbsp;0.13117350478706237073296499253&nbsp;;<br>
&nbsp;0.12325237681051242428556098615&nbsp;;&nbsp;0.11293229608053921839340060742&nbsp;;&nbsp;0.10041414444288096493207883783&nbsp;;&nbsp;0.08594160621706772741444368137&nbsp;;&nbsp;0.06979646842452048809496141893&nbsp;;<br>
&nbsp;0.052293335152683285940312051273&nbsp;;&nbsp;0.033774901584814154793302246866&nbsp;;&nbsp;0.014627995298272200684991098047&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_23_x&nbsp;=&nbsp;[|&nbsp;-0.99476933499755212352392572&nbsp;;&nbsp;-0.97254247121811523195602408&nbsp;;&nbsp;-0.93297108682601610234919699&nbsp;;&nbsp;-0.87675235827044166737815689&nbsp;;<br>
&nbsp;-0.80488840161883989215111841&nbsp;;&nbsp;-0.71866136313195019446162448&nbsp;;&nbsp;-0.61960987576364615638509731&nbsp;;&nbsp;-0.50950147784600754968979305&nbsp;;&nbsp;-0.39030103803029083142148887&nbsp;;<br>
&nbsp;-0.26413568097034493053386954&nbsp;;&nbsp;-0.13325682429846611093174268&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.13325682429846611093174268&nbsp;;&nbsp;0.26413568097034493053386954&nbsp;;&nbsp;0.39030103803029083142148887&nbsp;;<br>
&nbsp;0.50950147784600754968979305&nbsp;;&nbsp;0.61960987576364615638509731&nbsp;;&nbsp;0.71866136313195019446162448&nbsp;;&nbsp;0.80488840161883989215111841&nbsp;;&nbsp;0.87675235827044166737815689&nbsp;;<br>
&nbsp;0.93297108682601610234919699&nbsp;;&nbsp;0.97254247121811523195602408&nbsp;;&nbsp;0.99476933499755212352392572&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_23_w&nbsp;=&nbsp;[|&nbsp;0.013411859487141772081309493459&nbsp;;&nbsp;0.030988005856979444310694219642&nbsp;;&nbsp;0.048037671731084668571641071632&nbsp;;&nbsp;0.064232421408525852127169615159&nbsp;;<br>
&nbsp;0.079281411776718954922892524742&nbsp;;&nbsp;0.092915766060035147477018617370&nbsp;;&nbsp;0.104892091464541410074086185015&nbsp;;&nbsp;0.11499664022241136494164351293&nbsp;;&nbsp;0.12304908430672953046757840067&nbsp;;<br>
&nbsp;0.12890572218808214997859533940&nbsp;;&nbsp;0.13246203940469661737164246470&nbsp;;&nbsp;0.13365457218610617535145711055&nbsp;;&nbsp;0.13246203940469661737164246470&nbsp;;&nbsp;0.12890572218808214997859533940&nbsp;;<br>
&nbsp;0.12304908430672953046757840067&nbsp;;&nbsp;0.11499664022241136494164351293&nbsp;;&nbsp;0.104892091464541410074086185015&nbsp;;&nbsp;0.092915766060035147477018617370&nbsp;;&nbsp;0.079281411776718954922892524742&nbsp;;<br>
&nbsp;0.064232421408525852127169615159&nbsp;;&nbsp;0.048037671731084668571641071632&nbsp;;&nbsp;0.030988005856979444310694219642&nbsp;;&nbsp;0.013411859487141772081309493459&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_24_x&nbsp;=&nbsp;[|&nbsp;-0.99518721999702136017999741&nbsp;;&nbsp;-0.97472855597130949819839199&nbsp;;&nbsp;-0.93827455200273275852364900&nbsp;;&nbsp;-0.88641552700440103421315434&nbsp;;<br>
&nbsp;-0.82000198597390292195394987&nbsp;;&nbsp;-0.74012419157855436424382810&nbsp;;&nbsp;-0.64809365193697556925249579&nbsp;;&nbsp;-0.54542147138883953565837562&nbsp;;&nbsp;-0.43379350762604513848708423&nbsp;;<br>
&nbsp;-0.31504267969616337438679329&nbsp;;&nbsp;-0.19111886747361630915863982&nbsp;;&nbsp;-0.06405689286260562608504308&nbsp;;&nbsp;0.06405689286260562608504308&nbsp;;&nbsp;0.19111886747361630915863982&nbsp;;<br>
&nbsp;0.31504267969616337438679329&nbsp;;&nbsp;0.43379350762604513848708423&nbsp;;&nbsp;0.54542147138883953565837562&nbsp;;&nbsp;0.64809365193697556925249579&nbsp;;&nbsp;0.74012419157855436424382810&nbsp;;<br>
&nbsp;0.82000198597390292195394987&nbsp;;&nbsp;0.88641552700440103421315434&nbsp;;&nbsp;0.93827455200273275852364900&nbsp;;&nbsp;0.97472855597130949819839199&nbsp;;&nbsp;0.99518721999702136017999741&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_24_w&nbsp;=&nbsp;[|&nbsp;0.012341229799987199546805667070&nbsp;;&nbsp;0.028531388628933663181307815952&nbsp;;&nbsp;0.044277438817419806168602748211&nbsp;;&nbsp;0.059298584915436780746367758500&nbsp;;<br>
&nbsp;0.07334648141108030573403361525&nbsp;;&nbsp;0.08619016153195327591718520298&nbsp;;&nbsp;0.09761865210411388826988066446&nbsp;;&nbsp;0.10744427011596563478257734245&nbsp;;&nbsp;0.11550566805372560135334448391&nbsp;;<br>
&nbsp;0.12167047292780339120446315348&nbsp;;&nbsp;0.12583745634682829612137538251&nbsp;;&nbsp;0.12793819534675215697405616522&nbsp;;&nbsp;0.12793819534675215697405616522&nbsp;;&nbsp;0.12583745634682829612137538251&nbsp;;<br>
&nbsp;0.12167047292780339120446315348&nbsp;;&nbsp;0.11550566805372560135334448391&nbsp;;&nbsp;0.10744427011596563478257734245&nbsp;;&nbsp;0.09761865210411388826988066446&nbsp;;&nbsp;0.08619016153195327591718520298&nbsp;;<br>
&nbsp;0.07334648141108030573403361525&nbsp;;&nbsp;0.059298584915436780746367758500&nbsp;;&nbsp;0.044277438817419806168602748211&nbsp;;&nbsp;0.028531388628933663181307815952&nbsp;;&nbsp;0.012341229799987199546805667070&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_25_x&nbsp;=&nbsp;[|&nbsp;-0.99555696979049809790878495&nbsp;;&nbsp;-0.97666392145951751149831539&nbsp;;&nbsp;-0.94297457122897433941401117&nbsp;;&nbsp;-0.89499199787827536885104201&nbsp;;<br>
&nbsp;-0.83344262876083400142102111&nbsp;;&nbsp;-0.75925926303735763057728287&nbsp;;&nbsp;-0.67356636847346836448512063&nbsp;;&nbsp;-0.57766293024122296772368984&nbsp;;&nbsp;-0.47300273144571496052218212&nbsp;;<br>
&nbsp;-0.36117230580938783773582173&nbsp;;&nbsp;-0.24386688372098843204519036&nbsp;;&nbsp;-0.12286469261071039638735982&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.12286469261071039638735982&nbsp;;&nbsp;0.24386688372098843204519036&nbsp;;<br>
&nbsp;0.36117230580938783773582173&nbsp;;&nbsp;0.47300273144571496052218212&nbsp;;&nbsp;0.57766293024122296772368984&nbsp;;&nbsp;0.67356636847346836448512063&nbsp;;&nbsp;0.75925926303735763057728287&nbsp;;<br>
&nbsp;0.83344262876083400142102111&nbsp;;&nbsp;0.89499199787827536885104201&nbsp;;&nbsp;0.94297457122897433941401117&nbsp;;&nbsp;0.97666392145951751149831539&nbsp;;&nbsp;0.99555696979049809790878495&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_25_w&nbsp;=&nbsp;[|&nbsp;0.0113937985010262879479029641132&nbsp;;&nbsp;0.026354986615032137261901815295&nbsp;;&nbsp;0.040939156701306312655623487712&nbsp;;&nbsp;0.054904695975835191925936891541&nbsp;;<br>
&nbsp;0.068038333812356917207187185657&nbsp;;&nbsp;0.080140700335001018013234959669&nbsp;;&nbsp;0.091028261982963649811497220703&nbsp;;&nbsp;0.100535949067050644202206890393&nbsp;;&nbsp;0.108519624474263653116093957050&nbsp;;<br>
&nbsp;0.11485825914571164833932554587&nbsp;;&nbsp;0.11945576353578477222817812651&nbsp;;&nbsp;0.12224244299031004168895951895&nbsp;;&nbsp;0.12317605372671545120390287308&nbsp;;&nbsp;0.12224244299031004168895951895&nbsp;;<br>
&nbsp;0.11945576353578477222817812651&nbsp;;&nbsp;0.11485825914571164833932554587&nbsp;;&nbsp;0.108519624474263653116093957050&nbsp;;&nbsp;0.100535949067050644202206890393&nbsp;;&nbsp;0.091028261982963649811497220703&nbsp;;<br>
&nbsp;0.080140700335001018013234959669&nbsp;;&nbsp;0.068038333812356917207187185657&nbsp;;&nbsp;0.054904695975835191925936891541&nbsp;;&nbsp;0.040939156701306312655623487712&nbsp;;&nbsp;0.026354986615032137261901815295&nbsp;;<br>
&nbsp;0.0113937985010262879479029641132&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_26_x&nbsp;=&nbsp;[|&nbsp;-0.99588570114561692900321696&nbsp;;&nbsp;-0.97838544595647099110058035&nbsp;;&nbsp;-0.94715906666171425013591528&nbsp;;&nbsp;-0.90263786198430707421766560&nbsp;;<br>
&nbsp;-0.84544594278849801879750706&nbsp;;&nbsp;-0.77638594882067885619296725&nbsp;;&nbsp;-0.69642726041995726486381391&nbsp;;&nbsp;-0.60669229301761806323197875&nbsp;;&nbsp;-0.50844071482450571769570306&nbsp;;<br>
&nbsp;-0.40305175512348630648107738&nbsp;;&nbsp;-0.29200483948595689514283538&nbsp;;&nbsp;-0.17685882035689018396905775&nbsp;;&nbsp;-0.05923009342931320709371858&nbsp;;&nbsp;0.05923009342931320709371858&nbsp;;<br>
&nbsp;0.17685882035689018396905775&nbsp;;&nbsp;0.29200483948595689514283538&nbsp;;&nbsp;0.40305175512348630648107738&nbsp;;&nbsp;0.50844071482450571769570306&nbsp;;&nbsp;0.60669229301761806323197875&nbsp;;<br>
&nbsp;0.69642726041995726486381391&nbsp;;&nbsp;0.77638594882067885619296725&nbsp;;&nbsp;0.84544594278849801879750706&nbsp;;&nbsp;0.90263786198430707421766560&nbsp;;&nbsp;0.94715906666171425013591528&nbsp;;<br>
&nbsp;0.97838544595647099110058035&nbsp;;&nbsp;0.99588570114561692900321696&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_26_w&nbsp;=&nbsp;[|&nbsp;0.010551372617343007155651187685&nbsp;;&nbsp;0.024417851092631908789615827520&nbsp;;&nbsp;0.037962383294362763950303141249&nbsp;;&nbsp;0.050975825297147811998319900724&nbsp;;<br>
&nbsp;0.063274046329574835539453689907&nbsp;;&nbsp;0.07468414976565974588707579610&nbsp;;&nbsp;0.08504589431348523921044776508&nbsp;;&nbsp;0.09421380035591414846366488307&nbsp;;&nbsp;0.10205916109442542323841407025&nbsp;;<br>
&nbsp;0.10847184052857659065657942673&nbsp;;&nbsp;0.11336181654631966654944071844&nbsp;;&nbsp;0.11666044348529658204466250754&nbsp;;&nbsp;0.11832141527926227651637108570&nbsp;;&nbsp;0.11832141527926227651637108570&nbsp;;<br>
&nbsp;0.11666044348529658204466250754&nbsp;;&nbsp;0.11336181654631966654944071844&nbsp;;&nbsp;0.10847184052857659065657942673&nbsp;;&nbsp;0.10205916109442542323841407025&nbsp;;&nbsp;0.09421380035591414846366488307&nbsp;;<br>
&nbsp;0.08504589431348523921044776508&nbsp;;&nbsp;0.07468414976565974588707579610&nbsp;;&nbsp;0.063274046329574835539453689907&nbsp;;&nbsp;0.050975825297147811998319900724&nbsp;;&nbsp;0.037962383294362763950303141249&nbsp;;<br>
&nbsp;0.024417851092631908789615827520&nbsp;;&nbsp;0.010551372617343007155651187685&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_27_x&nbsp;=&nbsp;[|&nbsp;-0.99617926288898856693888721&nbsp;;&nbsp;-0.97992347596150122285587336&nbsp;;&nbsp;-0.95090055781470500685190803&nbsp;;&nbsp;-0.90948232067749110430064502&nbsp;;<br>
&nbsp;-0.85620790801829449030273722&nbsp;;&nbsp;-0.79177163907050822714439734&nbsp;;&nbsp;-0.71701347373942369929481621&nbsp;;&nbsp;-0.63290797194649514092773464&nbsp;;&nbsp;-0.54055156457945689490030094&nbsp;;<br>
&nbsp;-0.44114825175002688058597416&nbsp;;&nbsp;-0.33599390363850889973031903&nbsp;;&nbsp;-0.22645936543953685885723911&nbsp;;&nbsp;-0.11397258560952996693289498&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.11397258560952996693289498&nbsp;;<br>
&nbsp;0.22645936543953685885723911&nbsp;;&nbsp;0.33599390363850889973031903&nbsp;;&nbsp;0.44114825175002688058597416&nbsp;;&nbsp;0.54055156457945689490030094&nbsp;;&nbsp;0.63290797194649514092773464&nbsp;;<br>
&nbsp;0.71701347373942369929481621&nbsp;;&nbsp;0.79177163907050822714439734&nbsp;;&nbsp;0.85620790801829449030273722&nbsp;;&nbsp;0.90948232067749110430064502&nbsp;;&nbsp;0.95090055781470500685190803&nbsp;;<br>
&nbsp;0.97992347596150122285587336&nbsp;;&nbsp;0.99617926288898856693888721&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_27_w&nbsp;=&nbsp;[|&nbsp;0.0097989960512943602611500550912&nbsp;;&nbsp;0.022686231596180623196034206447&nbsp;;&nbsp;0.035297053757419711022578289305&nbsp;;&nbsp;0.047449412520615062704096710114&nbsp;;<br>
&nbsp;0.058983536859833599110300833720&nbsp;;&nbsp;0.069748823766245592984322888357&nbsp;;&nbsp;0.079604867773057771263074959010&nbsp;;&nbsp;0.088423158543756950194322802854&nbsp;;&nbsp;0.096088727370028507565652646558&nbsp;;<br>
&nbsp;0.102501637817745798671247711533&nbsp;;&nbsp;0.107578285788533187212162984427&nbsp;;&nbsp;0.111252488356845192672163096043&nbsp;;&nbsp;0.113476346108965148620369948092&nbsp;;&nbsp;0.11422086737895698904504573690&nbsp;;<br>
&nbsp;0.113476346108965148620369948092&nbsp;;&nbsp;0.111252488356845192672163096043&nbsp;;&nbsp;0.107578285788533187212162984427&nbsp;;&nbsp;0.102501637817745798671247711533&nbsp;;&nbsp;0.096088727370028507565652646558&nbsp;;<br>
&nbsp;0.088423158543756950194322802854&nbsp;;&nbsp;0.079604867773057771263074959010&nbsp;;&nbsp;0.069748823766245592984322888357&nbsp;;&nbsp;0.058983536859833599110300833720&nbsp;;&nbsp;0.047449412520615062704096710114&nbsp;;<br>
&nbsp;0.035297053757419711022578289305&nbsp;;&nbsp;0.022686231596180623196034206447&nbsp;;&nbsp;0.0097989960512943602611500550912&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_28_x&nbsp;=&nbsp;[|&nbsp;-0.99644249757395444995043639&nbsp;;&nbsp;-0.98130316537087275369455995&nbsp;;&nbsp;-0.95425928062893819725410184&nbsp;;&nbsp;-0.91563302639213207386968942&nbsp;;<br>
&nbsp;-0.86589252257439504894225457&nbsp;;&nbsp;-0.80564137091717917144788596&nbsp;;&nbsp;-0.73561087801363177202814451&nbsp;;&nbsp;-0.65665109403886496121989818&nbsp;;&nbsp;-0.56972047181140171930800328&nbsp;;<br>
&nbsp;-0.47587422495511826103441185&nbsp;;&nbsp;-0.37625151608907871022135721&nbsp;;&nbsp;-0.27206162763517807767682636&nbsp;;&nbsp;-0.16456928213338077128147178&nbsp;;&nbsp;-0.05507928988403427042651653&nbsp;;<br>
&nbsp;0.05507928988403427042651653&nbsp;;&nbsp;0.16456928213338077128147178&nbsp;;&nbsp;0.27206162763517807767682636&nbsp;;&nbsp;0.37625151608907871022135721&nbsp;;&nbsp;0.47587422495511826103441185&nbsp;;<br>
&nbsp;0.56972047181140171930800328&nbsp;;&nbsp;0.65665109403886496121989818&nbsp;;&nbsp;0.73561087801363177202814451&nbsp;;&nbsp;0.80564137091717917144788596&nbsp;;&nbsp;0.86589252257439504894225457&nbsp;;<br>
&nbsp;0.91563302639213207386968942&nbsp;;&nbsp;0.95425928062893819725410184&nbsp;;&nbsp;0.98130316537087275369455995&nbsp;;&nbsp;0.99644249757395444995043639&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_28_w&nbsp;=&nbsp;[|&nbsp;0.009124282593094517738816153923&nbsp;;&nbsp;0.021132112592771259751500380993&nbsp;;&nbsp;0.032901427782304379977630819171&nbsp;;&nbsp;0.044272934759004227839587877653&nbsp;;<br>
&nbsp;0.055107345675716745431482918227&nbsp;;&nbsp;0.06527292396699959579339756678&nbsp;;&nbsp;0.07464621423456877902393188717&nbsp;;&nbsp;0.08311341722890121839039649824&nbsp;;&nbsp;0.09057174439303284094218603134&nbsp;;<br>
&nbsp;0.09693065799792991585048900610&nbsp;;&nbsp;0.10211296757806076981421663851&nbsp;;&nbsp;0.10605576592284641791041643700&nbsp;;&nbsp;0.10871119225829413525357151930&nbsp;;&nbsp;0.11004701301647519628237626560&nbsp;;<br>
&nbsp;0.11004701301647519628237626560&nbsp;;&nbsp;0.10871119225829413525357151930&nbsp;;&nbsp;0.10605576592284641791041643700&nbsp;;&nbsp;0.10211296757806076981421663851&nbsp;;&nbsp;0.09693065799792991585048900610&nbsp;;<br>
&nbsp;0.09057174439303284094218603134&nbsp;;&nbsp;0.08311341722890121839039649824&nbsp;;&nbsp;0.07464621423456877902393188717&nbsp;;&nbsp;0.06527292396699959579339756678&nbsp;;&nbsp;0.055107345675716745431482918227&nbsp;;<br>
&nbsp;0.044272934759004227839587877653&nbsp;;&nbsp;0.032901427782304379977630819171&nbsp;;&nbsp;0.021132112592771259751500380993&nbsp;;&nbsp;0.009124282593094517738816153923&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_29_x&nbsp;=&nbsp;[|&nbsp;-0.99667944226059658616319153&nbsp;;&nbsp;-0.98254550526141317487092602&nbsp;;&nbsp;-0.95728559577808772579820804&nbsp;;&nbsp;-0.92118023295305878509375344&nbsp;;<br>
&nbsp;-0.87463780492010279041779342&nbsp;;&nbsp;-0.81818548761525244498957221&nbsp;;&nbsp;-0.75246285173447713391261008&nbsp;;&nbsp;-0.67821453760268651515618501&nbsp;;&nbsp;-0.59628179713822782037958621&nbsp;;<br>
&nbsp;-0.50759295512422764210262792&nbsp;;&nbsp;-0.41315288817400866389070659&nbsp;;&nbsp;-0.31403163786763993494819592&nbsp;;&nbsp;-0.21135228616600107450637573&nbsp;;&nbsp;-0.10627823013267923017098239&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;0.10627823013267923017098239&nbsp;;&nbsp;0.21135228616600107450637573&nbsp;;&nbsp;0.31403163786763993494819592&nbsp;;&nbsp;0.41315288817400866389070659&nbsp;;&nbsp;0.50759295512422764210262792&nbsp;;<br>
&nbsp;0.59628179713822782037958621&nbsp;;&nbsp;0.67821453760268651515618501&nbsp;;&nbsp;0.75246285173447713391261008&nbsp;;&nbsp;0.81818548761525244498957221&nbsp;;&nbsp;0.87463780492010279041779342&nbsp;;<br>
&nbsp;0.92118023295305878509375344&nbsp;;&nbsp;0.95728559577808772579820804&nbsp;;&nbsp;0.98254550526141317487092602&nbsp;;&nbsp;0.99667944226059658616319153&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_29_w&nbsp;=&nbsp;[|&nbsp;0.0085169038787464096542638133022&nbsp;;&nbsp;0.019732085056122705983859801640&nbsp;;&nbsp;0.030740492202093622644408525375&nbsp;;&nbsp;0.041402062518682836104830010114&nbsp;;<br>
&nbsp;0.051594826902497923912594381180&nbsp;;&nbsp;0.061203090657079138542109848024&nbsp;;&nbsp;0.070117933255051278569581486949&nbsp;;&nbsp;0.078238327135763783828144888660&nbsp;;&nbsp;0.085472257366172527545344849297&nbsp;;<br>
&nbsp;0.091737757139258763347966411077&nbsp;;&nbsp;0.096963834094408606301900074883&nbsp;;&nbsp;0.101091273759914966121820546907&nbsp;;&nbsp;0.104073310077729373913328471285&nbsp;;&nbsp;0.105876155097320941406591327852&nbsp;;<br>
&nbsp;0.10647938171831424424651112691&nbsp;;&nbsp;0.105876155097320941406591327852&nbsp;;&nbsp;0.104073310077729373913328471285&nbsp;;&nbsp;0.101091273759914966121820546907&nbsp;;&nbsp;0.096963834094408606301900074883&nbsp;;<br>
&nbsp;0.091737757139258763347966411077&nbsp;;&nbsp;0.085472257366172527545344849297&nbsp;;&nbsp;0.078238327135763783828144888660&nbsp;;&nbsp;0.070117933255051278569581486949&nbsp;;&nbsp;0.061203090657079138542109848024&nbsp;;<br>
&nbsp;0.051594826902497923912594381180&nbsp;;&nbsp;0.041402062518682836104830010114&nbsp;;&nbsp;0.030740492202093622644408525375&nbsp;;&nbsp;0.019732085056122705983859801640&nbsp;;&nbsp;0.0085169038787464096542638133022&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_30_x&nbsp;=&nbsp;[|&nbsp;-0.99689348407464954027163005&nbsp;;&nbsp;-0.98366812327974720997003258&nbsp;;&nbsp;-0.96002186496830751221687103&nbsp;;&nbsp;-0.92620004742927432587932428&nbsp;;<br>
&nbsp;-0.88256053579205268154311646&nbsp;;&nbsp;-0.82956576238276839744289812&nbsp;;&nbsp;-0.76777743210482619491797734&nbsp;;&nbsp;-0.69785049479331579693229239&nbsp;;&nbsp;-0.62052618298924286114047756&nbsp;;<br>
&nbsp;-0.53662414814201989926416979&nbsp;;&nbsp;-0.44703376953808917678060990&nbsp;;&nbsp;-0.35270472553087811347103721&nbsp;;&nbsp;-0.25463692616788984643980513&nbsp;;&nbsp;-0.15386991360858354696379467&nbsp;;<br>
&nbsp;-0.05147184255531769583302521&nbsp;;&nbsp;0.05147184255531769583302521&nbsp;;&nbsp;0.15386991360858354696379467&nbsp;;&nbsp;0.25463692616788984643980513&nbsp;;&nbsp;0.35270472553087811347103721&nbsp;;<br>
&nbsp;0.44703376953808917678060990&nbsp;;&nbsp;0.53662414814201989926416979&nbsp;;&nbsp;0.62052618298924286114047756&nbsp;;&nbsp;0.69785049479331579693229239&nbsp;;&nbsp;0.76777743210482619491797734&nbsp;;<br>
&nbsp;0.82956576238276839744289812&nbsp;;&nbsp;0.88256053579205268154311646&nbsp;;&nbsp;0.92620004742927432587932428&nbsp;;&nbsp;0.96002186496830751221687103&nbsp;;&nbsp;0.98366812327974720997003258&nbsp;;<br>
&nbsp;0.99689348407464954027163005&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_30_w&nbsp;=&nbsp;[|&nbsp;0.007968192496166605615465883475&nbsp;;&nbsp;0.018466468311090959142302131912&nbsp;;&nbsp;0.028784707883323369349719179611&nbsp;;&nbsp;0.038799192569627049596801936446&nbsp;;<br>
&nbsp;0.048402672830594052902938140423&nbsp;;&nbsp;0.057493156217619066481721689402&nbsp;;&nbsp;0.06597422988218049512812851512&nbsp;;&nbsp;0.07375597473770520626824385002&nbsp;;&nbsp;0.08075589522942021535469493846&nbsp;;<br>
&nbsp;0.08689978720108297980238753072&nbsp;;&nbsp;0.09212252223778612871763270709&nbsp;;&nbsp;0.09636873717464425963946862635&nbsp;;&nbsp;0.09959342058679526706278028210&nbsp;;&nbsp;0.10176238974840550459642895217&nbsp;;<br>
&nbsp;0.10285265289355884034128563671&nbsp;;&nbsp;0.10285265289355884034128563671&nbsp;;&nbsp;0.10176238974840550459642895217&nbsp;;&nbsp;0.09959342058679526706278028210&nbsp;;&nbsp;0.09636873717464425963946862635&nbsp;;<br>
&nbsp;0.09212252223778612871763270709&nbsp;;&nbsp;0.08689978720108297980238753072&nbsp;;&nbsp;0.08075589522942021535469493846&nbsp;;&nbsp;0.07375597473770520626824385002&nbsp;;&nbsp;0.06597422988218049512812851512&nbsp;;<br>
&nbsp;0.057493156217619066481721689402&nbsp;;&nbsp;0.048402672830594052902938140423&nbsp;;&nbsp;0.038799192569627049596801936446&nbsp;;&nbsp;0.028784707883323369349719179611&nbsp;;&nbsp;0.018466468311090959142302131912&nbsp;;<br>
&nbsp;0.007968192496166605615465883475&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_31_x&nbsp;=&nbsp;[|&nbsp;-0.99708748181947707405562655&nbsp;;&nbsp;-0.98468590966515248400246517&nbsp;;&nbsp;-0.96250392509294966178905240&nbsp;;&nbsp;-0.93075699789664816495694576&nbsp;;<br>
&nbsp;-0.88976002994827104337419201&nbsp;;&nbsp;-0.83992032014626734008690454&nbsp;;&nbsp;-0.78173314841662494040636002&nbsp;;&nbsp;-0.71577678458685328390597087&nbsp;;&nbsp;-0.64270672292426034618441820&nbsp;;<br>
&nbsp;-0.56324916140714926272094492&nbsp;;&nbsp;-0.47819378204490248044059404&nbsp;;&nbsp;-0.38838590160823294306135146&nbsp;;&nbsp;-0.29471806998170161661790390&nbsp;;&nbsp;-0.19812119933557062877241300&nbsp;;<br>
&nbsp;-0.09955531215234152032517479&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.09955531215234152032517479&nbsp;;&nbsp;0.19812119933557062877241300&nbsp;;&nbsp;0.29471806998170161661790390&nbsp;;&nbsp;0.38838590160823294306135146&nbsp;;<br>
&nbsp;0.47819378204490248044059404&nbsp;;&nbsp;0.56324916140714926272094492&nbsp;;&nbsp;0.64270672292426034618441820&nbsp;;&nbsp;0.71577678458685328390597087&nbsp;;&nbsp;0.78173314841662494040636002&nbsp;;<br>
&nbsp;0.83992032014626734008690454&nbsp;;&nbsp;0.88976002994827104337419201&nbsp;;&nbsp;0.93075699789664816495694576&nbsp;;&nbsp;0.96250392509294966178905240&nbsp;;&nbsp;0.98468590966515248400246517&nbsp;;<br>
&nbsp;0.99708748181947707405562655&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_31_w&nbsp;=&nbsp;[|&nbsp;0.0074708315792487758586968750322&nbsp;;&nbsp;0.017318620790310582463157996087&nbsp;;&nbsp;0.027009019184979421800608708092&nbsp;;&nbsp;0.036432273912385464024392010468&nbsp;;<br>
&nbsp;0.045493707527201102902315857895&nbsp;;&nbsp;0.054103082424916853711666259087&nbsp;;&nbsp;0.062174786561028426910343543687&nbsp;;&nbsp;0.069628583235410366167756126255&nbsp;;&nbsp;0.076390386598776616426357674901&nbsp;;<br>
&nbsp;0.082392991761589263903823367432&nbsp;;&nbsp;0.087576740608477876126198069695&nbsp;;&nbsp;0.091890113893641478215362871607&nbsp;;&nbsp;0.095290242912319512807204197488&nbsp;;&nbsp;0.097743335386328725093474010979&nbsp;;<br>
&nbsp;0.099225011226672307874875514429&nbsp;;&nbsp;0.09972054479342645142753383373&nbsp;;&nbsp;0.099225011226672307874875514429&nbsp;;&nbsp;0.097743335386328725093474010979&nbsp;;&nbsp;0.095290242912319512807204197488&nbsp;;<br>
&nbsp;0.091890113893641478215362871607&nbsp;;&nbsp;0.087576740608477876126198069695&nbsp;;&nbsp;0.082392991761589263903823367432&nbsp;;&nbsp;0.076390386598776616426357674901&nbsp;;&nbsp;0.069628583235410366167756126255&nbsp;;<br>
&nbsp;0.062174786561028426910343543687&nbsp;;&nbsp;0.054103082424916853711666259087&nbsp;;&nbsp;0.045493707527201102902315857895&nbsp;;&nbsp;0.036432273912385464024392010468&nbsp;;&nbsp;0.027009019184979421800608708092&nbsp;;<br>
&nbsp;0.017318620790310582463157996087&nbsp;;&nbsp;0.0074708315792487758586968750322&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_32_x&nbsp;=&nbsp;[|&nbsp;-0.99726386184948156354498113&nbsp;;&nbsp;-0.98561151154526833540017504&nbsp;;&nbsp;-0.96476225558750643077381193&nbsp;;&nbsp;-0.93490607593773968917091913&nbsp;;<br>
&nbsp;-0.89632115576605212396530724&nbsp;;&nbsp;-0.84936761373256997013369300&nbsp;;&nbsp;-0.79448379596794240696309730&nbsp;;&nbsp;-0.73218211874028968038742667&nbsp;;&nbsp;-0.66304426693021520097511517&nbsp;;<br>
&nbsp;-0.58771575724076232904074548&nbsp;;&nbsp;-0.50689990893222939002374747&nbsp;;&nbsp;-0.42135127613063534536411944&nbsp;;&nbsp;-0.33186860228212764977991681&nbsp;;&nbsp;-0.23928736225213707454460321&nbsp;;<br>
&nbsp;-0.14447196158279649348518637&nbsp;;&nbsp;-0.04830766568773831623481257&nbsp;;&nbsp;0.04830766568773831623481257&nbsp;;&nbsp;0.14447196158279649348518637&nbsp;;&nbsp;0.23928736225213707454460321&nbsp;;<br>
&nbsp;0.33186860228212764977991681&nbsp;;&nbsp;0.42135127613063534536411944&nbsp;;&nbsp;0.50689990893222939002374747&nbsp;;&nbsp;0.58771575724076232904074548&nbsp;;&nbsp;0.66304426693021520097511517&nbsp;;<br>
&nbsp;0.73218211874028968038742667&nbsp;;&nbsp;0.79448379596794240696309730&nbsp;;&nbsp;0.84936761373256997013369300&nbsp;;&nbsp;0.89632115576605212396530724&nbsp;;&nbsp;0.93490607593773968917091913&nbsp;;<br>
&nbsp;0.96476225558750643077381193&nbsp;;&nbsp;0.98561151154526833540017504&nbsp;;&nbsp;0.99726386184948156354498113&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_32_w&nbsp;=&nbsp;[|&nbsp;0.007018610009470096600407063739&nbsp;;&nbsp;0.016274394730905670605170562206&nbsp;;&nbsp;0.025392065309262059455752589789&nbsp;;&nbsp;0.034273862913021433102687732252&nbsp;;<br>
&nbsp;0.042835898022226680656878646606&nbsp;;&nbsp;0.050998059262376176196163244690&nbsp;;&nbsp;0.058684093478535547145283637300&nbsp;;&nbsp;0.06582222277636184683765006371&nbsp;;&nbsp;0.07234579410884850622539935648&nbsp;;<br>
&nbsp;0.07819389578707030647174091883&nbsp;;&nbsp;0.08331192422694675522219907460&nbsp;;&nbsp;0.08765209300440381114277146275&nbsp;;&nbsp;0.09117387869576388471286857711&nbsp;;&nbsp;0.09384439908080456563918023767&nbsp;;<br>
&nbsp;0.09563872007927485941908200220&nbsp;;&nbsp;0.09654008851472780056676483006&nbsp;;&nbsp;0.09654008851472780056676483006&nbsp;;&nbsp;0.09563872007927485941908200220&nbsp;;&nbsp;0.09384439908080456563918023767&nbsp;;<br>
&nbsp;0.09117387869576388471286857711&nbsp;;&nbsp;0.08765209300440381114277146275&nbsp;;&nbsp;0.08331192422694675522219907460&nbsp;;&nbsp;0.07819389578707030647174091883&nbsp;;&nbsp;0.07234579410884850622539935648&nbsp;;<br>
&nbsp;0.06582222277636184683765006371&nbsp;;&nbsp;0.058684093478535547145283637300&nbsp;;&nbsp;0.050998059262376176196163244690&nbsp;;&nbsp;0.042835898022226680656878646606&nbsp;;&nbsp;0.034273862913021433102687732252&nbsp;;<br>
&nbsp;0.025392065309262059455752589789&nbsp;;&nbsp;0.016274394730905670605170562206&nbsp;;&nbsp;0.007018610009470096600407063739&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_33_x&nbsp;=&nbsp;[|&nbsp;-0.99742469424645521726616802&nbsp;;&nbsp;-0.98645572623064248811037570&nbsp;;&nbsp;-0.96682290968999276892837771&nbsp;;&nbsp;-0.93869437261116835035583512&nbsp;;<br>
&nbsp;-0.90231676774343358304053133&nbsp;;&nbsp;-0.85800965267650406464306148&nbsp;;&nbsp;-0.80616235627416658979620087&nbsp;;&nbsp;-0.74723049644956215785905512&nbsp;;&nbsp;-0.68173195996974278626821595&nbsp;;<br>
&nbsp;-0.61024234583637902730728751&nbsp;;&nbsp;-0.53338990478634764354889426&nbsp;;&nbsp;-0.45185001727245069572599328&nbsp;;&nbsp;-0.36633925774807334107022062&nbsp;;&nbsp;-0.27760909715249702940324807&nbsp;;<br>
&nbsp;-0.18643929882799157233579876&nbsp;;&nbsp;-0.09363106585473338567074292&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.09363106585473338567074292&nbsp;;&nbsp;0.18643929882799157233579876&nbsp;;&nbsp;0.27760909715249702940324807&nbsp;;<br>
&nbsp;0.36633925774807334107022062&nbsp;;&nbsp;0.45185001727245069572599328&nbsp;;&nbsp;0.53338990478634764354889426&nbsp;;&nbsp;0.61024234583637902730728751&nbsp;;&nbsp;0.68173195996974278626821595&nbsp;;<br>
&nbsp;0.74723049644956215785905512&nbsp;;&nbsp;0.80616235627416658979620087&nbsp;;&nbsp;0.85800965267650406464306148&nbsp;;&nbsp;0.90231676774343358304053133&nbsp;;&nbsp;0.93869437261116835035583512&nbsp;;<br>
&nbsp;0.96682290968999276892837771&nbsp;;&nbsp;0.98645572623064248811037570&nbsp;;&nbsp;0.99742469424645521726616802&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_33_w&nbsp;=&nbsp;[|&nbsp;0.0066062278475873780586492352085&nbsp;;&nbsp;0.015321701512934676127945768534&nbsp;;&nbsp;0.023915548101749480350533257529&nbsp;;&nbsp;0.032300358632328953281561447250&nbsp;;<br>
&nbsp;0.040401541331669591563409790527&nbsp;;&nbsp;0.048147742818711695670146880138&nbsp;;&nbsp;0.055470846631663561284944495439&nbsp;;&nbsp;0.062306482530317480031627725771&nbsp;;&nbsp;0.068594572818656712805955073015&nbsp;;<br>
&nbsp;0.074279854843954149342472175919&nbsp;;&nbsp;0.079312364794886738363908384942&nbsp;;&nbsp;0.083647876067038707613928014518&nbsp;;&nbsp;0.087248287618844337607281670945&nbsp;;&nbsp;0.090081958660638577239743705500&nbsp;;<br>
&nbsp;0.092123986643316846213240977717&nbsp;;&nbsp;0.093356426065596116160999126274&nbsp;;&nbsp;0.09376844616020999656730454155&nbsp;;&nbsp;0.093356426065596116160999126274&nbsp;;&nbsp;0.092123986643316846213240977717&nbsp;;<br>
&nbsp;0.090081958660638577239743705500&nbsp;;&nbsp;0.087248287618844337607281670945&nbsp;;&nbsp;0.083647876067038707613928014518&nbsp;;&nbsp;0.079312364794886738363908384942&nbsp;;&nbsp;0.074279854843954149342472175919&nbsp;;<br>
&nbsp;0.068594572818656712805955073015&nbsp;;&nbsp;0.062306482530317480031627725771&nbsp;;&nbsp;0.055470846631663561284944495439&nbsp;;&nbsp;0.048147742818711695670146880138&nbsp;;&nbsp;0.040401541331669591563409790527&nbsp;;<br>
&nbsp;0.032300358632328953281561447250&nbsp;;&nbsp;0.023915548101749480350533257529&nbsp;;&nbsp;0.015321701512934676127945768534&nbsp;;&nbsp;0.0066062278475873780586492352085&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_63_x&nbsp;=&nbsp;[|&nbsp;-0.99928298402912378037893614&nbsp;;&nbsp;-0.99622401277797010860219336&nbsp;;&nbsp;-0.99072854689218946681089467&nbsp;;&nbsp;-0.98280881059372723486251141&nbsp;;<br>
&nbsp;-0.97248403469757002280196068&nbsp;;&nbsp;-0.95977944975894192707035417&nbsp;;&nbsp;-0.94472613404100980296637532&nbsp;;&nbsp;-0.92736092062184320544703138&nbsp;;&nbsp;-0.90772630277853155803695313&nbsp;;<br>
&nbsp;-0.88587032850785342629029846&nbsp;;&nbsp;-0.86184648236412371953961184&nbsp;;&nbsp;-0.83571355431950284347180777&nbsp;;&nbsp;-0.80753549577345676005146599&nbsp;;&nbsp;-0.7773812629903723355633302&nbsp;;<br>
&nbsp;-0.7453246483178474178293217&nbsp;;&nbsp;-0.7114440995848458078514315&nbsp;;&nbsp;-0.6758225281149860901311033&nbsp;;&nbsp;-0.6385471058213653850003070&nbsp;;&nbsp;-0.5997090518776252357390089&nbsp;;<br>
&nbsp;-0.5594034094862850132676978&nbsp;;&nbsp;-0.5177288132900332481244776&nbsp;;&nbsp;-0.4747872479948043999222123&nbsp;;&nbsp;-0.4306837987951116006620889&nbsp;;&nbsp;-0.3855263942122478924776150&nbsp;;<br>
&nbsp;-0.3394255419745844024688344&nbsp;;&nbsp;-0.2924940585862514400361572&nbsp;;&nbsp;-0.2448467932459533627484046&nbsp;;&nbsp;-0.1966003467915066845576275&nbsp;;&nbsp;-0.1478727863578719685698391&nbsp;;<br>
&nbsp;-0.0987833564469452795297037&nbsp;;&nbsp;-0.0494521871161596272342338&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0494521871161596272342338&nbsp;;&nbsp;0.0987833564469452795297037&nbsp;;&nbsp;0.1478727863578719685698391&nbsp;;<br>
&nbsp;0.1966003467915066845576275&nbsp;;&nbsp;0.2448467932459533627484046&nbsp;;&nbsp;0.2924940585862514400361572&nbsp;;&nbsp;0.3394255419745844024688344&nbsp;;&nbsp;0.3855263942122478924776150&nbsp;;<br>
&nbsp;0.4306837987951116006620889&nbsp;;&nbsp;0.4747872479948043999222123&nbsp;;&nbsp;0.5177288132900332481244776&nbsp;;&nbsp;0.5594034094862850132676978&nbsp;;&nbsp;0.5997090518776252357390089&nbsp;;<br>
&nbsp;0.6385471058213653850003070&nbsp;;&nbsp;0.6758225281149860901311033&nbsp;;&nbsp;0.7114440995848458078514315&nbsp;;&nbsp;0.7453246483178474178293217&nbsp;;&nbsp;0.7773812629903723355633302&nbsp;;<br>
&nbsp;0.8075354957734567600514660&nbsp;;&nbsp;0.8357135543195028434718078&nbsp;;&nbsp;0.8618464823641237195396118&nbsp;;&nbsp;0.8858703285078534262902985&nbsp;;&nbsp;0.9077263027785315580369531&nbsp;;<br>
&nbsp;0.9273609206218432054470314&nbsp;;&nbsp;0.9447261340410098029663753&nbsp;;&nbsp;0.9597794497589419270703542&nbsp;;&nbsp;0.9724840346975700228019607&nbsp;;&nbsp;0.9828088105937272348625114&nbsp;;<br>
&nbsp;0.9907285468921894668108947&nbsp;;&nbsp;0.9962240127779701086021934&nbsp;;&nbsp;0.9992829840291237803789361&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_63_w&nbsp;=&nbsp;[|&nbsp;0.0018398745955770841170924455540&nbsp;;&nbsp;0.0042785083468637618660784110826&nbsp;;&nbsp;0.0067102917659601362519069307298&nbsp;;&nbsp;0.0091259686763266563540586454218&nbsp;;<br>
&nbsp;0.011519376076880041750750606149&nbsp;;&nbsp;0.013884612616115610824866086368&nbsp;;&nbsp;0.016215878410338338882283672975&nbsp;;&nbsp;0.018507464460161270409260545805&nbsp;;&nbsp;0.020753761258039090775341953421&nbsp;;<br>
&nbsp;0.022949271004889933148942319562&nbsp;;&nbsp;0.025088620553344986618630138068&nbsp;;&nbsp;0.027166574359097933225189839439&nbsp;;&nbsp;0.029178047208280526945551502154&nbsp;;&nbsp;0.031118116622219817508215988557&nbsp;;<br>
&nbsp;0.032982034883779341765683179672&nbsp;;&nbsp;0.034765240645355877697180504643&nbsp;;&nbsp;0.036463370085457289630452409788&nbsp;;&nbsp;0.038072267584349556763638324928&nbsp;;&nbsp;0.039587995891544093984807928149&nbsp;;<br>
&nbsp;0.041006845759666398635110037009&nbsp;;&nbsp;0.042325345020815822982505485403&nbsp;;&nbsp;0.043540267083027590798964315704&nbsp;;&nbsp;0.044648638825941395370332669517&nbsp;;&nbsp;0.045647747876292608685885992609&nbsp;;<br>
&nbsp;0.046535149245383696510395418747&nbsp;;&nbsp;0.047308671312268919080604988339&nbsp;;&nbsp;0.047966421137995131411052756195&nbsp;;&nbsp;0.048506789097883847864090099146&nbsp;;&nbsp;0.048928452820511989944709361549&nbsp;;<br>
&nbsp;0.049230380423747560785043116988&nbsp;;&nbsp;0.049411833039918178967039646117&nbsp;;&nbsp;0.04947236662393102088866936042&nbsp;;&nbsp;0.049411833039918178967039646117&nbsp;;&nbsp;0.049230380423747560785043116988&nbsp;;<br>
&nbsp;0.048928452820511989944709361549&nbsp;;&nbsp;0.048506789097883847864090099146&nbsp;;&nbsp;0.047966421137995131411052756195&nbsp;;&nbsp;0.047308671312268919080604988339&nbsp;;&nbsp;0.046535149245383696510395418747&nbsp;;<br>
&nbsp;0.045647747876292608685885992609&nbsp;;&nbsp;0.044648638825941395370332669517&nbsp;;&nbsp;0.043540267083027590798964315704&nbsp;;&nbsp;0.042325345020815822982505485403&nbsp;;&nbsp;0.041006845759666398635110037009&nbsp;;<br>
&nbsp;0.039587995891544093984807928149&nbsp;;&nbsp;0.038072267584349556763638324928&nbsp;;&nbsp;0.036463370085457289630452409788&nbsp;;&nbsp;0.034765240645355877697180504643&nbsp;;&nbsp;0.032982034883779341765683179672&nbsp;;<br>
&nbsp;0.031118116622219817508215988557&nbsp;;&nbsp;0.029178047208280526945551502154&nbsp;;&nbsp;0.027166574359097933225189839439&nbsp;;&nbsp;0.025088620553344986618630138068&nbsp;;&nbsp;0.022949271004889933148942319562&nbsp;;<br>
&nbsp;0.020753761258039090775341953421&nbsp;;&nbsp;0.018507464460161270409260545805&nbsp;;&nbsp;0.016215878410338338882283672975&nbsp;;&nbsp;0.013884612616115610824866086368&nbsp;;&nbsp;0.011519376076880041750750606149&nbsp;;<br>
&nbsp;0.0091259686763266563540586454218&nbsp;;&nbsp;0.0067102917659601362519069307298&nbsp;;&nbsp;0.0042785083468637618660784110826&nbsp;;&nbsp;0.0018398745955770841170924455540&nbsp;|]&nbsp;;;<br>
&nbsp;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_64_x&nbsp;=&nbsp;[|&nbsp;-0.99930504173577213945690562&nbsp;;&nbsp;-0.99634011677195527934692450&nbsp;;&nbsp;-0.99101337147674432073938238&nbsp;;&nbsp;-0.98333625388462595693129930&nbsp;;<br>
&nbsp;-0.97332682778991096374185351&nbsp;;&nbsp;-0.96100879965205371891861412&nbsp;;&nbsp;-0.94641137485840281606248149&nbsp;;&nbsp;-0.92956917213193957582149015&nbsp;;&nbsp;-0.91052213707850280575638067&nbsp;;<br>
&nbsp;-0.88931544599511410585340404&nbsp;;&nbsp;-0.86599939815409281976078339&nbsp;;&nbsp;-0.8406292962525803627516915&nbsp;;&nbsp;-0.8132653151227975597419233&nbsp;;&nbsp;-0.7839723589433414076102205&nbsp;;<br>
&nbsp;-0.7528199072605318966118638&nbsp;;&nbsp;-0.7198818501716108268489402&nbsp;;&nbsp;-0.6852363130542332425635584&nbsp;;&nbsp;-0.6489654712546573398577612&nbsp;;&nbsp;-0.6111553551723932502488530&nbsp;;<br>
&nbsp;-0.5718956462026340342838781&nbsp;;&nbsp;-0.5312794640198945456580139&nbsp;;&nbsp;-0.4894031457070529574785263&nbsp;;&nbsp;-0.4463660172534640879849477&nbsp;;&nbsp;-0.4022701579639916036957668&nbsp;;<br>
&nbsp;-0.3572201583376681159504426&nbsp;;&nbsp;-0.3113228719902109561575127&nbsp;;&nbsp;-0.2646871622087674163739642&nbsp;;&nbsp;-0.2174236437400070841496487&nbsp;;&nbsp;-0.1696444204239928180373136&nbsp;;<br>
&nbsp;-0.1214628192961205544703765&nbsp;;&nbsp;-0.0729931217877990394495429&nbsp;;&nbsp;-0.0243502926634244325089558&nbsp;;&nbsp;0.0243502926634244325089558&nbsp;;&nbsp;0.0729931217877990394495429&nbsp;;<br>
&nbsp;0.1214628192961205544703765&nbsp;;&nbsp;0.1696444204239928180373136&nbsp;;&nbsp;0.2174236437400070841496487&nbsp;;&nbsp;0.2646871622087674163739642&nbsp;;&nbsp;0.3113228719902109561575127&nbsp;;<br>
&nbsp;0.3572201583376681159504426&nbsp;;&nbsp;0.4022701579639916036957668&nbsp;;&nbsp;0.4463660172534640879849477&nbsp;;&nbsp;0.4894031457070529574785263&nbsp;;&nbsp;0.5312794640198945456580139&nbsp;;<br>
&nbsp;0.5718956462026340342838781&nbsp;;&nbsp;0.6111553551723932502488530&nbsp;;&nbsp;0.6489654712546573398577612&nbsp;;&nbsp;0.6852363130542332425635584&nbsp;;&nbsp;0.7198818501716108268489402&nbsp;;<br>
&nbsp;0.7528199072605318966118638&nbsp;;&nbsp;0.7839723589433414076102205&nbsp;;&nbsp;0.8132653151227975597419233&nbsp;;&nbsp;0.8406292962525803627516915&nbsp;;&nbsp;0.8659993981540928197607834&nbsp;;<br>
&nbsp;0.8893154459951141058534040&nbsp;;&nbsp;0.9105221370785028057563807&nbsp;;&nbsp;0.9295691721319395758214902&nbsp;;&nbsp;0.9464113748584028160624815&nbsp;;&nbsp;0.9610087996520537189186141&nbsp;;<br>
&nbsp;0.9733268277899109637418535&nbsp;;&nbsp;0.9833362538846259569312993&nbsp;;&nbsp;0.9910133714767443207393824&nbsp;;&nbsp;0.9963401167719552793469245&nbsp;;&nbsp;0.9993050417357721394569056&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_64_w&nbsp;=&nbsp;[|&nbsp;0.0017832807216964329472960791450&nbsp;;&nbsp;0.0041470332605624676352875357286&nbsp;;&nbsp;0.006504457968978362856117360400&nbsp;;&nbsp;0.008846759826363947723030914660&nbsp;;<br>
&nbsp;0.011168139460131128818590493019&nbsp;;&nbsp;0.013463047896718642598060766686&nbsp;;&nbsp;0.015726030476024719321965995298&nbsp;;&nbsp;0.017951715775697343085045302001&nbsp;;&nbsp;0.020134823153530209372340316729&nbsp;;<br>
&nbsp;0.022270173808383254159298330384&nbsp;;&nbsp;0.024352702568710873338177550409&nbsp;;&nbsp;0.026377469715054658671691792625&nbsp;;&nbsp;0.028339672614259483227511305200&nbsp;;&nbsp;0.030234657072402478867974059820&nbsp;;<br>
&nbsp;0.032057928354851553585467504348&nbsp;;&nbsp;0.033805161837141609391565482111&nbsp;;&nbsp;0.035472213256882383810693146715&nbsp;;&nbsp;0.037055128540240046040415101810&nbsp;;&nbsp;0.038550153178615629128962496947&nbsp;;<br>
&nbsp;0.039953741132720341386656926128&nbsp;;&nbsp;0.041262563242623528610156297474&nbsp;;&nbsp;0.042473515123653589007339767909&nbsp;;&nbsp;0.043583724529323453376827860974&nbsp;;&nbsp;0.044590558163756563060134710031&nbsp;;<br>
&nbsp;0.045491627927418144479770996971&nbsp;;&nbsp;0.046284796581314417295953249232&nbsp;;&nbsp;0.046968182816210017325326285755&nbsp;;&nbsp;0.047540165714830308662282206944&nbsp;;&nbsp;0.04799938859645830772812617987&nbsp;;<br>
&nbsp;0.04834476223480295716976952716&nbsp;;&nbsp;0.04857546744150342693479906678&nbsp;;&nbsp;0.04869095700913972038336539073&nbsp;;&nbsp;0.04869095700913972038336539073&nbsp;;&nbsp;0.04857546744150342693479906678&nbsp;;<br>
&nbsp;0.04834476223480295716976952716&nbsp;;&nbsp;0.04799938859645830772812617987&nbsp;;&nbsp;0.047540165714830308662282206944&nbsp;;&nbsp;0.046968182816210017325326285755&nbsp;;&nbsp;0.046284796581314417295953249232&nbsp;;<br>
&nbsp;0.045491627927418144479770996971&nbsp;;&nbsp;0.044590558163756563060134710031&nbsp;;&nbsp;0.043583724529323453376827860974&nbsp;;&nbsp;0.042473515123653589007339767909&nbsp;;&nbsp;0.041262563242623528610156297474&nbsp;;<br>
&nbsp;0.039953741132720341386656926128&nbsp;;&nbsp;0.038550153178615629128962496947&nbsp;;&nbsp;0.037055128540240046040415101810&nbsp;;&nbsp;0.035472213256882383810693146715&nbsp;;&nbsp;0.033805161837141609391565482111&nbsp;;<br>
&nbsp;0.032057928354851553585467504348&nbsp;;&nbsp;0.030234657072402478867974059820&nbsp;;&nbsp;0.028339672614259483227511305200&nbsp;;&nbsp;0.026377469715054658671691792625&nbsp;;&nbsp;0.024352702568710873338177550409&nbsp;;<br>
&nbsp;0.022270173808383254159298330384&nbsp;;&nbsp;0.020134823153530209372340316729&nbsp;;&nbsp;0.017951715775697343085045302001&nbsp;;&nbsp;0.015726030476024719321965995298&nbsp;;&nbsp;0.013463047896718642598060766686&nbsp;;<br>
&nbsp;0.011168139460131128818590493019&nbsp;;&nbsp;0.008846759826363947723030914660&nbsp;;&nbsp;0.006504457968978362856117360400&nbsp;;&nbsp;0.0041470332605624676352875357286&nbsp;;&nbsp;0.0017832807216964329472960791450&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_65_x&nbsp;=&nbsp;[|&nbsp;-0.99932609707541287726569361&nbsp;;&nbsp;-0.99645094806184916305579494&nbsp;;&nbsp;-0.99128527617680166872182118&nbsp;;&nbsp;-0.98383981218703494137763778&nbsp;;<br>
&nbsp;-0.97413153983355116907496789&nbsp;;&nbsp;-0.96218275471805523771198375&nbsp;;&nbsp;-0.94802092816840750637376974&nbsp;;&nbsp;-0.93167862822874933796567699&nbsp;;&nbsp;-0.91319344054284626173654692&nbsp;;<br>
&nbsp;-0.89260788050473893142328554&nbsp;;&nbsp;-0.8699692949264070361941320&nbsp;;&nbsp;-0.8453297528999302839424500&nbsp;;&nbsp;-0.8187459259226514534339191&nbsp;;&nbsp;-0.7902789574921218430473804&nbsp;;<br>
&nbsp;-0.7599943224419997868739828&nbsp;;&nbsp;-0.7279616763294246790119737&nbsp;;&nbsp;-0.6942546952139916335526225&nbsp;;&nbsp;-0.6589509061936251330409408&nbsp;;&nbsp;-0.6221315090854002415825996&nbsp;;<br>
&nbsp;-0.5838811896604873133271545&nbsp;;&nbsp;-0.5442879248622271385455725&nbsp;;&nbsp;-0.5034427804550068823410431&nbsp;;&nbsp;-0.4614397015691450576978341&nbsp;;&nbsp;-0.4183752966234090092641990&nbsp;;<br>
&nbsp;-0.3743486151220660120087939&nbsp;;&nbsp;-0.3294609198374864076452867&nbsp;;&nbsp;-0.2838154539022487306176554&nbsp;;&nbsp;-0.2375172033464168065707124&nbsp;;&nbsp;-0.1906726556261427697749124&nbsp;;<br>
&nbsp;-0.1433895546989751711312496&nbsp;;&nbsp;-0.0957766532091975056522186&nbsp;;&nbsp;-0.0479434623531718575225298&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0479434623531718575225298&nbsp;;&nbsp;0.0957766532091975056522186&nbsp;;<br>
&nbsp;0.1433895546989751711312496&nbsp;;&nbsp;0.1906726556261427697749124&nbsp;;&nbsp;0.2375172033464168065707124&nbsp;;&nbsp;0.2838154539022487306176554&nbsp;;&nbsp;0.3294609198374864076452867&nbsp;;<br>
&nbsp;0.3743486151220660120087939&nbsp;;&nbsp;0.4183752966234090092641990&nbsp;;&nbsp;0.4614397015691450576978341&nbsp;;&nbsp;0.5034427804550068823410431&nbsp;;&nbsp;0.5442879248622271385455725&nbsp;;<br>
&nbsp;0.5838811896604873133271545&nbsp;;&nbsp;0.6221315090854002415825996&nbsp;;&nbsp;0.6589509061936251330409408&nbsp;;&nbsp;0.6942546952139916335526225&nbsp;;&nbsp;0.7279616763294246790119737&nbsp;;<br>
&nbsp;0.7599943224419997868739828&nbsp;;&nbsp;0.7902789574921218430473804&nbsp;;&nbsp;0.8187459259226514534339191&nbsp;;&nbsp;0.8453297528999302839424500&nbsp;;&nbsp;0.8699692949264070361941320&nbsp;;<br>
&nbsp;0.8926078805047389314232855&nbsp;;&nbsp;0.9131934405428462617365469&nbsp;;&nbsp;0.9316786282287493379656770&nbsp;;&nbsp;0.9480209281684075063737697&nbsp;;&nbsp;0.9621827547180552377119837&nbsp;;<br>
&nbsp;0.9741315398335511690749679&nbsp;;&nbsp;0.9838398121870349413776378&nbsp;;&nbsp;0.9912852761768016687218212&nbsp;;&nbsp;0.9964509480618491630557949&nbsp;;&nbsp;0.9993260970754128772656936&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_65_w&nbsp;=&nbsp;[|&nbsp;0.0017292582513002508983395851463&nbsp;;&nbsp;0.0040215241720037363470786599528&nbsp;;&nbsp;0.0063079425789717545501888719039&nbsp;;&nbsp;0.0085801482668814598936358121592&nbsp;;<br>
&nbsp;0.0108326787895979686215140551272&nbsp;;&nbsp;0.013060311639994846336168342922&nbsp;;&nbsp;0.015257912146448310349265388145&nbsp;;&nbsp;0.017420421997670248495365759969&nbsp;;&nbsp;0.019542865836750062826837429313&nbsp;;<br>
&nbsp;0.021620361284934062841654274667&nbsp;;&nbsp;0.023648129691287236698780978994&nbsp;;&nbsp;0.025621506938037758214084978694&nbsp;;&nbsp;0.027535954088450343942499722327&nbsp;;&nbsp;0.029387067789310668062644859210&nbsp;;<br>
&nbsp;0.031170590380189142464431845777&nbsp;;&nbsp;0.032882419676368574984049638008&nbsp;;&nbsp;0.034518618398549058625221276859&nbsp;;&nbsp;0.036075423225565273932166270524&nbsp;;&nbsp;0.037549253448257709809772223198&nbsp;;<br>
&nbsp;0.038936719204051197616673806364&nbsp;;&nbsp;0.040234629273005533815446337743&nbsp;;&nbsp;0.041439998417240293022686299233&nbsp;;&nbsp;0.042550054246755802719217150803&nbsp;;&nbsp;0.043562243595800486532284821661&nbsp;;<br>
&nbsp;0.044474238395082974427323504000&nbsp;;&nbsp;0.045283941026300230657128240574&nbsp;;&nbsp;0.045989489146651696963893390818&nbsp;;&nbsp;0.046589259972233498302255136790&nbsp;;&nbsp;0.047081874010454522246006808290&nbsp;;<br>
&nbsp;0.047466198232885503152644458740&nbsp;;&nbsp;0.047741348681240621559038972227&nbsp;;&nbsp;0.047906692500495862031347289176&nbsp;;&nbsp;0.04796184939446661812070762137&nbsp;;&nbsp;0.047906692500495862031347289176&nbsp;;<br>
&nbsp;0.047741348681240621559038972227&nbsp;;&nbsp;0.047466198232885503152644458740&nbsp;;&nbsp;0.047081874010454522246006808290&nbsp;;&nbsp;0.046589259972233498302255136790&nbsp;;&nbsp;0.045989489146651696963893390818&nbsp;;<br>
&nbsp;0.045283941026300230657128240574&nbsp;;&nbsp;0.044474238395082974427323504000&nbsp;;&nbsp;0.043562243595800486532284821661&nbsp;;&nbsp;0.042550054246755802719217150803&nbsp;;&nbsp;0.041439998417240293022686299233&nbsp;;<br>
&nbsp;0.040234629273005533815446337743&nbsp;;&nbsp;0.038936719204051197616673806364&nbsp;;&nbsp;0.037549253448257709809772223198&nbsp;;&nbsp;0.036075423225565273932166270524&nbsp;;&nbsp;0.034518618398549058625221276859&nbsp;;<br>
&nbsp;0.032882419676368574984049638008&nbsp;;&nbsp;0.031170590380189142464431845777&nbsp;;&nbsp;0.029387067789310668062644859210&nbsp;;&nbsp;0.027535954088450343942499722327&nbsp;;&nbsp;0.025621506938037758214084978694&nbsp;;<br>
&nbsp;0.023648129691287236698780978994&nbsp;;&nbsp;0.021620361284934062841654274667&nbsp;;&nbsp;0.019542865836750062826837429313&nbsp;;&nbsp;0.017420421997670248495365759969&nbsp;;&nbsp;0.015257912146448310349265388145&nbsp;;<br>
&nbsp;0.013060311639994846336168342922&nbsp;;&nbsp;0.0108326787895979686215140551272&nbsp;;&nbsp;0.0085801482668814598936358121592&nbsp;;&nbsp;0.0063079425789717545501888719039&nbsp;;&nbsp;0.0040215241720037363470786599528&nbsp;;<br>
&nbsp;0.0017292582513002508983395851463&nbsp;|]&nbsp;;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_127_x&nbsp;=&nbsp;[|&nbsp;-0.9998221304153061462673512&nbsp;;&nbsp;-0.9990629343553118951383159&nbsp;;&nbsp;-0.9976975661898046210744170&nbsp;;&nbsp;-0.9957265513520272266354334&nbsp;;<br>
&nbsp;-0.9931510492545171473611308&nbsp;;&nbsp;-0.9899726145914841576077867&nbsp;;&nbsp;-0.9861931740169316667104383&nbsp;;&nbsp;-0.9818150208038141100334631&nbsp;;&nbsp;-0.9768408123430703268174439&nbsp;;<br>
&nbsp;-0.9712735681615291922889469&nbsp;;&nbsp;-0.9651166679452921210908251&nbsp;;&nbsp;-0.9583738494252387711491029&nbsp;;&nbsp;-0.9510492060778803105479076&nbsp;;&nbsp;-0.9431471846248148273454496&nbsp;;<br>
&nbsp;-0.9346725823247379685736349&nbsp;;&nbsp;-0.9256305440562338491274647&nbsp;;&nbsp;-0.9160265591914658093130886&nbsp;;&nbsp;-0.9058664582618213828024613&nbsp;;&nbsp;-0.8951564094170837089690438&nbsp;;<br>
&nbsp;-0.8839029146800265699452579&nbsp;;&nbsp;-0.8721128059985607114196375&nbsp;;&nbsp;-0.8597932410977408098120313&nbsp;;&nbsp;-0.8469516991340975984533393&nbsp;;&nbsp;-0.8335959761548995143795572&nbsp;;<br>
&nbsp;-0.8197341803650786741551191&nbsp;;&nbsp;-0.8053747272046802146665608&nbsp;;&nbsp;-0.7905263342398137999454500&nbsp;;&nbsp;-0.7751980158702023824449628&nbsp;;&nbsp;-0.7593990778565366715566637&nbsp;;<br>
&nbsp;-0.7431391116709545129205669&nbsp;;&nbsp;-0.7264279886740726855356929&nbsp;;&nbsp;-0.7092758541221045609994446&nbsp;;&nbsp;-0.6916931210077006701564414&nbsp;;&nbsp;-0.6736904637382504853466825&nbsp;;<br>
&nbsp;-0.6552788116554826302767651&nbsp;;&nbsp;-0.6364693424002972413476082&nbsp;;&nbsp;-0.6172734751268582838576392&nbsp;;&nbsp;-0.5977028635700652293844120&nbsp;;&nbsp;-0.5777693889706125800032517&nbsp;;<br>
&nbsp;-0.5574851528619322329218619&nbsp;;&nbsp;-0.5368624697233975674581664&nbsp;;&nbsp;-0.5159138595042493572772773&nbsp;;&nbsp;-0.4946520400227821173949402&nbsp;;&nbsp;-0.4730899192454052416450999&nbsp;;<br>
&nbsp;-0.4512405874502662273318986&nbsp;;&nbsp;-0.4291173092801933762625441&nbsp;;&nbsp;-0.4067335156897825634086729&nbsp;;&nbsp;-0.3841027957915169357790778&nbsp;;&nbsp;-0.3612388886058697060709248&nbsp;;<br>
&nbsp;-0.3381556747203985013760003&nbsp;;&nbsp;-0.3148671678628949814860148&nbsp;;&nbsp;-0.2913875063937056207945188&nbsp;;&nbsp;-0.2677309447223886208883435&nbsp;;&nbsp;-0.2439118446539178579707132&nbsp;;<br>
&nbsp;-0.2199446666696875424545234&nbsp;;&nbsp;-0.1958439611486108515042816&nbsp;;&nbsp;-0.1716243595336421650083449&nbsp;;&nbsp;-0.1473005654490856693893293&nbsp;;&nbsp;-0.1228873457740829717260337&nbsp;;<br>
&nbsp;-0.0983995216776989707510918&nbsp;;&nbsp;-0.0738519596210485452734404&nbsp;;&nbsp;-0.0492595623319266303153793&nbsp;;&nbsp;-0.0246372597574209446148971&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0246372597574209446148971&nbsp;;<br>
&nbsp;0.0492595623319266303153793&nbsp;;&nbsp;0.0738519596210485452734404&nbsp;;&nbsp;0.0983995216776989707510918&nbsp;;&nbsp;0.1228873457740829717260337&nbsp;;&nbsp;0.1473005654490856693893293&nbsp;;<br>
&nbsp;0.1716243595336421650083449&nbsp;;&nbsp;0.1958439611486108515042816&nbsp;;&nbsp;0.2199446666696875424545234&nbsp;;&nbsp;0.2439118446539178579707132&nbsp;;&nbsp;0.2677309447223886208883435&nbsp;;<br>
&nbsp;0.2913875063937056207945188&nbsp;;&nbsp;0.3148671678628949814860148&nbsp;;&nbsp;0.3381556747203985013760003&nbsp;;&nbsp;0.3612388886058697060709248&nbsp;;&nbsp;0.3841027957915169357790778&nbsp;;<br>
&nbsp;0.4067335156897825634086729&nbsp;;&nbsp;0.4291173092801933762625441&nbsp;;&nbsp;0.4512405874502662273318986&nbsp;;&nbsp;0.4730899192454052416450999&nbsp;;&nbsp;0.4946520400227821173949402&nbsp;;<br>
&nbsp;0.5159138595042493572772773&nbsp;;&nbsp;0.5368624697233975674581664&nbsp;;&nbsp;0.5574851528619322329218619&nbsp;;&nbsp;0.5777693889706125800032517&nbsp;;&nbsp;0.5977028635700652293844120&nbsp;;<br>
&nbsp;0.6172734751268582838576392&nbsp;;&nbsp;0.6364693424002972413476082&nbsp;;&nbsp;0.6552788116554826302767651&nbsp;;&nbsp;0.6736904637382504853466825&nbsp;;&nbsp;0.6916931210077006701564414&nbsp;;<br>
&nbsp;0.7092758541221045609994446&nbsp;;&nbsp;0.7264279886740726855356929&nbsp;;&nbsp;0.7431391116709545129205669&nbsp;;&nbsp;0.7593990778565366715566637&nbsp;;&nbsp;0.7751980158702023824449628&nbsp;;<br>
&nbsp;0.7905263342398137999454500&nbsp;;&nbsp;0.8053747272046802146665608&nbsp;;&nbsp;0.8197341803650786741551191&nbsp;;&nbsp;0.8335959761548995143795572&nbsp;;&nbsp;0.8469516991340975984533393&nbsp;;<br>
&nbsp;0.8597932410977408098120313&nbsp;;&nbsp;0.8721128059985607114196375&nbsp;;&nbsp;0.8839029146800265699452579&nbsp;;&nbsp;0.8951564094170837089690438&nbsp;;&nbsp;0.9058664582618213828024613&nbsp;;<br>
&nbsp;0.9160265591914658093130886&nbsp;;&nbsp;0.9256305440562338491274647&nbsp;;&nbsp;0.9346725823247379685736349&nbsp;;&nbsp;0.9431471846248148273454496&nbsp;;&nbsp;0.9510492060778803105479076&nbsp;;<br>
&nbsp;0.9583738494252387711491029&nbsp;;&nbsp;0.965116667945292121090825&nbsp;;&nbsp;0.971273568161529192288947&nbsp;;&nbsp;0.976840812343070326817444&nbsp;;&nbsp;0.981815020803814110033463&nbsp;;<br>
&nbsp;0.986193174016931666710438&nbsp;;&nbsp;0.989972614591484157607787&nbsp;;&nbsp;0.993151049254517147361131&nbsp;;&nbsp;0.995726551352027226635433&nbsp;;&nbsp;0.997697566189804621074417&nbsp;;<br>
&nbsp;0.999062934355311895138316&nbsp;;&nbsp;0.999822130415306146267351&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_127_w&nbsp;=&nbsp;[|&nbsp;0.00045645726109586662791936519265&nbsp;;&nbsp;0.00106227668695384869596523598532&nbsp;;&nbsp;0.0016683488125171936761028862915&nbsp;;&nbsp;0.0022734860707492547802810840776&nbsp;;<br>
&nbsp;0.0028772587656289004082883197514&nbsp;;&nbsp;0.0034792893810051465908910894100&nbsp;;&nbsp;0.0040792095178254605327114733457&nbsp;;&nbsp;0.0046766539777779034772638165663&nbsp;;&nbsp;0.0052712596565634400891303815906&nbsp;;<br>
&nbsp;0.0058626653903523901033648343751&nbsp;;&nbsp;0.0064505120486899171845442463869&nbsp;;&nbsp;0.0070344427036681608755685893033&nbsp;;&nbsp;0.0076141028256526859356393930849&nbsp;;&nbsp;0.0081891404887415730817235884719&nbsp;;<br>
&nbsp;0.0087592065795403145773316804234&nbsp;;&nbsp;0.0093239550065309714787536985834&nbsp;;&nbsp;0.0098830429087554914716648010900&nbsp;;&nbsp;0.0104361308631410052256731719977&nbsp;;&nbsp;0.0109828830900689757887996573761&nbsp;;<br>
&nbsp;0.011522967656921087154811609735&nbsp;;&nbsp;0.012056056679400848183529562145&nbsp;;&nbsp;0.012581826520465013101514365424&nbsp;;&nbsp;0.013099957986718627426172681913&nbsp;;&nbsp;0.013610136522139249906034237534&nbsp;;<br>
&nbsp;0.014112052399003395774044161634&nbsp;;&nbsp;0.014605400905893418351737288079&nbsp;;&nbsp;0.015089882532666922992635733981&nbsp;;&nbsp;0.015565203152273955098532590263&nbsp;;&nbsp;0.016031074199309941802254151843&nbsp;;<br>
&nbsp;0.016487212845194879399346060358&nbsp;;&nbsp;0.016933342169871654545878815295&nbsp;;&nbsp;0.017369191329918731922164721250&nbsp;;&nbsp;0.017794495722974774231027912900&nbsp;;&nbsp;0.018208997148375106468721469154&nbsp;;<br>
&nbsp;0.018612443963902310429440419899&nbsp;;&nbsp;0.019004591238555646611148901045&nbsp;;&nbsp;0.019385200901246454628112623489&nbsp;;&nbsp;0.019754041885329183081815217323&nbsp;;&nbsp;0.020110890268880247225644623956&nbsp;;<br>
&nbsp;0.020455529410639508279497065713&nbsp;;&nbsp;0.020787750081531811812652137291&nbsp;;&nbsp;0.021107350591688713643523847922&nbsp;;&nbsp;0.021414136912893259295449693234&nbsp;;&nbsp;0.021707922796373466052301324695&nbsp;;<br>
&nbsp;0.021988529885872983756478409759&nbsp;;&nbsp;0.022255787825930280235631416460&nbsp;;&nbsp;0.022509534365300608085694429903&nbsp;;&nbsp;0.022749615455457959852242553241&nbsp;;&nbsp;0.022975885344117206754377437839&nbsp;;<br>
&nbsp;0.023188206663719640249922582982&nbsp;;&nbsp;0.023386450514828194170722043497&nbsp;;&nbsp;0.023570496544381716050033676844&nbsp;;&nbsp;0.023740233018760777777714726703&nbsp;;&nbsp;0.023895556891620665983864481754&nbsp;;<br>
&nbsp;0.024036373866450369675132086026&nbsp;;&nbsp;0.024162598453819584716522917711&nbsp;;&nbsp;0.024274154023278979833195063937&nbsp;;&nbsp;0.024370972849882214952813561907&nbsp;;&nbsp;0.024452996155301467956140198472&nbsp;;<br>
&nbsp;0.024520174143511508275183033290&nbsp;;&nbsp;0.024572466031020653286354137335&nbsp;;&nbsp;0.024609840071630254092545634003&nbsp;;&nbsp;0.024632273575707679066033370218&nbsp;;&nbsp;0.02463975292396109441957941748&nbsp;;<br>
&nbsp;0.024632273575707679066033370218&nbsp;;&nbsp;0.024609840071630254092545634003&nbsp;;&nbsp;0.024572466031020653286354137335&nbsp;;&nbsp;0.024520174143511508275183033290&nbsp;;&nbsp;0.024452996155301467956140198472&nbsp;;<br>
&nbsp;0.024370972849882214952813561907&nbsp;;&nbsp;0.024274154023278979833195063937&nbsp;;&nbsp;0.024162598453819584716522917711&nbsp;;&nbsp;0.024036373866450369675132086026&nbsp;;&nbsp;0.023895556891620665983864481754&nbsp;;<br>
&nbsp;0.023740233018760777777714726703&nbsp;;&nbsp;0.023570496544381716050033676844&nbsp;;&nbsp;0.023386450514828194170722043497&nbsp;;&nbsp;0.023188206663719640249922582982&nbsp;;&nbsp;0.022975885344117206754377437839&nbsp;;<br>
&nbsp;0.022749615455457959852242553241&nbsp;;&nbsp;0.022509534365300608085694429903&nbsp;;&nbsp;0.022255787825930280235631416460&nbsp;;&nbsp;0.021988529885872983756478409759&nbsp;;&nbsp;0.021707922796373466052301324695&nbsp;;<br>
&nbsp;0.021414136912893259295449693234&nbsp;;&nbsp;0.021107350591688713643523847922&nbsp;;&nbsp;0.020787750081531811812652137291&nbsp;;&nbsp;0.020455529410639508279497065713&nbsp;;&nbsp;0.020110890268880247225644623956&nbsp;;<br>
&nbsp;0.019754041885329183081815217323&nbsp;;&nbsp;0.019385200901246454628112623489&nbsp;;&nbsp;0.019004591238555646611148901045&nbsp;;&nbsp;0.018612443963902310429440419899&nbsp;;&nbsp;0.018208997148375106468721469154&nbsp;;<br>
&nbsp;0.017794495722974774231027912900&nbsp;;&nbsp;0.017369191329918731922164721250&nbsp;;&nbsp;0.016933342169871654545878815295&nbsp;;&nbsp;0.016487212845194879399346060358&nbsp;;&nbsp;0.016031074199309941802254151843&nbsp;;<br>
&nbsp;0.015565203152273955098532590263&nbsp;;&nbsp;0.015089882532666922992635733981&nbsp;;&nbsp;0.014605400905893418351737288079&nbsp;;&nbsp;0.014112052399003395774044161634&nbsp;;&nbsp;0.013610136522139249906034237534&nbsp;;<br>
&nbsp;0.013099957986718627426172681913&nbsp;;&nbsp;0.012581826520465013101514365424&nbsp;;&nbsp;0.012056056679400848183529562145&nbsp;;&nbsp;0.011522967656921087154811609735&nbsp;;&nbsp;0.0109828830900689757887996573761&nbsp;;<br>
&nbsp;0.0104361308631410052256731719977&nbsp;;&nbsp;0.0098830429087554914716648010900&nbsp;;&nbsp;0.0093239550065309714787536985834&nbsp;;&nbsp;0.0087592065795403145773316804234&nbsp;;&nbsp;0.0081891404887415730817235884719&nbsp;;<br>
&nbsp;0.0076141028256526859356393930849&nbsp;;&nbsp;0.0070344427036681608755685893033&nbsp;;&nbsp;0.0064505120486899171845442463869&nbsp;;&nbsp;0.0058626653903523901033648343751&nbsp;;&nbsp;0.0052712596565634400891303815906&nbsp;;<br>
&nbsp;0.0046766539777779034772638165663&nbsp;;&nbsp;0.0040792095178254605327114733457&nbsp;;&nbsp;0.0034792893810051465908910894100&nbsp;;&nbsp;0.0028772587656289004082883197514&nbsp;;&nbsp;0.0022734860707492547802810840776&nbsp;;<br>
&nbsp;0.0016683488125171936761028862915&nbsp;;&nbsp;0.00106227668695384869596523598532&nbsp;;&nbsp;0.00045645726109586662791936519265&nbsp;|]&nbsp;;;<br>
&nbsp;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_128_x&nbsp;=&nbsp;[|&nbsp;-0.9998248879471319144736081&nbsp;;&nbsp;-0.9990774599773758950119878&nbsp;;&nbsp;-0.9977332486255140198821574&nbsp;;&nbsp;-0.9957927585349811868641612&nbsp;;<br>
&nbsp;-0.9932571129002129353034372&nbsp;;&nbsp;-0.9901278184917343833379303&nbsp;;&nbsp;-0.9864067427245862088712355&nbsp;;&nbsp;-0.9820961084357185360247656&nbsp;;&nbsp;-0.9771984914639073871653744&nbsp;;<br>
&nbsp;-0.9717168187471365809043384&nbsp;;&nbsp;-0.9656543664319652686458290&nbsp;;&nbsp;-0.9590147578536999280989185&nbsp;;&nbsp;-0.9518019613412643862177963&nbsp;;&nbsp;-0.9440202878302201821211114&nbsp;;<br>
&nbsp;-0.9356743882779163757831268&nbsp;;&nbsp;-0.9267692508789478433346245&nbsp;;&nbsp;-0.9173101980809605370364836&nbsp;;&nbsp;-0.9073028834017568139214859&nbsp;;&nbsp;-0.8967532880491581843864474&nbsp;;<br>
&nbsp;-0.8856677173453972174082924&nbsp;;&nbsp;-0.8740527969580317986954180&nbsp;;&nbsp;-0.8619154689395484605906323&nbsp;;&nbsp;-0.8492629875779689691636001&nbsp;;&nbsp;-0.8361029150609068471168753&nbsp;;<br>
&nbsp;-0.8224431169556438424645942&nbsp;;&nbsp;-0.8082917575079136601196422&nbsp;;&nbsp;-0.7936572947621932902433329&nbsp;;&nbsp;-0.7785484755064119668504941&nbsp;;&nbsp;-0.7629743300440947227797691&nbsp;;<br>
&nbsp;-0.7469441667970619811698824&nbsp;;&nbsp;-0.7304675667419088064717369&nbsp;;&nbsp;-0.7135543776835874133438599&nbsp;;&nbsp;-0.6962147083695143323850866&nbsp;;&nbsp;-0.6784589224477192593677557&nbsp;;<br>
&nbsp;-0.6602976322726460521059468&nbsp;;&nbsp;-0.6417416925623075571535249&nbsp;;&nbsp;-0.6228021939105849107615396&nbsp;;&nbsp;-0.6034904561585486242035732&nbsp;;&nbsp;-0.5838180216287630895500389&nbsp;;<br>
&nbsp;-0.5637966482266180839144308&nbsp;;&nbsp;-0.5434383024128103634441936&nbsp;;&nbsp;-0.5227551520511754784539479&nbsp;;&nbsp;-0.5017595591361444642896063&nbsp;;&nbsp;-0.4804640724041720258582757&nbsp;;<br>
&nbsp;-0.4588814198335521954490891&nbsp;;&nbsp;-0.4370245010371041629370429&nbsp;;&nbsp;-0.4149063795522750154922739&nbsp;;&nbsp;-0.3925402750332674427356482&nbsp;;&nbsp;-0.3699395553498590266165917&nbsp;;<br>
&nbsp;-0.3471177285976355084261628&nbsp;;&nbsp;-0.3240884350244133751832523&nbsp;;&nbsp;-0.3008654388776772026671541&nbsp;;&nbsp;-0.2774626201779044028062316&nbsp;;&nbsp;-0.2538939664226943208556180&nbsp;;<br>
&nbsp;-0.2301735642266599864109866&nbsp;;&nbsp;-0.2063155909020792171540580&nbsp;;&nbsp;-0.1823343059853371824103826&nbsp;;&nbsp;-0.1582440427142249339974755&nbsp;;&nbsp;-0.1340591994611877851175753&nbsp;;<br>
&nbsp;-0.1097942311276437466729747&nbsp;;&nbsp;-0.0854636405045154986364980&nbsp;;&nbsp;-0.0610819696041395681037870&nbsp;;&nbsp;-0.0366637909687334933302153&nbsp;;&nbsp;-0.0122236989606157641980521&nbsp;;<br>
&nbsp;0.0122236989606157641980521&nbsp;;&nbsp;0.0366637909687334933302153&nbsp;;&nbsp;0.0610819696041395681037870&nbsp;;&nbsp;0.0854636405045154986364980&nbsp;;&nbsp;0.1097942311276437466729747&nbsp;;<br>
&nbsp;0.1340591994611877851175753&nbsp;;&nbsp;0.1582440427142249339974755&nbsp;;&nbsp;0.1823343059853371824103826&nbsp;;&nbsp;0.2063155909020792171540580&nbsp;;&nbsp;0.2301735642266599864109866&nbsp;;<br>
&nbsp;0.2538939664226943208556180&nbsp;;&nbsp;0.2774626201779044028062316&nbsp;;&nbsp;0.3008654388776772026671541&nbsp;;&nbsp;0.3240884350244133751832523&nbsp;;&nbsp;0.3471177285976355084261628&nbsp;;<br>
&nbsp;0.3699395553498590266165917&nbsp;;&nbsp;0.3925402750332674427356482&nbsp;;&nbsp;0.4149063795522750154922739&nbsp;;&nbsp;0.4370245010371041629370429&nbsp;;&nbsp;0.4588814198335521954490891&nbsp;;<br>
&nbsp;0.4804640724041720258582757&nbsp;;&nbsp;0.5017595591361444642896063&nbsp;;&nbsp;0.5227551520511754784539479&nbsp;;&nbsp;0.5434383024128103634441936&nbsp;;&nbsp;0.5637966482266180839144308&nbsp;;<br>
&nbsp;0.5838180216287630895500389&nbsp;;&nbsp;0.6034904561585486242035732&nbsp;;&nbsp;0.6228021939105849107615396&nbsp;;&nbsp;0.6417416925623075571535249&nbsp;;&nbsp;0.6602976322726460521059468&nbsp;;<br>
&nbsp;0.6784589224477192593677557&nbsp;;&nbsp;0.6962147083695143323850866&nbsp;;&nbsp;0.7135543776835874133438599&nbsp;;&nbsp;0.7304675667419088064717369&nbsp;;&nbsp;0.7469441667970619811698824&nbsp;;<br>
&nbsp;0.7629743300440947227797691&nbsp;;&nbsp;0.7785484755064119668504941&nbsp;;&nbsp;0.7936572947621932902433329&nbsp;;&nbsp;0.8082917575079136601196422&nbsp;;&nbsp;0.8224431169556438424645942&nbsp;;<br>
&nbsp;0.8361029150609068471168753&nbsp;;&nbsp;0.8492629875779689691636001&nbsp;;&nbsp;0.8619154689395484605906323&nbsp;;&nbsp;0.8740527969580317986954180&nbsp;;&nbsp;0.8856677173453972174082924&nbsp;;<br>
&nbsp;0.8967532880491581843864474&nbsp;;&nbsp;0.9073028834017568139214859&nbsp;;&nbsp;0.9173101980809605370364836&nbsp;;&nbsp;0.926769250878947843334625&nbsp;;&nbsp;0.935674388277916375783127&nbsp;;<br>
&nbsp;0.944020287830220182121111&nbsp;;&nbsp;0.951801961341264386217796&nbsp;;&nbsp;0.959014757853699928098919&nbsp;;&nbsp;0.965654366431965268645829&nbsp;;&nbsp;0.971716818747136580904338&nbsp;;<br>
&nbsp;0.977198491463907387165374&nbsp;;&nbsp;0.982096108435718536024766&nbsp;;&nbsp;0.986406742724586208871236&nbsp;;&nbsp;0.990127818491734383337930&nbsp;;&nbsp;0.993257112900212935303437&nbsp;;<br>
&nbsp;0.995792758534981186864161&nbsp;;&nbsp;0.997733248625514019882157&nbsp;;&nbsp;0.999077459977375895011988&nbsp;;&nbsp;0.999824887947131914473608&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_128_w&nbsp;=&nbsp;[|&nbsp;0.00044938096029209037639429223999&nbsp;;&nbsp;0.0010458126793403487793128516001&nbsp;;&nbsp;0.0016425030186690295387908755948&nbsp;;&nbsp;0.0022382884309626187436220542727&nbsp;;<br>
&nbsp;0.0028327514714579910952857346468&nbsp;;&nbsp;0.0034255260409102157743377846601&nbsp;;&nbsp;0.0040162549837386423131943434863&nbsp;;&nbsp;0.0046045842567029551182905419803&nbsp;;&nbsp;0.0051901618326763302050707671348&nbsp;;<br>
&nbsp;0.0057726375428656985893346176261&nbsp;;&nbsp;0.006351663161707188787214327826&nbsp;;&nbsp;0.006926892566898813563426670360&nbsp;;&nbsp;0.007497981925634728687671962688&nbsp;;&nbsp;0.008064589890486057972928598698&nbsp;;<br>
&nbsp;0.008626377798616749704978843782&nbsp;;&nbsp;0.009183009871660874334478743688&nbsp;;&nbsp;0.009734153415006805863548266094&nbsp;;&nbsp;0.010279479015832157133215340326&nbsp;;&nbsp;0.010818660739503076247659646277&nbsp;;<br>
&nbsp;0.011351376324080416693281668453&nbsp;;&nbsp;0.011877307372740279575891106926&nbsp;;&nbsp;0.012396139543950922968821728197&nbsp;;&nbsp;0.012907562739267347220442834004&nbsp;;&nbsp;0.013411271288616332314488951616&nbsp;;<br>
&nbsp;0.013906964132951985244288007396&nbsp;;&nbsp;0.014394345004166846176823892009&nbsp;;&nbsp;0.014873122602147314252385498520&nbsp;;&nbsp;0.015343010768865144085990853741&nbsp;;&nbsp;0.015803728659399346858965631687&nbsp;;<br>
&nbsp;0.016255000909785187051657456477&nbsp;;&nbsp;0.016696557801589204589091507954&nbsp;;&nbsp;0.017128135423111376830680987619&nbsp;;&nbsp;0.017549475827117704648706925634&nbsp;;&nbsp;0.017960327185008685940196927525&nbsp;;<br>
&nbsp;0.018360443937331343221289290991&nbsp;;&nbsp;0.018749586940544708650919548474&nbsp;;&nbsp;0.019127523609950945486518531668&nbsp;;&nbsp;0.019494028058706602823021918681&nbsp;;&nbsp;0.019848881232830862219944413265&nbsp;;<br>
&nbsp;0.020191871042130041180673158406&nbsp;;&nbsp;0.020522792486960069432284967788&nbsp;;&nbsp;0.020841447780751149113583948423&nbsp;;&nbsp;0.021147646468221348537019535180&nbsp;;&nbsp;0.021441205539208460137111853878&nbsp;;<br>
&nbsp;0.021721949538052075375260957768&nbsp;;&nbsp;0.021989710668460491434122106599&nbsp;;&nbsp;0.022244328893799765104629133607&nbsp;;&nbsp;0.022485652032744966871824603941&nbsp;;&nbsp;0.022713535850236461309712635923&nbsp;;<br>
&nbsp;0.022927844143686846920410987209&nbsp;;&nbsp;0.023128448824387027879297902403&nbsp;;&nbsp;0.023315229994062760122415671273&nbsp;;&nbsp;0.023488076016535913153025273282&nbsp;;&nbsp;0.023646883584447615143651392303&nbsp;;<br>
&nbsp;0.023791557781003400638780709885&nbsp;;&nbsp;0.023922012136703455672450408817&nbsp;;&nbsp;0.024038168681024052637587316820&nbsp;;&nbsp;0.024139957989019284997716653890&nbsp;;&nbsp;0.024227319222815248120093308442&nbsp;;<br>
&nbsp;0.024300200167971865323442606364&nbsp;;&nbsp;0.024358557264690625853268520246&nbsp;;&nbsp;0.024402355633849582093297989694&nbsp;;&nbsp;0.02443156909785004505484856143&nbsp;;&nbsp;0.02444618019626251821132585261&nbsp;;<br>
&nbsp;0.02444618019626251821132585261&nbsp;;&nbsp;0.02443156909785004505484856143&nbsp;;&nbsp;0.024402355633849582093297989694&nbsp;;&nbsp;0.024358557264690625853268520246&nbsp;;&nbsp;0.024300200167971865323442606364&nbsp;;<br>
&nbsp;0.024227319222815248120093308442&nbsp;;&nbsp;0.024139957989019284997716653890&nbsp;;&nbsp;0.024038168681024052637587316820&nbsp;;&nbsp;0.023922012136703455672450408817&nbsp;;&nbsp;0.023791557781003400638780709885&nbsp;;<br>
&nbsp;0.023646883584447615143651392303&nbsp;;&nbsp;0.023488076016535913153025273282&nbsp;;&nbsp;0.023315229994062760122415671273&nbsp;;&nbsp;0.023128448824387027879297902403&nbsp;;&nbsp;0.022927844143686846920410987209&nbsp;;<br>
&nbsp;0.022713535850236461309712635923&nbsp;;&nbsp;0.022485652032744966871824603941&nbsp;;&nbsp;0.022244328893799765104629133607&nbsp;;&nbsp;0.021989710668460491434122106599&nbsp;;&nbsp;0.021721949538052075375260957768&nbsp;;<br>
&nbsp;0.021441205539208460137111853878&nbsp;;&nbsp;0.021147646468221348537019535180&nbsp;;&nbsp;0.020841447780751149113583948423&nbsp;;&nbsp;0.020522792486960069432284967788&nbsp;;&nbsp;0.020191871042130041180673158406&nbsp;;<br>
&nbsp;0.019848881232830862219944413265&nbsp;;&nbsp;0.019494028058706602823021918681&nbsp;;&nbsp;0.019127523609950945486518531668&nbsp;;&nbsp;0.018749586940544708650919548474&nbsp;;&nbsp;0.018360443937331343221289290991&nbsp;;<br>
&nbsp;0.017960327185008685940196927525&nbsp;;&nbsp;0.017549475827117704648706925634&nbsp;;&nbsp;0.017128135423111376830680987619&nbsp;;&nbsp;0.016696557801589204589091507954&nbsp;;&nbsp;0.016255000909785187051657456477&nbsp;;<br>
&nbsp;0.015803728659399346858965631687&nbsp;;&nbsp;0.015343010768865144085990853741&nbsp;;&nbsp;0.014873122602147314252385498520&nbsp;;&nbsp;0.014394345004166846176823892009&nbsp;;&nbsp;0.013906964132951985244288007396&nbsp;;<br>
&nbsp;0.013411271288616332314488951616&nbsp;;&nbsp;0.012907562739267347220442834004&nbsp;;&nbsp;0.012396139543950922968821728197&nbsp;;&nbsp;0.011877307372740279575891106926&nbsp;;&nbsp;0.011351376324080416693281668453&nbsp;;<br>
&nbsp;0.010818660739503076247659646277&nbsp;;&nbsp;0.010279479015832157133215340326&nbsp;;&nbsp;0.009734153415006805863548266094&nbsp;;&nbsp;0.009183009871660874334478743688&nbsp;;&nbsp;0.008626377798616749704978843782&nbsp;;<br>
&nbsp;0.008064589890486057972928598698&nbsp;;&nbsp;0.007497981925634728687671962688&nbsp;;&nbsp;0.006926892566898813563426670360&nbsp;;&nbsp;0.006351663161707188787214327826&nbsp;;&nbsp;0.0057726375428656985893346176261&nbsp;;<br>
&nbsp;0.0051901618326763302050707671348&nbsp;;&nbsp;0.0046045842567029551182905419803&nbsp;;&nbsp;0.0040162549837386423131943434863&nbsp;;&nbsp;0.0034255260409102157743377846601&nbsp;;&nbsp;0.0028327514714579910952857346468&nbsp;;<br>
&nbsp;0.0022382884309626187436220542727&nbsp;;&nbsp;0.0016425030186690295387908755948&nbsp;;&nbsp;0.0010458126793403487793128516001&nbsp;;&nbsp;0.00044938096029209037639429223999&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_129_x&nbsp;=&nbsp;[|&nbsp;-0.9998275818477487191077441&nbsp;;&nbsp;-0.9990916504696409986514389&nbsp;;&nbsp;-0.9977681080525852721429460&nbsp;;&nbsp;-0.9958574393142831982149111&nbsp;;<br>
&nbsp;-0.9933607326210712814854011&nbsp;;&nbsp;-0.9902794486488178389207689&nbsp;;&nbsp;-0.9866153978313475022005761&nbsp;;&nbsp;-0.9823707352517413115507418&nbsp;;&nbsp;-0.9775479582993672474447814&nbsp;;<br>
&nbsp;-0.9721499048427034297274163&nbsp;;&nbsp;-0.9661797514202097197778763&nbsp;;&nbsp;-0.9596410113101918904168119&nbsp;;&nbsp;-0.9525375324342090471027732&nbsp;;&nbsp;-0.9448734950776734726784764&nbsp;;<br>
&nbsp;-0.9366534094216514605284616&nbsp;;&nbsp;-0.9278821128840036204317296&nbsp;;&nbsp;-0.9185647672698286252225115&nbsp;;&nbsp;-0.9087068557320696331245539&nbsp;;&nbsp;-0.8983141795436338850435985&nbsp;;<br>
&nbsp;-0.8873928546826803665034968&nbsp;;&nbsp;-0.8759493082329433892035217&nbsp;;&nbsp;-0.8639902746011257878940216&nbsp;;&nbsp;-0.8515227915535356930243826&nbsp;;&nbsp;-0.8385541960742664442975407&nbsp;;<br>
&nbsp;-0.8250921200473358809210133&nbsp;;&nbsp;-0.8111444857653120742087717&nbsp;;&nbsp;-0.7967195012670592680339606&nbsp;;&nbsp;-0.7818256555073413245387500&nbsp;;&nbsp;-0.7664717133611208816717785&nbsp;;<br>
&nbsp;-0.7506667104654910227632368&nbsp;;&nbsp;-0.7344199479022727047791516&nbsp;;&nbsp;-0.7177409867244055767721220&nbsp;;&nbsp;-0.7006396423293521790044710&nbsp;;&nbsp;-0.6831259786828258512462248&nbsp;;<br>
&nbsp;-0.6652103023962409818802202&nbsp;;&nbsp;-0.6469031566613704719753373&nbsp;;&nbsp;-0.6282153150457794374886895&nbsp;;&nbsp;-0.6091577751526861909563306&nbsp;;&nbsp;-0.5897417521489813916767844&nbsp;;<br>
&nbsp;-0.5699786721652138894754096&nbsp;;&nbsp;-0.5498801655714271702189358&nbsp;;&nbsp;-0.5294580601328034000099406&nbsp;;&nbsp;-0.5087243740491428186199463&nbsp;;&nbsp;-0.4876913088822746111853066&nbsp;;<br>
&nbsp;-0.4663712423755613514331869&nbsp;;&nbsp;-0.4447767211697226217818454&nbsp;;&nbsp;-0.4229204534192644388475065&nbsp;;&nbsp;-0.4008153013138596117693121&nbsp;;&nbsp;-0.3784742735090801012801265&nbsp;;<br>
&nbsp;-0.3559105174709357969672656&nbsp;;&nbsp;-0.3331373117387248575049982&nbsp;;&nbsp;-0.3101680581107488341147318&nbsp;;&nbsp;-0.2870162737574911929568755&nbsp;;&nbsp;-0.2636955832669005409666949&nbsp;;<br>
&nbsp;-0.2402197106264598167721148&nbsp;;&nbsp;-0.2166024711467599103221439&nbsp;;&nbsp;-0.1928577633313305998663880&nbsp;;&nbsp;-0.1689995606975133227390302&nbsp;;&nbsp;-0.1450419035531891084328306&nbsp;;<br>
&nbsp;-0.1209988907342009817690539&nbsp;;&nbsp;-0.0968846713073332753086909&nbsp;;&nbsp;-0.0727134362437305599118207&nbsp;;&nbsp;-0.0484994100676562986191764&nbsp;;&nbsp;-0.0242568424855058415749954&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;0.0242568424855058415749954&nbsp;;&nbsp;0.0484994100676562986191764&nbsp;;&nbsp;0.0727134362437305599118207&nbsp;;&nbsp;0.0968846713073332753086909&nbsp;;&nbsp;0.1209988907342009817690539&nbsp;;<br>
&nbsp;0.1450419035531891084328306&nbsp;;&nbsp;0.1689995606975133227390302&nbsp;;&nbsp;0.1928577633313305998663880&nbsp;;&nbsp;0.2166024711467599103221439&nbsp;;&nbsp;0.2402197106264598167721148&nbsp;;<br>
&nbsp;0.2636955832669005409666949&nbsp;;&nbsp;0.2870162737574911929568755&nbsp;;&nbsp;0.3101680581107488341147318&nbsp;;&nbsp;0.3331373117387248575049982&nbsp;;&nbsp;0.3559105174709357969672656&nbsp;;<br>
&nbsp;0.3784742735090801012801265&nbsp;;&nbsp;0.4008153013138596117693121&nbsp;;&nbsp;0.4229204534192644388475065&nbsp;;&nbsp;0.4447767211697226217818454&nbsp;;&nbsp;0.4663712423755613514331869&nbsp;;<br>
&nbsp;0.4876913088822746111853066&nbsp;;&nbsp;0.5087243740491428186199463&nbsp;;&nbsp;0.5294580601328034000099406&nbsp;;&nbsp;0.5498801655714271702189358&nbsp;;&nbsp;0.5699786721652138894754096&nbsp;;<br>
&nbsp;0.5897417521489813916767844&nbsp;;&nbsp;0.6091577751526861909563306&nbsp;;&nbsp;0.6282153150457794374886895&nbsp;;&nbsp;0.6469031566613704719753373&nbsp;;&nbsp;0.6652103023962409818802202&nbsp;;<br>
&nbsp;0.6831259786828258512462248&nbsp;;&nbsp;0.7006396423293521790044710&nbsp;;&nbsp;0.7177409867244055767721220&nbsp;;&nbsp;0.7344199479022727047791516&nbsp;;&nbsp;0.7506667104654910227632368&nbsp;;<br>
&nbsp;0.7664717133611208816717785&nbsp;;&nbsp;0.7818256555073413245387500&nbsp;;&nbsp;0.7967195012670592680339606&nbsp;;&nbsp;0.8111444857653120742087717&nbsp;;&nbsp;0.8250921200473358809210133&nbsp;;<br>
&nbsp;0.8385541960742664442975407&nbsp;;&nbsp;0.8515227915535356930243826&nbsp;;&nbsp;0.8639902746011257878940216&nbsp;;&nbsp;0.875949308232943389203522&nbsp;;&nbsp;0.887392854682680366503497&nbsp;;<br>
&nbsp;0.898314179543633885043599&nbsp;;&nbsp;0.908706855732069633124554&nbsp;;&nbsp;0.918564767269828625222511&nbsp;;&nbsp;0.927882112884003620431730&nbsp;;&nbsp;0.936653409421651460528462&nbsp;;<br>
&nbsp;0.944873495077673472678476&nbsp;;&nbsp;0.952537532434209047102773&nbsp;;&nbsp;0.959641011310191890416812&nbsp;;&nbsp;0.966179751420209719777876&nbsp;;&nbsp;0.972149904842703429727416&nbsp;;<br>
&nbsp;0.977547958299367247444781&nbsp;;&nbsp;0.982370735251741311550742&nbsp;;&nbsp;0.986615397831347502200576&nbsp;;&nbsp;0.990279448648817838920769&nbsp;;&nbsp;0.993360732621071281485401&nbsp;;<br>
&nbsp;0.995857439314283198214911&nbsp;;&nbsp;0.997768108052585272142946&nbsp;;&nbsp;0.999091650469640998651439&nbsp;;&nbsp;0.999827581847748719107744&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_129_w&nbsp;=&nbsp;[|&nbsp;0.00044246794182939296923668005717&nbsp;;&nbsp;0.00102972844619622394463273519315&nbsp;;&nbsp;0.0016172530556785534682413679271&nbsp;;&nbsp;0.0022039015180966937075786419741&nbsp;;<br>
&nbsp;0.0027892681877797554940944677057&nbsp;;&nbsp;0.0033729979506246246117755709288&nbsp;;&nbsp;0.0039547444682113562172392974765&nbsp;;&nbsp;0.0045341644298525434513226874954&nbsp;;&nbsp;0.0051109164669246267289761565766&nbsp;;<br>
&nbsp;0.0056846609912469045788016012203&nbsp;;&nbsp;0.0062550602724461408889348709586&nbsp;;&nbsp;0.0068217785893519121070498527769&nbsp;;&nbsp;0.0073844824072454014447165055698&nbsp;;&nbsp;0.0079428405646668029041114107832&nbsp;;<br>
&nbsp;0.0084965244635723279730542832506&nbsp;;&nbsp;0.0090452082602137316404219313819&nbsp;;&nbsp;0.0095885690555104190787301294510&nbsp;;&nbsp;0.0101262870842733548093160774580&nbsp;;&nbsp;0.0106580459029055185304204093001&nbsp;;<br>
&nbsp;0.0111835325753305049735380697538&nbsp;;&nbsp;0.011702437856964778185746436834&nbsp;;&nbsp;0.012214456376582979416221105914&nbsp;;&nbsp;0.012719286815944623465099036330&nbsp;;&nbsp;0.013216632087061724231482387345&nbsp;;<br>
&nbsp;0.013706199506993971244060563234&nbsp;;&nbsp;0.014187700970062900419317230938&nbsp;;&nbsp;0.014660853117380060971041027493&nbsp;;&nbsp;0.015125377503587024690403432771&nbsp;;&nbsp;0.015581000760707523415881287558&nbsp;;<br>
&nbsp;0.016027454759014214436403950465&nbsp;;&nbsp;0.016464476764814667467169189640&nbsp;;&nbsp;0.016891809595063204177526208819&nbsp;;&nbsp;0.017309201768707240731293596444&nbsp;;&nbsp;0.017716407654678809269702031810&nbsp;;<br>
&nbsp;0.018113187616443980503999783812&nbsp;;&nbsp;0.018499308153024985727791918518&nbsp;;&nbsp;0.018874542036411948181617592169&nbsp;;&nbsp;0.019238668445283284085199492202&nbsp;;&nbsp;0.019591473094956024580283987216&nbsp;;<br>
&nbsp;0.019932748363489542089706675388&nbsp;;&nbsp;0.020262293413868438317104423081&nbsp;;&nbsp;0.020579914312192665948185517085&nbsp;;&nbsp;0.020885424141805311409990024684&nbsp;;&nbsp;0.021178643113290860912881038703&nbsp;;<br>
&nbsp;0.021459398670279205389981598196&nbsp;;&nbsp;0.021727525590993110687305178710&nbsp;;&nbsp;0.021982866085479386179554968899&nbsp;;&nbsp;0.022225269888466526554736910919&nbsp;;&nbsp;0.022454594347794176432066564511&nbsp;;<br>
&nbsp;0.022670704508362374313093970958&nbsp;;&nbsp;0.022873473191551169638592083492&nbsp;;&nbsp;0.023062781070063872924670495006&nbsp;;&nbsp;0.023238516738149892544490435771&nbsp;;&nbsp;0.023400576777165831146714346635&nbsp;;<br>
&nbsp;0.023548865816436258377269094263&nbsp;;&nbsp;0.023683296589378342897341543485&nbsp;;&nbsp;0.023803789984857314051325299744&nbsp;;&nbsp;0.023910275093742530302367230296&nbsp;;&nbsp;0.024002689250636756075547029720&nbsp;;<br>
&nbsp;0.024080978070754089272959634041&nbsp;;&nbsp;0.024145095481924836783843156014&nbsp;;&nbsp;0.024195003751708503129818111597&nbsp;;&nbsp;0.024230673509598936275508460625&nbsp;;&nbsp;0.024252083764308562906498864071&nbsp;;<br>
&nbsp;0.02425922191612154143202867472&nbsp;;&nbsp;0.024252083764308562906498864071&nbsp;;&nbsp;0.024230673509598936275508460625&nbsp;;&nbsp;0.024195003751708503129818111597&nbsp;;&nbsp;0.024145095481924836783843156014&nbsp;;<br>
&nbsp;0.024080978070754089272959634041&nbsp;;&nbsp;0.024002689250636756075547029720&nbsp;;&nbsp;0.023910275093742530302367230296&nbsp;;&nbsp;0.023803789984857314051325299744&nbsp;;&nbsp;0.023683296589378342897341543485&nbsp;;<br>
&nbsp;0.023548865816436258377269094263&nbsp;;&nbsp;0.023400576777165831146714346635&nbsp;;&nbsp;0.023238516738149892544490435771&nbsp;;&nbsp;0.023062781070063872924670495006&nbsp;;&nbsp;0.022873473191551169638592083492&nbsp;;<br>
&nbsp;0.022670704508362374313093970958&nbsp;;&nbsp;0.022454594347794176432066564511&nbsp;;&nbsp;0.022225269888466526554736910919&nbsp;;&nbsp;0.021982866085479386179554968899&nbsp;;&nbsp;0.021727525590993110687305178710&nbsp;;<br>
&nbsp;0.021459398670279205389981598196&nbsp;;&nbsp;0.021178643113290860912881038703&nbsp;;&nbsp;0.020885424141805311409990024684&nbsp;;&nbsp;0.020579914312192665948185517085&nbsp;;&nbsp;0.020262293413868438317104423081&nbsp;;<br>
&nbsp;0.019932748363489542089706675388&nbsp;;&nbsp;0.019591473094956024580283987216&nbsp;;&nbsp;0.019238668445283284085199492202&nbsp;;&nbsp;0.018874542036411948181617592169&nbsp;;&nbsp;0.018499308153024985727791918518&nbsp;;<br>
&nbsp;0.018113187616443980503999783812&nbsp;;&nbsp;0.017716407654678809269702031810&nbsp;;&nbsp;0.017309201768707240731293596444&nbsp;;&nbsp;0.016891809595063204177526208819&nbsp;;&nbsp;0.016464476764814667467169189640&nbsp;;<br>
&nbsp;0.016027454759014214436403950465&nbsp;;&nbsp;0.015581000760707523415881287558&nbsp;;&nbsp;0.015125377503587024690403432771&nbsp;;&nbsp;0.014660853117380060971041027493&nbsp;;&nbsp;0.014187700970062900419317230938&nbsp;;<br>
&nbsp;0.013706199506993971244060563234&nbsp;;&nbsp;0.013216632087061724231482387345&nbsp;;&nbsp;0.012719286815944623465099036330&nbsp;;&nbsp;0.012214456376582979416221105914&nbsp;;&nbsp;0.011702437856964778185746436834&nbsp;;<br>
&nbsp;0.0111835325753305049735380697538&nbsp;;&nbsp;0.0106580459029055185304204093001&nbsp;;&nbsp;0.0101262870842733548093160774580&nbsp;;&nbsp;0.0095885690555104190787301294510&nbsp;;&nbsp;0.0090452082602137316404219313819&nbsp;;<br>
&nbsp;0.0084965244635723279730542832506&nbsp;;&nbsp;0.0079428405646668029041114107832&nbsp;;&nbsp;0.0073844824072454014447165055698&nbsp;;&nbsp;0.0068217785893519121070498527769&nbsp;;&nbsp;0.0062550602724461408889348709586&nbsp;;<br>
&nbsp;0.0056846609912469045788016012203&nbsp;;&nbsp;0.0051109164669246267289761565766&nbsp;;&nbsp;0.0045341644298525434513226874954&nbsp;;&nbsp;0.0039547444682113562172392974765&nbsp;;&nbsp;0.0033729979506246246117755709288&nbsp;;<br>
&nbsp;0.0027892681877797554940944677057&nbsp;;&nbsp;0.0022039015180966937075786419741&nbsp;;&nbsp;0.0016172530556785534682413679271&nbsp;;&nbsp;0.00102972844619622394463273519315&nbsp;;&nbsp;0.00044246794182939296923668005717&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_255_x&nbsp;=&nbsp;[|&nbsp;-0.999955705317563751730191&nbsp;;&nbsp;-0.999766621312000569367063&nbsp;;&nbsp;-0.999426474680169959344386&nbsp;;&nbsp;-0.998935241284654635142155&nbsp;;<br>
&nbsp;-0.998292986136967889228248&nbsp;;&nbsp;-0.997499804126615814044844&nbsp;;&nbsp;-0.996555814435198617028738&nbsp;;&nbsp;-0.995461159480026294089975&nbsp;;&nbsp;-0.994216004616630164799381&nbsp;;<br>
&nbsp;-0.992820538021989138984811&nbsp;;&nbsp;-0.991274970630385567164523&nbsp;;&nbsp;-0.989579536085920123498574&nbsp;;&nbsp;-0.987734490699732356281248&nbsp;;&nbsp;-0.985740113407419277752900&nbsp;;<br>
&nbsp;-0.983596705724776358640192&nbsp;;&nbsp;-0.981304591701017185126565&nbsp;;&nbsp;-0.978864117869068155239121&nbsp;;&nbsp;-0.976275653192735980815246&nbsp;;&nbsp;-0.973539589010643617645393&nbsp;;<br>
&nbsp;-0.970656338976880365477697&nbsp;;&nbsp;-0.967626338998338798105523&nbsp;;&nbsp;-0.964450047168726298761719&nbsp;;&nbsp;-0.961127943699247839572910&nbsp;;&nbsp;-0.957660530845962076295490&nbsp;;<br>
&nbsp;-0.954048332833816317950921&nbsp;;&nbsp;-0.950291895777368285733522&nbsp;;&nbsp;-0.946391787598204251752103&nbsp;;&nbsp;-0.942348597939064408301480&nbsp;;&nbsp;-0.938162938074687317626793&nbsp;;<br>
&nbsp;-0.933835440819386124349338&nbsp;;&nbsp;-0.929366760431369935739045&nbsp;;&nbsp;-0.924757572513824425220425&nbsp;;&nbsp;-0.920008573912766315142721&nbsp;;&nbsp;-0.915120482611686961035103&nbsp;;<br>
&nbsp;-0.910094037623000801254172&nbsp;;&nbsp;-0.904929998876314959753358&nbsp;;&nbsp;-0.899629147103536800144342&nbsp;;&nbsp;-0.894192283720836729335637&nbsp;;&nbsp;-0.888620230707484040924981&nbsp;;<br>
&nbsp;-0.882913830481574073645470&nbsp;;&nbsp;-0.877073945772665439532627&nbsp;;&nbsp;-0.871101459491346550796200&nbsp;;&nbsp;-0.864997274595751144137121&nbsp;;&nbsp;-0.858762313955042966785823&nbsp;;<br>
&nbsp;-0.852397520209890250084237&nbsp;;&nbsp;-0.845903855629951054143931&nbsp;;&nbsp;-0.839282301968391021084600&nbsp;;&nbsp;-0.832533860313455524647230&nbsp;;&nbsp;-0.825659550937118650611534&nbsp;;<br>
&nbsp;-0.818660413140831885432406&nbsp;;&nbsp;-0.811537505098395829833580&nbsp;;&nbsp;-0.804291903695978689734633&nbsp;;&nbsp;-0.796924704369305728807154&nbsp;;&nbsp;-0.789437020938044295117764&nbsp;;<br>
&nbsp;-0.781829985437409458675147&nbsp;;&nbsp;-0.774104747947015717207115&nbsp;;&nbsp;-0.766262476417000644100858&nbsp;;&nbsp;-0.758304356491446765092016&nbsp;;&nbsp;-0.750231591329128358931528&nbsp;;<br>
&nbsp;-0.742045401421610281838045&nbsp;;&nbsp;-0.733747024408726316001889&nbsp;;&nbsp;-0.725337714891464938687812&nbsp;;&nbsp;-0.716818744242290800531501&nbsp;;&nbsp;-0.708191400412930589382399&nbsp;;<br>
&nbsp;-0.699456987739652339456557&nbsp;;&nbsp;-0.690616826746067624571761&nbsp;;&nbsp;-0.681672253943486448787259&nbsp;;&nbsp;-0.672624621628855017806731&nbsp;;&nbsp;-0.663475297680306939970658&nbsp;;<br>
&nbsp;-0.654225665350358766508700&nbsp;;&nbsp;-0.644877123056781136890077&nbsp;;&nbsp;-0.635431084171177146547142&nbsp;;&nbsp;-0.625888976805299900901619&nbsp;;&nbsp;-0.616252243595141561442344&nbsp;;<br>
&nbsp;-0.606522341482826526536576&nbsp;;&nbsp;-0.596700741496341721653202&nbsp;;&nbsp;-0.586788928527137300685706&nbsp;;&nbsp;-0.576788401105631382036211&nbsp;;&nbsp;-0.566700671174652760010815&nbsp;;<br>
&nbsp;-0.556527263860855843833077&nbsp;;&nbsp;-0.546269717244142383159817&nbsp;;&nbsp;-0.535929582125124840335150&nbsp;;&nbsp;-0.525508421790666565699453&nbsp;;&nbsp;-0.515007811777534223035005&nbsp;;<br>
&nbsp;-0.504429339634198197635551&nbsp;;&nbsp;-0.493774604680816999489812&nbsp;;&nbsp;-0.483045217767441948626854&nbsp;;&nbsp;-0.472242801030478698742627&nbsp;;&nbsp;-0.461368987647442418771401&nbsp;;<br>
&nbsp;-0.450425421590043710043279&nbsp;;&nbsp;-0.439413757375642589040685&nbsp;;&nbsp;-0.428335659817108112494341&nbsp;;&nbsp;-0.417192803771121462605751&nbsp;;&nbsp;-0.405986873884960545511889&nbsp;;<br>
&nbsp;-0.394719564341804385683361&nbsp;;&nbsp;-0.383392578604595822734854&nbsp;;&nbsp;-0.372007629158501235092510&nbsp;;&nbsp;-0.360566437252006227074021&nbsp;;&nbsp;-0.349070732636686422161576&nbsp;;<br>
&nbsp;-0.337522253305692705554261&nbsp;;&nbsp;-0.325922745230990453444769&nbsp;;&nbsp;-0.314273962099392474845918&nbsp;;&nbsp;-0.302577665047425574167140&nbsp;;&nbsp;-0.290835622395070819082047&nbsp;;<br>
&nbsp;-0.279049609378417768508970&nbsp;;&nbsp;-0.267221407881273079721012&nbsp;;&nbsp;-0.255352806165764071686080&nbsp;;&nbsp;-0.243445598601977973686482&nbsp;;&nbsp;-0.231501585396677734059116&nbsp;;<br>
&nbsp;-0.219522572321135403508985&nbsp;;&nbsp;-0.207510370438124240859625&nbsp;;&nbsp;-0.195466795828110816293869&nbsp;;&nbsp;-0.183393669314688508087976&nbsp;;&nbsp;-0.171292816189293903533225&nbsp;;<br>
&nbsp;-0.159166065935247723154292&nbsp;;&nbsp;-0.147015251951161989456661&nbsp;;&nbsp;-0.134842211273755257250625&nbsp;;&nbsp;-0.122648784300117812092492&nbsp;;&nbsp;-0.110436814509468826540991&nbsp;;<br>
&nbsp;-0.098208148184447540736015&nbsp;;&nbsp;-0.085964634131980604256000&nbsp;;&nbsp;-0.073708123403767780288977&nbsp;;&nbsp;-0.061440469016428270850728&nbsp;;&nbsp;-0.049163525671349973093019&nbsp;;<br>
&nbsp;-0.036879149474284021657652&nbsp;;&nbsp;-0.024589197654727010541405&nbsp;;&nbsp;-0.012295528285133320036860&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.012295528285133320036860&nbsp;;&nbsp;0.024589197654727010541405&nbsp;;<br>
&nbsp;0.036879149474284021657652&nbsp;;&nbsp;0.049163525671349973093019&nbsp;;&nbsp;0.061440469016428270850728&nbsp;;&nbsp;0.073708123403767780288977&nbsp;;&nbsp;0.085964634131980604256000&nbsp;;<br>
&nbsp;0.098208148184447540736015&nbsp;;&nbsp;0.110436814509468826540991&nbsp;;&nbsp;0.122648784300117812092492&nbsp;;&nbsp;0.134842211273755257250625&nbsp;;&nbsp;0.147015251951161989456661&nbsp;;<br>
&nbsp;0.159166065935247723154292&nbsp;;&nbsp;0.171292816189293903533225&nbsp;;&nbsp;0.183393669314688508087976&nbsp;;&nbsp;0.195466795828110816293869&nbsp;;&nbsp;0.207510370438124240859625&nbsp;;<br>
&nbsp;0.219522572321135403508985&nbsp;;&nbsp;0.231501585396677734059116&nbsp;;&nbsp;0.243445598601977973686482&nbsp;;&nbsp;0.255352806165764071686080&nbsp;;&nbsp;0.267221407881273079721012&nbsp;;<br>
&nbsp;0.279049609378417768508970&nbsp;;&nbsp;0.290835622395070819082047&nbsp;;&nbsp;0.302577665047425574167140&nbsp;;&nbsp;0.314273962099392474845918&nbsp;;&nbsp;0.325922745230990453444769&nbsp;;<br>
&nbsp;0.337522253305692705554261&nbsp;;&nbsp;0.349070732636686422161576&nbsp;;&nbsp;0.360566437252006227074021&nbsp;;&nbsp;0.372007629158501235092510&nbsp;;&nbsp;0.383392578604595822734854&nbsp;;<br>
&nbsp;0.394719564341804385683361&nbsp;;&nbsp;0.405986873884960545511889&nbsp;;&nbsp;0.417192803771121462605751&nbsp;;&nbsp;0.428335659817108112494341&nbsp;;&nbsp;0.439413757375642589040685&nbsp;;<br>
&nbsp;0.450425421590043710043279&nbsp;;&nbsp;0.461368987647442418771401&nbsp;;&nbsp;0.472242801030478698742627&nbsp;;&nbsp;0.483045217767441948626854&nbsp;;&nbsp;0.493774604680816999489812&nbsp;;<br>
&nbsp;0.504429339634198197635551&nbsp;;&nbsp;0.515007811777534223035005&nbsp;;&nbsp;0.525508421790666565699453&nbsp;;&nbsp;0.535929582125124840335150&nbsp;;&nbsp;0.546269717244142383159817&nbsp;;<br>
&nbsp;0.556527263860855843833077&nbsp;;&nbsp;0.566700671174652760010815&nbsp;;&nbsp;0.576788401105631382036211&nbsp;;&nbsp;0.586788928527137300685706&nbsp;;&nbsp;0.596700741496341721653202&nbsp;;<br>
&nbsp;0.606522341482826526536576&nbsp;;&nbsp;0.616252243595141561442344&nbsp;;&nbsp;0.625888976805299900901619&nbsp;;&nbsp;0.635431084171177146547142&nbsp;;&nbsp;0.644877123056781136890077&nbsp;;<br>
&nbsp;0.654225665350358766508700&nbsp;;&nbsp;0.663475297680306939970658&nbsp;;&nbsp;0.672624621628855017806731&nbsp;;&nbsp;0.681672253943486448787259&nbsp;;&nbsp;0.690616826746067624571761&nbsp;;<br>
&nbsp;0.699456987739652339456557&nbsp;;&nbsp;0.708191400412930589382399&nbsp;;&nbsp;0.716818744242290800531501&nbsp;;&nbsp;0.725337714891464938687812&nbsp;;&nbsp;0.733747024408726316001889&nbsp;;<br>
&nbsp;0.742045401421610281838045&nbsp;;&nbsp;0.750231591329128358931528&nbsp;;&nbsp;0.758304356491446765092016&nbsp;;&nbsp;0.766262476417000644100858&nbsp;;&nbsp;0.774104747947015717207115&nbsp;;<br>
&nbsp;0.781829985437409458675147&nbsp;;&nbsp;0.789437020938044295117764&nbsp;;&nbsp;0.796924704369305728807154&nbsp;;&nbsp;0.804291903695978689734633&nbsp;;&nbsp;0.811537505098395829833580&nbsp;;<br>
&nbsp;0.818660413140831885432406&nbsp;;&nbsp;0.825659550937118650611534&nbsp;;&nbsp;0.832533860313455524647230&nbsp;;&nbsp;0.839282301968391021084600&nbsp;;&nbsp;0.845903855629951054143931&nbsp;;<br>
&nbsp;0.852397520209890250084237&nbsp;;&nbsp;0.858762313955042966785823&nbsp;;&nbsp;0.864997274595751144137121&nbsp;;&nbsp;0.871101459491346550796200&nbsp;;&nbsp;0.877073945772665439532627&nbsp;;<br>
&nbsp;0.882913830481574073645470&nbsp;;&nbsp;0.888620230707484040924981&nbsp;;&nbsp;0.894192283720836729335637&nbsp;;&nbsp;0.899629147103536800144342&nbsp;;&nbsp;0.904929998876314959753358&nbsp;;<br>
&nbsp;0.910094037623000801254172&nbsp;;&nbsp;0.915120482611686961035103&nbsp;;&nbsp;0.920008573912766315142721&nbsp;;&nbsp;0.924757572513824425220425&nbsp;;&nbsp;0.929366760431369935739045&nbsp;;<br>
&nbsp;0.933835440819386124349338&nbsp;;&nbsp;0.938162938074687317626793&nbsp;;&nbsp;0.942348597939064408301480&nbsp;;&nbsp;0.946391787598204251752103&nbsp;;&nbsp;0.950291895777368285733522&nbsp;;<br>
&nbsp;0.954048332833816317950921&nbsp;;&nbsp;0.957660530845962076295490&nbsp;;&nbsp;0.961127943699247839572910&nbsp;;&nbsp;0.964450047168726298761719&nbsp;;&nbsp;0.967626338998338798105523&nbsp;;<br>
&nbsp;0.970656338976880365477697&nbsp;;&nbsp;0.973539589010643617645393&nbsp;;&nbsp;0.976275653192735980815246&nbsp;;&nbsp;0.978864117869068155239121&nbsp;;&nbsp;0.981304591701017185126565&nbsp;;<br>
&nbsp;0.983596705724776358640192&nbsp;;&nbsp;0.985740113407419277752900&nbsp;;&nbsp;0.987734490699732356281248&nbsp;;&nbsp;0.989579536085920123498574&nbsp;;&nbsp;0.991274970630385567164523&nbsp;;<br>
&nbsp;0.992820538021989138984811&nbsp;;&nbsp;0.994216004616630164799381&nbsp;;&nbsp;0.995461159480026294089975&nbsp;;&nbsp;0.996555814435198617028738&nbsp;;&nbsp;0.997499804126615814044844&nbsp;;<br>
&nbsp;0.998292986136967889228248&nbsp;;&nbsp;0.998935241284654635142155&nbsp;;&nbsp;0.999426474680169959344386&nbsp;;&nbsp;0.999766621312000569367063&nbsp;;&nbsp;0.999955705317563751730191&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_255_w&nbsp;=&nbsp;[|&nbsp;0.00011367361999142272115645954414&nbsp;;&nbsp;0.00026459387119083065532790838855&nbsp;;&nbsp;0.00041569762526823913616284210066&nbsp;;&nbsp;0.00056675794564824918946626058353&nbsp;;<br>
&nbsp;0.00071773647800611087798371518325&nbsp;;&nbsp;0.00086860766611945667949717690640&nbsp;;&nbsp;0.00101934797642732530281229369360&nbsp;;&nbsp;0.0011699343729388079886897709773&nbsp;;&nbsp;0.0013203439900221692090523602144&nbsp;;<br>
&nbsp;0.0014705540427783843160097204304&nbsp;;&nbsp;0.0016205417990415653896921100325&nbsp;;&nbsp;0.0017702845706603213070421243905&nbsp;;&nbsp;0.0019197597117132050055085980675&nbsp;;&nbsp;0.0020689446195015801533643667413&nbsp;;<br>
&nbsp;0.0022178167367540171700373764020&nbsp;;&nbsp;0.0023663535543962867157201855305&nbsp;;&nbsp;0.0025145326145997073931298921370&nbsp;;&nbsp;0.0026623315139717112732749157331&nbsp;;&nbsp;0.0028097279068204407457332299361&nbsp;;<br>
&nbsp;0.0029566995084575002760043344138&nbsp;;&nbsp;0.0031032240985191112621977893133&nbsp;;&nbsp;0.0032492795242943133198690930777&nbsp;;&nbsp;0.0033948437040533928255056951665&nbsp;;&nbsp;0.0035398946303722552150296713510&nbsp;;<br>
&nbsp;0.0036844103734499176530742235517&nbsp;;&nbsp;0.0038283690844171626400743524999&nbsp;;&nbsp;0.0039717489986349171988699773906&nbsp;;&nbsp;0.0041145284389812475901826468094&nbsp;;&nbsp;0.0042566858191260658425395494472&nbsp;;<br>
&nbsp;0.0043981996467927779838546384780&nbsp;;&nbsp;0.0045390485270061921259394035112&nbsp;;&nbsp;0.0046792111653260640506279893190&nbsp;;&nbsp;0.0048186663710656988918572043815&nbsp;;&nbsp;0.0049573930604950563104281084148&nbsp;;<br>
&nbsp;0.0050953702600278273039420404117&nbsp;;&nbsp;0.0052325771093919661294970523234&nbsp;;&nbsp;0.0053689928647831724787741258653&nbsp;;&nbsp;0.0055045969020008281904902120813&nbsp;;&nbsp;0.0056393687195659001929970994675&nbsp;;<br>
&nbsp;0.0057732879418203275712033691864&nbsp;;&nbsp;0.0059063343220074160130475409466&nbsp;;&nbsp;0.0060384877453327676663371666884&nbsp;;&nbsp;0.0061697282320052788060812561217&nbsp;;&nbsp;0.0063000359402577418025981070425&nbsp;;<br>
&nbsp;0.0064293911693465917826140832500&nbsp;;&nbsp;0.0065577743625303421548456356354&nbsp;;&nbsp;0.0066851661100262568757892743568&nbsp;;&nbsp;0.0068115471519448109954345674817&nbsp;;&nbsp;0.0069368983812014946719507501243&nbsp;;<br>
&nbsp;0.0070612008464055194979848418291&nbsp;;&nbsp;0.0071844357547249896530757997058&nbsp;;&nbsp;0.0073065844747281040972736443146&nbsp;;&nbsp;0.0074276285391999597581348419714&nbsp;;&nbsp;0.0075475496479345294426435656724&nbsp;;<br>
&nbsp;0.0076663296705013920315933272426&nbsp;;&nbsp;0.0077839506489867963897419914623&nbsp;;&nbsp;0.0079003948007086443529587296692&nbsp;;&nbsp;0.0080156445209049821352946484008&nbsp;;&nbsp;0.0081296823853955935356080649925&nbsp;;<br>
&nbsp;0.0082424911532162924158504385939&nbsp;;&nbsp;0.0083540537692255160718568405530&nbsp;;&nbsp;0.0084643533666828253227353760036&nbsp;;&nbsp;0.0085733732697989214067758505840&nbsp;;&nbsp;0.0086810969962567940901133439612&nbsp;;<br>
&nbsp;0.0087875082597036197689825483144&nbsp;;&nbsp;0.0088925909722130327769834298578&nbsp;;&nbsp;0.0089963292467173975949700110383&nbsp;;&nbsp;0.0090987073994097142025303711406&nbsp;;&nbsp;0.0091997099521147934060534414075&nbsp;;<br>
&nbsp;0.0092993216346293436285393234867&nbsp;;&nbsp;0.0093975273870306153500305317074&nbsp;;&nbsp;0.0094943123619532541442165010292&nbsp;;&nbsp;0.0095896619268340180657610209655&nbsp;;&nbsp;0.0096835616661240200035669970076&nbsp;;<br>
&nbsp;0.0097759973834681605268499842249&nbsp;;&nbsp;0.0098669551038514217128483481814&nbsp;;&nbsp;0.0099564210757116974565448593910&nbsp;;&nbsp;0.0100443817730188408231888789497&nbsp;;&nbsp;0.0101308238973196141129538950955&nbsp;;<br>
&nbsp;0.0102157343797482324629939488415&nbsp;;&nbsp;0.0102991003830021970147153502911&nbsp;;&nbsp;0.0103809093032831189224876935085&nbsp;;&nbsp;0.0104611487722022407735015844669&nbsp;;&nbsp;0.0105398066586503673262517188088&nbsp;;<br>
&nbsp;0.0106168710706319228563864391054&nbsp;;&nbsp;0.0106923303570628578226139809571&nbsp;;&nbsp;0.0107661731095321330311788312990&nbsp;;&nbsp;0.0108383881640265149842990798832&nbsp;;&nbsp;0.0109089646026184216450603134401&nbsp;;<br>
&nbsp;0.0109778917551165634377595759712&nbsp;;&nbsp;0.0110451592006791299277436662993&nbsp;;&nbsp;0.0111107567693892782875426356195&nbsp;;&nbsp;0.0111746745437926853557086684962&nbsp;;&nbsp;0.0112369028603969308303734810332&nbsp;;<br>
&nbsp;0.0112974323111324849102690558722&nbsp;;&nbsp;0.0113562537447750795009464486204&nbsp;;&nbsp;0.011413358268329247942299599697&nbsp;;&nbsp;0.011468737248372824084374355981&nbsp;;&nbsp;0.011522382312362197440930930031&nbsp;;<br>
&nbsp;0.011574285349898127083439539046&nbsp;;&nbsp;0.011624438513951922901227922331&nbsp;;&nbsp;0.011672834222051808845465154244&nbsp;;&nbsp;0.011719465157429288794653489478&nbsp;;&nbsp;0.011764324270125341726399410909&nbsp;;<br>
&nbsp;0.011807404778056278953532930501&nbsp;;&nbsp;0.011848700168039102281222824051&nbsp;;&nbsp;0.011888204196776208064673282076&nbsp;;&nbsp;0.011925910891799288293359117699&nbsp;;&nbsp;0.011961814552372285996633285380&nbsp;;<br>
&nbsp;0.011995909750353268455989686823&nbsp;;&nbsp;0.012028191331015087920350431142&nbsp;;&nbsp;0.012058654413824705751531083631&nbsp;;&nbsp;0.012087294393181062176578184854&nbsp;;&nbsp;0.012114106939111380091025793650&nbsp;;<br>
&nbsp;0.012139087997925797641334635250&nbsp;;&nbsp;0.012162233792830230614908682534&nbsp;;&nbsp;0.012183540824497371981177306326&nbsp;;&nbsp;0.012203005871595742256331865516&nbsp;;&nbsp;0.012220625991276710706457005806&nbsp;;<br>
&nbsp;0.012236398519619413758040249691&nbsp;;&nbsp;0.012250321072033503350218104906&nbsp;;&nbsp;0.012262391543619664338660618398&nbsp;;&nbsp;0.012272608109487846445745237751&nbsp;;&nbsp;0.012280969225033162644659793962&nbsp;;<br>
&nbsp;0.012287473626169412265336919908&nbsp;;&nbsp;0.012292120329520193516690694701&nbsp;;&nbsp;0.012294908632567576531532225710&nbsp;;&nbsp;0.01229583811375831445681490730&nbsp;;&nbsp;0.012294908632567576531532225710&nbsp;;<br>
&nbsp;0.012292120329520193516690694701&nbsp;;&nbsp;0.012287473626169412265336919908&nbsp;;&nbsp;0.012280969225033162644659793962&nbsp;;&nbsp;0.012272608109487846445745237751&nbsp;;&nbsp;0.012262391543619664338660618398&nbsp;;<br>
&nbsp;0.012250321072033503350218104906&nbsp;;&nbsp;0.012236398519619413758040249691&nbsp;;&nbsp;0.012220625991276710706457005806&nbsp;;&nbsp;0.012203005871595742256331865516&nbsp;;&nbsp;0.012183540824497371981177306326&nbsp;;<br>
&nbsp;0.012162233792830230614908682534&nbsp;;&nbsp;0.012139087997925797641334635250&nbsp;;&nbsp;0.012114106939111380091025793650&nbsp;;&nbsp;0.012087294393181062176578184854&nbsp;;&nbsp;0.012058654413824705751531083631&nbsp;;<br>
&nbsp;0.012028191331015087920350431142&nbsp;;&nbsp;0.011995909750353268455989686823&nbsp;;&nbsp;0.011961814552372285996633285380&nbsp;;&nbsp;0.011925910891799288293359117699&nbsp;;&nbsp;0.011888204196776208064673282076&nbsp;;<br>
&nbsp;0.011848700168039102281222824051&nbsp;;&nbsp;0.011807404778056278953532930501&nbsp;;&nbsp;0.011764324270125341726399410909&nbsp;;&nbsp;0.011719465157429288794653489478&nbsp;;&nbsp;0.011672834222051808845465154244&nbsp;;<br>
&nbsp;0.011624438513951922901227922331&nbsp;;&nbsp;0.011574285349898127083439539046&nbsp;;&nbsp;0.011522382312362197440930930031&nbsp;;&nbsp;0.011468737248372824084374355981&nbsp;;&nbsp;0.011413358268329247942299599697&nbsp;;<br>
&nbsp;0.0113562537447750795009464486204&nbsp;;&nbsp;0.0112974323111324849102690558722&nbsp;;&nbsp;0.0112369028603969308303734810332&nbsp;;&nbsp;0.0111746745437926853557086684962&nbsp;;&nbsp;0.0111107567693892782875426356195&nbsp;;<br>
&nbsp;0.0110451592006791299277436662993&nbsp;;&nbsp;0.0109778917551165634377595759712&nbsp;;&nbsp;0.0109089646026184216450603134401&nbsp;;&nbsp;0.0108383881640265149842990798832&nbsp;;&nbsp;0.0107661731095321330311788312990&nbsp;;<br>
&nbsp;0.0106923303570628578226139809571&nbsp;;&nbsp;0.0106168710706319228563864391054&nbsp;;&nbsp;0.0105398066586503673262517188088&nbsp;;&nbsp;0.0104611487722022407735015844669&nbsp;;&nbsp;0.0103809093032831189224876935085&nbsp;;<br>
&nbsp;0.0102991003830021970147153502911&nbsp;;&nbsp;0.0102157343797482324629939488415&nbsp;;&nbsp;0.0101308238973196141129538950955&nbsp;;&nbsp;0.0100443817730188408231888789497&nbsp;;&nbsp;0.0099564210757116974565448593910&nbsp;;<br>
&nbsp;0.0098669551038514217128483481814&nbsp;;&nbsp;0.0097759973834681605268499842249&nbsp;;&nbsp;0.0096835616661240200035669970076&nbsp;;&nbsp;0.0095896619268340180657610209655&nbsp;;&nbsp;0.0094943123619532541442165010292&nbsp;;<br>
&nbsp;0.0093975273870306153500305317074&nbsp;;&nbsp;0.0092993216346293436285393234867&nbsp;;&nbsp;0.0091997099521147934060534414075&nbsp;;&nbsp;0.0090987073994097142025303711406&nbsp;;&nbsp;0.0089963292467173975949700110383&nbsp;;<br>
&nbsp;0.0088925909722130327769834298578&nbsp;;&nbsp;0.0087875082597036197689825483144&nbsp;;&nbsp;0.0086810969962567940901133439612&nbsp;;&nbsp;0.0085733732697989214067758505840&nbsp;;&nbsp;0.0084643533666828253227353760036&nbsp;;<br>
&nbsp;0.0083540537692255160718568405530&nbsp;;&nbsp;0.0082424911532162924158504385939&nbsp;;&nbsp;0.0081296823853955935356080649925&nbsp;;&nbsp;0.0080156445209049821352946484008&nbsp;;&nbsp;0.0079003948007086443529587296692&nbsp;;<br>
&nbsp;0.0077839506489867963897419914623&nbsp;;&nbsp;0.0076663296705013920315933272426&nbsp;;&nbsp;0.0075475496479345294426435656724&nbsp;;&nbsp;0.0074276285391999597581348419714&nbsp;;&nbsp;0.0073065844747281040972736443146&nbsp;;<br>
&nbsp;0.0071844357547249896530757997058&nbsp;;&nbsp;0.0070612008464055194979848418291&nbsp;;&nbsp;0.0069368983812014946719507501243&nbsp;;&nbsp;0.0068115471519448109954345674817&nbsp;;&nbsp;0.0066851661100262568757892743568&nbsp;;<br>
&nbsp;0.0065577743625303421548456356354&nbsp;;&nbsp;0.0064293911693465917826140832500&nbsp;;&nbsp;0.0063000359402577418025981070425&nbsp;;&nbsp;0.0061697282320052788060812561217&nbsp;;&nbsp;0.0060384877453327676663371666884&nbsp;;<br>
&nbsp;0.0059063343220074160130475409466&nbsp;;&nbsp;0.0057732879418203275712033691864&nbsp;;&nbsp;0.0056393687195659001929970994675&nbsp;;&nbsp;0.0055045969020008281904902120813&nbsp;;&nbsp;0.0053689928647831724787741258653&nbsp;;<br>
&nbsp;0.0052325771093919661294970523234&nbsp;;&nbsp;0.0050953702600278273039420404117&nbsp;;&nbsp;0.0049573930604950563104281084148&nbsp;;&nbsp;0.0048186663710656988918572043815&nbsp;;&nbsp;0.0046792111653260640506279893190&nbsp;;<br>
&nbsp;0.0045390485270061921259394035112&nbsp;;&nbsp;0.0043981996467927779838546384780&nbsp;;&nbsp;0.0042566858191260658425395494472&nbsp;;&nbsp;0.0041145284389812475901826468094&nbsp;;&nbsp;0.0039717489986349171988699773906&nbsp;;<br>
&nbsp;0.0038283690844171626400743524999&nbsp;;&nbsp;0.0036844103734499176530742235517&nbsp;;&nbsp;0.0035398946303722552150296713510&nbsp;;&nbsp;0.0033948437040533928255056951665&nbsp;;&nbsp;0.0032492795242943133198690930777&nbsp;;<br>
&nbsp;0.0031032240985191112621977893133&nbsp;;&nbsp;0.0029566995084575002760043344138&nbsp;;&nbsp;0.0028097279068204407457332299361&nbsp;;&nbsp;0.0026623315139717112732749157331&nbsp;;&nbsp;0.0025145326145997073931298921370&nbsp;;<br>
&nbsp;0.0023663535543962867157201855305&nbsp;;&nbsp;0.0022178167367540171700373764020&nbsp;;&nbsp;0.0020689446195015801533643667413&nbsp;;&nbsp;0.0019197597117132050055085980675&nbsp;;&nbsp;0.0017702845706603213070421243905&nbsp;;<br>
&nbsp;0.0016205417990415653896921100325&nbsp;;&nbsp;0.0014705540427783843160097204304&nbsp;;&nbsp;0.0013203439900221692090523602144&nbsp;;&nbsp;0.0011699343729388079886897709773&nbsp;;&nbsp;0.00101934797642732530281229369360&nbsp;;<br>
&nbsp;0.00086860766611945667949717690640&nbsp;;&nbsp;0.00071773647800611087798371518325&nbsp;;&nbsp;0.00056675794564824918946626058353&nbsp;;&nbsp;0.00041569762526823913616284210066&nbsp;;&nbsp;0.00026459387119083065532790838855&nbsp;;<br>
&nbsp;0.00011367361999142272115645954414&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_256_x&nbsp;=&nbsp;[|&nbsp;-0.999956050018992230734801&nbsp;;&nbsp;-0.999768437409263186104879&nbsp;;&nbsp;-0.999430937466261408240854&nbsp;;&nbsp;-0.998943525843408856555026&nbsp;;<br>
&nbsp;-0.998306266473006444055500&nbsp;;&nbsp;-0.997519252756720827563409&nbsp;;&nbsp;-0.996582602023381540430504&nbsp;;&nbsp;-0.995496454481096356592647&nbsp;;&nbsp;-0.994260972922409664962878&nbsp;;<br>
&nbsp;-0.992876342608822117143534&nbsp;;&nbsp;-0.991342771207583086922189&nbsp;;&nbsp;-0.989660488745065218319244&nbsp;;&nbsp;-0.987829747564860608916488&nbsp;;&nbsp;-0.985850822286125956479245&nbsp;;<br>
&nbsp;-0.983724009760315496166686&nbsp;;&nbsp;-0.981449629025464405769303&nbsp;;&nbsp;-0.979028021257622038824238&nbsp;;&nbsp;-0.976459549719234155621011&nbsp;;&nbsp;-0.973744599704370405266079&nbsp;;<br>
&nbsp;-0.970883578480743029320923&nbsp;;&nbsp;-0.967876915228489454909004&nbsp;;&nbsp;-0.964725060975706430932612&nbsp;;&nbsp;-0.961428488530732144006407&nbsp;;&nbsp;-0.957987692411178129365790&nbsp;;<br>
&nbsp;-0.954403188769716241764448&nbsp;;&nbsp;-0.950675515316628276363852&nbsp;;&nbsp;-0.946805231239127481372052&nbsp;;&nbsp;-0.942792917117462443183076&nbsp;;&nbsp;-0.938639174837814804981926&nbsp;;<br>
&nbsp;-0.934344627502003094292477&nbsp;;&nbsp;-0.929909919334005641180246&nbsp;;&nbsp;-0.925335715583316202872730&nbsp;;&nbsp;-0.920622702425146495505047&nbsp;;&nbsp;-0.915771586857490384526670&nbsp;;<br>
&nbsp;-0.910783096595065011890907&nbsp;;&nbsp;-0.905657979960144647082682&nbsp;;&nbsp;-0.900397005770303544771620&nbsp;;&nbsp;-0.895000963223084577441223&nbsp;;&nbsp;-0.889470661777610888828677&nbsp;;<br>
&nbsp;-0.883806931033158284859826&nbsp;;&nbsp;-0.878010620604706543986435&nbsp;;&nbsp;-0.872082599995488289130046&nbsp;;&nbsp;-0.866023758466554519297515&nbsp;;&nbsp;-0.859835004903376350696173&nbsp;;<br>
&nbsp;-0.853517267679502965073036&nbsp;;&nbsp;-0.847071494517296207187072&nbsp;;&nbsp;-0.840498652345762713895068&nbsp;;&nbsp;-0.833799727155504894348444&nbsp;;&nbsp;-0.826975723850812514289093&nbsp;;<br>
&nbsp;-0.820027666098917067403478&nbsp;;&nbsp;-0.812956596176431543136410&nbsp;;&nbsp;-0.805763574812998623257389&nbsp;;&nbsp;-0.798449681032170758782543&nbsp;;&nbsp;-0.791016011989545994546707&nbsp;;<br>
&nbsp;-0.783463682808183820750670&nbsp;;&nbsp;-0.775793826411325739132053&nbsp;;&nbsp;-0.768007593352445635975891&nbsp;;&nbsp;-0.760106151642655454941907&nbsp;;&nbsp;-0.752090686575492059587530&nbsp;;<br>
&nbsp;-0.743962400549111568455683&nbsp;;&nbsp;-0.735722512885917834620373&nbsp;;&nbsp;-0.727372259649652126586894&nbsp;;&nbsp;-0.718912893459971448372640&nbsp;;&nbsp;-0.710345683304543313394566&nbsp;;<br>
&nbsp;-0.701671914348685159406084&nbsp;;&nbsp;-0.692892887742576960105342&nbsp;;&nbsp;-0.684009920426075953124877&nbsp;;&nbsp;-0.675024344931162763855919&nbsp;;&nbsp;-0.665937509182048559906408&nbsp;;<br>
&nbsp;-0.656750776292973221887500&nbsp;;&nbsp;-0.647465524363724862617016&nbsp;;&nbsp;-0.638083146272911368668689&nbsp;;&nbsp;-0.628605049469014975432210&nbsp;;&nbsp;-0.619032655759261219430968&nbsp;;<br>
&nbsp;-0.609367401096333939522311&nbsp;;&nbsp;-0.599610735362968321730388&nbsp;;&nbsp;-0.589764122154454300785786&nbsp;;&nbsp;-0.579829038559082944921832&nbsp;;&nbsp;-0.569806974936568759057668&nbsp;;<br>
&nbsp;-0.559699434694481145136907&nbsp;;&nbsp;-0.549507934062718557042427&nbsp;;&nbsp;-0.539234001866059181127936&nbsp;;&nbsp;-0.528879179294822261951476&nbsp;;&nbsp;-0.518445019673674476221662&nbsp;;<br>
&nbsp;-0.507933088228616036231925&nbsp;;&nbsp;-0.497344961852181477119512&nbsp;;&nbsp;-0.486682228866890350103621&nbsp;;&nbsp;-0.475946488786983306390738&nbsp;;&nbsp;-0.465139352078479313645570&nbsp;;<br>
&nbsp;-0.454262439917589998774455&nbsp;;&nbsp;-0.443317383947527357216926&nbsp;;&nbsp;-0.432305826033741309953441&nbsp;;&nbsp;-0.421229418017623824976812&nbsp;;&nbsp;-0.410089821468716550006434&nbsp;;<br>
&nbsp;-0.398888707435459127713463&nbsp;;&nbsp;-0.387627756194515583637985&nbsp;;&nbsp;-0.376308656998716390283056&nbsp;;&nbsp;-0.364933107823654018533465&nbsp;;&nbsp;-0.353502815112969989537790&nbsp;;<br>
&nbsp;-0.342019493522371636480730&nbsp;;&nbsp;-0.330484865662416976229187&nbsp;;&nbsp;-0.318900661840106275631683&nbsp;;&nbsp;-0.307268619799319076258610&nbsp;;&nbsp;-0.295590484460135614563787&nbsp;;<br>
&nbsp;-0.283868007657081741799766&nbsp;;&nbsp;-0.272102947876336609505245&nbsp;;&nbsp;-0.260297069991942541978561&nbsp;;&nbsp;-0.248452145001056666833243&nbsp;;&nbsp;-0.236569949758284018477508&nbsp;;<br>
&nbsp;-0.224652266709131967147878&nbsp;;&nbsp;-0.212700883622625957937040&nbsp;;&nbsp;-0.200717593323126670068001&nbsp;;&nbsp;-0.188704193421388826461504&nbsp;;&nbsp;-0.176662486044901997403722&nbsp;;<br>
&nbsp;-0.164594277567553849829285&nbsp;;&nbsp;-0.152501378338656395374607&nbsp;;&nbsp;-0.140385602411375885913025&nbsp;;&nbsp;-0.128248767270607094742050&nbsp;;&nbsp;-0.116092693560332804940735&nbsp;;<br>
&nbsp;-0.103919204810509403639197&nbsp;;&nbsp;-0.091730127163519552031146&nbsp;;&nbsp;-0.079527289100232965903227&nbsp;;&nbsp;-0.067312521165716400242290&nbsp;;&nbsp;-0.055087655694633984104561&nbsp;;<br>
&nbsp;-0.042854526536379098381242&nbsp;;&nbsp;-0.030614968779979029366279&nbsp;;&nbsp;-0.018370818478813665117926&nbsp;;&nbsp;-0.006123912375189529501170&nbsp;;&nbsp;0.006123912375189529501170&nbsp;;<br>
&nbsp;0.018370818478813665117926&nbsp;;&nbsp;0.030614968779979029366279&nbsp;;&nbsp;0.042854526536379098381242&nbsp;;&nbsp;0.055087655694633984104561&nbsp;;&nbsp;0.067312521165716400242290&nbsp;;<br>
&nbsp;0.079527289100232965903227&nbsp;;&nbsp;0.091730127163519552031146&nbsp;;&nbsp;0.103919204810509403639197&nbsp;;&nbsp;0.116092693560332804940735&nbsp;;&nbsp;0.128248767270607094742050&nbsp;;<br>
&nbsp;0.140385602411375885913025&nbsp;;&nbsp;0.152501378338656395374607&nbsp;;&nbsp;0.164594277567553849829285&nbsp;;&nbsp;0.176662486044901997403722&nbsp;;&nbsp;0.188704193421388826461504&nbsp;;<br>
&nbsp;0.200717593323126670068001&nbsp;;&nbsp;0.212700883622625957937040&nbsp;;&nbsp;0.224652266709131967147878&nbsp;;&nbsp;0.236569949758284018477508&nbsp;;&nbsp;0.248452145001056666833243&nbsp;;<br>
&nbsp;0.260297069991942541978561&nbsp;;&nbsp;0.272102947876336609505245&nbsp;;&nbsp;0.283868007657081741799766&nbsp;;&nbsp;0.295590484460135614563787&nbsp;;&nbsp;0.307268619799319076258610&nbsp;;<br>
&nbsp;0.318900661840106275631683&nbsp;;&nbsp;0.330484865662416976229187&nbsp;;&nbsp;0.342019493522371636480730&nbsp;;&nbsp;0.353502815112969989537790&nbsp;;&nbsp;0.364933107823654018533465&nbsp;;<br>
&nbsp;0.376308656998716390283056&nbsp;;&nbsp;0.387627756194515583637985&nbsp;;&nbsp;0.398888707435459127713463&nbsp;;&nbsp;0.410089821468716550006434&nbsp;;&nbsp;0.421229418017623824976812&nbsp;;<br>
&nbsp;0.432305826033741309953441&nbsp;;&nbsp;0.443317383947527357216926&nbsp;;&nbsp;0.454262439917589998774455&nbsp;;&nbsp;0.465139352078479313645570&nbsp;;&nbsp;0.475946488786983306390738&nbsp;;<br>
&nbsp;0.486682228866890350103621&nbsp;;&nbsp;0.497344961852181477119512&nbsp;;&nbsp;0.507933088228616036231925&nbsp;;&nbsp;0.518445019673674476221662&nbsp;;&nbsp;0.528879179294822261951476&nbsp;;<br>
&nbsp;0.539234001866059181127936&nbsp;;&nbsp;0.549507934062718557042427&nbsp;;&nbsp;0.559699434694481145136907&nbsp;;&nbsp;0.569806974936568759057668&nbsp;;&nbsp;0.579829038559082944921832&nbsp;;<br>
&nbsp;0.589764122154454300785786&nbsp;;&nbsp;0.599610735362968321730388&nbsp;;&nbsp;0.609367401096333939522311&nbsp;;&nbsp;0.619032655759261219430968&nbsp;;&nbsp;0.628605049469014975432210&nbsp;;<br>
&nbsp;0.638083146272911368668689&nbsp;;&nbsp;0.647465524363724862617016&nbsp;;&nbsp;0.656750776292973221887500&nbsp;;&nbsp;0.665937509182048559906408&nbsp;;&nbsp;0.675024344931162763855919&nbsp;;<br>
&nbsp;0.684009920426075953124877&nbsp;;&nbsp;0.692892887742576960105342&nbsp;;&nbsp;0.701671914348685159406084&nbsp;;&nbsp;0.710345683304543313394566&nbsp;;&nbsp;0.718912893459971448372640&nbsp;;<br>
&nbsp;0.727372259649652126586894&nbsp;;&nbsp;0.735722512885917834620373&nbsp;;&nbsp;0.743962400549111568455683&nbsp;;&nbsp;0.752090686575492059587530&nbsp;;&nbsp;0.760106151642655454941907&nbsp;;<br>
&nbsp;0.768007593352445635975891&nbsp;;&nbsp;0.775793826411325739132053&nbsp;;&nbsp;0.783463682808183820750670&nbsp;;&nbsp;0.791016011989545994546707&nbsp;;&nbsp;0.798449681032170758782543&nbsp;;<br>
&nbsp;0.805763574812998623257389&nbsp;;&nbsp;0.812956596176431543136410&nbsp;;&nbsp;0.820027666098917067403478&nbsp;;&nbsp;0.826975723850812514289093&nbsp;;&nbsp;0.833799727155504894348444&nbsp;;<br>
&nbsp;0.840498652345762713895068&nbsp;;&nbsp;0.847071494517296207187072&nbsp;;&nbsp;0.853517267679502965073036&nbsp;;&nbsp;0.859835004903376350696173&nbsp;;&nbsp;0.866023758466554519297515&nbsp;;<br>
&nbsp;0.872082599995488289130046&nbsp;;&nbsp;0.878010620604706543986435&nbsp;;&nbsp;0.883806931033158284859826&nbsp;;&nbsp;0.889470661777610888828677&nbsp;;&nbsp;0.895000963223084577441223&nbsp;;<br>
&nbsp;0.900397005770303544771620&nbsp;;&nbsp;0.905657979960144647082682&nbsp;;&nbsp;0.910783096595065011890907&nbsp;;&nbsp;0.915771586857490384526670&nbsp;;&nbsp;0.920622702425146495505047&nbsp;;<br>
&nbsp;0.925335715583316202872730&nbsp;;&nbsp;0.929909919334005641180246&nbsp;;&nbsp;0.934344627502003094292477&nbsp;;&nbsp;0.938639174837814804981926&nbsp;;&nbsp;0.942792917117462443183076&nbsp;;<br>
&nbsp;0.946805231239127481372052&nbsp;;&nbsp;0.950675515316628276363852&nbsp;;&nbsp;0.954403188769716241764448&nbsp;;&nbsp;0.957987692411178129365790&nbsp;;&nbsp;0.961428488530732144006407&nbsp;;<br>
&nbsp;0.964725060975706430932612&nbsp;;&nbsp;0.967876915228489454909004&nbsp;;&nbsp;0.970883578480743029320923&nbsp;;&nbsp;0.973744599704370405266079&nbsp;;&nbsp;0.976459549719234155621011&nbsp;;<br>
&nbsp;0.979028021257622038824238&nbsp;;&nbsp;0.981449629025464405769303&nbsp;;&nbsp;0.983724009760315496166686&nbsp;;&nbsp;0.985850822286125956479245&nbsp;;&nbsp;0.987829747564860608916488&nbsp;;<br>
&nbsp;0.989660488745065218319244&nbsp;;&nbsp;0.991342771207583086922189&nbsp;;&nbsp;0.992876342608822117143534&nbsp;;&nbsp;0.994260972922409664962878&nbsp;;&nbsp;0.995496454481096356592647&nbsp;;<br>
&nbsp;0.996582602023381540430504&nbsp;;&nbsp;0.997519252756720827563409&nbsp;;&nbsp;0.998306266473006444055500&nbsp;;&nbsp;0.998943525843408856555026&nbsp;;&nbsp;0.999430937466261408240854&nbsp;;<br>
&nbsp;0.999768437409263186104879&nbsp;;&nbsp;0.999956050018992230734801&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_256_w&nbsp;=&nbsp;[|&nbsp;0.00011278901782227217551253887725&nbsp;;&nbsp;0.00026253494429644590628745756250&nbsp;;&nbsp;0.00041246325442617632843218583774&nbsp;;&nbsp;0.00056234895403140980281523674759&nbsp;;<br>
&nbsp;0.0007121541634733206669089891511&nbsp;;&nbsp;0.0008618537014200890378140934163&nbsp;;&nbsp;0.0010114243932084404526058128414&nbsp;;&nbsp;0.0011608435575677247239705981135&nbsp;;&nbsp;0.0013100886819025044578316804271&nbsp;;<br>
&nbsp;0.0014591373333107332010883864996&nbsp;;&nbsp;0.0016079671307493272424499395690&nbsp;;&nbsp;0.0017565557363307299936069145295&nbsp;;&nbsp;0.0019048808534997184044191411746&nbsp;;&nbsp;0.0020529202279661431745487818492&nbsp;;<br>
&nbsp;0.0022006516498399104996848834189&nbsp;;&nbsp;0.0023480529563273120170064609087&nbsp;;&nbsp;0.0024951020347037068508395354372&nbsp;;&nbsp;0.0026417768254274905641208292516&nbsp;;&nbsp;0.0027880553253277068805747610763&nbsp;;<br>
&nbsp;0.0029339155908297166460123254142&nbsp;;&nbsp;0.0030793357411993375832053528316&nbsp;;&nbsp;0.0032242939617941981570107134269&nbsp;;&nbsp;0.0033687685073155510120191062489&nbsp;;&nbsp;0.0035127377050563073309710549844&nbsp;;<br>
&nbsp;0.0036561799581425021693892413052&nbsp;;&nbsp;0.0037990737487662579981170192082&nbsp;;&nbsp;0.0039413976414088336277290349840&nbsp;;&nbsp;0.0040831302860526684085997759212&nbsp;;&nbsp;0.0042242504213815362723565049060&nbsp;;<br>
&nbsp;0.0043647368779680566815684200621&nbsp;;&nbsp;0.0045045685814478970686417923159&nbsp;;&nbsp;0.0046437245556800603139790923525&nbsp;;&nbsp;0.0047821839258926913729317340448&nbsp;;&nbsp;0.0049199259218138656695587765655&nbsp;;<br>
&nbsp;0.0050569298807868423875578160762&nbsp;;&nbsp;0.0051931752508692809303287536296&nbsp;;&nbsp;0.0053286415939159303170811114788&nbsp;;&nbsp;0.0054633085886443102775705318566&nbsp;;&nbsp;0.0055971560336829100775514452572&nbsp;;<br>
&nbsp;0.005730163850601437177384417555&nbsp;;&nbsp;0.005862312086922653060661598801&nbsp;;&nbsp;0.005993580919115338221127696870&nbsp;;&nbsp;0.006123950655567932542389081187&nbsp;;&nbsp;0.006253401739542401272063645975&nbsp;;<br>
&nbsp;0.006381914752107880570375164275&nbsp;;&nbsp;0.006509470415053660267809899951&nbsp;;&nbsp;0.006636049593781065044590038355&nbsp;;&nbsp;0.006761633300173798780927861108&nbsp;;&nbsp;0.006886202695446320346713323775&nbsp;;<br>
&nbsp;0.007009739092969822621234436194&nbsp;;&nbsp;0.007132223961075390071672422986&nbsp;;&nbsp;0.007253638925833913783829137214&nbsp;;&nbsp;0.007373965773812346437572440695&nbsp;;&nbsp;0.007493186454805883358599761133&nbsp;;<br>
&nbsp;0.007611283084545659461618719618&nbsp;;&nbsp;0.007728237947381555631110194958&nbsp;;&nbsp;0.007844033498939711866810316151&nbsp;;&nbsp;0.007958652368754348353613161227&nbsp;;&nbsp;0.008072077362873499500946974804&nbsp;;<br>
&nbsp;0.008184291466438269935619761004&nbsp;;&nbsp;0.008295277846235225425171412553&nbsp;;&nbsp;0.008405019853221535756180301698&nbsp;;&nbsp;0.008513501025022490693838354790&nbsp;;&nbsp;0.008620705088401014305368838410&nbsp;;<br>
&nbsp;0.008726615961698807140336632217&nbsp;;&nbsp;0.008831217757248750025318272685&nbsp;;&nbsp;0.008934494783758207548408417085&nbsp;;&nbsp;0.009036431548662873680227775572&nbsp;;&nbsp;0.009137012760450806402000472219&nbsp;;<br>
&nbsp;0.009236223330956302687378716714&nbsp;;&nbsp;0.009334048377623269712466014486&nbsp;;&nbsp;0.009430473225737752747352764482&nbsp;;&nbsp;0.009525483410629284811829685754&nbsp;;&nbsp;0.009619064679840727857162164401&nbsp;;<br>
&nbsp;0.009711202995266279964249670496&nbsp;;&nbsp;0.009801884535257327825498800250&nbsp;;&nbsp;0.009891095696695828602630683809&nbsp;;&nbsp;0.009978823097034910124733949495&nbsp;;&nbsp;0.010065053576306383309460978930&nbsp;;<br>
&nbsp;0.010149774199094865654634066042&nbsp;;&nbsp;0.010232972256478219656954857160&nbsp;;&nbsp;0.010314635267934015068260713997&nbsp;;&nbsp;0.010394750983211728997101725205&nbsp;;&nbsp;0.010473307384170403003569566927&nbsp;;<br>
&nbsp;0.010550292686581481517533575536&nbsp;;&nbsp;0.010625695341896561133961681801&nbsp;;&nbsp;0.010699504038979785603048200583&nbsp;;&nbsp;0.010771707705804626636653631927&nbsp;;&nbsp;0.010842295511114795995293477058&nbsp;;<br>
&nbsp;0.010911256866049039700796847788&nbsp;;&nbsp;0.010978581425729570637988203448&nbsp;;&nbsp;0.011044259090813901263517571044&nbsp;;&nbsp;0.011108280009009843630460815451&nbsp;;&nbsp;0.011170634576553449462710881938&nbsp;;<br>
&nbsp;0.011231313439649668572656802083&nbsp;;&nbsp;0.011290307495875509508367594121&nbsp;;&nbsp;0.011347607895545491941625714297&nbsp;;&nbsp;0.011403206043039185964847059552&nbsp;;&nbsp;0.011457093598090639152334392298&nbsp;;<br>
&nbsp;0.011509262477039497958586392439&nbsp;;&nbsp;0.011559704854043635772668656950&nbsp;;&nbsp;0.011608413162253105722084706677&nbsp;;&nbsp;0.011655380094945242121298939730&nbsp;;&nbsp;0.011700598606620740288189823359&nbsp;;<br>
&nbsp;0.011744061914060550305376732759&nbsp;;&nbsp;0.011785763497343426181690117627&nbsp;;&nbsp;0.011825697100823977771160737958&nbsp;;&nbsp;0.011863856734071078731904572908&nbsp;;&nbsp;0.011900236672766489754287204237&nbsp;;<br>
&nbsp;0.011934831459563562255873201696&nbsp;;&nbsp;0.011967635904905893729007282670&nbsp;;&nbsp;0.011998645087805811934536710071&nbsp;;&nbsp;0.012027854356582571161267533498&nbsp;;&nbsp;0.012055259329560149814347085327&nbsp;;<br>
&nbsp;0.012080855895724544655975183976&nbsp;;&nbsp;0.012104640215340463097757829736&nbsp;;&nbsp;0.012126608720527321034718492205&nbsp;;&nbsp;0.012146758115794459815559837664&nbsp;;&nbsp;0.012165085378535502061307291839&nbsp;;<br>
&nbsp;0.012181587759481772174047585032&nbsp;;&nbsp;0.012196262783114713518180974196&nbsp;;&nbsp;0.012209108248037240407514094371&nbsp;;&nbsp;0.012220122227303969191708737227&nbsp;;&nbsp;0.012229303068710278904146266083&nbsp;;<br>
&nbsp;0.012236649395040158109242574767&nbsp;;&nbsp;0.012242160104272800769728083260&nbsp;;&nbsp;0.012245834369747920142463857550&nbsp;;&nbsp;0.01224767164028975590407032649&nbsp;;&nbsp;0.01224767164028975590407032649&nbsp;;<br>
&nbsp;0.012245834369747920142463857550&nbsp;;&nbsp;0.012242160104272800769728083260&nbsp;;&nbsp;0.012236649395040158109242574767&nbsp;;&nbsp;0.012229303068710278904146266083&nbsp;;&nbsp;0.012220122227303969191708737227&nbsp;;<br>
&nbsp;0.012209108248037240407514094371&nbsp;;&nbsp;0.012196262783114713518180974196&nbsp;;&nbsp;0.012181587759481772174047585032&nbsp;;&nbsp;0.012165085378535502061307291839&nbsp;;&nbsp;0.012146758115794459815559837664&nbsp;;<br>
&nbsp;0.012126608720527321034718492205&nbsp;;&nbsp;0.012104640215340463097757829736&nbsp;;&nbsp;0.012080855895724544655975183976&nbsp;;&nbsp;0.012055259329560149814347085327&nbsp;;&nbsp;0.012027854356582571161267533498&nbsp;;<br>
&nbsp;0.011998645087805811934536710071&nbsp;;&nbsp;0.011967635904905893729007282670&nbsp;;&nbsp;0.011934831459563562255873201696&nbsp;;&nbsp;0.011900236672766489754287204237&nbsp;;&nbsp;0.011863856734071078731904572908&nbsp;;<br>
&nbsp;0.011825697100823977771160737958&nbsp;;&nbsp;0.011785763497343426181690117627&nbsp;;&nbsp;0.011744061914060550305376732759&nbsp;;&nbsp;0.011700598606620740288189823359&nbsp;;&nbsp;0.011655380094945242121298939730&nbsp;;<br>
&nbsp;0.011608413162253105722084706677&nbsp;;&nbsp;0.011559704854043635772668656950&nbsp;;&nbsp;0.011509262477039497958586392439&nbsp;;&nbsp;0.011457093598090639152334392298&nbsp;;&nbsp;0.011403206043039185964847059552&nbsp;;<br>
&nbsp;0.011347607895545491941625714297&nbsp;;&nbsp;0.011290307495875509508367594121&nbsp;;&nbsp;0.011231313439649668572656802083&nbsp;;&nbsp;0.011170634576553449462710881938&nbsp;;&nbsp;0.011108280009009843630460815451&nbsp;;<br>
&nbsp;0.011044259090813901263517571044&nbsp;;&nbsp;0.010978581425729570637988203448&nbsp;;&nbsp;0.010911256866049039700796847788&nbsp;;&nbsp;0.010842295511114795995293477058&nbsp;;&nbsp;0.010771707705804626636653631927&nbsp;;<br>
&nbsp;0.010699504038979785603048200583&nbsp;;&nbsp;0.010625695341896561133961681801&nbsp;;&nbsp;0.010550292686581481517533575536&nbsp;;&nbsp;0.010473307384170403003569566927&nbsp;;&nbsp;0.010394750983211728997101725205&nbsp;;<br>
&nbsp;0.010314635267934015068260713997&nbsp;;&nbsp;0.010232972256478219656954857160&nbsp;;&nbsp;0.010149774199094865654634066042&nbsp;;&nbsp;0.010065053576306383309460978930&nbsp;;&nbsp;0.009978823097034910124733949495&nbsp;;<br>
&nbsp;0.009891095696695828602630683809&nbsp;;&nbsp;0.009801884535257327825498800250&nbsp;;&nbsp;0.009711202995266279964249670496&nbsp;;&nbsp;0.009619064679840727857162164401&nbsp;;&nbsp;0.009525483410629284811829685754&nbsp;;<br>
&nbsp;0.009430473225737752747352764482&nbsp;;&nbsp;0.009334048377623269712466014486&nbsp;;&nbsp;0.009236223330956302687378716714&nbsp;;&nbsp;0.009137012760450806402000472219&nbsp;;&nbsp;0.009036431548662873680227775572&nbsp;;<br>
&nbsp;0.008934494783758207548408417085&nbsp;;&nbsp;0.008831217757248750025318272685&nbsp;;&nbsp;0.008726615961698807140336632217&nbsp;;&nbsp;0.008620705088401014305368838410&nbsp;;&nbsp;0.008513501025022490693838354790&nbsp;;<br>
&nbsp;0.008405019853221535756180301698&nbsp;;&nbsp;0.008295277846235225425171412553&nbsp;;&nbsp;0.008184291466438269935619761004&nbsp;;&nbsp;0.008072077362873499500946974804&nbsp;;&nbsp;0.007958652368754348353613161227&nbsp;;<br>
&nbsp;0.007844033498939711866810316151&nbsp;;&nbsp;0.007728237947381555631110194958&nbsp;;&nbsp;0.007611283084545659461618719618&nbsp;;&nbsp;0.007493186454805883358599761133&nbsp;;&nbsp;0.007373965773812346437572440695&nbsp;;<br>
&nbsp;0.007253638925833913783829137214&nbsp;;&nbsp;0.007132223961075390071672422986&nbsp;;&nbsp;0.007009739092969822621234436194&nbsp;;&nbsp;0.006886202695446320346713323775&nbsp;;&nbsp;0.006761633300173798780927861108&nbsp;;<br>
&nbsp;0.006636049593781065044590038355&nbsp;;&nbsp;0.006509470415053660267809899951&nbsp;;&nbsp;0.006381914752107880570375164275&nbsp;;&nbsp;0.006253401739542401272063645975&nbsp;;&nbsp;0.006123950655567932542389081187&nbsp;;<br>
&nbsp;0.005993580919115338221127696870&nbsp;;&nbsp;0.005862312086922653060661598801&nbsp;;&nbsp;0.005730163850601437177384417555&nbsp;;&nbsp;0.0055971560336829100775514452572&nbsp;;&nbsp;0.0054633085886443102775705318566&nbsp;;<br>
&nbsp;0.0053286415939159303170811114788&nbsp;;&nbsp;0.0051931752508692809303287536296&nbsp;;&nbsp;0.0050569298807868423875578160762&nbsp;;&nbsp;0.0049199259218138656695587765655&nbsp;;&nbsp;0.0047821839258926913729317340448&nbsp;;<br>
&nbsp;0.0046437245556800603139790923525&nbsp;;&nbsp;0.0045045685814478970686417923159&nbsp;;&nbsp;0.0043647368779680566815684200621&nbsp;;&nbsp;0.0042242504213815362723565049060&nbsp;;&nbsp;0.0040831302860526684085997759212&nbsp;;<br>
&nbsp;0.0039413976414088336277290349840&nbsp;;&nbsp;0.0037990737487662579981170192082&nbsp;;&nbsp;0.0036561799581425021693892413052&nbsp;;&nbsp;0.0035127377050563073309710549844&nbsp;;&nbsp;0.0033687685073155510120191062489&nbsp;;<br>
&nbsp;0.0032242939617941981570107134269&nbsp;;&nbsp;0.0030793357411993375832053528316&nbsp;;&nbsp;0.0029339155908297166460123254142&nbsp;;&nbsp;0.0027880553253277068805747610763&nbsp;;&nbsp;0.0026417768254274905641208292516&nbsp;;<br>
&nbsp;0.0024951020347037068508395354372&nbsp;;&nbsp;0.0023480529563273120170064609087&nbsp;;&nbsp;0.0022006516498399104996848834189&nbsp;;&nbsp;0.0020529202279661431745487818492&nbsp;;&nbsp;0.0019048808534997184044191411746&nbsp;;<br>
&nbsp;0.0017565557363307299936069145295&nbsp;;&nbsp;0.0016079671307493272424499395690&nbsp;;&nbsp;0.0014591373333107332010883864996&nbsp;;&nbsp;0.0013100886819025044578316804271&nbsp;;&nbsp;0.0011608435575677247239705981135&nbsp;;<br>
&nbsp;0.0010114243932084404526058128414&nbsp;;&nbsp;0.0008618537014200890378140934163&nbsp;;&nbsp;0.0007121541634733206669089891511&nbsp;;&nbsp;0.00056234895403140980281523674759&nbsp;;&nbsp;0.00041246325442617632843218583774&nbsp;;<br>
&nbsp;0.00026253494429644590628745756250&nbsp;;&nbsp;0.00011278901782227217551253887725&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_257_x&nbsp;=&nbsp;[|&nbsp;-0.999956390712330402472857&nbsp;;&nbsp;-0.999770232390338019056053&nbsp;;&nbsp;-0.999435348366365078441838&nbsp;;&nbsp;-0.998951714093223210129834&nbsp;;<br>
&nbsp;-0.998319392445383847808766&nbsp;;&nbsp;-0.997538475365520218731818&nbsp;;&nbsp;-0.996609078365487004512326&nbsp;;&nbsp;-0.995531339486830143483750&nbsp;;&nbsp;-0.994305419008553630362377&nbsp;;<br>
&nbsp;-0.992931499332908653172844&nbsp;;&nbsp;-0.991409784923101705201254&nbsp;;&nbsp;-0.989740502257507526030375&nbsp;;&nbsp;-0.987923899788618253106809&nbsp;;&nbsp;-0.985960247902290665366669&nbsp;;<br>
&nbsp;-0.983849838875444644048531&nbsp;;&nbsp;-0.981592986831381877693095&nbsp;;&nbsp;-0.979190027692327124191591&nbsp;;&nbsp;-0.976641319128992592610888&nbsp;;&nbsp;-0.973947240507062326750976&nbsp;;<br>
&nbsp;-0.971108192830542793021113&nbsp;;&nbsp;-0.968124598681952354372943&nbsp;;&nbsp;-0.964996902159337170373447&nbsp;;&nbsp;-0.961725568810109767190665&nbsp;;&nbsp;-0.958311085561711847074814&nbsp;;<br>
&nbsp;-0.954753960649106318830855&nbsp;;&nbsp;-0.951054723539105826691801&nbsp;;&nbsp;-0.947213924851546682950881&nbsp;;&nbsp;-0.943232136277318328151464&nbsp;;&nbsp;-0.939109950493259404355123&nbsp;;<br>
&nbsp;-0.934847981073932324370129&nbsp;;&nbsp;-0.930446862400288909805510&nbsp;;&nbsp;-0.925907249565240289235888&nbsp;;&nbsp;-0.921229818276144817520964&nbsp;;&nbsp;-0.916415264754228313295468&nbsp;;<br>
&nbsp;-0.911464305630951423630955&nbsp;;&nbsp;-0.906377677841339419411308&nbsp;;&nbsp;-0.901156138514290206476301&nbsp;;&nbsp;-0.895800464859876809085345&nbsp;;&nbsp;-0.890311454053661045810287&nbsp;;<br>
&nbsp;-0.884689923118035575018750&nbsp;;&nbsp;-0.878936708800611938658765&nbsp;;&nbsp;-0.873052667449672679799858&nbsp;;&nbsp;-0.867038674886706051812473&nbsp;;&nbsp;-0.860895626276042275514686&nbsp;;<br>
&nbsp;-0.854624435991610735314055&nbsp;;&nbsp;-0.848226037480837936478636&nbsp;;&nbsp;-0.841701383125706473284556&nbsp;;&nbsp;-0.835051444100995681967937&nbsp;;&nbsp;-0.828277210229725073186687&nbsp;;<br>
&nbsp;-0.821379689835822056081139&nbsp;;&nbsp;-0.814359909594035880004229&nbsp;;&nbsp;-0.807218914377120130552073&nbsp;;&nbsp;-0.799957767100306523636066&nbsp;;&nbsp;-0.792577548563093144962574&nbsp;;<br>
&nbsp;-0.785079357288370682385816&nbsp;;&nbsp;-0.777464309358910595129671&nbsp;;&nbsp;-0.769733538251239556788216&nbsp;;&nbsp;-0.761888194666924898264210&nbsp;;&nbsp;-0.753929446361296162339238&nbsp;;<br>
&nbsp;-0.745858477969628263337895&nbsp;;&nbsp;-0.737676490830812123299244&nbsp;;&nbsp;-0.729384702808539030149808&nbsp;;&nbsp;-0.720984348110025333531072&nbsp;;&nbsp;-0.712476677102304460118510&nbsp;;<br>
&nbsp;-0.703862956126113592426171&nbsp;;&nbsp;-0.695144467307402713168813&nbsp;;&nbsp;-0.686322508366494071200553&nbsp;;&nbsp;-0.677398392424920474813593&nbsp;;&nbsp;-0.668373447809971163711735&nbsp;;<br>
&nbsp;-0.659249017856974352220492&nbsp;;&nbsp;-0.650026460709345873208532&nbsp;;&nbsp;-0.640707149116433684724434&nbsp;;&nbsp;-0.631292470229188329449219&nbsp;;&nbsp;-0.621783825393689760680446&nbsp;;<br>
&nbsp;-0.612182629942561267650033&nbsp;;&nbsp;-0.602490312984301547488097&nbsp;;&nbsp;-0.592708317190566281032495&nbsp;;&nbsp;-0.582838098581430874902446&nbsp;;&nbsp;-0.572881126308666332759406&nbsp;;<br>
&nbsp;-0.562838882437060514424546&nbsp;;&nbsp;-0.552712861723817332466074&nbsp;;&nbsp;-0.542504571396066721967792&nbsp;;&nbsp;-0.532215530926518500400434&nbsp;;&nbsp;-0.521847271807293510797499&nbsp;;<br>
&nbsp;-0.511401337321965712746629&nbsp;;&nbsp;-0.500879282315849152005553&nbsp;;&nbsp;-0.490282672964564000798817&nbsp;;&nbsp;-0.479613086540916117008992&nbsp;;&nbsp;-0.468872111180124821505728&nbsp;;<br>
&nbsp;-0.458061345643433838720630&nbsp;;&nbsp;-0.447182399080140586238810&nbsp;;&nbsp;-0.436236890788079234603398&nbsp;;&nbsp;-0.425226449972593188682213&nbsp;;&nbsp;-0.414152715504032866791986&nbsp;;<br>
&nbsp;-0.403017335673814873281489&nbsp;;&nbsp;-0.391821967949078874408131&nbsp;;&nbsp;-0.380568278725978696070941&nbsp;;&nbsp;-0.369257943081644365255611&nbsp;;&nbsp;-0.357892644524852014873858&nbsp;;<br>
&nbsp;-0.346474074745438764010632&nbsp;;&nbsp;-0.335003933362499872399782&nbsp;;&nbsp;-0.323483927671405649204085&nbsp;;&nbsp;-0.311915772389675771851948&nbsp;;&nbsp;-0.300301189401748840754520&nbsp;;<br>
&nbsp;-0.288641907502685160168097&nbsp;;&nbsp;-0.276939662140840894253032&nbsp;;&nbsp;-0.265196195159551900488370&nbsp;;&nbsp;-0.253413254537865690008131&nbsp;;&nbsp;-0.241592594130360106108882&nbsp;;<br>
&nbsp;-0.229735973406087448117604&nbsp;;&nbsp;-0.217845157186682897983880&nbsp;;&nbsp;-0.205921915383676231351599&nbsp;;&nbsp;-0.193968022735045913454182&nbsp;;&nbsp;-0.181985258541054792946197&nbsp;;<br>
&nbsp;-0.169975406399406713716337&nbsp;;&nbsp;-0.157940253939763465806087&nbsp;;&nbsp;-0.145881592557661591770148&nbsp;;&nbsp;-0.133801217147868654144405&nbsp;;&nbsp;-0.121700925837218653121859&nbsp;;<br>
&nbsp;-0.109582519716966361063898&nbsp;;&nbsp;-0.097447802574700412082119&nbsp;;&nbsp;-0.085298580625855050603929&nbsp;;&nbsp;-0.073136662244860502573600&nbsp;;&nbsp;-0.060963857695971986730406&nbsp;;<br>
&nbsp;-0.048781978863817431238958&nbsp;;&nbsp;-0.036592838983704002816750&nbsp;;&nbsp;-0.024398252371723591403953&nbsp;;&nbsp;-0.012200034154697423345412&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.012200034154697423345412&nbsp;;<br>
&nbsp;0.024398252371723591403953&nbsp;;&nbsp;0.036592838983704002816750&nbsp;;&nbsp;0.048781978863817431238958&nbsp;;&nbsp;0.060963857695971986730406&nbsp;;&nbsp;0.073136662244860502573600&nbsp;;<br>
&nbsp;0.085298580625855050603929&nbsp;;&nbsp;0.097447802574700412082119&nbsp;;&nbsp;0.109582519716966361063898&nbsp;;&nbsp;0.121700925837218653121859&nbsp;;&nbsp;0.133801217147868654144405&nbsp;;<br>
&nbsp;0.145881592557661591770148&nbsp;;&nbsp;0.157940253939763465806087&nbsp;;&nbsp;0.169975406399406713716337&nbsp;;&nbsp;0.181985258541054792946197&nbsp;;&nbsp;0.193968022735045913454182&nbsp;;<br>
&nbsp;0.205921915383676231351599&nbsp;;&nbsp;0.217845157186682897983880&nbsp;;&nbsp;0.229735973406087448117604&nbsp;;&nbsp;0.241592594130360106108882&nbsp;;&nbsp;0.253413254537865690008131&nbsp;;<br>
&nbsp;0.265196195159551900488370&nbsp;;&nbsp;0.276939662140840894253032&nbsp;;&nbsp;0.288641907502685160168097&nbsp;;&nbsp;0.300301189401748840754520&nbsp;;&nbsp;0.311915772389675771851948&nbsp;;<br>
&nbsp;0.323483927671405649204085&nbsp;;&nbsp;0.335003933362499872399782&nbsp;;&nbsp;0.346474074745438764010632&nbsp;;&nbsp;0.357892644524852014873858&nbsp;;&nbsp;0.369257943081644365255611&nbsp;;<br>
&nbsp;0.380568278725978696070941&nbsp;;&nbsp;0.391821967949078874408131&nbsp;;&nbsp;0.403017335673814873281489&nbsp;;&nbsp;0.414152715504032866791986&nbsp;;&nbsp;0.425226449972593188682213&nbsp;;<br>
&nbsp;0.436236890788079234603398&nbsp;;&nbsp;0.447182399080140586238810&nbsp;;&nbsp;0.458061345643433838720630&nbsp;;&nbsp;0.468872111180124821505728&nbsp;;&nbsp;0.479613086540916117008992&nbsp;;<br>
&nbsp;0.490282672964564000798817&nbsp;;&nbsp;0.500879282315849152005553&nbsp;;&nbsp;0.511401337321965712746629&nbsp;;&nbsp;0.521847271807293510797499&nbsp;;&nbsp;0.532215530926518500400434&nbsp;;<br>
&nbsp;0.542504571396066721967792&nbsp;;&nbsp;0.552712861723817332466074&nbsp;;&nbsp;0.562838882437060514424546&nbsp;;&nbsp;0.572881126308666332759406&nbsp;;&nbsp;0.582838098581430874902446&nbsp;;<br>
&nbsp;0.592708317190566281032495&nbsp;;&nbsp;0.602490312984301547488097&nbsp;;&nbsp;0.612182629942561267650033&nbsp;;&nbsp;0.621783825393689760680446&nbsp;;&nbsp;0.631292470229188329449219&nbsp;;<br>
&nbsp;0.640707149116433684724434&nbsp;;&nbsp;0.650026460709345873208532&nbsp;;&nbsp;0.659249017856974352220492&nbsp;;&nbsp;0.668373447809971163711735&nbsp;;&nbsp;0.677398392424920474813593&nbsp;;<br>
&nbsp;0.686322508366494071200553&nbsp;;&nbsp;0.695144467307402713168813&nbsp;;&nbsp;0.703862956126113592426171&nbsp;;&nbsp;0.712476677102304460118510&nbsp;;&nbsp;0.720984348110025333531072&nbsp;;<br>
&nbsp;0.729384702808539030149808&nbsp;;&nbsp;0.737676490830812123299244&nbsp;;&nbsp;0.745858477969628263337895&nbsp;;&nbsp;0.753929446361296162339238&nbsp;;&nbsp;0.761888194666924898264210&nbsp;;<br>
&nbsp;0.769733538251239556788216&nbsp;;&nbsp;0.777464309358910595129671&nbsp;;&nbsp;0.785079357288370682385816&nbsp;;&nbsp;0.792577548563093144962574&nbsp;;&nbsp;0.799957767100306523636066&nbsp;;<br>
&nbsp;0.807218914377120130552073&nbsp;;&nbsp;0.814359909594035880004229&nbsp;;&nbsp;0.821379689835822056081139&nbsp;;&nbsp;0.828277210229725073186687&nbsp;;&nbsp;0.835051444100995681967937&nbsp;;<br>
&nbsp;0.841701383125706473284556&nbsp;;&nbsp;0.848226037480837936478636&nbsp;;&nbsp;0.854624435991610735314055&nbsp;;&nbsp;0.860895626276042275514686&nbsp;;&nbsp;0.867038674886706051812473&nbsp;;<br>
&nbsp;0.873052667449672679799858&nbsp;;&nbsp;0.878936708800611938658765&nbsp;;&nbsp;0.884689923118035575018750&nbsp;;&nbsp;0.890311454053661045810287&nbsp;;&nbsp;0.895800464859876809085345&nbsp;;<br>
&nbsp;0.901156138514290206476301&nbsp;;&nbsp;0.906377677841339419411308&nbsp;;&nbsp;0.911464305630951423630955&nbsp;;&nbsp;0.916415264754228313295468&nbsp;;&nbsp;0.921229818276144817520964&nbsp;;<br>
&nbsp;0.925907249565240289235888&nbsp;;&nbsp;0.930446862400288909805510&nbsp;;&nbsp;0.934847981073932324370129&nbsp;;&nbsp;0.939109950493259404355123&nbsp;;&nbsp;0.943232136277318328151464&nbsp;;<br>
&nbsp;0.947213924851546682950881&nbsp;;&nbsp;0.951054723539105826691801&nbsp;;&nbsp;0.954753960649106318830855&nbsp;;&nbsp;0.958311085561711847074814&nbsp;;&nbsp;0.961725568810109767190665&nbsp;;<br>
&nbsp;0.964996902159337170373447&nbsp;;&nbsp;0.968124598681952354372943&nbsp;;&nbsp;0.971108192830542793021113&nbsp;;&nbsp;0.973947240507062326750976&nbsp;;&nbsp;0.976641319128992592610888&nbsp;;<br>
&nbsp;0.979190027692327124191591&nbsp;;&nbsp;0.981592986831381877693095&nbsp;;&nbsp;0.983849838875444644048531&nbsp;;&nbsp;0.985960247902290665366669&nbsp;;&nbsp;0.987923899788618253106809&nbsp;;<br>
&nbsp;0.989740502257507526030375&nbsp;;&nbsp;0.991409784923101705201254&nbsp;;&nbsp;0.992931499332908653172844&nbsp;;&nbsp;0.994305419008553630362377&nbsp;;&nbsp;0.995531339486830143483750&nbsp;;<br>
&nbsp;0.996609078365487004512326&nbsp;;&nbsp;0.997538475365520218731818&nbsp;;&nbsp;0.998319392445383847808766&nbsp;;&nbsp;0.998951714093223210129834&nbsp;;&nbsp;0.999435348366365078441838&nbsp;;<br>
&nbsp;0.999770232390338019056053&nbsp;;&nbsp;0.999956390712330402472857&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_legendre_257_w&nbsp;=&nbsp;[|&nbsp;0.00011191470145601756450862287886&nbsp;;&nbsp;0.00026049995580176964436806680831&nbsp;;&nbsp;0.00040926648283531339591138751432&nbsp;;&nbsp;0.00055799120546880640169677292533&nbsp;;<br>
&nbsp;0.00070663671051592291949335494247&nbsp;;&nbsp;0.00085517818446696565626595950963&nbsp;;&nbsp;0.00100359280467969441299468763292&nbsp;;&nbsp;0.0011518582377826677880963146741&nbsp;;&nbsp;0.0012999523174235227389668643832&nbsp;;<br>
&nbsp;0.0014478529559255120065233994722&nbsp;;&nbsp;0.0015955381166175133369701690235&nbsp;;&nbsp;0.0017429858051468299509941139300&nbsp;;&nbsp;0.0018901740676190104269878470891&nbsp;;&nbsp;0.0020370809914723626741694800322&nbsp;;<br>
&nbsp;0.0021836847075455253317921866057&nbsp;;&nbsp;0.0023299633927021828561308282641&nbsp;;&nbsp;0.0024758952727301488651840215879&nbsp;;&nbsp;0.0026214586253808109266552781372&nbsp;;&nbsp;0.0027666317834818283552560256501&nbsp;;<br>
&nbsp;0.0029113931380877846359302447381&nbsp;;&nbsp;0.0030557211416493711130936102459&nbsp;;&nbsp;0.0031995943111899437356540290142&nbsp;;&nbsp;0.0033429912314827618499065991316&nbsp;;&nbsp;0.0034858905582247143702551557840&nbsp;;<br>
&nbsp;0.0036282710212037760873102463983&nbsp;;&nbsp;0.0037701114274582873548537007645&nbsp;;&nbsp;0.0039113906644266662571543468015&nbsp;;&nbsp;0.0040520877030864825223229951262&nbsp;;&nbsp;0.0041921816010820254766367595011&nbsp;;<br>
&nbsp;0.0043316515058396297504806208252&nbsp;;&nbsp;0.0044704766576701092218388764046&nbsp;;&nbsp;0.0046086363928577081326523656522&nbsp;;&nbsp;0.0047461101467350184936945641585&nbsp;;&nbsp;0.0048828774567433411142588306018&nbsp;;<br>
&nbsp;0.0050189179654779878773297516544&nbsp;;&nbsp;0.0051542114237180378340642003713&nbsp;;&nbsp;0.0052887376934400710240953933529&nbsp;;&nbsp;0.0054224767508154127788846727083&nbsp;;&nbsp;0.0055554086891904284012033890901&nbsp;;<br>
&nbsp;0.0056875137220494140577838938236&nbsp;;&nbsp;0.0058187721859596348346566361185&nbsp;;&nbsp;0.0059491645434980654366600347567&nbsp;;&nbsp;0.0060786713861593931405204596709&nbsp;;&nbsp;0.0062072734372448464599330978665&nbsp;;<br>
&nbsp;0.0063349515547314166407936938524&nbsp;;&nbsp;0.0064616867341210426397202932350&nbsp;;&nbsp;0.0065874601112693336961737372300&nbsp;;&nbsp;0.0067122529651934070221351960200&nbsp;;&nbsp;0.0068360467208584215286561508406&nbsp;;<br>
&nbsp;0.0069588229519423919043121805236&nbsp;;&nbsp;0.0070805633835788707705149901066&nbsp;;&nbsp;0.0072012498950770900730828552207&nbsp;;&nbsp;0.0073208645226191563361371026044&nbsp;;&nbsp;0.0074393894619338979090297315972&nbsp;;<br>
&nbsp;0.0075568070709469658838993300454&nbsp;;&nbsp;0.0076730998724067939537782250476&nbsp;;&nbsp;0.0077882505564860261212726654404&nbsp;;&nbsp;0.0079022419833580248574070864277&nbsp;;&nbsp;0.0080150571857480760504667455353&nbsp;;<br>
&nbsp;0.0081266793714589108764118189068&nbsp;;&nbsp;0.0082370919258701685661946145361&nbsp;;&nbsp;0.0083462784144114279413811886655&nbsp;;&nbsp;0.0084542225850084395379670551258&nbsp;;&nbsp;0.0085609083705021941391459209280&nbsp;;<br>
&nbsp;0.0086663198910404675908861979240&nbsp;;&nbsp;0.0087704414564414858792445834744&nbsp;;&nbsp;0.0088732575685293586050755892934&nbsp;;&nbsp;0.0089747529234409331997949023068&nbsp;;&nbsp;0.0090749124139037264846862498962&nbsp;;<br>
&nbsp;0.0091737211314845944854270065178&nbsp;;&nbsp;0.0092711643688088057725325917169&nbsp;;&nbsp;0.0093672276217491880067391857021&nbsp;;&nbsp;0.0094618965915850218253881576301&nbsp;;&nbsp;0.0095551571871303607110514249099&nbsp;;<br>
&nbsp;0.0096469955268314600363329731559&nbsp;;&nbsp;0.0097373979408330030783691793250&nbsp;;&nbsp;0.0098263509730128164423854701706&nbsp;;&nbsp;0.0099138413829847720250916955489&nbsp;;&nbsp;0.0099998561480695773850435626986&nbsp;;<br>
&nbsp;0.0100843824652331611676814627839&nbsp;;&nbsp;0.0101674077529923650568895461852&nbsp;;&nbsp;0.0102489196532876585918958554047&nbsp;;&nbsp;0.0103289060333225980974485876288&nbsp;;&nbsp;0.0104073549873697559257355517893&nbsp;;<br>
&nbsp;0.0104842548385428511997370260353&nbsp;;&nbsp;0.0105595941405348182788823332058&nbsp;;&nbsp;0.0106333616793215542382761147904&nbsp;;&nbsp;0.0107055464748310917616231511294&nbsp;;&nbsp;0.0107761377825779489945556541150&nbsp;;<br>
&nbsp;0.0108451250952624130885928632830&nbsp;;&nbsp;0.0109124981443345193856719616965&nbsp;;&nbsp;0.0109782469015224934483083029166&nbsp;;&nbsp;0.0110423615803254284301924654946&nbsp;;&nbsp;0.0111048326374699756056269264803&nbsp;;<br>
&nbsp;0.0111656507743308312328559850485&nbsp;;&nbsp;0.0112248069383148083152535688671&nbsp;;&nbsp;0.0112822923242082872447042603128&nbsp;;&nbsp;0.0113380983754878447625379269120&nbsp;;&nbsp;0.011392216785593866154247619654&nbsp;;<br>
&nbsp;0.011444639499166951104119199270&nbsp;;&nbsp;0.011495358713246929174010288914&nbsp;;&nbsp;0.011544366878434306436012137033&nbsp;;&nbsp;0.011591656700013970380783131035&nbsp;;&nbsp;0.011637221139040985841125311445&nbsp;;<br>
&nbsp;0.011681053413388320313049670635&nbsp;;&nbsp;0.011723146998756342723302879656&nbsp;;&nbsp;0.011763495629643945382264331878&nbsp;;&nbsp;0.011802093300281144573421477037&nbsp;;&nbsp;0.011838934265523020964443424791&nbsp;;<br>
&nbsp;0.011874013041704866779344562066&nbsp;;&nbsp;0.011907324407458412445505183140&nbsp;;&nbsp;0.011938863404489011222535627643&nbsp;;&nbsp;0.011968625338313666131272065445&nbsp;;&nbsp;0.011996605778959789329711050159&nbsp;;<br>
&nbsp;0.012022800561624589927558893338&nbsp;;&nbsp;0.012047205787294992091420946532&nbsp;;&nbsp;0.012069817823327991167612855626&nbsp;;&nbsp;0.012090633303991361438266420912&nbsp;;&nbsp;0.012109649130964635027950450318&nbsp;;<br>
&nbsp;0.012126862473800277391553601370&nbsp;;&nbsp;0.012142270770344990738801546574&nbsp;;&nbsp;0.012155871727121082685623083829&nbsp;;&nbsp;0.012167663319667843366755737416&nbsp;;&nbsp;0.012177643792842880196606249581&nbsp;;<br>
&nbsp;0.012185811661083365425569178819&nbsp;;&nbsp;0.012192165708627157605870499188&nbsp;;&nbsp;0.012196704989693764053654538465&nbsp;;&nbsp;0.012199428828625117371582840212&nbsp;;&nbsp;0.01220033681998614507777289232&nbsp;;<br>
&nbsp;0.012199428828625117371582840212&nbsp;;&nbsp;0.012196704989693764053654538465&nbsp;;&nbsp;0.012192165708627157605870499188&nbsp;;&nbsp;0.012185811661083365425569178819&nbsp;;&nbsp;0.012177643792842880196606249581&nbsp;;<br>
&nbsp;0.012167663319667843366755737416&nbsp;;&nbsp;0.012155871727121082685623083829&nbsp;;&nbsp;0.012142270770344990738801546574&nbsp;;&nbsp;0.012126862473800277391553601370&nbsp;;&nbsp;0.012109649130964635027950450318&nbsp;;<br>
&nbsp;0.012090633303991361438266420912&nbsp;;&nbsp;0.012069817823327991167612855626&nbsp;;&nbsp;0.012047205787294992091420946532&nbsp;;&nbsp;0.012022800561624589927558893338&nbsp;;&nbsp;0.011996605778959789329711050159&nbsp;;<br>
&nbsp;0.011968625338313666131272065445&nbsp;;&nbsp;0.011938863404489011222535627643&nbsp;;&nbsp;0.011907324407458412445505183140&nbsp;;&nbsp;0.011874013041704866779344562066&nbsp;;&nbsp;0.011838934265523020964443424791&nbsp;;<br>
&nbsp;0.011802093300281144573421477037&nbsp;;&nbsp;0.011763495629643945382264331878&nbsp;;&nbsp;0.011723146998756342723302879656&nbsp;;&nbsp;0.011681053413388320313049670635&nbsp;;&nbsp;0.011637221139040985841125311445&nbsp;;<br>
&nbsp;0.011591656700013970380783131035&nbsp;;&nbsp;0.011544366878434306436012137033&nbsp;;&nbsp;0.011495358713246929174010288914&nbsp;;&nbsp;0.011444639499166951104119199270&nbsp;;&nbsp;0.011392216785593866154247619654&nbsp;;<br>
&nbsp;0.0113380983754878447625379269120&nbsp;;&nbsp;0.0112822923242082872447042603128&nbsp;;&nbsp;0.0112248069383148083152535688671&nbsp;;&nbsp;0.0111656507743308312328559850485&nbsp;;&nbsp;0.0111048326374699756056269264803&nbsp;;<br>
&nbsp;0.0110423615803254284301924654946&nbsp;;&nbsp;0.0109782469015224934483083029166&nbsp;;&nbsp;0.0109124981443345193856719616965&nbsp;;&nbsp;0.0108451250952624130885928632830&nbsp;;&nbsp;0.0107761377825779489945556541150&nbsp;;<br>
&nbsp;0.0107055464748310917616231511294&nbsp;;&nbsp;0.0106333616793215542382761147904&nbsp;;&nbsp;0.0105595941405348182788823332058&nbsp;;&nbsp;0.0104842548385428511997370260353&nbsp;;&nbsp;0.0104073549873697559257355517893&nbsp;;<br>
&nbsp;0.0103289060333225980974485876288&nbsp;;&nbsp;0.0102489196532876585918958554047&nbsp;;&nbsp;0.0101674077529923650568895461852&nbsp;;&nbsp;0.0100843824652331611676814627839&nbsp;;&nbsp;0.0099998561480695773850435626986&nbsp;;<br>
&nbsp;0.0099138413829847720250916955489&nbsp;;&nbsp;0.0098263509730128164423854701706&nbsp;;&nbsp;0.0097373979408330030783691793250&nbsp;;&nbsp;0.0096469955268314600363329731559&nbsp;;&nbsp;0.0095551571871303607110514249099&nbsp;;<br>
&nbsp;0.0094618965915850218253881576301&nbsp;;&nbsp;0.0093672276217491880067391857021&nbsp;;&nbsp;0.0092711643688088057725325917169&nbsp;;&nbsp;0.0091737211314845944854270065178&nbsp;;&nbsp;0.0090749124139037264846862498962&nbsp;;<br>
&nbsp;0.0089747529234409331997949023068&nbsp;;&nbsp;0.0088732575685293586050755892934&nbsp;;&nbsp;0.0087704414564414858792445834744&nbsp;;&nbsp;0.0086663198910404675908861979240&nbsp;;&nbsp;0.0085609083705021941391459209280&nbsp;;<br>
&nbsp;0.0084542225850084395379670551258&nbsp;;&nbsp;0.0083462784144114279413811886655&nbsp;;&nbsp;0.0082370919258701685661946145361&nbsp;;&nbsp;0.0081266793714589108764118189068&nbsp;;&nbsp;0.0080150571857480760504667455353&nbsp;;<br>
&nbsp;0.0079022419833580248574070864277&nbsp;;&nbsp;0.0077882505564860261212726654404&nbsp;;&nbsp;0.0076730998724067939537782250476&nbsp;;&nbsp;0.0075568070709469658838993300454&nbsp;;&nbsp;0.0074393894619338979090297315972&nbsp;;<br>
&nbsp;0.0073208645226191563361371026044&nbsp;;&nbsp;0.0072012498950770900730828552207&nbsp;;&nbsp;0.0070805633835788707705149901066&nbsp;;&nbsp;0.0069588229519423919043121805236&nbsp;;&nbsp;0.0068360467208584215286561508406&nbsp;;<br>
&nbsp;0.0067122529651934070221351960200&nbsp;;&nbsp;0.0065874601112693336961737372300&nbsp;;&nbsp;0.0064616867341210426397202932350&nbsp;;&nbsp;0.0063349515547314166407936938524&nbsp;;&nbsp;0.0062072734372448464599330978665&nbsp;;<br>
&nbsp;0.0060786713861593931405204596709&nbsp;;&nbsp;0.0059491645434980654366600347567&nbsp;;&nbsp;0.0058187721859596348346566361185&nbsp;;&nbsp;0.0056875137220494140577838938236&nbsp;;&nbsp;0.0055554086891904284012033890901&nbsp;;<br>
&nbsp;0.0054224767508154127788846727083&nbsp;;&nbsp;0.0052887376934400710240953933529&nbsp;;&nbsp;0.0051542114237180378340642003713&nbsp;;&nbsp;0.0050189179654779878773297516544&nbsp;;&nbsp;0.0048828774567433411142588306018&nbsp;;<br>
&nbsp;0.0047461101467350184936945641585&nbsp;;&nbsp;0.0046086363928577081326523656522&nbsp;;&nbsp;0.0044704766576701092218388764046&nbsp;;&nbsp;0.0043316515058396297504806208252&nbsp;;&nbsp;0.0041921816010820254766367595011&nbsp;;<br>
&nbsp;0.0040520877030864825223229951262&nbsp;;&nbsp;0.0039113906644266662571543468015&nbsp;;&nbsp;0.0037701114274582873548537007645&nbsp;;&nbsp;0.0036282710212037760873102463983&nbsp;;&nbsp;0.0034858905582247143702551557840&nbsp;;<br>
&nbsp;0.0033429912314827618499065991316&nbsp;;&nbsp;0.0031995943111899437356540290142&nbsp;;&nbsp;0.0030557211416493711130936102459&nbsp;;&nbsp;0.0029113931380877846359302447381&nbsp;;&nbsp;0.0027666317834818283552560256501&nbsp;;<br>
&nbsp;0.0026214586253808109266552781372&nbsp;;&nbsp;0.0024758952727301488651840215879&nbsp;;&nbsp;0.0023299633927021828561308282641&nbsp;;&nbsp;0.0021836847075455253317921866057&nbsp;;&nbsp;0.0020370809914723626741694800322&nbsp;;<br>
&nbsp;0.0018901740676190104269878470891&nbsp;;&nbsp;0.0017429858051468299509941139300&nbsp;;&nbsp;0.0015955381166175133369701690235&nbsp;;&nbsp;0.0014478529559255120065233994722&nbsp;;&nbsp;0.0012999523174235227389668643832&nbsp;;<br>
&nbsp;0.0011518582377826677880963146741&nbsp;;&nbsp;0.00100359280467969441299468763292&nbsp;;&nbsp;0.00085517818446696565626595950963&nbsp;;&nbsp;0.00070663671051592291949335494247&nbsp;;&nbsp;0.00055799120546880640169677292533&nbsp;;<br>
&nbsp;0.00040926648283531339591138751432&nbsp;;&nbsp;0.00026049995580176964436806680831&nbsp;;&nbsp;0.00011191470145601756450862287886&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_1_x&nbsp;=&nbsp;[|&nbsp;0.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_1_w&nbsp;=&nbsp;[|&nbsp;2.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_3_x&nbsp;=&nbsp;[|&nbsp;-0.77459666924148337704&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.77459666924148337704&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_3_w&nbsp;=&nbsp;[|&nbsp;0.555555555555555555556&nbsp;;&nbsp;0.888888888888888888889&nbsp;;&nbsp;0.555555555555555555556&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_7_x&nbsp;=&nbsp;[|&nbsp;-0.96049126870802028342&nbsp;;&nbsp;-0.77459666924148337704&nbsp;;&nbsp;-0.43424374934680255800&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;0.43424374934680255800&nbsp;;&nbsp;0.77459666924148337704&nbsp;;&nbsp;0.96049126870802028342&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_7_w&nbsp;=&nbsp;[|&nbsp;0.104656226026467265194&nbsp;;&nbsp;0.268488089868333440729&nbsp;;&nbsp;0.401397414775962222905&nbsp;;<br>
&nbsp;0.450916538658474142345&nbsp;;&nbsp;0.401397414775962222905&nbsp;;&nbsp;0.268488089868333440729&nbsp;;&nbsp;0.104656226026467265194&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_15_x&nbsp;=&nbsp;[|&nbsp;-0.99383196321275502221&nbsp;;&nbsp;-0.96049126870802028342&nbsp;;&nbsp;-0.88845923287225699889&nbsp;;<br>
&nbsp;-0.77459666924148337704&nbsp;;&nbsp;-0.62110294673722640294&nbsp;;&nbsp;-0.43424374934680255800&nbsp;;&nbsp;-0.22338668642896688163&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;&nbsp;0.22338668642896688163&nbsp;;&nbsp;&nbsp;0.43424374934680255800&nbsp;;&nbsp;&nbsp;0.62110294673722640294&nbsp;;<br>
&nbsp;0.77459666924148337704&nbsp;;&nbsp;&nbsp;0.88845923287225699889&nbsp;;&nbsp;&nbsp;0.96049126870802028342&nbsp;;&nbsp;&nbsp;0.99383196321275502221&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_15_w&nbsp;=&nbsp;[|&nbsp;0.0170017196299402603390&nbsp;;&nbsp;0.0516032829970797396969&nbsp;;&nbsp;&nbsp;0.0929271953151245376859&nbsp;;<br>
&nbsp;0.134415255243784220360&nbsp;;&nbsp;0.171511909136391380787&nbsp;;&nbsp;0.200628529376989021034&nbsp;;&nbsp;0.219156858401587496404&nbsp;;<br>
&nbsp;0.225510499798206687386&nbsp;;&nbsp;0.219156858401587496404&nbsp;;&nbsp;0.200628529376989021034&nbsp;;&nbsp;0.171511909136391380787&nbsp;;&nbsp;<br>
&nbsp;0.134415255243784220360&nbsp;;&nbsp;0.0929271953151245376859&nbsp;;&nbsp;0.0516032829970797396969&nbsp;;&nbsp;0.0170017196299402603390&nbsp;|]&nbsp;;;&nbsp;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_31_x&nbsp;=&nbsp;[|&nbsp;-0.99909812496766759766&nbsp;;&nbsp;-0.99383196321275502221&nbsp;;&nbsp;-0.98153114955374010687&nbsp;;<br>
&nbsp;-0.96049126870802028342&nbsp;;&nbsp;-0.92965485742974005667&nbsp;;&nbsp;-0.88845923287225699889&nbsp;;&nbsp;-0.83672593816886873550&nbsp;;<br>
&nbsp;-0.77459666924148337704&nbsp;;&nbsp;-0.70249620649152707861&nbsp;;&nbsp;-0.62110294673722640294&nbsp;;&nbsp;-0.53131974364437562397&nbsp;;<br>
&nbsp;-0.43424374934680255800&nbsp;;&nbsp;-0.33113539325797683309&nbsp;;&nbsp;-0.22338668642896688163&nbsp;;&nbsp;-0.11248894313318662575&nbsp;;&nbsp;<br>
&nbsp;0.0&nbsp;;&nbsp;0.11248894313318662575&nbsp;;&nbsp;0.22338668642896688163&nbsp;;&nbsp;0.33113539325797683309&nbsp;;&nbsp;0.43424374934680255800&nbsp;;<br>
&nbsp;0.53131974364437562397&nbsp;;&nbsp;0.62110294673722640294&nbsp;;&nbsp;0.70249620649152707861&nbsp;;&nbsp;0.77459666924148337704&nbsp;;<br>
&nbsp;0.83672593816886873550&nbsp;;&nbsp;0.88845923287225699889&nbsp;;&nbsp;0.92965485742974005667&nbsp;;&nbsp;0.96049126870802028342&nbsp;;&nbsp;<br>
&nbsp;0.98153114955374010687&nbsp;;&nbsp;0.99383196321275502221&nbsp;;&nbsp;0.99909812496766759766&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_31_w&nbsp;=&nbsp;[|&nbsp;0.00254478079156187441540&nbsp;;&nbsp;0.00843456573932110624631&nbsp;;&nbsp;0.0164460498543878109338&nbsp;;<br>
&nbsp;0.0258075980961766535646&nbsp;;&nbsp;0.0359571033071293220968&nbsp;;&nbsp;0.0464628932617579865414&nbsp;;&nbsp;0.0569795094941233574122&nbsp;;<br>
&nbsp;0.0672077542959907035404&nbsp;;&nbsp;0.0768796204990035310427&nbsp;;&nbsp;0.0857559200499903511542&nbsp;;&nbsp;0.0936271099812644736167&nbsp;;<br>
&nbsp;0.100314278611795578771&nbsp;;&nbsp;0.105669893580234809744&nbsp;;&nbsp;0.109578421055924638237&nbsp;;&nbsp;0.111956873020953456880&nbsp;;<br>
&nbsp;0.112755256720768691607&nbsp;;&nbsp;0.111956873020953456880&nbsp;;&nbsp;0.109578421055924638237&nbsp;;&nbsp;0.105669893580234809744&nbsp;;<br>
&nbsp;0.100314278611795578771&nbsp;;&nbsp;0.0936271099812644736167&nbsp;;&nbsp;0.0857559200499903511542&nbsp;;&nbsp;0.0768796204990035310427&nbsp;;<br>
&nbsp;0.0672077542959907035404&nbsp;;&nbsp;0.0569795094941233574122&nbsp;;&nbsp;0.0464628932617579865414&nbsp;;&nbsp;0.0359571033071293220968&nbsp;;<br>
&nbsp;0.0258075980961766535646&nbsp;;&nbsp;0.0164460498543878109338&nbsp;;&nbsp;0.00843456573932110624631&nbsp;;&nbsp;0.00254478079156187441540&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_63_x&nbsp;=&nbsp;[|&nbsp;-0.99987288812035761194&nbsp;;&nbsp;-0.99909812496766759766&nbsp;;&nbsp;-0.99720625937222195908&nbsp;;<br>
&nbsp;-0.99383196321275502221&nbsp;;&nbsp;-0.98868475754742947994&nbsp;;&nbsp;-0.98153114955374010687&nbsp;;&nbsp;-0.97218287474858179658&nbsp;;<br>
&nbsp;-0.96049126870802028342&nbsp;;&nbsp;-0.94634285837340290515&nbsp;;&nbsp;-0.92965485742974005667&nbsp;;&nbsp;-0.91037115695700429250&nbsp;;<br>
&nbsp;-0.88845923287225699889&nbsp;;&nbsp;-0.86390793819369047715&nbsp;;&nbsp;-0.83672593816886873550&nbsp;;&nbsp;-0.80694053195021761186&nbsp;;<br>
&nbsp;-0.77459666924148337704&nbsp;;&nbsp;-0.73975604435269475868&nbsp;;&nbsp;-0.70249620649152707861&nbsp;;&nbsp;-0.66290966002478059546&nbsp;;<br>
&nbsp;-0.62110294673722640294&nbsp;;&nbsp;-0.57719571005204581484&nbsp;;&nbsp;-0.53131974364437562397&nbsp;;&nbsp;-0.48361802694584102756&nbsp;;<br>
&nbsp;-0.43424374934680255800&nbsp;;&nbsp;-0.38335932419873034692&nbsp;;&nbsp;-0.33113539325797683309&nbsp;;&nbsp;-0.27774982202182431507&nbsp;;<br>
&nbsp;-0.22338668642896688163&nbsp;;&nbsp;-0.16823525155220746498&nbsp;;&nbsp;-0.11248894313318662575&nbsp;;&nbsp;-0.056344313046592789972&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;0.056344313046592789972&nbsp;;&nbsp;0.11248894313318662575&nbsp;;&nbsp;0.16823525155220746498&nbsp;;&nbsp;0.22338668642896688163&nbsp;;<br>
&nbsp;0.27774982202182431507&nbsp;;&nbsp;0.33113539325797683309&nbsp;;&nbsp;0.38335932419873034692&nbsp;;&nbsp;0.43424374934680255800&nbsp;;<br>
&nbsp;0.48361802694584102756&nbsp;;&nbsp;0.53131974364437562397&nbsp;;&nbsp;0.57719571005204581484&nbsp;;&nbsp;0.62110294673722640294&nbsp;;<br>
&nbsp;0.66290966002478059546&nbsp;;&nbsp;0.70249620649152707861&nbsp;;&nbsp;0.73975604435269475868&nbsp;;&nbsp;0.77459666924148337704&nbsp;;<br>
&nbsp;0.80694053195021761186&nbsp;;&nbsp;0.83672593816886873550&nbsp;;&nbsp;0.86390793819369047715&nbsp;;&nbsp;0.88845923287225699889&nbsp;;<br>
&nbsp;0.91037115695700429250&nbsp;;&nbsp;0.92965485742974005667&nbsp;;&nbsp;0.94634285837340290515&nbsp;;&nbsp;0.96049126870802028342&nbsp;;<br>
&nbsp;0.97218287474858179658&nbsp;;&nbsp;0.98153114955374010687&nbsp;;&nbsp;0.98868475754742947994&nbsp;;&nbsp;0.99383196321275502221&nbsp;;<br>
&nbsp;0.99720625937222195908&nbsp;;&nbsp;0.99909812496766759766&nbsp;;&nbsp;0.99987288812035761194&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_63_w&nbsp;=&nbsp;[|&nbsp;0.000363221481845530659694&nbsp;;&nbsp;0.00126515655623006801137&nbsp;;&nbsp;0.00257904979468568827243&nbsp;;<br>
&nbsp;0.00421763044155885483908&nbsp;;&nbsp;0.00611550682211724633968&nbsp;;&nbsp;0.00822300795723592966926&nbsp;;&nbsp;0.0104982469096213218983&nbsp;;<br>
&nbsp;0.0129038001003512656260&nbsp;;&nbsp;0.0154067504665594978021&nbsp;;&nbsp;0.0179785515681282703329&nbsp;;&nbsp;0.0205942339159127111492&nbsp;;<br>
&nbsp;0.0232314466399102694433&nbsp;;&nbsp;0.0258696793272147469108&nbsp;;&nbsp;0.0284897547458335486125&nbsp;;&nbsp;0.0310735511116879648799&nbsp;;<br>
&nbsp;0.0336038771482077305417&nbsp;;&nbsp;0.0360644327807825726401&nbsp;;&nbsp;0.0384398102494555320386&nbsp;;&nbsp;0.0407155101169443189339&nbsp;;<br>
&nbsp;0.0428779600250077344929&nbsp;;&nbsp;0.0449145316536321974143&nbsp;;&nbsp;0.0468135549906280124026&nbsp;;&nbsp;0.0485643304066731987159&nbsp;;<br>
&nbsp;0.0501571393058995374137&nbsp;;&nbsp;0.0515832539520484587768&nbsp;;&nbsp;0.0528349467901165198621&nbsp;;&nbsp;0.0539054993352660639269&nbsp;;<br>
&nbsp;0.0547892105279628650322&nbsp;;&nbsp;0.0554814043565593639878&nbsp;;&nbsp;0.0559784365104763194076&nbsp;;&nbsp;0.0562776998312543012726&nbsp;;<br>
&nbsp;0.0563776283603847173877&nbsp;;&nbsp;0.0562776998312543012726&nbsp;;&nbsp;0.0559784365104763194076&nbsp;;&nbsp;0.0554814043565593639878&nbsp;;<br>
&nbsp;0.0547892105279628650322&nbsp;;&nbsp;0.0539054993352660639269&nbsp;;&nbsp;0.0528349467901165198621&nbsp;;&nbsp;0.0515832539520484587768&nbsp;;<br>
&nbsp;0.0501571393058995374137&nbsp;;&nbsp;0.0485643304066731987159&nbsp;;&nbsp;0.0468135549906280124026&nbsp;;&nbsp;0.0449145316536321974143&nbsp;;<br>
&nbsp;0.0428779600250077344929&nbsp;;&nbsp;0.0407155101169443189339&nbsp;;&nbsp;0.0384398102494555320386&nbsp;;&nbsp;0.0360644327807825726401&nbsp;;<br>
&nbsp;0.0336038771482077305417&nbsp;;&nbsp;0.0310735511116879648799&nbsp;;&nbsp;0.0284897547458335486125&nbsp;;&nbsp;0.0258696793272147469108&nbsp;;<br>
&nbsp;0.0232314466399102694433&nbsp;;&nbsp;0.0205942339159127111492&nbsp;;&nbsp;0.0179785515681282703329&nbsp;;&nbsp;0.0154067504665594978021&nbsp;;<br>
&nbsp;0.0129038001003512656260&nbsp;;&nbsp;0.0104982469096213218983&nbsp;;&nbsp;0.00822300795723592966926&nbsp;;&nbsp;0.00611550682211724633968&nbsp;;<br>
&nbsp;0.00421763044155885483908&nbsp;;&nbsp;0.00257904979468568827243&nbsp;;&nbsp;0.00126515655623006801137&nbsp;;&nbsp;0.000363221481845530659694&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_127_x&nbsp;=&nbsp;[|&nbsp;-0.99998243035489159858&nbsp;;&nbsp;-0.99987288812035761194&nbsp;;&nbsp;-0.99959879967191068325&nbsp;;<br>
&nbsp;-0.99909812496766759766&nbsp;;&nbsp;-0.99831663531840739253&nbsp;;&nbsp;-0.99720625937222195908&nbsp;;&nbsp;-0.99572410469840718851&nbsp;;<br>
&nbsp;-0.99383196321275502221&nbsp;;&nbsp;-0.99149572117810613240&nbsp;;&nbsp;-0.98868475754742947994&nbsp;;&nbsp;-0.98537149959852037111&nbsp;;<br>
&nbsp;-0.98153114955374010687&nbsp;;&nbsp;-0.97714151463970571416&nbsp;;&nbsp;-0.97218287474858179658&nbsp;;&nbsp;-0.96663785155841656709&nbsp;;<br>
&nbsp;-0.96049126870802028342&nbsp;;&nbsp;-0.95373000642576113641&nbsp;;&nbsp;-0.94634285837340290515&nbsp;;&nbsp;-0.93832039777959288365&nbsp;;<br>
&nbsp;-0.92965485742974005667&nbsp;;&nbsp;-0.92034002547001242073&nbsp;;&nbsp;-0.91037115695700429250&nbsp;;&nbsp;-0.89974489977694003664&nbsp;;<br>
&nbsp;-0.88845923287225699889&nbsp;;&nbsp;-0.87651341448470526974&nbsp;;&nbsp;-0.86390793819369047715&nbsp;;&nbsp;-0.85064449476835027976&nbsp;;<br>
&nbsp;-0.83672593816886873550&nbsp;;&nbsp;-0.82215625436498040737&nbsp;;&nbsp;-0.80694053195021761186&nbsp;;&nbsp;-0.79108493379984836143&nbsp;;<br>
&nbsp;-0.77459666924148337704&nbsp;;&nbsp;-0.75748396638051363793&nbsp;;&nbsp;-0.73975604435269475868&nbsp;;&nbsp;-0.72142308537009891548&nbsp;;<br>
&nbsp;-0.70249620649152707861&nbsp;;&nbsp;-0.68298743109107922809&nbsp;;&nbsp;-0.66290966002478059546&nbsp;;&nbsp;-0.64227664250975951377&nbsp;;<br>
&nbsp;-0.62110294673722640294&nbsp;;&nbsp;-0.59940393024224289297&nbsp;;&nbsp;-0.57719571005204581484&nbsp;;&nbsp;-0.55449513263193254887&nbsp;;<br>
&nbsp;-0.53131974364437562397&nbsp;;&nbsp;-0.50768775753371660215&nbsp;;&nbsp;-0.48361802694584102756&nbsp;;&nbsp;-0.45913001198983233287&nbsp;;<br>
&nbsp;-0.43424374934680255800&nbsp;;&nbsp;-0.40897982122988867241&nbsp;;&nbsp;-0.38335932419873034692&nbsp;;&nbsp;-0.35740383783153215238&nbsp;;<br>
&nbsp;-0.33113539325797683309&nbsp;;&nbsp;-0.30457644155671404334&nbsp;;&nbsp;-0.27774982202182431507&nbsp;;&nbsp;-0.25067873030348317661&nbsp;;<br>
&nbsp;-0.22338668642896688163&nbsp;;&nbsp;-0.19589750271110015392&nbsp;;&nbsp;-0.16823525155220746498&nbsp;;&nbsp;-0.14042423315256017459&nbsp;;<br>
&nbsp;-0.11248894313318662575&nbsp;;&nbsp;-0.084454040083710883710&nbsp;;&nbsp;-0.056344313046592789972&nbsp;;&nbsp;-0.028184648949745694339&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;0.028184648949745694339&nbsp;;&nbsp;0.056344313046592789972&nbsp;;&nbsp;0.084454040083710883710&nbsp;;&nbsp;0.11248894313318662575&nbsp;;<br>
&nbsp;0.14042423315256017459&nbsp;;&nbsp;0.16823525155220746498&nbsp;;&nbsp;0.19589750271110015392&nbsp;;&nbsp;0.22338668642896688163&nbsp;;<br>
&nbsp;0.25067873030348317661&nbsp;;&nbsp;0.27774982202182431507&nbsp;;&nbsp;0.30457644155671404334&nbsp;;&nbsp;0.33113539325797683309&nbsp;;<br>
&nbsp;0.35740383783153215238&nbsp;;&nbsp;0.38335932419873034692&nbsp;;&nbsp;0.40897982122988867241&nbsp;;&nbsp;0.43424374934680255800&nbsp;;<br>
&nbsp;0.45913001198983233287&nbsp;;&nbsp;0.48361802694584102756&nbsp;;&nbsp;0.50768775753371660215&nbsp;;&nbsp;0.53131974364437562397&nbsp;;<br>
&nbsp;0.55449513263193254887&nbsp;;&nbsp;0.57719571005204581484&nbsp;;&nbsp;0.59940393024224289297&nbsp;;&nbsp;0.62110294673722640294&nbsp;;<br>
&nbsp;0.64227664250975951377&nbsp;;&nbsp;0.66290966002478059546&nbsp;;&nbsp;0.68298743109107922809&nbsp;;&nbsp;0.70249620649152707861&nbsp;;<br>
&nbsp;0.72142308537009891548&nbsp;;&nbsp;0.73975604435269475868&nbsp;;&nbsp;0.75748396638051363793&nbsp;;&nbsp;0.77459666924148337704&nbsp;;<br>
&nbsp;0.79108493379984836143&nbsp;;&nbsp;0.80694053195021761186&nbsp;;&nbsp;0.82215625436498040737&nbsp;;&nbsp;0.83672593816886873550&nbsp;;<br>
&nbsp;0.85064449476835027976&nbsp;;&nbsp;0.86390793819369047715&nbsp;;&nbsp;0.87651341448470526974&nbsp;;&nbsp;0.88845923287225699889&nbsp;;<br>
&nbsp;0.89974489977694003664&nbsp;;&nbsp;0.91037115695700429250&nbsp;;&nbsp;0.92034002547001242073&nbsp;;&nbsp;0.92965485742974005667&nbsp;;<br>
&nbsp;0.93832039777959288365&nbsp;;&nbsp;0.94634285837340290515&nbsp;;&nbsp;0.95373000642576113641&nbsp;;&nbsp;0.96049126870802028342&nbsp;;<br>
&nbsp;0.96663785155841656709&nbsp;;&nbsp;0.97218287474858179658&nbsp;;&nbsp;0.97714151463970571416&nbsp;;&nbsp;0.98153114955374010687&nbsp;;<br>
&nbsp;0.98537149959852037111&nbsp;;&nbsp;0.98868475754742947994&nbsp;;&nbsp;0.99149572117810613240&nbsp;;&nbsp;0.99383196321275502221&nbsp;;<br>
&nbsp;0.99572410469840718851&nbsp;;&nbsp;0.99720625937222195908&nbsp;;&nbsp;0.99831663531840739253&nbsp;;&nbsp;0.99909812496766759766&nbsp;;<br>
&nbsp;0.99959879967191068325&nbsp;;&nbsp;0.99987288812035761194&nbsp;;&nbsp;0.99998243035489159858&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_127_w&nbsp;=&nbsp;[|&nbsp;0.0000505360952078625176247&nbsp;;&nbsp;0.000180739564445388357820&nbsp;;&nbsp;0.000377746646326984660274&nbsp;;<br>
&nbsp;0.000632607319362633544219&nbsp;;&nbsp;0.000938369848542381500794&nbsp;;&nbsp;0.00128952408261041739210&nbsp;;&nbsp;0.00168114286542146990631&nbsp;;<br>
&nbsp;0.00210881524572663287933&nbsp;;&nbsp;0.00256876494379402037313&nbsp;;&nbsp;0.00305775341017553113613&nbsp;;&nbsp;0.00357289278351729964938&nbsp;;<br>
&nbsp;0.00411150397865469304717&nbsp;;&nbsp;0.00467105037211432174741&nbsp;;&nbsp;0.00524912345480885912513&nbsp;;&nbsp;0.00584344987583563950756&nbsp;;<br>
&nbsp;0.00645190005017573692280&nbsp;;&nbsp;0.00707248999543355546805&nbsp;;&nbsp;0.00770337523327974184817&nbsp;;&nbsp;0.00834283875396815770558&nbsp;;<br>
&nbsp;0.00898927578406413572328&nbsp;;&nbsp;0.00964117772970253669530&nbsp;;&nbsp;0.0102971169579563555237&nbsp;;&nbsp;0.0109557333878379016480&nbsp;;<br>
&nbsp;0.0116157233199551347270&nbsp;;&nbsp;0.0122758305600827700870&nbsp;;&nbsp;0.0129348396636073734547&nbsp;;&nbsp;0.0135915710097655467896&nbsp;;<br>
&nbsp;0.0142448773729167743063&nbsp;;&nbsp;0.0148936416648151820348&nbsp;;&nbsp;0.0155367755558439824399&nbsp;;&nbsp;0.0161732187295777199419&nbsp;;<br>
&nbsp;0.0168019385741038652709&nbsp;;&nbsp;0.0174219301594641737472&nbsp;;&nbsp;0.0180322163903912863201&nbsp;;&nbsp;0.0186318482561387901863&nbsp;;<br>
&nbsp;0.0192199051247277660193&nbsp;;&nbsp;0.0197954950480974994880&nbsp;;&nbsp;0.0203577550584721594669&nbsp;;&nbsp;0.0209058514458120238522&nbsp;;<br>
&nbsp;0.0214389800125038672465&nbsp;;&nbsp;0.0219563663053178249393&nbsp;;&nbsp;0.0224572658268160987071&nbsp;;&nbsp;0.0229409642293877487608&nbsp;;<br>
&nbsp;0.0234067774953140062013&nbsp;;&nbsp;0.0238540521060385400804&nbsp;;&nbsp;0.0242821652033365993580&nbsp;;&nbsp;0.0246905247444876769091&nbsp;;<br>
&nbsp;0.0250785696529497687068&nbsp;;&nbsp;0.0254457699654647658126&nbsp;;&nbsp;0.0257916269760242293884&nbsp;;&nbsp;0.0261156733767060976805&nbsp;;<br>
&nbsp;0.0264174733950582599310&nbsp;;&nbsp;0.0266966229274503599062&nbsp;;&nbsp;0.0269527496676330319634&nbsp;;&nbsp;0.0271855132296247918192&nbsp;;<br>
&nbsp;0.0273946052639814325161&nbsp;;&nbsp;0.0275797495664818730349&nbsp;;&nbsp;0.0277407021782796819939&nbsp;;&nbsp;0.0278772514766137016085&nbsp;;<br>
&nbsp;0.0279892182552381597038&nbsp;;&nbsp;0.0280764557938172466068&nbsp;;&nbsp;0.0281388499156271506363&nbsp;;&nbsp;0.0281763190330166021307&nbsp;;<br>
&nbsp;0.0281888141801923586938&nbsp;;&nbsp;0.0281763190330166021307&nbsp;;&nbsp;0.0281388499156271506363&nbsp;;&nbsp;0.0280764557938172466068&nbsp;;<br>
&nbsp;0.0279892182552381597038&nbsp;;&nbsp;0.0278772514766137016085&nbsp;;&nbsp;0.0277407021782796819939&nbsp;;&nbsp;0.0275797495664818730349&nbsp;;<br>
&nbsp;0.0273946052639814325161&nbsp;;&nbsp;0.0271855132296247918192&nbsp;;&nbsp;0.0269527496676330319634&nbsp;;&nbsp;0.0266966229274503599062&nbsp;;<br>
&nbsp;0.0264174733950582599310&nbsp;;&nbsp;0.0261156733767060976805&nbsp;;&nbsp;0.0257916269760242293884&nbsp;;&nbsp;0.0254457699654647658126&nbsp;;<br>
&nbsp;0.0250785696529497687068&nbsp;;&nbsp;0.0246905247444876769091&nbsp;;&nbsp;0.0242821652033365993580&nbsp;;&nbsp;0.0238540521060385400804&nbsp;;<br>
&nbsp;0.0234067774953140062013&nbsp;;&nbsp;0.0229409642293877487608&nbsp;;&nbsp;0.0224572658268160987071&nbsp;;&nbsp;0.0219563663053178249393&nbsp;;<br>
&nbsp;0.0214389800125038672465&nbsp;;&nbsp;0.0209058514458120238522&nbsp;;&nbsp;0.0203577550584721594669&nbsp;;&nbsp;0.0197954950480974994880&nbsp;;<br>
&nbsp;0.0192199051247277660193&nbsp;;&nbsp;0.0186318482561387901863&nbsp;;&nbsp;0.0180322163903912863201&nbsp;;&nbsp;0.0174219301594641737472&nbsp;;<br>
&nbsp;0.0168019385741038652709&nbsp;;&nbsp;0.0161732187295777199419&nbsp;;&nbsp;0.0155367755558439824399&nbsp;;&nbsp;0.0148936416648151820348&nbsp;;<br>
&nbsp;0.0142448773729167743063&nbsp;;&nbsp;0.0135915710097655467896&nbsp;;&nbsp;0.0129348396636073734547&nbsp;;&nbsp;0.0122758305600827700870&nbsp;;<br>
&nbsp;0.0116157233199551347270&nbsp;;&nbsp;0.0109557333878379016480&nbsp;;&nbsp;0.0102971169579563555237&nbsp;;&nbsp;0.00964117772970253669530&nbsp;;<br>
&nbsp;0.00898927578406413572328&nbsp;;&nbsp;0.00834283875396815770558&nbsp;;&nbsp;0.00770337523327974184817&nbsp;;&nbsp;0.00707248999543355546805&nbsp;;<br>
&nbsp;0.00645190005017573692280&nbsp;;&nbsp;0.00584344987583563950756&nbsp;;&nbsp;0.00524912345480885912513&nbsp;;&nbsp;0.00467105037211432174741&nbsp;;<br>
&nbsp;0.00411150397865469304717&nbsp;;&nbsp;0.00357289278351729964938&nbsp;;&nbsp;0.00305775341017553113613&nbsp;;&nbsp;0.00256876494379402037313&nbsp;;<br>
&nbsp;0.00210881524572663287933&nbsp;;&nbsp;0.00168114286542146990631&nbsp;;&nbsp;0.00128952408261041739210&nbsp;;&nbsp;0.000938369848542381500794&nbsp;;<br>
&nbsp;0.000632607319362633544219&nbsp;;&nbsp;0.000377746646326984660274&nbsp;;&nbsp;0.000180739564445388357820&nbsp;;&nbsp;0.0000505360952078625176247&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_255_x&nbsp;=&nbsp;[|&nbsp;-0.99999759637974846462&nbsp;;&nbsp;-0.99998243035489159858&nbsp;;&nbsp;-0.99994399620705437576&nbsp;;&nbsp;-0.99987288812035761194&nbsp;;<br>
&nbsp;-0.99976049092443204733&nbsp;;&nbsp;-0.99959879967191068325&nbsp;;&nbsp;-0.99938033802502358193&nbsp;;&nbsp;-0.99909812496766759766&nbsp;;&nbsp;-0.99874561446809511470&nbsp;;<br>
&nbsp;-0.99831663531840739253&nbsp;;&nbsp;-0.99780535449595727456&nbsp;;&nbsp;-0.99720625937222195908&nbsp;;&nbsp;-0.99651414591489027385&nbsp;;&nbsp;-0.99572410469840718851&nbsp;;<br>
&nbsp;-0.99483150280062100052&nbsp;;&nbsp;-0.99383196321275502221&nbsp;;&nbsp;-0.99272134428278861533&nbsp;;&nbsp;-0.99149572117810613240&nbsp;;&nbsp;-0.99015137040077015918&nbsp;;<br>
&nbsp;-0.98868475754742947994&nbsp;;&nbsp;-0.98709252795403406719&nbsp;;&nbsp;-0.98537149959852037111&nbsp;;&nbsp;-0.98351865757863272876&nbsp;;&nbsp;-0.98153114955374010687&nbsp;;<br>
&nbsp;-0.97940628167086268381&nbsp;;&nbsp;-0.97714151463970571416&nbsp;;&nbsp;-0.97473445975240266776&nbsp;;&nbsp;-0.97218287474858179658&nbsp;;&nbsp;-0.96948465950245923177&nbsp;;<br>
&nbsp;-0.96663785155841656709&nbsp;;&nbsp;-0.96364062156981213252&nbsp;;&nbsp;-0.96049126870802028342&nbsp;;&nbsp;-0.95718821610986096274&nbsp;;&nbsp;-0.95373000642576113641&nbsp;;<br>
&nbsp;-0.95011529752129487656&nbsp;;&nbsp;-0.94634285837340290515&nbsp;;&nbsp;-0.94241156519108305981&nbsp;;&nbsp;-0.93832039777959288365&nbsp;;&nbsp;-0.93406843615772578800&nbsp;;<br>
&nbsp;-0.92965485742974005667&nbsp;;&nbsp;-0.92507893290707565236&nbsp;;&nbsp;-0.92034002547001242073&nbsp;;&nbsp;-0.91543758715576504064&nbsp;;&nbsp;-0.91037115695700429250&nbsp;;<br>
&nbsp;-0.90514035881326159519&nbsp;;&nbsp;-0.89974489977694003664&nbsp;;&nbsp;-0.89418456833555902286&nbsp;;&nbsp;-0.88845923287225699889&nbsp;;&nbsp;-0.88256884024734190684&nbsp;;<br>
&nbsp;-0.87651341448470526974&nbsp;;&nbsp;-0.87029305554811390585&nbsp;;&nbsp;-0.86390793819369047715&nbsp;;&nbsp;-0.85735831088623215653&nbsp;;&nbsp;-0.85064449476835027976&nbsp;;<br>
&nbsp;-0.84376688267270860104&nbsp;;&nbsp;-0.83672593816886873550&nbsp;;&nbsp;-0.82952219463740140018&nbsp;;&nbsp;-0.82215625436498040737&nbsp;;&nbsp;-0.81462878765513741344&nbsp;;<br>
&nbsp;-0.80694053195021761186&nbsp;;&nbsp;-0.79909229096084140180&nbsp;;&nbsp;-0.79108493379984836143&nbsp;;&nbsp;-0.78291939411828301639&nbsp;;&nbsp;-0.77459666924148337704&nbsp;;<br>
&nbsp;-0.76611781930376009072&nbsp;;&nbsp;-0.75748396638051363793&nbsp;;&nbsp;-0.74869629361693660282&nbsp;;&nbsp;-0.73975604435269475868&nbsp;;&nbsp;-0.73066452124218126133&nbsp;;<br>
&nbsp;-0.72142308537009891548&nbsp;;&nbsp;-0.71203315536225203459&nbsp;;&nbsp;-0.70249620649152707861&nbsp;;&nbsp;-0.69281376977911470289&nbsp;;&nbsp;-0.68298743109107922809&nbsp;;<br>
&nbsp;-0.67301883023041847920&nbsp;;&nbsp;-0.66290966002478059546&nbsp;;&nbsp;-0.65266166541001749610&nbsp;;&nbsp;-0.64227664250975951377&nbsp;;&nbsp;-0.63175643771119423041&nbsp;;<br>
&nbsp;-0.62110294673722640294&nbsp;;&nbsp;-0.61031811371518640016&nbsp;;&nbsp;-0.59940393024224289297&nbsp;;&nbsp;-0.58836243444766254143&nbsp;;&nbsp;-0.57719571005204581484&nbsp;;<br>
&nbsp;-0.56590588542365442262&nbsp;;&nbsp;-0.55449513263193254887&nbsp;;&nbsp;-0.54296566649831149049&nbsp;;&nbsp;-0.53131974364437562397&nbsp;;&nbsp;-0.51955966153745702199&nbsp;;<br>
&nbsp;-0.50768775753371660215&nbsp;;&nbsp;-0.49570640791876146017&nbsp;;&nbsp;-0.48361802694584102756&nbsp;;&nbsp;-0.47142506587165887693&nbsp;;&nbsp;-0.45913001198983233287&nbsp;;<br>
&nbsp;-0.44673538766202847374&nbsp;;&nbsp;-0.43424374934680255800&nbsp;;&nbsp;-0.42165768662616330006&nbsp;;&nbsp;-0.40897982122988867241&nbsp;;&nbsp;-0.39621280605761593918&nbsp;;<br>
&nbsp;-0.38335932419873034692&nbsp;;&nbsp;-0.37042208795007823014&nbsp;;&nbsp;-0.35740383783153215238&nbsp;;&nbsp;-0.34430734159943802278&nbsp;;&nbsp;-0.33113539325797683309&nbsp;;<br>
&nbsp;-0.31789081206847668318&nbsp;;&nbsp;-0.30457644155671404334&nbsp;;&nbsp;-0.29119514851824668196&nbsp;;&nbsp;-0.27774982202182431507&nbsp;;&nbsp;-0.26424337241092676194&nbsp;;<br>
&nbsp;-0.25067873030348317661&nbsp;;&nbsp;-0.23705884558982972721&nbsp;;&nbsp;-0.22338668642896688163&nbsp;;&nbsp;-0.20966523824318119477&nbsp;;&nbsp;-0.19589750271110015392&nbsp;;<br>
&nbsp;-0.18208649675925219825&nbsp;;&nbsp;-0.16823525155220746498&nbsp;;&nbsp;-0.15434681148137810869&nbsp;;&nbsp;-0.14042423315256017459&nbsp;;&nbsp;-0.12647058437230196685&nbsp;;<br>
&nbsp;-0.11248894313318662575&nbsp;;&nbsp;-0.098482396598119202090&nbsp;;&nbsp;-0.084454040083710883710&nbsp;;&nbsp;-0.070406976042855179063&nbsp;;&nbsp;-0.056344313046592789972&nbsp;;<br>
&nbsp;-0.042269164765363603212&nbsp;;&nbsp;-0.028184648949745694339&nbsp;;&nbsp;-0.014093886410782462614&nbsp;;&nbsp;&nbsp;0.0&nbsp;;&nbsp;&nbsp;0.014093886410782462614&nbsp;;&nbsp;&nbsp;0.028184648949745694339&nbsp;;<br>
&nbsp;0.042269164765363603212&nbsp;;&nbsp;&nbsp;0.056344313046592789972&nbsp;;&nbsp;&nbsp;0.070406976042855179063&nbsp;;&nbsp;&nbsp;0.084454040083710883710&nbsp;;&nbsp;&nbsp;0.098482396598119202090&nbsp;;&nbsp;<br>
&nbsp;0.11248894313318662575&nbsp;;&nbsp;&nbsp;0.12647058437230196685&nbsp;;&nbsp;&nbsp;0.14042423315256017459&nbsp;;&nbsp;&nbsp;0.15434681148137810869&nbsp;;&nbsp;&nbsp;0.16823525155220746498&nbsp;;<br>
&nbsp;0.18208649675925219825&nbsp;;&nbsp;&nbsp;0.19589750271110015392&nbsp;;&nbsp;&nbsp;0.20966523824318119477&nbsp;;&nbsp;&nbsp;0.22338668642896688163&nbsp;;&nbsp;&nbsp;0.23705884558982972721&nbsp;;<br>
&nbsp;0.25067873030348317661&nbsp;;&nbsp;&nbsp;0.26424337241092676194&nbsp;;&nbsp;&nbsp;0.27774982202182431507&nbsp;;&nbsp;&nbsp;0.29119514851824668196&nbsp;;&nbsp;&nbsp;0.30457644155671404334&nbsp;;<br>
&nbsp;0.31789081206847668318&nbsp;;&nbsp;&nbsp;0.33113539325797683309&nbsp;;&nbsp;&nbsp;0.34430734159943802278&nbsp;;&nbsp;&nbsp;0.35740383783153215238&nbsp;;&nbsp;&nbsp;0.37042208795007823014&nbsp;;<br>
&nbsp;0.38335932419873034692&nbsp;;&nbsp;&nbsp;0.39621280605761593918&nbsp;;&nbsp;&nbsp;0.40897982122988867241&nbsp;;&nbsp;&nbsp;0.42165768662616330006&nbsp;;&nbsp;&nbsp;0.43424374934680255800&nbsp;;<br>
&nbsp;0.44673538766202847374&nbsp;;&nbsp;&nbsp;0.45913001198983233287&nbsp;;&nbsp;&nbsp;0.47142506587165887693&nbsp;;&nbsp;&nbsp;0.48361802694584102756&nbsp;;&nbsp;&nbsp;0.49570640791876146017&nbsp;;<br>
&nbsp;0.50768775753371660215&nbsp;;&nbsp;&nbsp;0.51955966153745702199&nbsp;;&nbsp;&nbsp;0.53131974364437562397&nbsp;;&nbsp;&nbsp;0.54296566649831149049&nbsp;;&nbsp;&nbsp;0.55449513263193254887&nbsp;;<br>
&nbsp;0.56590588542365442262&nbsp;;&nbsp;&nbsp;0.57719571005204581484&nbsp;;&nbsp;&nbsp;0.58836243444766254143&nbsp;;&nbsp;&nbsp;0.59940393024224289297&nbsp;;&nbsp;&nbsp;0.61031811371518640016&nbsp;;<br>
&nbsp;0.62110294673722640294&nbsp;;&nbsp;&nbsp;0.63175643771119423041&nbsp;;&nbsp;&nbsp;0.64227664250975951377&nbsp;;&nbsp;&nbsp;0.65266166541001749610&nbsp;;&nbsp;&nbsp;0.66290966002478059546&nbsp;;<br>
&nbsp;0.67301883023041847920&nbsp;;&nbsp;&nbsp;0.68298743109107922809&nbsp;;&nbsp;&nbsp;0.69281376977911470289&nbsp;;&nbsp;&nbsp;0.70249620649152707861&nbsp;;&nbsp;&nbsp;0.71203315536225203459&nbsp;;<br>
&nbsp;0.72142308537009891548&nbsp;;&nbsp;&nbsp;0.73066452124218126133&nbsp;;&nbsp;&nbsp;0.73975604435269475868&nbsp;;&nbsp;&nbsp;0.74869629361693660282&nbsp;;&nbsp;&nbsp;0.75748396638051363793&nbsp;;<br>
&nbsp;0.76611781930376009072&nbsp;;&nbsp;&nbsp;0.77459666924148337704&nbsp;;&nbsp;&nbsp;0.78291939411828301639&nbsp;;&nbsp;&nbsp;0.79108493379984836143&nbsp;;&nbsp;&nbsp;0.79909229096084140180&nbsp;;<br>
&nbsp;0.80694053195021761186&nbsp;;&nbsp;&nbsp;0.81462878765513741344&nbsp;;&nbsp;&nbsp;0.82215625436498040737&nbsp;;&nbsp;&nbsp;0.82952219463740140018&nbsp;;&nbsp;&nbsp;0.83672593816886873550&nbsp;;<br>
&nbsp;0.84376688267270860104&nbsp;;&nbsp;&nbsp;0.85064449476835027976&nbsp;;&nbsp;&nbsp;0.85735831088623215653&nbsp;;&nbsp;&nbsp;0.86390793819369047715&nbsp;;&nbsp;&nbsp;0.87029305554811390585&nbsp;;<br>
&nbsp;0.87651341448470526974&nbsp;;&nbsp;&nbsp;0.88256884024734190684&nbsp;;&nbsp;&nbsp;0.88845923287225699889&nbsp;;&nbsp;&nbsp;0.89418456833555902286&nbsp;;&nbsp;&nbsp;0.89974489977694003664&nbsp;;<br>
&nbsp;0.90514035881326159519&nbsp;;&nbsp;&nbsp;0.91037115695700429250&nbsp;;&nbsp;&nbsp;0.91543758715576504064&nbsp;;&nbsp;&nbsp;0.92034002547001242073&nbsp;;&nbsp;&nbsp;0.92507893290707565236&nbsp;;<br>
&nbsp;0.92965485742974005667&nbsp;;&nbsp;&nbsp;0.93406843615772578800&nbsp;;&nbsp;&nbsp;0.93832039777959288365&nbsp;;&nbsp;&nbsp;0.94241156519108305981&nbsp;;&nbsp;&nbsp;0.94634285837340290515&nbsp;;<br>
&nbsp;0.95011529752129487656&nbsp;;&nbsp;&nbsp;0.95373000642576113641&nbsp;;&nbsp;&nbsp;0.95718821610986096274&nbsp;;&nbsp;&nbsp;0.96049126870802028342&nbsp;;&nbsp;&nbsp;0.96364062156981213252&nbsp;;<br>
&nbsp;0.96663785155841656709&nbsp;;&nbsp;&nbsp;0.96948465950245923177&nbsp;;&nbsp;&nbsp;0.97218287474858179658&nbsp;;&nbsp;&nbsp;0.97473445975240266776&nbsp;;&nbsp;&nbsp;0.97714151463970571416&nbsp;;<br>
&nbsp;0.97940628167086268381&nbsp;;&nbsp;&nbsp;0.98153114955374010687&nbsp;;&nbsp;&nbsp;0.98351865757863272876&nbsp;;&nbsp;&nbsp;0.98537149959852037111&nbsp;;&nbsp;&nbsp;0.98709252795403406719&nbsp;;<br>
&nbsp;0.98868475754742947994&nbsp;;&nbsp;&nbsp;0.99015137040077015918&nbsp;;&nbsp;&nbsp;0.99149572117810613240&nbsp;;&nbsp;&nbsp;0.99272134428278861533&nbsp;;&nbsp;&nbsp;0.99383196321275502221&nbsp;;<br>
&nbsp;0.99483150280062100052&nbsp;;&nbsp;&nbsp;0.99572410469840718851&nbsp;;&nbsp;&nbsp;0.99651414591489027385&nbsp;;&nbsp;&nbsp;0.99720625937222195908&nbsp;;&nbsp;&nbsp;0.99780535449595727456&nbsp;;<br>
&nbsp;0.99831663531840739253&nbsp;;&nbsp;&nbsp;0.99874561446809511470&nbsp;;&nbsp;&nbsp;0.99909812496766759766&nbsp;;&nbsp;&nbsp;0.99938033802502358193&nbsp;;&nbsp;&nbsp;0.99959879967191068325&nbsp;;<br>
&nbsp;0.99976049092443204733&nbsp;;&nbsp;0.99987288812035761194&nbsp;;&nbsp;0.99994399620705437576&nbsp;;&nbsp;0.99998243035489159858&nbsp;;&nbsp;0.99999759637974846462&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;gauss_patterson_255_w&nbsp;=&nbsp;[|&nbsp;0.69379364324108267170e-5&nbsp;;&nbsp;0.25157870384280661489e-4&nbsp;;&nbsp;0.53275293669780613125e-4&nbsp;;&nbsp;0.90372734658751149261e-4&nbsp;;&nbsp;0.13575491094922871973e-3<br>
&nbsp;;&nbsp;0.18887326450650491366e-3&nbsp;;&nbsp;0.24921240048299729402e-3&nbsp;;&nbsp;0.31630366082226447689e-3&nbsp;;&nbsp;0.38974528447328229322e-3&nbsp;;&nbsp;0.46918492424785040975e-3<br>
&nbsp;;&nbsp;0.55429531493037471492e-3&nbsp;;&nbsp;0.64476204130572477933e-3&nbsp;;&nbsp;0.74028280424450333046e-3&nbsp;;&nbsp;0.84057143271072246365e-3&nbsp;;&nbsp;0.94536151685852538246e-3<br>
&nbsp;;&nbsp;0.10544076228633167722e-2&nbsp;;&nbsp;0.11674841174299594077e-2&nbsp;;&nbsp;0.12843824718970101768e-2&nbsp;;&nbsp;0.14049079956551446427e-2&nbsp;;&nbsp;0.15288767050877655684e-2<br>
&nbsp;;&nbsp;0.16561127281544526052e-2&nbsp;;&nbsp;0.17864463917586498247e-2&nbsp;;&nbsp;0.19197129710138724125e-2&nbsp;;&nbsp;0.20557519893273465236e-2&nbsp;;&nbsp;0.21944069253638388388e-2<br>
&nbsp;;&nbsp;0.23355251860571608737e-2&nbsp;;&nbsp;0.24789582266575679307e-2&nbsp;;&nbsp;0.26245617274044295626e-2&nbsp;;&nbsp;0.27721957645934509940e-2&nbsp;;&nbsp;0.29217249379178197538e-2<br>
&nbsp;;&nbsp;0.30730184347025783234e-2&nbsp;;&nbsp;0.32259500250878684614e-2&nbsp;;&nbsp;0.33803979910869203823e-2&nbsp;;&nbsp;0.35362449977167777340e-2&nbsp;;&nbsp;0.36933779170256508183e-2<br>
&nbsp;;&nbsp;0.38516876166398709241e-2&nbsp;;&nbsp;0.40110687240750233989e-2&nbsp;;&nbsp;0.41714193769840788528e-2&nbsp;;&nbsp;0.43326409680929828545e-2&nbsp;;&nbsp;0.44946378920320678616e-2<br>
&nbsp;;&nbsp;0.46573172997568547773e-2&nbsp;;&nbsp;0.48205888648512683476e-2&nbsp;;&nbsp;0.49843645647655386012e-2&nbsp;;&nbsp;0.51485584789781777618e-2&nbsp;;&nbsp;0.53130866051870565663e-2<br>
&nbsp;;&nbsp;0.54778666939189508240e-2&nbsp;;&nbsp;0.56428181013844441585e-2&nbsp;;&nbsp;0.58078616599775673635e-2&nbsp;;&nbsp;0.59729195655081658049e-2&nbsp;;&nbsp;0.61379152800413850435e-2<br>
&nbsp;;&nbsp;0.63027734490857587172e-2&nbsp;;&nbsp;0.64674198318036867274e-2&nbsp;;&nbsp;0.66317812429018878941e-2&nbsp;;&nbsp;0.67957855048827733948e-2&nbsp;;&nbsp;0.69593614093904229394e-2<br>
&nbsp;;&nbsp;0.71224386864583871532e-2&nbsp;;&nbsp;0.72849479805538070639e-2&nbsp;;&nbsp;0.74468208324075910174e-2&nbsp;;&nbsp;0.76079896657190565832e-2&nbsp;;&nbsp;0.77683877779219912200e-2<br>
&nbsp;;&nbsp;0.79279493342948491103e-2&nbsp;;&nbsp;0.80866093647888599710e-2&nbsp;;&nbsp;0.82443037630328680306e-2&nbsp;;&nbsp;0.84009692870519326354e-2&nbsp;;&nbsp;0.85565435613076896192e-2<br>
&nbsp;;&nbsp;0.87109650797320868736e-2&nbsp;;&nbsp;0.88641732094824942641e-2&nbsp;;&nbsp;0.90161081951956431600e-2&nbsp;;&nbsp;0.91667111635607884067e-2&nbsp;;&nbsp;0.93159241280693950932e-2<br>
&nbsp;;&nbsp;0.94636899938300652943e-2&nbsp;;&nbsp;0.96099525623638830097e-2&nbsp;;&nbsp;0.97546565363174114611e-2&nbsp;;&nbsp;0.98977475240487497440e-2&nbsp;;&nbsp;0.10039172044056840798e-1<br>
&nbsp;;&nbsp;0.10178877529236079733e-1&nbsp;;&nbsp;0.10316812330947621682e-1&nbsp;;&nbsp;0.10452925722906011926e-1&nbsp;;&nbsp;0.10587167904885197931e-1&nbsp;;&nbsp;0.10719490006251933623e-1<br>
&nbsp;;&nbsp;0.10849844089337314099e-1&nbsp;;&nbsp;0.10978183152658912470e-1&nbsp;;&nbsp;0.11104461134006926537e-1&nbsp;;&nbsp;0.11228632913408049354e-1&nbsp;;&nbsp;0.11350654315980596602e-1<br>
&nbsp;;&nbsp;0.11470482114693874380e-1&nbsp;;&nbsp;0.11588074033043952568e-1&nbsp;;&nbsp;0.11703388747657003101e-1&nbsp;;&nbsp;0.11816385890830235763e-1&nbsp;;&nbsp;0.11927026053019270040e-1<br>
&nbsp;;&nbsp;0.12035270785279562630e-1&nbsp;;&nbsp;0.12141082601668299679e-1&nbsp;;&nbsp;0.12244424981611985899e-1&nbsp;;&nbsp;0.12345262372243838455e-1&nbsp;;&nbsp;0.12443560190714035263e-1<br>
&nbsp;;&nbsp;0.12539284826474884353e-1&nbsp;;&nbsp;0.12632403643542078765e-1&nbsp;;&nbsp;0.12722884982732382906e-1&nbsp;;&nbsp;0.12810698163877361967e-1&nbsp;;&nbsp;0.12895813488012114694e-1<br>
&nbsp;;&nbsp;0.12978202239537399286e-1&nbsp;;&nbsp;0.13057836688353048840e-1&nbsp;;&nbsp;0.13134690091960152836e-1&nbsp;;&nbsp;0.13208736697529129966e-1&nbsp;;&nbsp;0.13279951743930530650e-1<br>
&nbsp;;&nbsp;0.13348311463725179953e-1&nbsp;;&nbsp;0.13413793085110098513e-1&nbsp;;&nbsp;0.13476374833816515982e-1&nbsp;;&nbsp;0.13536035934956213614e-1&nbsp;;&nbsp;0.13592756614812395910e-1<br>
&nbsp;;&nbsp;0.13646518102571291428e-1&nbsp;;&nbsp;0.13697302631990716258e-1&nbsp;;&nbsp;0.13745093443001896632e-1&nbsp;;&nbsp;0.13789874783240936517e-1&nbsp;;&nbsp;0.13831631909506428676e-1<br>
&nbsp;;&nbsp;0.13870351089139840997e-1&nbsp;;&nbsp;0.13906019601325461264e-1&nbsp;;&nbsp;0.13938625738306850804e-1&nbsp;;&nbsp;0.13968158806516938516e-1&nbsp;;&nbsp;0.13994609127619079852e-1<br>
&nbsp;;&nbsp;0.14017968039456608810e-1&nbsp;;&nbsp;0.14038227896908623303e-1&nbsp;;&nbsp;0.14055382072649964277e-1&nbsp;;&nbsp;0.14069424957813575318e-1&nbsp;;&nbsp;0.14080351962553661325e-1<br>
&nbsp;;&nbsp;0.14088159516508301065e-1&nbsp;;&nbsp;0.14092845069160408355e-1&nbsp;;&nbsp;0.14094407090096179347e-1&nbsp;;&nbsp;0.14092845069160408355e-1&nbsp;;&nbsp;0.14088159516508301065e-1<br>
&nbsp;;&nbsp;0.14080351962553661325e-1&nbsp;;&nbsp;0.14069424957813575318e-1&nbsp;;&nbsp;0.14055382072649964277e-1&nbsp;;&nbsp;0.14038227896908623303e-1&nbsp;;&nbsp;0.14017968039456608810e-1<br>
&nbsp;;&nbsp;0.13994609127619079852e-1&nbsp;;&nbsp;0.13968158806516938516e-1&nbsp;;&nbsp;0.13938625738306850804e-1&nbsp;;&nbsp;0.13906019601325461264e-1&nbsp;;&nbsp;0.13870351089139840997e-1<br>
&nbsp;;&nbsp;0.13831631909506428676e-1&nbsp;;&nbsp;0.13789874783240936517e-1&nbsp;;&nbsp;0.13745093443001896632e-1&nbsp;;&nbsp;0.13697302631990716258e-1&nbsp;;&nbsp;0.13646518102571291428e-1<br>
&nbsp;;&nbsp;0.13592756614812395910e-1&nbsp;;&nbsp;0.13536035934956213614e-1&nbsp;;&nbsp;0.13476374833816515982e-1&nbsp;;&nbsp;0.13413793085110098513e-1&nbsp;;&nbsp;0.13348311463725179953e-1<br>
&nbsp;;&nbsp;0.13279951743930530650e-1&nbsp;;&nbsp;0.13208736697529129966e-1&nbsp;;&nbsp;0.13134690091960152836e-1&nbsp;;&nbsp;0.13057836688353048840e-1&nbsp;;&nbsp;0.12978202239537399286e-1<br>
&nbsp;;&nbsp;0.12895813488012114694e-1&nbsp;;&nbsp;0.12810698163877361967e-1&nbsp;;&nbsp;0.12722884982732382906e-1&nbsp;;&nbsp;0.12632403643542078765e-1&nbsp;;&nbsp;0.12539284826474884353e-1<br>
&nbsp;;&nbsp;0.12443560190714035263e-1&nbsp;;&nbsp;0.12345262372243838455e-1&nbsp;;&nbsp;0.12244424981611985899e-1&nbsp;;&nbsp;0.12141082601668299679e-1&nbsp;;&nbsp;0.12035270785279562630e-1<br>
&nbsp;;&nbsp;0.11927026053019270040e-1&nbsp;;&nbsp;0.11816385890830235763e-1&nbsp;;&nbsp;0.11703388747657003101e-1&nbsp;;&nbsp;0.11588074033043952568e-1&nbsp;;&nbsp;0.11470482114693874380e-1<br>
&nbsp;;&nbsp;0.11350654315980596602e-1&nbsp;;&nbsp;0.11228632913408049354e-1&nbsp;;&nbsp;0.11104461134006926537e-1&nbsp;;&nbsp;0.10978183152658912470e-1&nbsp;;&nbsp;0.10849844089337314099e-1<br>
&nbsp;;&nbsp;0.10719490006251933623e-1&nbsp;;&nbsp;0.10587167904885197931e-1&nbsp;;&nbsp;0.10452925722906011926e-1&nbsp;;&nbsp;0.10316812330947621682e-1&nbsp;;&nbsp;0.10178877529236079733e-1<br>
&nbsp;;&nbsp;0.10039172044056840798e-1&nbsp;;&nbsp;0.98977475240487497440e-2&nbsp;;&nbsp;0.97546565363174114611e-2&nbsp;;&nbsp;0.96099525623638830097e-2&nbsp;;&nbsp;0.94636899938300652943e-2<br>
&nbsp;;&nbsp;0.93159241280693950932e-2&nbsp;;&nbsp;0.91667111635607884067e-2&nbsp;;&nbsp;0.90161081951956431600e-2&nbsp;;&nbsp;0.88641732094824942641e-2&nbsp;;&nbsp;0.87109650797320868736e-2<br>
&nbsp;;&nbsp;0.85565435613076896192e-2&nbsp;;&nbsp;0.84009692870519326354e-2&nbsp;;&nbsp;0.82443037630328680306e-2&nbsp;;&nbsp;0.80866093647888599710e-2&nbsp;;&nbsp;0.79279493342948491103e-2<br>
&nbsp;;&nbsp;0.77683877779219912200e-2&nbsp;;&nbsp;0.76079896657190565832e-2&nbsp;;&nbsp;0.74468208324075910174e-2&nbsp;;&nbsp;0.72849479805538070639e-2&nbsp;;&nbsp;0.71224386864583871532e-2<br>
&nbsp;;&nbsp;0.69593614093904229394e-2&nbsp;;&nbsp;0.67957855048827733948e-2&nbsp;;&nbsp;0.66317812429018878941e-2&nbsp;;&nbsp;0.64674198318036867274e-2&nbsp;;&nbsp;0.63027734490857587172e-2<br>
&nbsp;;&nbsp;0.61379152800413850435e-2&nbsp;;&nbsp;0.59729195655081658049e-2&nbsp;;&nbsp;0.58078616599775673635e-2&nbsp;;&nbsp;0.56428181013844441585e-2&nbsp;;&nbsp;0.54778666939189508240e-2<br>
&nbsp;;&nbsp;0.53130866051870565663e-2&nbsp;;&nbsp;0.51485584789781777618e-2&nbsp;;&nbsp;0.49843645647655386012e-2&nbsp;;&nbsp;0.48205888648512683476e-2&nbsp;;&nbsp;0.46573172997568547773e-2<br>
&nbsp;;&nbsp;0.44946378920320678616e-2&nbsp;;&nbsp;0.43326409680929828545e-2&nbsp;;&nbsp;0.41714193769840788528e-2&nbsp;;&nbsp;0.40110687240750233989e-2&nbsp;;&nbsp;0.38516876166398709241e-2<br>
&nbsp;;&nbsp;0.36933779170256508183e-2&nbsp;;&nbsp;0.35362449977167777340e-2&nbsp;;&nbsp;0.33803979910869203823e-2&nbsp;;&nbsp;0.32259500250878684614e-2&nbsp;;&nbsp;0.30730184347025783234e-2<br>
&nbsp;;&nbsp;0.29217249379178197538e-2&nbsp;;&nbsp;0.27721957645934509940e-2&nbsp;;&nbsp;0.26245617274044295626e-2&nbsp;;&nbsp;0.24789582266575679307e-2&nbsp;;&nbsp;0.23355251860571608737e-2<br>
&nbsp;;&nbsp;0.21944069253638388388e-2&nbsp;;&nbsp;0.20557519893273465236e-2&nbsp;;&nbsp;0.19197129710138724125e-2&nbsp;;&nbsp;0.17864463917586498247e-2&nbsp;;&nbsp;0.16561127281544526052e-2<br>
&nbsp;;&nbsp;0.15288767050877655684e-2&nbsp;;&nbsp;0.14049079956551446427e-2&nbsp;;&nbsp;0.12843824718970101768e-2&nbsp;;&nbsp;0.11674841174299594077e-2&nbsp;;&nbsp;0.10544076228633167722e-2<br>
&nbsp;;&nbsp;0.94536151685852538246e-3&nbsp;;&nbsp;0.84057143271072246365e-3&nbsp;;&nbsp;0.74028280424450333046e-3&nbsp;;&nbsp;0.64476204130572477933e-3&nbsp;;&nbsp;0.55429531493037471492e-3<br>
&nbsp;;&nbsp;0.46918492424785040975e-3&nbsp;;&nbsp;0.38974528447328229322e-3&nbsp;;&nbsp;0.31630366082226447689e-3&nbsp;;&nbsp;0.24921240048299729402e-3&nbsp;;&nbsp;0.18887326450650491366e-3<br>
&nbsp;;&nbsp;0.13575491094922871973e-3&nbsp;;&nbsp;0.90372734658751149261e-4&nbsp;;&nbsp;0.53275293669780613125e-4&nbsp;;&nbsp;0.25157870384280661489e-4&nbsp;;&nbsp;0.69379364324108267170e-5&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_2_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_2_w&nbsp;=&nbsp;[|&nbsp;&nbsp;1.0&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_3_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_3_w&nbsp;=&nbsp;[|&nbsp;&nbsp;1.0&nbsp;/.&nbsp;3.0&nbsp;;&nbsp;4.0&nbsp;/.&nbsp;3.0&nbsp;;&nbsp;1.0&nbsp;/.&nbsp;3.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_4_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.447213595499957939281834733746&nbsp;;&nbsp;0.447213595499957939281834733746&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_4_w&nbsp;=&nbsp;[|&nbsp;&nbsp;1.0&nbsp;/.&nbsp;6.0&nbsp;;&nbsp;5.0&nbsp;/.&nbsp;6.0&nbsp;;&nbsp;5.0&nbsp;/.&nbsp;6.0&nbsp;;&nbsp;1.0&nbsp;/.&nbsp;6.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_5_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.654653670707977143798292456247&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.654653670707977143798292456247&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_5_w&nbsp;=&nbsp;[|&nbsp;&nbsp;9.0&nbsp;/.&nbsp;90.0&nbsp;;&nbsp;49.0&nbsp;/.&nbsp;90.0&nbsp;;&nbsp;64.0&nbsp;/.&nbsp;90.0&nbsp;;&nbsp;49.0&nbsp;/.&nbsp;90.0&nbsp;;&nbsp;9.0&nbsp;/.&nbsp;90.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_6_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.765055323929464692851002973959&nbsp;;&nbsp;-&nbsp;0.285231516480645096314150994041&nbsp;;<br>
&nbsp;0.285231516480645096314150994041&nbsp;;&nbsp;0.765055323929464692851002973959&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_6_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.066666666666666666666666666667&nbsp;;&nbsp;0.378474956297846980316612808212&nbsp;;&nbsp;0.554858377035486353016720525121&nbsp;;<br>
&nbsp;0.554858377035486353016720525121&nbsp;;&nbsp;0.378474956297846980316612808212&nbsp;;&nbsp;0.066666666666666666666666666667&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_7_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.830223896278566929872032213967&nbsp;;&nbsp;-&nbsp;0.468848793470714213803771881909&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;0.468848793470714213803771881909&nbsp;;&nbsp;0.830223896278566929872032213967&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_7_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.476190476190476190476190476190e-1&nbsp;;&nbsp;0.276826047361565948010700406290&nbsp;;&nbsp;0.431745381209862623417871022281&nbsp;;<br>
&nbsp;0.487619047619047619047619047619&nbsp;;&nbsp;0.431745381209862623417871022281&nbsp;;&nbsp;0.276826047361565948010700406290&nbsp;;&nbsp;0.476190476190476190476190476190e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_8_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.871740148509606615337445761221&nbsp;;&nbsp;-&nbsp;0.591700181433142302144510731398&nbsp;;&nbsp;-&nbsp;0.209299217902478868768657260345&nbsp;;<br>
&nbsp;0.209299217902478868768657260345&nbsp;;&nbsp;0.591700181433142302144510731398&nbsp;;&nbsp;0.871740148509606615337445761221&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_8_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.357142857142857142857142857143e-1&nbsp;;&nbsp;0.210704227143506039382991065776&nbsp;;&nbsp;0.341122692483504364764240677108&nbsp;;<br>
&nbsp;0.412458794658703881567052971402&nbsp;;&nbsp;0.412458794658703881567052971402&nbsp;;&nbsp;0.341122692483504364764240677108&nbsp;;&nbsp;0.210704227143506039382991065776&nbsp;;<br>
&nbsp;0.357142857142857142857142857143e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_9_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.899757995411460157312345244418&nbsp;;&nbsp;-&nbsp;0.677186279510737753445885427091&nbsp;;&nbsp;-&nbsp;0.363117463826178158710752068709&nbsp;;&nbsp;0.0&nbsp;;<br>
&nbsp;0.363117463826178158710752068709&nbsp;;&nbsp;0.677186279510737753445885427091&nbsp;;&nbsp;0.899757995411460157312345244418&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_9_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.277777777777777777777777777778e-1&nbsp;;&nbsp;0.165495361560805525046339720029&nbsp;;&nbsp;0.274538712500161735280705618579&nbsp;;<br>
&nbsp;0.346428510973046345115131532140&nbsp;;&nbsp;0.371519274376417233560090702948&nbsp;;&nbsp;0.346428510973046345115131532140&nbsp;;&nbsp;0.274538712500161735280705618579&nbsp;;<br>
&nbsp;0.165495361560805525046339720029&nbsp;;&nbsp;0.277777777777777777777777777778e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_9_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.919533908166458813828932660822&nbsp;;&nbsp;-&nbsp;0.738773865105505075003106174860&nbsp;;&nbsp;-&nbsp;0.477924949810444495661175092731&nbsp;;<br>
&nbsp;-&nbsp;0.165278957666387024626219765958&nbsp;;&nbsp;0.165278957666387024626219765958&nbsp;;&nbsp;0.477924949810444495661175092731&nbsp;;&nbsp;0.738773865105505075003106174860&nbsp;;<br>
&nbsp;0.919533908166458813828932660822&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_10_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.222222222222222222222222222222e-1&nbsp;;&nbsp;0.133305990851070111126227170755&nbsp;;&nbsp;0.224889342063126452119457821731&nbsp;;<br>
&nbsp;0.292042683679683757875582257374&nbsp;;&nbsp;0.327539761183897456656510527917&nbsp;;&nbsp;0.327539761183897456656510527917&nbsp;;&nbsp;0.292042683679683757875582257374&nbsp;;<br>
&nbsp;0.224889342063126452119457821731&nbsp;;&nbsp;0.133305990851070111126227170755&nbsp;;&nbsp;0.222222222222222222222222222222e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_11_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.934001430408059134332274136099&nbsp;;&nbsp;-&nbsp;0.784483473663144418622417816108&nbsp;;&nbsp;-&nbsp;0.565235326996205006470963969478&nbsp;;<br>
&nbsp;-&nbsp;0.295758135586939391431911515559&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.295758135586939391431911515559&nbsp;;&nbsp;0.565235326996205006470963969478&nbsp;;<br>
&nbsp;0.784483473663144418622417816108&nbsp;;&nbsp;0.934001430408059134332274136099&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_11_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.181818181818181818181818181818e-1&nbsp;;&nbsp;0.109612273266994864461403449580&nbsp;;&nbsp;0.187169881780305204108141521899&nbsp;;<br>
&nbsp;0.248048104264028314040084866422&nbsp;;&nbsp;0.286879124779008088679222403332&nbsp;;&nbsp;0.300217595455690693785931881170&nbsp;;&nbsp;0.286879124779008088679222403332&nbsp;;<br>
&nbsp;0.248048104264028314040084866422&nbsp;;&nbsp;0.187169881780305204108141521899&nbsp;;&nbsp;0.109612273266994864461403449580&nbsp;;&nbsp;0.181818181818181818181818181818e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_12_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.944899272222882223407580138303&nbsp;;&nbsp;-&nbsp;0.819279321644006678348641581717&nbsp;;&nbsp;-&nbsp;0.632876153031869677662404854444&nbsp;;<br>
&nbsp;-&nbsp;0.399530940965348932264349791567&nbsp;;&nbsp;-&nbsp;0.136552932854927554864061855740&nbsp;;&nbsp;0.136552932854927554864061855740&nbsp;;&nbsp;0.399530940965348932264349791567&nbsp;;<br>
&nbsp;0.632876153031869677662404854444&nbsp;;&nbsp;0.819279321644006678348641581717&nbsp;;&nbsp;0.944899272222882223407580138303&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_12_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.151515151515151515151515151515e-1&nbsp;;&nbsp;0.916845174131961306683425941341e-1&nbsp;;&nbsp;0.157974705564370115164671062700&nbsp;;<br>
&nbsp;0.212508417761021145358302077367&nbsp;;&nbsp;0.251275603199201280293244412148&nbsp;;&nbsp;0.271405240910696177000288338500&nbsp;;&nbsp;0.271405240910696177000288338500&nbsp;;<br>
&nbsp;0.251275603199201280293244412148&nbsp;;&nbsp;0.212508417761021145358302077367&nbsp;;&nbsp;0.157974705564370115164671062700&nbsp;;&nbsp;0.916845174131961306683425941341e-1&nbsp;;<br>
&nbsp;0.151515151515151515151515151515e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_13_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.953309846642163911896905464755&nbsp;;&nbsp;-&nbsp;0.846347564651872316865925607099&nbsp;;&nbsp;-&nbsp;0.686188469081757426072759039566&nbsp;;<br>
&nbsp;-&nbsp;0.482909821091336201746937233637&nbsp;;&nbsp;-&nbsp;0.249286930106239992568673700374&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.249286930106239992568673700374&nbsp;;&nbsp;0.482909821091336201746937233637&nbsp;;<br>
&nbsp;0.686188469081757426072759039566&nbsp;;&nbsp;0.846347564651872316865925607099&nbsp;;&nbsp;0.953309846642163911896905464755&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_13_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.128205128205128205128205128205e-1&nbsp;;&nbsp;0.778016867468189277935889883331e-1&nbsp;;&nbsp;0.134981926689608349119914762589&nbsp;;<br>
&nbsp;0.183646865203550092007494258747&nbsp;;&nbsp;0.220767793566110086085534008379&nbsp;;&nbsp;0.244015790306676356458578148360&nbsp;;&nbsp;0.251930849333446736044138641541&nbsp;;<br>
&nbsp;0.244015790306676356458578148360&nbsp;;&nbsp;0.220767793566110086085534008379&nbsp;;&nbsp;0.183646865203550092007494258747&nbsp;;&nbsp;0.134981926689608349119914762589&nbsp;;<br>
&nbsp;0.778016867468189277935889883331e-1&nbsp;;&nbsp;0.128205128205128205128205128205e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_14_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.959935045267260901355100162015&nbsp;;&nbsp;-&nbsp;0.867801053830347251000220202908&nbsp;;&nbsp;-&nbsp;0.728868599091326140584672400521&nbsp;;<br>
&nbsp;-&nbsp;0.550639402928647055316622705859&nbsp;;&nbsp;-&nbsp;0.342724013342712845043903403642&nbsp;;&nbsp;-&nbsp;0.116331868883703867658776709736&nbsp;;&nbsp;0.116331868883703867658776709736&nbsp;;<br>
&nbsp;0.342724013342712845043903403642&nbsp;;&nbsp;0.550639402928647055316622705859&nbsp;;&nbsp;0.728868599091326140584672400521&nbsp;;&nbsp;0.867801053830347251000220202908&nbsp;;<br>
&nbsp;0.959935045267260901355100162015&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_14_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.109890109890109890109890109890e-1&nbsp;;&nbsp;0.668372844976812846340706607461e-1&nbsp;;&nbsp;0.116586655898711651540996670655&nbsp;;<br>
&nbsp;0.160021851762952142412820997988&nbsp;;&nbsp;0.194826149373416118640331778376&nbsp;;&nbsp;0.219126253009770754871162523954&nbsp;;&nbsp;0.231612794468457058889628357293&nbsp;;<br>
&nbsp;0.231612794468457058889628357293&nbsp;;&nbsp;0.219126253009770754871162523954&nbsp;;&nbsp;0.194826149373416118640331778376&nbsp;;&nbsp;0.160021851762952142412820997988&nbsp;;<br>
&nbsp;0.116586655898711651540996670655&nbsp;;&nbsp;0.668372844976812846340706607461e-1&nbsp;;&nbsp;0.109890109890109890109890109890e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_15_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.965245926503838572795851392070&nbsp;;&nbsp;-&nbsp;0.885082044222976298825401631482&nbsp;;&nbsp;-&nbsp;0.763519689951815200704118475976&nbsp;;<br>
&nbsp;-&nbsp;0.606253205469845711123529938637&nbsp;;&nbsp;-&nbsp;0.420638054713672480921896938739&nbsp;;&nbsp;-&nbsp;0.215353955363794238225679446273&nbsp;;&nbsp;0.0&nbsp;;<br>
&nbsp;0.215353955363794238225679446273&nbsp;;&nbsp;0.420638054713672480921896938739&nbsp;;&nbsp;0.606253205469845711123529938637&nbsp;;&nbsp;0.763519689951815200704118475976&nbsp;;<br>
&nbsp;0.885082044222976298825401631482&nbsp;;&nbsp;0.965245926503838572795851392070&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_15_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.952380952380952380952380952381e-2&nbsp;;&nbsp;0.580298930286012490968805840253e-1&nbsp;;&nbsp;0.101660070325718067603666170789&nbsp;;<br>
&nbsp;0.140511699802428109460446805644&nbsp;;&nbsp;0.172789647253600949052077099408&nbsp;;&nbsp;0.196987235964613356092500346507&nbsp;;&nbsp;0.211973585926820920127430076977&nbsp;;<br>
&nbsp;0.217048116348815649514950214251&nbsp;;&nbsp;0.211973585926820920127430076977&nbsp;;&nbsp;0.196987235964613356092500346507&nbsp;;&nbsp;0.172789647253600949052077099408&nbsp;;<br>
&nbsp;0.140511699802428109460446805644&nbsp;;&nbsp;0.101660070325718067603666170789&nbsp;;&nbsp;0.580298930286012490968805840253e-1&nbsp;;&nbsp;0.952380952380952380952380952381e-2&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_16_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.969568046270217932952242738367&nbsp;;&nbsp;-&nbsp;0.899200533093472092994628261520&nbsp;;&nbsp;-&nbsp;0.792008291861815063931088270963&nbsp;;<br>
&nbsp;-&nbsp;0.652388702882493089467883219641&nbsp;;&nbsp;-&nbsp;0.486059421887137611781890785847&nbsp;;&nbsp;-&nbsp;0.299830468900763208098353454722&nbsp;;&nbsp;-&nbsp;0.101326273521949447843033005046&nbsp;;<br>
&nbsp;0.101326273521949447843033005046&nbsp;;&nbsp;0.299830468900763208098353454722&nbsp;;&nbsp;0.486059421887137611781890785847&nbsp;;&nbsp;0.652388702882493089467883219641&nbsp;;<br>
&nbsp;0.792008291861815063931088270963&nbsp;;&nbsp;0.899200533093472092994628261520&nbsp;;&nbsp;0.969568046270217932952242738367&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_16_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.833333333333333333333333333333e-2&nbsp;;&nbsp;0.508503610059199054032449195655e-1&nbsp;;&nbsp;0.893936973259308009910520801661e-1&nbsp;;<br>
&nbsp;0.124255382132514098349536332657&nbsp;;&nbsp;0.154026980807164280815644940485&nbsp;;&nbsp;0.177491913391704125301075669528&nbsp;;&nbsp;0.193690023825203584316913598854&nbsp;;<br>
&nbsp;0.201958308178229871489199125411&nbsp;;&nbsp;0.201958308178229871489199125411&nbsp;;&nbsp;0.193690023825203584316913598854&nbsp;;&nbsp;0.177491913391704125301075669528&nbsp;;<br>
&nbsp;0.154026980807164280815644940485&nbsp;;&nbsp;0.124255382132514098349536332657&nbsp;;&nbsp;0.893936973259308009910520801661e-1&nbsp;;&nbsp;0.508503610059199054032449195655e-1&nbsp;;<br>
&nbsp;0.833333333333333333333333333333e-2&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_17_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.973132176631418314156979501874&nbsp;;&nbsp;-&nbsp;0.910879995915573595623802506398&nbsp;;&nbsp;-&nbsp;0.815696251221770307106750553238&nbsp;;<br>
&nbsp;-&nbsp;0.691028980627684705394919357372&nbsp;;&nbsp;-&nbsp;0.541385399330101539123733407504&nbsp;;&nbsp;-&nbsp;0.372174433565477041907234680735&nbsp;;&nbsp;-&nbsp;0.189511973518317388304263014753&nbsp;;<br>
&nbsp;0.0&nbsp;;&nbsp;0.189511973518317388304263014753&nbsp;;&nbsp;0.372174433565477041907234680735&nbsp;;&nbsp;0.541385399330101539123733407504&nbsp;;&nbsp;0.691028980627684705394919357372&nbsp;;<br>
&nbsp;0.815696251221770307106750553238&nbsp;;&nbsp;0.910879995915573595623802506398&nbsp;;&nbsp;0.973132176631418314156979501874&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_17_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.735294117647058823529411764706e-2&nbsp;;&nbsp;0.449219405432542096474009546232e-1&nbsp;;&nbsp;0.791982705036871191902644299528e-1&nbsp;;<br>
&nbsp;0.110592909007028161375772705220&nbsp;;&nbsp;0.137987746201926559056201574954&nbsp;;&nbsp;0.160394661997621539516328365865&nbsp;;&nbsp;0.177004253515657870436945745363&nbsp;;<br>
&nbsp;0.187216339677619235892088482861&nbsp;;&nbsp;0.190661874753469433299407247028&nbsp;;&nbsp;0.187216339677619235892088482861&nbsp;;&nbsp;0.177004253515657870436945745363&nbsp;;<br>
&nbsp;0.160394661997621539516328365865&nbsp;;&nbsp;0.137987746201926559056201574954&nbsp;;&nbsp;0.110592909007028161375772705220&nbsp;;&nbsp;0.791982705036871191902644299528e-1&nbsp;;<br>
&nbsp;0.449219405432542096474009546232e-1&nbsp;;&nbsp;0.735294117647058823529411764706e-2&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_18_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.976105557412198542864518924342&nbsp;;&nbsp;-&nbsp;0.920649185347533873837854625431&nbsp;;&nbsp;-&nbsp;0.835593535218090213713646362328&nbsp;;<br>
&nbsp;-&nbsp;0.723679329283242681306210365302&nbsp;;&nbsp;-&nbsp;0.588504834318661761173535893194&nbsp;;&nbsp;-&nbsp;0.434415036912123975342287136741&nbsp;;&nbsp;-&nbsp;0.266362652878280984167665332026&nbsp;;<br>
&nbsp;-&nbsp;0.897490934846521110226450100886e-1&nbsp;;&nbsp;0.897490934846521110226450100886e-1&nbsp;;&nbsp;0.266362652878280984167665332026&nbsp;;&nbsp;0.434415036912123975342287136741&nbsp;;<br>
&nbsp;0.588504834318661761173535893194&nbsp;;&nbsp;0.723679329283242681306210365302&nbsp;;&nbsp;0.835593535218090213713646362328&nbsp;;&nbsp;0.920649185347533873837854625431&nbsp;;<br>
&nbsp;0.976105557412198542864518924342&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_18_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.653594771241830065359477124183e-2&nbsp;;&nbsp;0.399706288109140661375991764101e-1&nbsp;;&nbsp;0.706371668856336649992229601678e-1&nbsp;;<br>
&nbsp;0.990162717175028023944236053187e-1&nbsp;;&nbsp;0.124210533132967100263396358897&nbsp;;&nbsp;0.145411961573802267983003210494&nbsp;;&nbsp;0.161939517237602489264326706700&nbsp;;<br>
&nbsp;0.173262109489456226010614403827&nbsp;;&nbsp;0.179015863439703082293818806944&nbsp;;&nbsp;0.179015863439703082293818806944&nbsp;;&nbsp;0.173262109489456226010614403827&nbsp;;<br>
&nbsp;0.161939517237602489264326706700&nbsp;;&nbsp;0.145411961573802267983003210494&nbsp;;&nbsp;0.124210533132967100263396358897&nbsp;;&nbsp;0.990162717175028023944236053187e-1&nbsp;;<br>
&nbsp;0.706371668856336649992229601678e-1&nbsp;;&nbsp;0.399706288109140661375991764101e-1&nbsp;;&nbsp;0.653594771241830065359477124183e-2&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_19_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.978611766222080095152634063110&nbsp;;&nbsp;-&nbsp;0.928901528152586243717940258797&nbsp;;&nbsp;-&nbsp;0.852460577796646093085955970041&nbsp;;<br>
&nbsp;-&nbsp;0.751494202552613014163637489634&nbsp;;&nbsp;-&nbsp;0.628908137265220497766832306229&nbsp;;&nbsp;-&nbsp;0.488229285680713502777909637625&nbsp;;&nbsp;-&nbsp;0.333504847824498610298500103845&nbsp;;<br>
&nbsp;-&nbsp;0.169186023409281571375154153445&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.169186023409281571375154153445&nbsp;;&nbsp;0.333504847824498610298500103845&nbsp;;&nbsp;0.488229285680713502777909637625&nbsp;;<br>
&nbsp;0.628908137265220497766832306229&nbsp;;&nbsp;0.751494202552613014163637489634&nbsp;;&nbsp;0.852460577796646093085955970041&nbsp;;&nbsp;0.928901528152586243717940258797&nbsp;;<br>
&nbsp;0.978611766222080095152634063110&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_19_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.584795321637426900584795321637e-2&nbsp;;&nbsp;0.357933651861764771154255690351e-1&nbsp;;&nbsp;0.633818917626297368516956904183e-1&nbsp;;<br>
&nbsp;0.891317570992070844480087905562e-1&nbsp;;&nbsp;0.112315341477305044070910015464&nbsp;;&nbsp;0.132267280448750776926046733910&nbsp;;&nbsp;0.148413942595938885009680643668&nbsp;;<br>
&nbsp;0.160290924044061241979910968184&nbsp;;&nbsp;0.167556584527142867270137277740&nbsp;;&nbsp;0.170001919284827234644672715617&nbsp;;&nbsp;0.167556584527142867270137277740&nbsp;;<br>
&nbsp;0.160290924044061241979910968184&nbsp;;&nbsp;0.148413942595938885009680643668&nbsp;;&nbsp;0.132267280448750776926046733910&nbsp;;&nbsp;0.112315341477305044070910015464&nbsp;;<br>
&nbsp;0.891317570992070844480087905562e-1&nbsp;;&nbsp;0.633818917626297368516956904183e-1&nbsp;;&nbsp;0.357933651861764771154255690351e-1&nbsp;;&nbsp;0.584795321637426900584795321637e-2&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_20_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.980743704893914171925446438584&nbsp;;&nbsp;-&nbsp;0.935934498812665435716181584931&nbsp;;&nbsp;-&nbsp;0.866877978089950141309847214616&nbsp;;<br>
&nbsp;-&nbsp;0.775368260952055870414317527595&nbsp;;&nbsp;-&nbsp;0.663776402290311289846403322971&nbsp;;&nbsp;-&nbsp;0.534992864031886261648135961829&nbsp;;&nbsp;-&nbsp;0.392353183713909299386474703816&nbsp;;<br>
&nbsp;-&nbsp;0.239551705922986495182401356927&nbsp;;&nbsp;-&nbsp;0.805459372388218379759445181596e-1&nbsp;;&nbsp;0.805459372388218379759445181596e-1&nbsp;;&nbsp;0.239551705922986495182401356927&nbsp;;<br>
&nbsp;0.392353183713909299386474703816&nbsp;;&nbsp;0.534992864031886261648135961829&nbsp;;&nbsp;0.663776402290311289846403322971&nbsp;;&nbsp;0.775368260952055870414317527595&nbsp;;<br>
&nbsp;0.866877978089950141309847214616&nbsp;;&nbsp;0.935934498812665435716181584931&nbsp;;&nbsp;0.980743704893914171925446438584&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lobatto_20_w&nbsp;=&nbsp;[|&nbsp;&nbsp;0.526315789473684210526315789474e-2&nbsp;;&nbsp;0.322371231884889414916050281173e-1&nbsp;;&nbsp;0.571818021275668260047536271732e-1&nbsp;;<br>
&nbsp;0.806317639961196031447768461137e-1&nbsp;;&nbsp;0.101991499699450815683781205733&nbsp;;&nbsp;0.120709227628674725099429705002&nbsp;;&nbsp;0.136300482358724184489780792989&nbsp;;<br>
&nbsp;0.148361554070916825814713013734&nbsp;;&nbsp;0.156580102647475487158169896794&nbsp;;&nbsp;0.160743286387845749007726726449&nbsp;;&nbsp;0.160743286387845749007726726449&nbsp;;<br>
&nbsp;0.156580102647475487158169896794&nbsp;;&nbsp;0.148361554070916825814713013734&nbsp;;&nbsp;0.136300482358724184489780792989&nbsp;;&nbsp;0.120709227628674725099429705002&nbsp;;<br>
&nbsp;0.101991499699450815683781205733&nbsp;;&nbsp;0.806317639961196031447768461137e-1&nbsp;;&nbsp;0.571818021275668260047536271732e-1&nbsp;;&nbsp;0.322371231884889414916050281173e-1&nbsp;;<br>
&nbsp;0.526315789473684210526315789474e-2&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_1_x&nbsp;=&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_1_w&nbsp;=&nbsp;[|&nbsp;2.&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_2_w&nbsp;=&nbsp;[|&nbsp;1.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_2_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_3_w&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;4.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_3_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_4_w&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;4.&nbsp;;&nbsp;3.&nbsp;/.&nbsp;4.&nbsp;;&nbsp;3.&nbsp;/.&nbsp;4.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;4.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_4_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.33333333333333333333&nbsp;;&nbsp;0.33333333333333333333&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_5_w&nbsp;=&nbsp;[|&nbsp;7.&nbsp;/.&nbsp;45.&nbsp;;&nbsp;32.&nbsp;/.&nbsp;45.&nbsp;;&nbsp;12.&nbsp;/.&nbsp;45.&nbsp;;&nbsp;32.&nbsp;/.&nbsp;45.&nbsp;;&nbsp;7.&nbsp;/.&nbsp;45.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_5_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.5&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.5&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_6_w&nbsp;=&nbsp;[|&nbsp;19.&nbsp;/.&nbsp;144.&nbsp;;&nbsp;75.&nbsp;/.&nbsp;144.&nbsp;;&nbsp;50.&nbsp;/.&nbsp;144.&nbsp;;&nbsp;50.&nbsp;/.&nbsp;144.&nbsp;;&nbsp;75.&nbsp;/.&nbsp;144.&nbsp;;&nbsp;19.&nbsp;/.&nbsp;144.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_6_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.6&nbsp;;&nbsp;-0.2&nbsp;;&nbsp;0.2&nbsp;;&nbsp;0.6&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_7_w&nbsp;=&nbsp;[|&nbsp;41.&nbsp;/.&nbsp;420.&nbsp;;&nbsp;216.&nbsp;/.&nbsp;420.&nbsp;;&nbsp;27.&nbsp;/.&nbsp;420.&nbsp;;&nbsp;272.&nbsp;/.&nbsp;420.&nbsp;;&nbsp;27.&nbsp;/.&nbsp;420.&nbsp;;&nbsp;216.&nbsp;/.&nbsp;420.&nbsp;;&nbsp;41.&nbsp;/.&nbsp;420.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_7_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.66666666666666666667&nbsp;;&nbsp;-0.33333333333333333333&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.33333333333333333333&nbsp;;&nbsp;0.66666666666666666667&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_8_w&nbsp;=&nbsp;[|&nbsp;751.&nbsp;/.&nbsp;8640.&nbsp;;&nbsp;3577.&nbsp;/.&nbsp;8640.&nbsp;;&nbsp;1323.&nbsp;/.&nbsp;8640.&nbsp;;&nbsp;2989.&nbsp;/.&nbsp;8640.&nbsp;;&nbsp;2989.&nbsp;/.&nbsp;8640.&nbsp;;<br>
&nbsp;1323.&nbsp;/.&nbsp;8640.&nbsp;;&nbsp;3577.&nbsp;/.&nbsp;8640.&nbsp;;&nbsp;751.&nbsp;/.&nbsp;8640.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_8_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.71428571428571428571&nbsp;;&nbsp;-0.42857142857142857143&nbsp;;&nbsp;-0.14285714285714285714&nbsp;;<br>
&nbsp;0.14285714285714285714&nbsp;;&nbsp;0.42857142857142857143&nbsp;;&nbsp;0.71428571428571428571&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_9_w&nbsp;=&nbsp;[|&nbsp;989.&nbsp;/.&nbsp;14175.&nbsp;;&nbsp;5888.&nbsp;/.&nbsp;14175.&nbsp;;&nbsp;-928.&nbsp;/.&nbsp;14175.&nbsp;;&nbsp;10496.&nbsp;/.&nbsp;14175.&nbsp;;&nbsp;-4540.&nbsp;/.&nbsp;14175.&nbsp;;<br>
&nbsp;10496.&nbsp;/.&nbsp;14175.&nbsp;;&nbsp;-928.&nbsp;/.&nbsp;14175.&nbsp;;&nbsp;5888.&nbsp;/.&nbsp;14175.&nbsp;;&nbsp;989.&nbsp;/.&nbsp;14175.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_9_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.75&nbsp;;&nbsp;-0.5&nbsp;;&nbsp;-0.25&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.25&nbsp;;&nbsp;0.5&nbsp;;&nbsp;0.75&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_10_w&nbsp;=&nbsp;[|&nbsp;2857.&nbsp;/.&nbsp;44800.&nbsp;;&nbsp;15741.&nbsp;/.&nbsp;44800.&nbsp;;&nbsp;1080.&nbsp;/.&nbsp;44800.&nbsp;;&nbsp;19344.&nbsp;/.&nbsp;44800.&nbsp;;&nbsp;5778.&nbsp;/.&nbsp;44800.&nbsp;;<br>
&nbsp;5778.&nbsp;/.&nbsp;44800.&nbsp;;&nbsp;19344.&nbsp;/.&nbsp;44800.&nbsp;;&nbsp;1080.&nbsp;/.&nbsp;44800.&nbsp;;&nbsp;15741.&nbsp;/.&nbsp;44800.&nbsp;;&nbsp;2857.&nbsp;/.&nbsp;44800.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_10_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.77777777777777777778&nbsp;;&nbsp;-0.55555555555555555556&nbsp;;&nbsp;-0.33333333333333333333&nbsp;;&nbsp;-0.11111111111111111111&nbsp;;<br>
&nbsp;0.11111111111111111111&nbsp;;&nbsp;0.33333333333333333333&nbsp;;&nbsp;0.55555555555555555556&nbsp;;&nbsp;0.77777777777777777778&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_11_w&nbsp;=&nbsp;[|&nbsp;16067.&nbsp;/.&nbsp;299376.&nbsp;;&nbsp;106300.&nbsp;/.&nbsp;299376.&nbsp;;&nbsp;-&nbsp;48525.&nbsp;/.&nbsp;299376.&nbsp;;&nbsp;272400.&nbsp;/.&nbsp;299376.&nbsp;;&nbsp;-&nbsp;260550.&nbsp;/.&nbsp;299376.&nbsp;;<br>
&nbsp;427368.&nbsp;/.&nbsp;299376.&nbsp;;&nbsp;-&nbsp;260550.&nbsp;/.&nbsp;299376.&nbsp;;&nbsp;272400.&nbsp;/.&nbsp;299376.&nbsp;;&nbsp;-&nbsp;48525.&nbsp;/.&nbsp;299376.&nbsp;;&nbsp;106300.&nbsp;/.&nbsp;299376.&nbsp;;&nbsp;16067.&nbsp;/.&nbsp;299376.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_11_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.8&nbsp;;&nbsp;-0.6&nbsp;;&nbsp;-0.4&nbsp;;&nbsp;-0.2&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.2&nbsp;;&nbsp;0.4&nbsp;;&nbsp;0.6&nbsp;;&nbsp;0.8&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_12_w&nbsp;=&nbsp;[|&nbsp;2171465.&nbsp;/.&nbsp;43545600.&nbsp;;&nbsp;13486539.&nbsp;/.&nbsp;43545600.&nbsp;;&nbsp;-&nbsp;3237113.&nbsp;/.&nbsp;43545600.&nbsp;;&nbsp;25226685.&nbsp;/.&nbsp;43545600.&nbsp;;<br>
&nbsp;-&nbsp;9595542.&nbsp;/.&nbsp;43545600.&nbsp;;&nbsp;15493566.&nbsp;/.&nbsp;43545600.&nbsp;;&nbsp;15493566.&nbsp;/.&nbsp;43545600.&nbsp;;&nbsp;-&nbsp;9595542.&nbsp;/.&nbsp;43545600.&nbsp;;&nbsp;25226685.&nbsp;/.&nbsp;43545600.&nbsp;;<br>
&nbsp;-&nbsp;3237113.&nbsp;/.&nbsp;43545600.&nbsp;;&nbsp;13486539.&nbsp;/.&nbsp;43545600.&nbsp;;&nbsp;2171465.&nbsp;/.&nbsp;43545600.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_12_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.81818181818181818182&nbsp;;&nbsp;-0.63636363636363636364&nbsp;;&nbsp;-0.45454545454545454545&nbsp;;&nbsp;-0.27272727272727272727&nbsp;;<br>
&nbsp;-0.090909090909090909091&nbsp;;&nbsp;0.090909090909090909091&nbsp;;&nbsp;0.27272727272727272727&nbsp;;&nbsp;0.45454545454545454545&nbsp;;&nbsp;0.63636363636363636364&nbsp;;&nbsp;0.81818181818181818182&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_13_w&nbsp;=&nbsp;[|&nbsp;1364651.&nbsp;/.&nbsp;31531500.&nbsp;;&nbsp;9903168.&nbsp;/.&nbsp;31531500.&nbsp;;&nbsp;-&nbsp;7587864.&nbsp;/.&nbsp;31531500.&nbsp;;&nbsp;35725120.&nbsp;/.&nbsp;31531500.&nbsp;;<br>
&nbsp;-&nbsp;51491295.&nbsp;/.&nbsp;31531500.&nbsp;;&nbsp;87516288.&nbsp;/.&nbsp;31531500.&nbsp;;&nbsp;-&nbsp;87797136.&nbsp;/.&nbsp;31531500.&nbsp;;&nbsp;87516288.&nbsp;/.&nbsp;31531500.&nbsp;;&nbsp;-&nbsp;51491295.&nbsp;/.&nbsp;31531500.&nbsp;;<br>
&nbsp;35725120.&nbsp;/.&nbsp;31531500.&nbsp;;&nbsp;-&nbsp;7587864.&nbsp;/.&nbsp;31531500.&nbsp;;&nbsp;9903168.&nbsp;/.&nbsp;31531500.&nbsp;;&nbsp;1364651.&nbsp;/.&nbsp;31531500.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_13_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.83333333333333333333&nbsp;;&nbsp;-0.66666666666666666667&nbsp;;&nbsp;-0.5&nbsp;;&nbsp;-0.33333333333333333333&nbsp;;&nbsp;-0.16666666666666666667&nbsp;;<br>
&nbsp;0.&nbsp;;&nbsp;0.16666666666666666667&nbsp;;&nbsp;0.33333333333333333333&nbsp;;&nbsp;0.5&nbsp;;&nbsp;0.66666666666666666667&nbsp;;&nbsp;0.83333333333333333333&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_14_w&nbsp;=&nbsp;[|&nbsp;6137698213.&nbsp;/.&nbsp;150885504000.&nbsp;;&nbsp;42194238652.&nbsp;/.&nbsp;150885504000.&nbsp;;&nbsp;-&nbsp;23361540993.&nbsp;/.&nbsp;150885504000.&nbsp;;<br>
&nbsp;116778274403.&nbsp;/.&nbsp;150885504000.&nbsp;;&nbsp;-&nbsp;113219777650.&nbsp;/.&nbsp;150885504000.&nbsp;;&nbsp;154424590209.&nbsp;/.&nbsp;150885504000.&nbsp;;&nbsp;-&nbsp;32067978834.&nbsp;/.&nbsp;150885504000.&nbsp;;<br>
&nbsp;-&nbsp;32067978834.&nbsp;/.&nbsp;150885504000.&nbsp;;&nbsp;154424590209.&nbsp;/.&nbsp;150885504000.&nbsp;;&nbsp;-&nbsp;113219777650.&nbsp;/.&nbsp;150885504000.&nbsp;;&nbsp;116778274403.&nbsp;/.&nbsp;150885504000.&nbsp;;<br>
&nbsp;-&nbsp;23361540993.&nbsp;/.&nbsp;150885504000.&nbsp;;&nbsp;42194238652.&nbsp;/.&nbsp;150885504000.&nbsp;;&nbsp;6137698213.&nbsp;/.&nbsp;150885504000.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_14_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.84615384615384615385&nbsp;;&nbsp;-0.69230769230769230769&nbsp;;&nbsp;-0.53846153846153846154&nbsp;;&nbsp;-0.38461538461538461538&nbsp;;<br>
&nbsp;-0.23076923076923076923&nbsp;;&nbsp;-0.076923076923076923077&nbsp;;&nbsp;0.076923076923076923077&nbsp;;&nbsp;0.23076923076923076923&nbsp;;&nbsp;0.38461538461538461538&nbsp;;<br>
&nbsp;0.53846153846153846154&nbsp;;&nbsp;0.69230769230769230769&nbsp;;&nbsp;0.84615384615384615385&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_15_w&nbsp;=&nbsp;[|&nbsp;90241897.&nbsp;/.&nbsp;2501928000.&nbsp;;&nbsp;710986864.&nbsp;/.&nbsp;2501928000.&nbsp;;&nbsp;-&nbsp;770720657.&nbsp;/.&nbsp;2501928000.&nbsp;;&nbsp;3501442784.&nbsp;/.&nbsp;2501928000.&nbsp;;<br>
&nbsp;-&nbsp;6625093363.&nbsp;/.&nbsp;2501928000.&nbsp;;&nbsp;12630121616.&nbsp;/.&nbsp;2501928000.&nbsp;;&nbsp;-&nbsp;16802270373.&nbsp;/.&nbsp;2501928000.&nbsp;;&nbsp;19534438464.&nbsp;/.&nbsp;2501928000.&nbsp;;<br>
&nbsp;-&nbsp;16802270373.&nbsp;/.&nbsp;2501928000.&nbsp;;&nbsp;12630121616.&nbsp;/.&nbsp;2501928000.&nbsp;;&nbsp;-&nbsp;6625093363.&nbsp;/.&nbsp;2501928000.&nbsp;;&nbsp;3501442784.&nbsp;/.&nbsp;2501928000.&nbsp;;<br>
&nbsp;-&nbsp;770720657.&nbsp;/.&nbsp;2501928000.&nbsp;;&nbsp;710986864.&nbsp;/.&nbsp;2501928000.&nbsp;;&nbsp;90241897.&nbsp;/.&nbsp;2501928000.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_15_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.85714285714285714286&nbsp;;&nbsp;-0.71428571428571428571&nbsp;;&nbsp;-0.57142857142857142857&nbsp;;&nbsp;-0.42857142857142857143&nbsp;;<br>
&nbsp;-0.28571428571428571429&nbsp;;&nbsp;-0.14285714285714285714&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.14285714285714285714&nbsp;;&nbsp;0.28571428571428571429&nbsp;;<br>
&nbsp;0.42857142857142857143&nbsp;;&nbsp;0.57142857142857142857&nbsp;;&nbsp;0.71428571428571428571&nbsp;;&nbsp;0.85714285714285714286&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_16_w&nbsp;=&nbsp;[|&nbsp;105930069.&nbsp;/.&nbsp;3099672576.&nbsp;;&nbsp;796661595.&nbsp;/.&nbsp;3099672576.&nbsp;;&nbsp;-&nbsp;698808195.&nbsp;/.&nbsp;3099672576.&nbsp;;<br>
&nbsp;3143332755.&nbsp;/.&nbsp;3099672576.&nbsp;;&nbsp;-&nbsp;4688522055.&nbsp;/.&nbsp;3099672576.&nbsp;;&nbsp;7385654007.&nbsp;/.&nbsp;3099672576.&nbsp;;&nbsp;-&nbsp;6000998415.&nbsp;/.&nbsp;3099672576.&nbsp;;<br>
&nbsp;3056422815.&nbsp;/.&nbsp;3099672576.&nbsp;;&nbsp;3056422815.&nbsp;/.&nbsp;3099672576.&nbsp;;&nbsp;-&nbsp;6000998415.&nbsp;/.&nbsp;3099672576.&nbsp;;&nbsp;7385654007.&nbsp;/.&nbsp;3099672576.&nbsp;;<br>
&nbsp;-&nbsp;4688522055.&nbsp;/.&nbsp;3099672576.&nbsp;;&nbsp;3143332755.&nbsp;/.&nbsp;3099672576.&nbsp;;&nbsp;-&nbsp;698808195.&nbsp;/.&nbsp;3099672576.&nbsp;;&nbsp;796661595.&nbsp;/.&nbsp;3099672576.&nbsp;;&nbsp;105930069.&nbsp;/.&nbsp;3099672576.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_16_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.86666666666666666667&nbsp;;&nbsp;-0.73333333333333333333&nbsp;;&nbsp;-0.6&nbsp;;&nbsp;-0.46666666666666666667&nbsp;;&nbsp;-0.33333333333333333333&nbsp;;&nbsp;-0.2&nbsp;;<br>
&nbsp;-0.066666666666666666667&nbsp;;&nbsp;0.066666666666666666667&nbsp;;&nbsp;0.2&nbsp;;&nbsp;0.33333333333333333333&nbsp;;&nbsp;0.46666666666666666667&nbsp;;&nbsp;0.6&nbsp;;&nbsp;0.73333333333333333333&nbsp;;<br>
&nbsp;0.86666666666666666667&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_17_w&nbsp;=&nbsp;[|&nbsp;15043611773.&nbsp;/.&nbsp;488462349375.&nbsp;;&nbsp;127626606592.&nbsp;/.&nbsp;488462349375.&nbsp;;&nbsp;-&nbsp;179731134720.&nbsp;/.&nbsp;488462349375.&nbsp;;<br>
&nbsp;832211855360.&nbsp;/.&nbsp;488462349375.&nbsp;;&nbsp;-&nbsp;1929498607520.&nbsp;/.&nbsp;488462349375.&nbsp;;&nbsp;4177588893696.&nbsp;/.&nbsp;488462349375.&nbsp;;&nbsp;-&nbsp;6806534407936.&nbsp;/.&nbsp;488462349375.&nbsp;;<br>
&nbsp;9368875018240.&nbsp;/.&nbsp;488462349375.&nbsp;;&nbsp;-&nbsp;10234238972220.&nbsp;/.&nbsp;488462349375.&nbsp;;&nbsp;9368875018240.&nbsp;/.&nbsp;488462349375.&nbsp;;&nbsp;-&nbsp;6806534407936.&nbsp;/.&nbsp;488462349375.&nbsp;;<br>
&nbsp;4177588893696.&nbsp;/.&nbsp;488462349375.&nbsp;;&nbsp;-&nbsp;1929498607520.&nbsp;/.&nbsp;488462349375.&nbsp;;&nbsp;832211855360.&nbsp;/.&nbsp;488462349375.&nbsp;;<br>
&nbsp;-&nbsp;179731134720.&nbsp;/.&nbsp;488462349375.&nbsp;;&nbsp;127626606592.&nbsp;/.&nbsp;488462349375.&nbsp;;&nbsp;15043611773.&nbsp;/.&nbsp;488462349375.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_17_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.875&nbsp;;&nbsp;-0.75&nbsp;;&nbsp;-0.625&nbsp;;&nbsp;-0.5&nbsp;;&nbsp;-0.375&nbsp;;&nbsp;-0.25&nbsp;;&nbsp;-0.125&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.125&nbsp;;&nbsp;0.25&nbsp;;&nbsp;0.375&nbsp;;&nbsp;0.5&nbsp;;&nbsp;0.625&nbsp;;&nbsp;0.75&nbsp;;&nbsp;0.875&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_18_w&nbsp;=&nbsp;[|&nbsp;55294720874657.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;450185515446285.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;-&nbsp;542023437008852.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;2428636525764260.&nbsp;/.&nbsp;1883051089920000.&nbsp;;<br>
&nbsp;-&nbsp;4768916800123440.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;8855416648684984.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;-&nbsp;10905371859796660.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;10069615750132836.&nbsp;/.&nbsp;1883051089920000.&nbsp;;<br>
&nbsp;-&nbsp;3759785974054070.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;-&nbsp;3759785974054070.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;10069615750132836.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;-&nbsp;10905371859796660.&nbsp;/.&nbsp;1883051089920000.&nbsp;;<br>
&nbsp;8855416648684984.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;-&nbsp;4768916800123440.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;2428636525764260.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;-&nbsp;542023437008852.&nbsp;/.&nbsp;1883051089920000.&nbsp;;<br>
&nbsp;450185515446285.&nbsp;/.&nbsp;1883051089920000.&nbsp;;&nbsp;55294720874657.&nbsp;/.&nbsp;1883051089920000.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_18_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.88235294117647058824&nbsp;;&nbsp;-0.76470588235294117647&nbsp;;&nbsp;-0.64705882352941176471&nbsp;;&nbsp;-0.52941176470588235294&nbsp;;<br>
&nbsp;-0.41176470588235294118&nbsp;;&nbsp;-0.29411764705882352941&nbsp;;&nbsp;-0.17647058823529411765&nbsp;;&nbsp;-0.058823529411764705882&nbsp;;&nbsp;0.058823529411764705882&nbsp;;<br>
&nbsp;0.17647058823529411765&nbsp;;&nbsp;0.29411764705882352941&nbsp;;&nbsp;0.41176470588235294118&nbsp;;&nbsp;0.52941176470588235294&nbsp;;&nbsp;0.64705882352941176471&nbsp;;<br>
&nbsp;0.76470588235294117647&nbsp;;&nbsp;0.88235294117647058824&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_19_w&nbsp;=&nbsp;[|&nbsp;203732352169.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;1848730221900.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;-&nbsp;3212744374395.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;15529830312096.&nbsp;/.&nbsp;7604556960000.&nbsp;;<br>
&nbsp;-&nbsp;42368630685840.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;103680563465808.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;-&nbsp;198648429867720.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;319035784479840.&nbsp;/.&nbsp;7604556960000.&nbsp;;<br>
&nbsp;-&nbsp;419127951114198.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;461327344340680.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;-&nbsp;419127951114198.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;319035784479840.&nbsp;/.&nbsp;7604556960000.&nbsp;;<br>
&nbsp;-&nbsp;198648429867720.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;103680563465808.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;-&nbsp;42368630685840.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;15529830312096.&nbsp;/.&nbsp;7604556960000.&nbsp;;<br>
&nbsp;-&nbsp;3212744374395.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;1848730221900.&nbsp;/.&nbsp;7604556960000.&nbsp;;&nbsp;203732352169.&nbsp;/.&nbsp;7604556960000.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_19_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.88888888888888888889&nbsp;;&nbsp;-0.77777777777777777778&nbsp;;&nbsp;-0.66666666666666666667&nbsp;;&nbsp;-0.55555555555555555556&nbsp;;<br>
&nbsp;-0.44444444444444444444&nbsp;;&nbsp;-0.33333333333333333333&nbsp;;&nbsp;-0.22222222222222222222&nbsp;;&nbsp;-0.11111111111111111111&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.11111111111111111111&nbsp;;<br>
&nbsp;0.22222222222222222222&nbsp;;&nbsp;0.33333333333333333333&nbsp;;&nbsp;0.44444444444444444444&nbsp;;&nbsp;0.55555555555555555556&nbsp;;&nbsp;0.66666666666666666667&nbsp;;<br>
&nbsp;0.77777777777777777778&nbsp;;&nbsp;0.88888888888888888889&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_20_w&nbsp;=&nbsp;[|&nbsp;69028763155644023.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;603652082270808125.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;-&nbsp;926840515700222955.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;<br>
&nbsp;4301581538450500095.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;-&nbsp;10343692234243192788.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;22336420328479961316.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;<br>
&nbsp;-&nbsp;35331888421114781580.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;43920768370565135580.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;-&nbsp;37088370261379851390.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;<br>
&nbsp;15148337305921759574.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;15148337305921759574.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;-&nbsp;37088370261379851390.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;<br>
&nbsp;43920768370565135580.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;-&nbsp;35331888421114781580.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;22336420328479961316.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;<br>
&nbsp;-&nbsp;10343692234243192788.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;4301581538450500095.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;-&nbsp;926840515700222955.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;<br>
&nbsp;603652082270808125.&nbsp;/.&nbsp;2688996956405760000.&nbsp;;&nbsp;69028763155644023.&nbsp;/.&nbsp;2688996956405760000.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_20_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.89473684210526315789&nbsp;;&nbsp;-0.78947368421052631579&nbsp;;&nbsp;-0.68421052631578947368&nbsp;;<br>
&nbsp;-0.57894736842105263158&nbsp;;&nbsp;-0.47368421052631578947&nbsp;;&nbsp;-0.36842105263157894737&nbsp;;&nbsp;-0.26315789473684210526&nbsp;;<br>
&nbsp;-0.15789473684210526316&nbsp;;&nbsp;-0.052631578947368421053&nbsp;;&nbsp;0.052631578947368421053&nbsp;;&nbsp;0.15789473684210526316&nbsp;;<br>
&nbsp;0.26315789473684210526&nbsp;;&nbsp;0.36842105263157894737&nbsp;;&nbsp;0.47368421052631578947&nbsp;;&nbsp;0.57894736842105263158&nbsp;;<br>
&nbsp;0.68421052631578947368&nbsp;;&nbsp;0.78947368421052631579&nbsp;;&nbsp;0.89473684210526315789&nbsp;;&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_21_x&nbsp;=&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;-0.9&nbsp;;&nbsp;-0.8&nbsp;;&nbsp;-0.7&nbsp;;&nbsp;-0.6&nbsp;;&nbsp;-0.5&nbsp;;&nbsp;-0.4&nbsp;;&nbsp;-0.3&nbsp;;&nbsp;-0.2&nbsp;;&nbsp;-0.1&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.1&nbsp;;&nbsp;0.2&nbsp;;&nbsp;0.3&nbsp;;&nbsp;0.4&nbsp;;&nbsp;0.5&nbsp;;&nbsp;0.6&nbsp;;&nbsp;0.7&nbsp;;&nbsp;0.8&nbsp;;&nbsp;0.9&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;newton_cotes_21_w&nbsp;=&nbsp;[|&nbsp;0.023650546498063206389&nbsp;;&nbsp;0.22827543528921394997&nbsp;;&nbsp;-0.47295674102285392846&nbsp;;&nbsp;2.4123737869637513288&nbsp;;<br>
&nbsp;-7.5420634534306609355&nbsp;;&nbsp;20.673596439879602287&nbsp;;&nbsp;-45.417631687959024596&nbsp;;&nbsp;83.656114844387109207&nbsp;;&nbsp;-128.1505589803080093&nbsp;;<br>
&nbsp;165.59456694494570344&nbsp;;&nbsp;-180.01073427048578932&nbsp;;&nbsp;165.59456694494570344&nbsp;;&nbsp;-128.1505589803080093&nbsp;;&nbsp;83.656114844387109207&nbsp;;<br>
&nbsp;-45.417631687959024596&nbsp;;&nbsp;20.673596439879602287&nbsp;;&nbsp;-7.5420634534306609355&nbsp;;&nbsp;2.4123737869637513288&nbsp;;&nbsp;-0.47295674102285392846&nbsp;;<br>
&nbsp;0.22827543528921394997&nbsp;;&nbsp;0.023650546498063206389&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_1_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_1_w&nbsp;=&nbsp;[|&nbsp;&nbsp;2.0&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_2_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;<br>
&nbsp;1.0&nbsp;/.&nbsp;3.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_2_w&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;<br>
&nbsp;1.5&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_3_x&nbsp;=&nbsp;[|&nbsp;&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.289897948556635619639456814941&nbsp;;&nbsp;0.689897948556635619639456814941&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_3_w&nbsp;=&nbsp;[|&nbsp;0.222222222222222222222222222222&nbsp;;&nbsp;1.02497165237684322767762689304&nbsp;;&nbsp;0.752806125400934550100150884739&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_4_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.575318923521694112050483779752&nbsp;;&nbsp;0.181066271118530578270147495862&nbsp;;&nbsp;0.822824080974592105208907712461&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_4_w&nbsp;=&nbsp;[|&nbsp;0.125&nbsp;;&nbsp;0.657688639960119487888578442146&nbsp;;&nbsp;0.776386937686343761560464613780&nbsp;;&nbsp;0.440924422353536750550956944074&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_5_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.720480271312438895695825837750&nbsp;;&nbsp;-&nbsp;0.167180864737833640113395337326&nbsp;;&nbsp;0.446313972723752344639908004629&nbsp;;&nbsp;0.885791607770964635613757614892&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_5_w&nbsp;=&nbsp;[|&nbsp;0.08&nbsp;;&nbsp;0.446207802167141488805120436457&nbsp;;&nbsp;0.623653045951482508163709823153&nbsp;;&nbsp;0.562712030298924120384345300681&nbsp;;&nbsp;0.287427121582451882646824439708&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_6_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.802929828402347147753002204224&nbsp;;&nbsp;-&nbsp;0.390928546707272189029229647442&nbsp;;&nbsp;0.124050379505227711989974959990&nbsp;;&nbsp;0.603973164252783654928415726409&nbsp;;<br>
&nbsp;0.920380285897062515318386619813&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_6_w&nbsp;=&nbsp;[|&nbsp;0.555555555555555555555555555556e-1&nbsp;;&nbsp;0.319640753220510966545779983796&nbsp;;&nbsp;0.485387188468969916159827915587&nbsp;;&nbsp;0.520926783189574982570229406570&nbsp;;<br>
&nbsp;0.416901334311907738959406382743&nbsp;;&nbsp;0.201588385253480840209200755749&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_7_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.853891342639482229703747931639&nbsp;;&nbsp;-&nbsp;0.538467724060109001833766720231&nbsp;;&nbsp;-&nbsp;0.117343037543100264162786683611&nbsp;;&nbsp;0.326030619437691401805894055838&nbsp;;<br>
&nbsp;0.703842800663031416300046295008&nbsp;;&nbsp;0.941367145680430216055899446174&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_7_w&nbsp;=&nbsp;[|&nbsp;0.408163265306122448979591836735e-1&nbsp;;&nbsp;0.239227489225312405787077480770&nbsp;;&nbsp;0.380949873644231153805938347876&nbsp;;&nbsp;0.447109829014566469499348953642&nbsp;;<br>
&nbsp;0.424703779005955608398308039150&nbsp;;&nbsp;0.318204231467301481744870434470&nbsp;;&nbsp;0.148988471112020635866497560418&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_8_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.887474878926155707068695617935&nbsp;;&nbsp;-&nbsp;0.639518616526215270024840114382&nbsp;;&nbsp;-&nbsp;0.294750565773660725252184459658&nbsp;;&nbsp;0.943072526611107660028971153047e-1&nbsp;;<br>
&nbsp;0.468420354430821063046421216613&nbsp;;&nbsp;0.770641893678191536180719525865&nbsp;;&nbsp;0.955041227122575003782349000858&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_8_w&nbsp;=&nbsp;[|&nbsp;0.03125&nbsp;;&nbsp;0.185358154802979278540728972699&nbsp;;&nbsp;0.304130620646785128975743291400&nbsp;;&nbsp;0.376517545389118556572129261442&nbsp;;&nbsp;0.391572167452493593082499534004&nbsp;;<br>
&nbsp;0.347014795634501280228675918422&nbsp;;&nbsp;0.249647901329864963257869293513&nbsp;;&nbsp;0.114508814744257199342353728520&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_9_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.910732089420060298533757956283&nbsp;;&nbsp;-&nbsp;0.711267485915708857029562959544&nbsp;;&nbsp;-&nbsp;0.426350485711138962102627520502&nbsp;;&nbsp;-&nbsp;0.903733696068532980645444599064e-1&nbsp;;<br>
&nbsp;0.256135670833455395138292079035&nbsp;;&nbsp;0.571383041208738483284917464837&nbsp;;&nbsp;0.817352784200412087992517083851&nbsp;;&nbsp;0.964440169705273096373589797925&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_9_w&nbsp;=&nbsp;[|&nbsp;0.246913580246913580246913580247e-1&nbsp;;&nbsp;0.147654019046315385819588499802&nbsp;;&nbsp;0.247189378204593052361239794969&nbsp;;&nbsp;0.316843775670437978338000849642&nbsp;;<br>
&nbsp;0.348273002772966594071991031186&nbsp;;&nbsp;0.337693966975929585803724239792&nbsp;;&nbsp;0.286386696357231171146705637752&nbsp;;&nbsp;0.200553298024551957421165090417&nbsp;;&nbsp;0.907145049232829170128934984159e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_10_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.927484374233581078117671398464&nbsp;;&nbsp;-&nbsp;0.763842042420002599615429776011&nbsp;;&nbsp;-&nbsp;0.525646030370079229365386614293&nbsp;;&nbsp;-&nbsp;0.236234469390588049278459503207&nbsp;;<br>
&nbsp;0.760591978379781302337137826389e-1&nbsp;;&nbsp;0.380664840144724365880759065541&nbsp;;&nbsp;0.647766687674009436273648507855&nbsp;;&nbsp;0.851225220581607910728163628088&nbsp;;&nbsp;0.971175180702246902734346518378&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_10_w&nbsp;=&nbsp;[|&nbsp;0.02&nbsp;;&nbsp;0.120296670557481631517310522702&nbsp;;&nbsp;0.204270131879000675555788672223&nbsp;;&nbsp;0.268194837841178696058554475262&nbsp;;&nbsp;0.305859287724422621016275475401&nbsp;;<br>
&nbsp;0.313582457226938376695902847302&nbsp;;&nbsp;0.290610164832918311146863077963&nbsp;;&nbsp;0.239193431714379713376571966160&nbsp;;&nbsp;0.164376012736921475701681668908&nbsp;;&nbsp;0.736170054867584989310512940790e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_11_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.939941935677027005913871284731&nbsp;;&nbsp;-&nbsp;0.803421975580293540697597956820&nbsp;;&nbsp;-&nbsp;0.601957842073797690275892603234&nbsp;;&nbsp;-&nbsp;0.351888923353330214714301017870&nbsp;;<br>
&nbsp;-&nbsp;0.734775314313212657461903554238e-1&nbsp;;&nbsp;0.210720306228426314076095789845&nbsp;;&nbsp;0.477680647983087519467896683890&nbsp;;&nbsp;0.705777100713859519144801128840&nbsp;;&nbsp;0.876535856245703748954741265611&nbsp;;<br>
&nbsp;0.976164773135168806180508826082&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_11_w&nbsp;=&nbsp;[|&nbsp;0.165289256198347107438016528926e-1&nbsp;;&nbsp;0.998460819079680638957534695802e-1&nbsp;;&nbsp;0.171317619206659836486712649042&nbsp;;&nbsp;0.228866123848976624401683231126&nbsp;;<br>
&nbsp;0.267867086189684177806638163355&nbsp;;&nbsp;0.285165563941007337460004408915&nbsp;;&nbsp;0.279361333103383045188962195720&nbsp;;&nbsp;0.250925377697128394649140267633&nbsp;;&nbsp;0.202163108540024418349931754266&nbsp;;<br>
&nbsp;0.137033682133202256310153880580&nbsp;;&nbsp;0.609250978121311347072183268883e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_12_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.949452759204959300493337627077&nbsp;;&nbsp;-&nbsp;0.833916773105189706586269254036&nbsp;;&nbsp;-&nbsp;0.661649799245637148061133087811&nbsp;;&nbsp;-&nbsp;0.444406569781935851126642615609&nbsp;;<br>
&nbsp;-&nbsp;0.196994559534278366455441427346&nbsp;;&nbsp;0.637247738208319158337792384845e-1&nbsp;;&nbsp;0.319983684170669623532789532206&nbsp;;&nbsp;0.554318785912324288984337093085&nbsp;;&nbsp;0.750761549711113852529400825472&nbsp;;<br>
&nbsp;0.895929097745638894832914608454&nbsp;;&nbsp;0.979963439076639188313950540264&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_12_w&nbsp;=&nbsp;[|&nbsp;0.138888888888888888888888888888e-1&nbsp;;&nbsp;0.841721349386809762415796536813e-1&nbsp;;&nbsp;0.145563668853995128522547654706&nbsp;;&nbsp;0.196998534826089634656049637969&nbsp;;<br>
&nbsp;0.235003115144985839348633985940&nbsp;;&nbsp;0.256991338152707776127974253598&nbsp;;&nbsp;0.261465660552133103438074715743&nbsp;;&nbsp;0.248121560804009959403073107079&nbsp;;&nbsp;0.217868879026192438848747482023&nbsp;;<br>
&nbsp;0.172770639313308564306065766966&nbsp;;&nbsp;0.115907480291738392750341908272&nbsp;;&nbsp;0.512480992072692974680229451351e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_13_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.956875873668299278183813833834&nbsp;;&nbsp;-&nbsp;0.857884202528822035697620310269&nbsp;;&nbsp;-&nbsp;0.709105087529871761580423832811&nbsp;;&nbsp;-&nbsp;0.519197779050454107485205148087&nbsp;;<br>
&nbsp;-&nbsp;0.299201300554509985532583446686&nbsp;;&nbsp;-&nbsp;0.619016986256353412578604857936e-1&nbsp;;&nbsp;0.178909837597084635021931298881&nbsp;;&nbsp;0.409238231474839556754166331248&nbsp;;&nbsp;0.615697890940291918017885487543&nbsp;;<br>
&nbsp;0.786291018233046684731786459135&nbsp;;&nbsp;0.911107073689184553949066402429&nbsp;;&nbsp;0.982921890023145161262671078244&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_13_w&nbsp;=&nbsp;[|&nbsp;0.118343195266272189349112426036e-1&nbsp;;&nbsp;0.719024162924955289397537405641e-1&nbsp;;&nbsp;0.125103834331152358133769287976&nbsp;;&nbsp;0.171003460470616642463758674512&nbsp;;<br>
&nbsp;0.206960611455877074631132560829&nbsp;;&nbsp;0.230888862886995434012203758668&nbsp;;&nbsp;0.241398342287691148630866924129&nbsp;;&nbsp;0.237878547660712031342685189180&nbsp;;&nbsp;0.220534229288451464691077164199&nbsp;;<br>
&nbsp;0.190373715559631732254759820746&nbsp;;&nbsp;0.149150950090000205151491864242&nbsp;;&nbsp;0.992678068818470859847363877478e-1&nbsp;;&nbsp;0.437029032679020748288533846051e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_14_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.962779269978024297120561244319&nbsp;;&nbsp;-&nbsp;0.877048918201462024795266773531&nbsp;;&nbsp;-&nbsp;0.747389642613378838735429134263&nbsp;;&nbsp;-&nbsp;0.580314056546874971105726664999&nbsp;;<br>
&nbsp;-&nbsp;0.384202003439203313794083903375&nbsp;;&nbsp;-&nbsp;0.168887928042680911008441695622&nbsp;;&nbsp;0.548312279917645496498107146428e-1&nbsp;;&nbsp;0.275737205435522399182637403545&nbsp;;&nbsp;0.482752918588474966820418534355&nbsp;;<br>
&nbsp;0.665497977216884537008955042481&nbsp;;&nbsp;0.814809550601994729434217249123&nbsp;;&nbsp;0.923203722520643299246334950272&nbsp;;&nbsp;0.985270697947821356698617003172&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_14_w&nbsp;=&nbsp;[|&nbsp;0.102040816326530612244897959184e-1&nbsp;;&nbsp;0.621220169077714601661329164668e-1&nbsp;;&nbsp;0.108607722744362826826720935229&nbsp;;&nbsp;0.149620539353121355950520836946&nbsp;;<br>
&nbsp;0.183127002125729654123867302103&nbsp;;&nbsp;0.207449763335175672668082886489&nbsp;;&nbsp;0.221369811499570948931671683021&nbsp;;&nbsp;0.224189348002707794238414632220&nbsp;;&nbsp;0.215767100604618851381187446115&nbsp;;<br>
&nbsp;0.196525518452982430324613091930&nbsp;;&nbsp;0.167429727891086278990102277038&nbsp;;&nbsp;0.129939668737342347807425737146&nbsp;;&nbsp;0.859405354429804030893077310866e-1&nbsp;;&nbsp;0.377071632698969142774627282919e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;radau_15_x&nbsp;=&nbsp;[|&nbsp;-&nbsp;1.0&nbsp;;&nbsp;-&nbsp;0.967550468197200476562456018282&nbsp;;&nbsp;-&nbsp;0.892605400120550767066811886849&nbsp;;&nbsp;-&nbsp;0.778685617639031079381743321893&nbsp;;&nbsp;-&nbsp;0.630779478886949283946148437224&nbsp;;<br>
&nbsp;-&nbsp;0.455352905778529370872053455981&nbsp;;&nbsp;-&nbsp;0.260073376740807915768961188263&nbsp;;&nbsp;-&nbsp;0.534757226797460641074538896258e-1&nbsp;;&nbsp;0.155410685384859484319182024964&nbsp;;&nbsp;0.357456512022127651195319205174&nbsp;;<br>
&nbsp;0.543831458701484016930711802760&nbsp;;&nbsp;0.706390264637572540152679669478&nbsp;;&nbsp;0.838029000636089631215097384520&nbsp;;&nbsp;0.932997190935973719928072142859&nbsp;;&nbsp;0.987166478414363086378359071811&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;radau_15_w&nbsp;=&nbsp;[|&nbsp;0.888888888888888888888888888889e-2&nbsp;;&nbsp;0.542027800486444943382142368018e-1&nbsp;;&nbsp;0.951295994604808992038477266346e-1&nbsp;;&nbsp;0.131875462504951632186262157944&nbsp;;<br>
&nbsp;0.162854477303832629448732245828&nbsp;;&nbsp;0.186715145839450908083795103799&nbsp;;&nbsp;0.202415187030618429872703310435&nbsp;;&nbsp;0.209268608147694581430889790306&nbsp;;&nbsp;0.206975960249553755479027321787&nbsp;;<br>
&nbsp;0.195637503045116116473556617575&nbsp;;&nbsp;0.175748872642447685670310440476&nbsp;;&nbsp;0.148179527003467253924682058743&nbsp;;&nbsp;0.114135203489752753013075582569&nbsp;;&nbsp;0.751083927605064397329716653914e-1&nbsp;;<br>
&nbsp;0.328643915845935322530428528231e-1&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_weighted_int_minus1_1 abscissae weights function a b</pre> The standard abscissae are spread over the interval <code class="code">-1 ; 1</code>.
The ends of the integration interval must be filled in.
<p>

Les abscisses normalisées sont réparties sur l'interavlle <code class="code">-1 ; 1</code>.
Les bornes d'intégration doivent être précisées. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_weighted_int_minus1_1&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(x:float&nbsp;array)&nbsp;(w:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;x<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;center&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;/.&nbsp;2.<br>
&nbsp;<span class="keyword">and</span>&nbsp;halflength&nbsp;=&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;/.&nbsp;2.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;w.(i)&nbsp;*.&nbsp;f&nbsp;(&nbsp;center&nbsp;+.&nbsp;halflength&nbsp;*.&nbsp;x.(i)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;*.&nbsp;halflength&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Mthodesadaptativesvaries"><h2>Méthodes adaptatives variées</h2></span>
<span id="2_Miscellaneousadaptativemethods"><h2>Miscellaneous adaptative methods</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_dichot_adapt methode tolerance function a b</pre> The method must contain the integrating method, included
the parameters, as in the following example. 
The tolerance is the relative error allowed between two steps in order to stop the dichotomy.
<p>

<pre>float_int_romberg 11 4</pre>
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres, 
comme dans l'exemple ci-dessus. La tolérance est l'erreur relative admise entre deux pas pour arrêter la dichotomie.
*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_dichot_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;methode&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;ref&nbsp;(&nbsp;methode&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;methode&nbsp;f&nbsp;c&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;!second&nbsp;-.&nbsp;first&nbsp;)&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;!second&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;float_int_dichot_adapt&nbsp;methode&nbsp;tol&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;float_int_dichot_adapt&nbsp;methode&nbsp;tol&nbsp;f&nbsp;c&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!second&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_dichot_bounded maxstages methode tolerance function a b</pre> The method must contain the integrating method, included
the parameters, as in the following example. 
The tolerance is the relative error allowed between two steps in order to stop the dichotomy.
<p>

<pre>float_int_romberg 11 4</pre>
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres, 
comme dans l'exemple ci-dessus. La tolérance est l'erreur relative admise entre deux pas pour arrêter la dichotomie.
*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_dichot_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;methode&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;(&nbsp;a&nbsp;+.&nbsp;b&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;ref&nbsp;(&nbsp;methode&nbsp;f&nbsp;a&nbsp;c&nbsp;+.&nbsp;methode&nbsp;f&nbsp;c&nbsp;b&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;!second&nbsp;-.&nbsp;first&nbsp;)&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;!second&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;float_int_dichot_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;methode&nbsp;tol&nbsp;f&nbsp;a&nbsp;c<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+.&nbsp;float_int_dichot_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;methode&nbsp;tol&nbsp;f&nbsp;c&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;!second&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_multi_adapt methode nslices tolerance function a b</pre> The method must contain the integrating method, included
the parameters, as in the following example. 
The tolerance is the relative error allowed between two steps in order to stop the slicing.
<p>

<pre>float_int_romberg 11 4</pre>
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres, 
comme dans l'exemple ci-dessus. La tolérance est l'erreur relative admise entre deux pas pour arrêter le tranchage.
*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_multi_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(nslices:int)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;methode&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keyword">and</span>&nbsp;length&nbsp;=&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nslices&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;ref&nbsp;(&nbsp;a&nbsp;+.&nbsp;length&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;ref&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;ref&nbsp;(&nbsp;methode&nbsp;f&nbsp;a&nbsp;!c&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nslices&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;!c&nbsp;+.&nbsp;length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;!second&nbsp;+.&nbsp;methode&nbsp;f&nbsp;!c&nbsp;!d&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;!d&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;!second&nbsp;-.&nbsp;first&nbsp;)&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;!second&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;a&nbsp;+.&nbsp;length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;float_int_multi_adapt&nbsp;methode&nbsp;nslices&nbsp;tol&nbsp;f&nbsp;a&nbsp;!c&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nslices&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;!c&nbsp;+.&nbsp;length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;!second&nbsp;+.&nbsp;float_int_multi_adapt&nbsp;methode&nbsp;nslices&nbsp;tol&nbsp;f&nbsp;!c&nbsp;!d&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;!d&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;!second&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_multi_bounded maxstages methode nslices tolerance function a b</pre> The method must contain the integrating method, included
the parameters, as in the following example. 
The tolerance is the relative error allowed between two steps in order to stop the slicing.
<p>

<pre>float_int_romberg 11 4</pre>
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres, 
comme dans l'exemple ci-dessus. La tolérance est l'erreur relative admise entre deux pas pour arrêter le tranchage.
*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_multi_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;methode&nbsp;(nslices:int)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;methode&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;length&nbsp;=&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nslices&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;ref&nbsp;(&nbsp;a&nbsp;+.&nbsp;length&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;d&nbsp;=&nbsp;ref&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;second&nbsp;=&nbsp;ref&nbsp;(&nbsp;methode&nbsp;f&nbsp;a&nbsp;!c&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nslices&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;!c&nbsp;+.&nbsp;length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;!second&nbsp;+.&nbsp;methode&nbsp;f&nbsp;!c&nbsp;!d&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;!d&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;abs_float&nbsp;(&nbsp;!second&nbsp;-.&nbsp;first&nbsp;)&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;abs_float&nbsp;!second&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;a&nbsp;+.&nbsp;length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;float_int_multi_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;methode&nbsp;nslices&nbsp;tol&nbsp;f&nbsp;a&nbsp;!c&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nslices&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;!c&nbsp;+.&nbsp;length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;!second&nbsp;+.&nbsp;float_int_multi_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;methode&nbsp;nslices&nbsp;tol&nbsp;f&nbsp;!c&nbsp;!d&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;!d&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!second&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_adapt_trapez_simpson nintervals tolerance function a b</pre> The tolerance is the maximal 
relative error for every step whose overshoot triggers an integral over the sub-interval.
<p>

La tolérance est l'erreur relative maximale pour chaque pas dont le dépassement 
entraîne une intégrale sur le sous-intervalle. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_adapt_trapez_simpson&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:int)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;a&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;length&nbsp;=&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;n&nbsp;-&nbsp;2<br>
&nbsp;<span class="keyword">and</span>&nbsp;nnn&nbsp;=&nbsp;int_of_float&nbsp;(&nbsp;sqrt&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;a&nbsp;+.&nbsp;length&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;!xx&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;!y&nbsp;+.&nbsp;!yy&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;-.&nbsp;!y&nbsp;)&nbsp;&lt;=&nbsp;tol&nbsp;*.&nbsp;abs_float&nbsp;!z&nbsp;<span class="keyword">then</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!z&nbsp;*.&nbsp;length<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;accu&nbsp;:=&nbsp;float_int_simpson&nbsp;nnn&nbsp;f&nbsp;a&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nn&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!xx&nbsp;+.&nbsp;length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;(&nbsp;!y&nbsp;+.&nbsp;!yy&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;-.&nbsp;!y&nbsp;)&nbsp;&lt;=&nbsp;tol&nbsp;*.&nbsp;abs_float&nbsp;!z&nbsp;<span class="keyword">then</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;!z&nbsp;*.&nbsp;length<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;float_int_simpson&nbsp;nnn&nbsp;f&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;b&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;(&nbsp;!y&nbsp;+.&nbsp;!yy&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;-.&nbsp;!y&nbsp;)&nbsp;&lt;=&nbsp;tol&nbsp;*.&nbsp;abs_float&nbsp;!z&nbsp;<span class="keyword">then</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;!z&nbsp;*.&nbsp;length<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;float_int_simpson&nbsp;nnn&nbsp;f&nbsp;!x&nbsp;b&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_adapt methode nintervals tolerance function a b</pre> The method must contain the integrating method, 
included the parameters, as in the following example. 
The tolerance is the maximal relative error for every step 
whose overshoot triggers an integral over the sub-interval.
<p>

<pre>float_int_simpson 100</pre>
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres, comme dans l'exemple ci-dessus. 
La tolérance est l'erreur relative maximale pour chaque pas dont le dépassement 
entraîne une intégrale sur le sous-intervalle.
*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(n:int)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;a&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;length&nbsp;=&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;n&nbsp;-&nbsp;2&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;(&nbsp;a&nbsp;+.&nbsp;length&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;!xx&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;!y&nbsp;+.&nbsp;!yy&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;-.&nbsp;!y&nbsp;)&nbsp;&lt;=&nbsp;tol&nbsp;*.&nbsp;abs_float&nbsp;!z&nbsp;<span class="keyword">then</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!z&nbsp;*.&nbsp;length<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;accu&nbsp;:=&nbsp;methode&nbsp;f&nbsp;a&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nn&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!xx&nbsp;+.&nbsp;length&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;(&nbsp;!y&nbsp;+.&nbsp;!yy&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;-.&nbsp;!y&nbsp;)&nbsp;&lt;=&nbsp;tol&nbsp;*.&nbsp;abs_float&nbsp;!z&nbsp;<span class="keyword">then</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;!z&nbsp;*.&nbsp;length<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;methode&nbsp;f&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;f&nbsp;b&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;(&nbsp;!y&nbsp;+.&nbsp;!yy&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!yy&nbsp;-.&nbsp;!y&nbsp;)&nbsp;&lt;=&nbsp;tol&nbsp;*.&nbsp;abs_float&nbsp;!z&nbsp;<span class="keyword">then</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;!z&nbsp;*.&nbsp;length<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;methode&nbsp;f&nbsp;!x&nbsp;b&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Intgralesmultiplesetmultidimensionnelles"><h2>Intégrales multiples et multidimensionnelles</h2></span>
<span id="2_Multidimensionalandmultipleintegrals"><h2>Multidimensional and multiple integrals</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The multiple integrals are calculated over rectangular parallelepipedes.
<p>

Les intégrales multiples sont calculées sur des pavés. *)</span></td></tr></table><code class="code"><br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_double methode function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_double&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;;&nbsp;y&nbsp;|]&nbsp;)&nbsp;a.(0)&nbsp;b.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode&nbsp;g&nbsp;a.(1)&nbsp;b.(1)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_triple methode function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_int_triple&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;<span class="constructor">Array</span>.append&nbsp;[|&nbsp;x&nbsp;|]&nbsp;v&nbsp;)&nbsp;)&nbsp;a.(0)&nbsp;b.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;float_int_double&nbsp;methode&nbsp;g&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;a&nbsp;1&nbsp;2&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;b&nbsp;1&nbsp;2&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_mult methode function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_mult&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;r&nbsp;&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;0.<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;|]&nbsp;)&nbsp;a.(0)&nbsp;b.(0)<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;2&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_int_double&nbsp;methode&nbsp;f&nbsp;a&nbsp;b&nbsp;<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;3&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_int_triple&nbsp;methode&nbsp;f&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;<span class="constructor">Array</span>.append&nbsp;[|&nbsp;x&nbsp;|]&nbsp;v&nbsp;)&nbsp;)&nbsp;a.(0)&nbsp;b.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;rr&nbsp;=&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;float_int_mult&nbsp;methode&nbsp;g&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;a&nbsp;1&nbsp;rr&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;b&nbsp;1&nbsp;rr&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_float_int_mult methode function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;matrix_float_int_mult&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;r&nbsp;&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;0.<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_int_mult&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;|]&nbsp;)&nbsp;a.(0)&nbsp;b.(0)<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_int_mult&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;<span class="constructor">Array</span>.append&nbsp;[|&nbsp;x&nbsp;|]&nbsp;v&nbsp;)&nbsp;)&nbsp;a.(0)&nbsp;b.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;rr&nbsp;=&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;matrix_float_int_mult&nbsp;methode&nbsp;g&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;a&nbsp;1&nbsp;rr&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;b&nbsp;1&nbsp;rr&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_vector_int methode function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_vector_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;(&nbsp;f&nbsp;a&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;v.(i)&nbsp;&lt;-&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;x&nbsp;).(i)&nbsp;)&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;v&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_matrix_int methode function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_matrix_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(a:float)&nbsp;(b:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;aa&nbsp;=&nbsp;(&nbsp;f&nbsp;a&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;aa<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;aa.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;c&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.(i)&nbsp;&lt;-&nbsp;float_vector_int&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;x&nbsp;).(i)&nbsp;)&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_int_mult methode function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_int_mult&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;(&nbsp;f&nbsp;a&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;v&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;v.(i)&nbsp;&lt;-&nbsp;float_int_mult&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;x&nbsp;).(i)&nbsp;)&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;v&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_matrix_int_mult methode function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_matrix_int_mult&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;aa&nbsp;=&nbsp;(&nbsp;f&nbsp;a&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;aa<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;aa.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;m&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;c&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.(i)&nbsp;&lt;-&nbsp;vector_int_mult&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;x&nbsp;).(i)&nbsp;)&nbsp;a&nbsp;b<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_vector_int_mult methode function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;matrix_vector_int_mult&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;r&nbsp;&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;0.&nbsp;|]<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;vector_int_mult&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;|]&nbsp;)&nbsp;a.(0)&nbsp;b.(0)<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;vector_int_mult&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;<span class="constructor">Array</span>.append&nbsp;[|&nbsp;x&nbsp;|]&nbsp;v&nbsp;)&nbsp;)&nbsp;a.(0)&nbsp;b.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;rr&nbsp;=&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;matrix_vector_int_mult&nbsp;methode&nbsp;g&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;a&nbsp;1&nbsp;rr&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;b&nbsp;1&nbsp;rr&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_int_mult methode function a b</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;matrix_int_mult&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;r&nbsp;&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;|]<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;1&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;vector_matrix_int_mult&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;[|&nbsp;x&nbsp;|]&nbsp;)&nbsp;a.(0)&nbsp;b.(0)<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;vector_matrix_int_mult&nbsp;methode&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;<span class="constructor">Array</span>.append&nbsp;[|&nbsp;x&nbsp;|]&nbsp;v&nbsp;)&nbsp;)&nbsp;a.(0)&nbsp;b.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;rr&nbsp;=&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;matrix_int_mult&nbsp;methode&nbsp;g&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;a&nbsp;1&nbsp;rr&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;b&nbsp;1&nbsp;rr&nbsp;)&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_int_mult_monte_carlo samples function center range</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_int_mult_monte_carlo&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(samples:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(r:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;s&nbsp;=&nbsp;float&nbsp;samples<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;samples&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;a&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_bal_random&nbsp;l&nbsp;r&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;f&nbsp;!x&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;*.&nbsp;(&nbsp;(&nbsp;2.&nbsp;*.&nbsp;r&nbsp;)&nbsp;**&nbsp;(&nbsp;float&nbsp;l&nbsp;)&nbsp;)&nbsp;/.&nbsp;s&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_compensated_int_mult_monte_carlo accelerator samples function center range</pre> The <code class="code">accelerator</code> is appied to real numbers. The <code class="code">factor</code> must be chosen 0 and 1.
<p>

L'accélérateur <code class="code">accelerator</code> s'applique aux réels. Le facteur <code class="code">factor</code> doit être choisi entre 0 et 1. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_compensated_int_mult_monte_carlo&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;accelerator&nbsp;(stages:int)&nbsp;(factor:float)&nbsp;(samples:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(r:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;seq&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;stages&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;aux&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;n&nbsp;p&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int_of_float&nbsp;(&nbsp;(&nbsp;factor&nbsp;**&nbsp;(&nbsp;float&nbsp;p&nbsp;)&nbsp;)&nbsp;*.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;stages&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;seq.(i)&nbsp;&lt;-&nbsp;float_int_mult_monte_carlo&nbsp;(&nbsp;aux&nbsp;samples&nbsp;(&nbsp;stages&nbsp;-&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;)&nbsp;f&nbsp;a&nbsp;r<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;accelerator&nbsp;seq&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_int_mult_monte_carlo samples function center range</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_int_mult_monte_carlo&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(samples:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(r:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;s&nbsp;=&nbsp;float&nbsp;samples<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;(&nbsp;f&nbsp;a&nbsp;)&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;samples&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;a&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_bal_random&nbsp;l&nbsp;r&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;!accu&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;(&nbsp;(&nbsp;2.&nbsp;*.&nbsp;r&nbsp;)&nbsp;**&nbsp;(&nbsp;float&nbsp;l&nbsp;)&nbsp;)&nbsp;/.&nbsp;s&nbsp;)&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_compensated_int_mult_monte_carlo accelerator samples function center range</pre> The <code class="code">accelerator</code> is appied to real vectors. The <code class="code">factor</code> must be chosen 0 and 1.
<p>

L'accélérateur <code class="code">accelerator</code> s'applique aux vecteurs réels. Le facteur <code class="code">factor</code> doit être choisi entre 0 et 1. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_compensated_int_mult_monte_carlo&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;accelerator&nbsp;(stages:int)&nbsp;(factor:float)&nbsp;(samples:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(r:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;seq&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;stages&nbsp;(&nbsp;f&nbsp;a&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;aux&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;n&nbsp;p&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int_of_float&nbsp;(&nbsp;(&nbsp;factor&nbsp;**&nbsp;(&nbsp;float&nbsp;p&nbsp;)&nbsp;)&nbsp;*.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;stages&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;seq.(i)&nbsp;&lt;-&nbsp;vector_int_mult_monte_carlo&nbsp;(&nbsp;aux&nbsp;samples&nbsp;(&nbsp;stages&nbsp;-&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;)&nbsp;f&nbsp;a&nbsp;r<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;accelerator&nbsp;seq&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_matrix_int_mult_monte_carlo samples function center range</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_matrix_int_mult_monte_carlo&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(samples:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(r:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;s&nbsp;=&nbsp;float&nbsp;samples<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;fa&nbsp;=&nbsp;f&nbsp;a&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;fa&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;fa.(0)&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;samples&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;a&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_bal_random&nbsp;l&nbsp;r&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;!accu&nbsp;(&nbsp;f&nbsp;!x&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;(&nbsp;(&nbsp;2.&nbsp;*.&nbsp;r&nbsp;)&nbsp;**&nbsp;(&nbsp;float&nbsp;l&nbsp;)&nbsp;)&nbsp;/.&nbsp;s&nbsp;)&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_matrix_compensated_int_mult_monte_carlo accelerator samples function center range</pre> The <code class="code">accelerator</code> is appied to real matrices. The <code class="code">factor</code> must be chosen 0 and 1.
<p>

L'accélérateur <code class="code">accelerator</code> s'applique aux matrices réelles. Le facteur <code class="code">factor</code> doit être choisi entre 0 et 1. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_matrix_compensated_int_mult_monte_carlo&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;accelerator&nbsp;(stages:int)&nbsp;(factor:float)&nbsp;(samples:int)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(r:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;seq&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;stages&nbsp;(&nbsp;f&nbsp;a&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;aux&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;n&nbsp;p&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;int_of_float&nbsp;(&nbsp;(&nbsp;factor&nbsp;**&nbsp;(&nbsp;float&nbsp;p&nbsp;)&nbsp;)&nbsp;*.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;pred&nbsp;stages&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;seq.(i)&nbsp;&lt;-&nbsp;vector_matrix_int_mult_monte_carlo&nbsp;(&nbsp;aux&nbsp;samples&nbsp;(&nbsp;stages&nbsp;-&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;)&nbsp;f&nbsp;a&nbsp;r<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;accelerator&nbsp;seq&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_int_3 methode_diff methode_int f phi a b</pre> The first function <code class="code">f</code> is a parametrization of the surface from R^2 to R^3,
the second <code class="code">phi</code> is a function from R^3 to R. The integration method <code class="code">methode_int</code> calculates a double integral.
<p>

La première fonction <code class="code">f</code> est un paramétrage de la surface de R^2 dans R^3, la seconde <code class="code">phi</code> est une fonction de R^3 dans R.
La méthode d'intégration <code class="code">methode_int</code> calcule une intégrale double. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_int_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_diff&nbsp;methode_int&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(phi:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;phi&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;*.&nbsp;(&nbsp;surface_area_element_3&nbsp;methode_diff&nbsp;f&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_int&nbsp;g&nbsp;a&nbsp;b&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_int_2_3 methode_diff methode_int f phi a b</pre> The first function <code class="code">f</code> is a parametrization of the surface from R^2 to R^3,
the second <code class="code">phi</code> is a function from R^2 to R. The integration method <code class="code">methode_int</code> calculates a double integral.
<p>

La première fonction <code class="code">f</code> est un paramétrage de la surface de R^2 dans R^3, la seconde <code class="code">phi</code> est une fonction de R^2 dans R.
La méthode d'intégration <code class="code">methode_int</code> calcule une intégrale double. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_int_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_diff&nbsp;methode_int&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(phi:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;phi&nbsp;x&nbsp;)&nbsp;*.&nbsp;(&nbsp;surface_area_element_3&nbsp;methode_diff&nbsp;f&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_int&nbsp;g&nbsp;a&nbsp;b&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_vector_int_3 methode_diff methode_int f phi a b</pre> The first function <code class="code">f</code> is a parametrization of the surface from R^2 to R^3,
the second <code class="code">phi</code> is a function from R^3 to R^n. The integration method <code class="code">methode_int</code> calculates a vector double integral.
<p>

La première fonction <code class="code">f</code> est un paramétrage de la surface de R^2 dans R^3, la seconde <code class="code">phi</code> est une fonction de R^3 dans R^n.
La méthode d'intégration <code class="code">methode_int</code> calcule une intégrale double à valeurs vectorielles. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_vector_int_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_diff&nbsp;methode_int&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(phi:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;surface_area_element_3&nbsp;methode_diff&nbsp;f&nbsp;x&nbsp;)&nbsp;(&nbsp;phi&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_int&nbsp;g&nbsp;a&nbsp;b&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_vector_int_2_3 methode_diff methode_int f phi a b</pre> The first function <code class="code">f</code> is a parametrization of the surface from R^2 to R^3,
the second <code class="code">phi</code> is a function from R^2 to R^n. The integration method <code class="code">methode_int</code> calculates a vector double integral.
<p>

La première fonction <code class="code">f</code> est un paramétrage de la surface de R^2 dans R^3, la seconde <code class="code">phi</code> est une fonction de R^2 dans R^n.
La méthode d'intégration <code class="code">methode_int</code> calcule une intégrale double à valeurs vectorielles. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_vector_int_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_diff&nbsp;methode_int&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(phi:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;surface_area_element_3&nbsp;methode_diff&nbsp;f&nbsp;x&nbsp;)&nbsp;(&nbsp;phi&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_int&nbsp;g&nbsp;a&nbsp;b&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_matrix_int_3 methode_diff methode_int f phi a b</pre> The first function <code class="code">f</code> is a parametrization of the surface from R^2 to R^3,
the second <code class="code">phi</code> is a function from R^3 to M(n,p,R). The integration method <code class="code">methode_int</code> calculates a matrix double integral.
<p>

La première fonction <code class="code">f</code> est un paramétrage de la surface de R^2 dans R^3, la seconde <code class="code">phi</code> est une fonction de R^3 dans M(n,p,R).
La méthode d'intégration <code class="code">methode_int</code> calcule une intégrale double à valeurs matricielles. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_matrix_int_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_diff&nbsp;methode_int&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(phi:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;surface_area_element_3&nbsp;methode_diff&nbsp;f&nbsp;x&nbsp;)&nbsp;(&nbsp;phi&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_int&nbsp;g&nbsp;a&nbsp;b&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_matrix_int_2_3 methode_diff methode_int f phi a b</pre> The first function <code class="code">f</code> is a parametrization of the surface from R^2 to R^3,
the second <code class="code">phi</code> is a function from R^2 to M(n,p,R). The integration method <code class="code">methode_int</code> calculates a matrix double integral.
<p>

La première fonction <code class="code">f</code> est un paramétrage de la surface de R^2 dans R^3, la seconde <code class="code">phi</code> est une fonction de R^2 dans M(n,p,R).
La méthode d'intégration <code class="code">methode_int</code> calcule une intégrale double à valeurs matricielles. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_matrix_int_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_diff&nbsp;methode_int&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(phi:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;surface_area_element_3&nbsp;methode_diff&nbsp;f&nbsp;x&nbsp;)&nbsp;(&nbsp;phi&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_int&nbsp;g&nbsp;a&nbsp;b&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_vector_flux_3 methode_diff methode_int f phi a b</pre> The first function <code class="code">f</code> is a parametrization of the surface from R^2 to R^3,
the second <code class="code">phi</code> is a vector field from R^3 to R^3. The integration method <code class="code">methode_int</code> calculates a double integral.
<p>

La première fonction <code class="code">f</code> est un paramétrage de la surface de R^2 dans R^3, la seconde <code class="code">phi</code> est une champ de vecteurs de R^3 dans R^3.
La méthode d'intégration <code class="code">methode_int</code> calcule une intégrale double. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_vector_flux_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_diff&nbsp;methode_int&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(phi:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;(&nbsp;surface_area_vector_3&nbsp;methode_diff&nbsp;f&nbsp;x&nbsp;)&nbsp;(&nbsp;phi&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_int&nbsp;g&nbsp;a&nbsp;b&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>surface_vector_flux_2_3 methode_diff methode_int f phi a b</pre> The first function <code class="code">f</code> is a parametrization of the surface from R^2 to R^3,
the second <code class="code">phi</code> is a vector field from R^2 to R^3. The integration method <code class="code">methode_int</code> calculates a double integral.
<p>

La première fonction <code class="code">f</code> est un paramétrage de la surface de R^2 dans R^3, la seconde <code class="code">phi</code> est une champ de vecteurs de R^2 dans R^3.
La méthode d'intégration <code class="code">methode_int</code> calcule une intégrale double. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;surface_vector_flux_2_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_diff&nbsp;methode_int&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(phi:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;(&nbsp;surface_area_vector_3&nbsp;methode_diff&nbsp;f&nbsp;x&nbsp;)&nbsp;(&nbsp;phi&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_int&nbsp;g&nbsp;a&nbsp;b&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Intgralesdiscrtes"><h2>Intégrales discrètes</h2></span>
<span id="2_Discreteintegrals"><h2>Discrete integrals</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_discrete_int_rect length vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_discrete_int_rect&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(length:float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;n&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;v.(i)<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;&nbsp;*.&nbsp;length&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_discrete_int_trapez length vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_discrete_int_trapez&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(length:float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;)&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;(&nbsp;(v.(0)&nbsp;+.&nbsp;v.(nn)&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nn&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;v.(i)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!accu&nbsp;&nbsp;*.&nbsp;length&nbsp;/.&nbsp;(&nbsp;float&nbsp;nn&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_discrete_int_simpson length vector</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_discrete_int_simpson&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(length:float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;vv&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;n&nbsp;<span class="keyword">mod</span>&nbsp;2&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.append&nbsp;v&nbsp;vv&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;nn&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;nnn&nbsp;=&nbsp;nn&nbsp;/&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;(&nbsp;(&nbsp;w.(0)&nbsp;+.&nbsp;w.(&nbsp;nn&nbsp;-&nbsp;1&nbsp;)&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;+.&nbsp;2.&nbsp;*.&nbsp;w.(&nbsp;nn&nbsp;-&nbsp;2&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nnn&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;w.(&nbsp;2&nbsp;*&nbsp;i&nbsp;)&nbsp;+.&nbsp;2.&nbsp;*.&nbsp;w.(&nbsp;2&nbsp;*&nbsp;i&nbsp;-&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!accu&nbsp;&nbsp;*.&nbsp;length&nbsp;/.&nbsp;(&nbsp;1.5&nbsp;*.&nbsp;float&nbsp;n&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_discrete_int_interpol methode_interp methode_int length vector</pre> The integration method
<code class="code">methode_int</code> is aimed at functions and must contain all the parameters. The interpolation
method <code class="code">methode_interpol</code> must contain all the parameters.
<p>

La méthode d'intégration <code class="code">methode_int</code> est destinée aux fonctions et doit contenir tous les paramètres.
La méthode d'interpolation <code class="code">methode_interpol</code> doit contenir tous les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_discrete_int_interpol&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_interpol&nbsp;methode_int&nbsp;(length:float)&nbsp;(v:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;methode_interpol&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;length&nbsp;*.&nbsp;(&nbsp;methode_int&nbsp;f&nbsp;0.5&nbsp;(&nbsp;(&nbsp;float&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;)&nbsp;)&nbsp;-.&nbsp;0.5&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_discrete_trans_int methode length matrix</pre> The data are given by coordinates.
<p>

Les données sont présentées coordonnée par coordonnée. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_discrete_trans_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(length:float)&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dim&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;methode&nbsp;v.(i)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;w&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_discrete_int methode length matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_discrete_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(length:float)&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;vector_discrete_trans_int&nbsp;methode&nbsp;length&nbsp;(&nbsp;<span class="constructor">Matrix</span>.float_transpose&nbsp;v&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_discrete_int_double methode length_x length_y vector</pre> The row numbers match the ordinates
and the column numbers match the abscissae.
<p>

Les numéros de ligne de v correspondent aux ordonnées et les numéros de colonne aux abscisses. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_discrete_int_double&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(length_x:float)&nbsp;(length_y:float)&nbsp;(v:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;methode&nbsp;length_x&nbsp;)&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode&nbsp;length_y&nbsp;w&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_discrete_int_double methode length_x length_y vector</pre> The row numbers match the ordinates
and the column numbers match the abscissae.
<p>

Les numéros de ligne de v correspondent aux ordonnées et les numéros de colonne aux abscisses. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_discrete_int_double&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(length_x:float)&nbsp;(length_y:float)&nbsp;(v:float&nbsp;array&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;vector_discrete_int&nbsp;methode&nbsp;length_x&nbsp;)&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;vector_discrete_int&nbsp;methode&nbsp;length_y&nbsp;w&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Transformes"><h1>Transformées</h1></span>
<span id="1_Transforms"><h1>Transforms</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Fonctions"><h2>Fonctions</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_fourier_coefficient methode function pulsation</pre> The method 
must contain the integrating method, included the parameters.
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_fourier_coefficient&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;*.&nbsp;cos&nbsp;(&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;*.&nbsp;x&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;*.&nbsp;sin&nbsp;(&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;*.&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coefficient&nbsp;=&nbsp;<span class="keyword">match</span>&nbsp;n&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;inv_doublepi<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1.&nbsp;/.&nbsp;pi&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[|&nbsp;coefficient&nbsp;*.&nbsp;methode&nbsp;g&nbsp;0.&nbsp;doublepi&nbsp;;&nbsp;inv_doublepi&nbsp;*.&nbsp;methode&nbsp;h&nbsp;0.&nbsp;doublepi&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_fourier_coefficient_general methode beginning ending function pulsation</pre> The method 
must contain the integrating method, included the parameters.
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_fourier_coefficient_general&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(a:float)&nbsp;(b:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;a&nbsp;+.&nbsp;(&nbsp;b&nbsp;-.&nbsp;a&nbsp;)&nbsp;*.&nbsp;x&nbsp;*.&nbsp;inv_doublepi&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;float_fourier_coefficient&nbsp;methode&nbsp;g&nbsp;n&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_fourier_series coefficients real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_fourier_series&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(coefficients:float&nbsp;array&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;coefficients.(0).(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;coefficients&nbsp;)&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;coefficients.(i).(0)&nbsp;*.&nbsp;cos&nbsp;(&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;*.&nbsp;x&nbsp;)&nbsp;+.&nbsp;coefficients.(i).(1)&nbsp;*.&nbsp;sin&nbsp;(&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;*.&nbsp;x&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_fourier_transform methode beginning ending function pulsation</pre> The method 
must contain the integrating method, included the parameters.
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_fourier_transform&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(a:float)&nbsp;(b:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(omega:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;*.&nbsp;cos&nbsp;(&nbsp;omega&nbsp;*.&nbsp;x&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;*.&nbsp;sin&nbsp;(&nbsp;omega&nbsp;*.&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;[|&nbsp;methode&nbsp;g&nbsp;a&nbsp;b&nbsp;;&nbsp;-.&nbsp;methode&nbsp;h&nbsp;a&nbsp;b&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_inv_fourier_transform methode beginning ending function pulsation</pre> The method 
must contain the integrating method, included the parameters.
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_inv_fourier_transform&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(a:float)&nbsp;(b:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;omega&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;omega&nbsp;).(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;omega&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;omega&nbsp;).(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;omega&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;g&nbsp;omega&nbsp;)&nbsp;*.&nbsp;cos&nbsp;(&nbsp;omega&nbsp;*.&nbsp;x&nbsp;)&nbsp;-.&nbsp;(&nbsp;h&nbsp;omega&nbsp;)&nbsp;*.&nbsp;sin&nbsp;(&nbsp;omega&nbsp;*.&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;inv_doublepi&nbsp;*.&nbsp;methode&nbsp;k&nbsp;a&nbsp;b&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_laplace_complex methode ending function parameter</pre> The method 
must contain the integrating method, included the parameters.
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_laplace_complex&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(b:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(p:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;-.&nbsp;p.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;omega&nbsp;=&nbsp;-.&nbsp;p.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;*.&nbsp;exp&nbsp;(&nbsp;r&nbsp;*.&nbsp;x&nbsp;)&nbsp;*.&nbsp;cos&nbsp;(&nbsp;omega&nbsp;*.&nbsp;x&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;*.&nbsp;exp&nbsp;(&nbsp;r&nbsp;*.&nbsp;x&nbsp;)&nbsp;*.&nbsp;sin&nbsp;(&nbsp;omega&nbsp;*.&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;[|&nbsp;methode&nbsp;g&nbsp;0.&nbsp;b&nbsp;;&nbsp;methode&nbsp;h&nbsp;0.&nbsp;b&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_laplace_real methode ending function parameter</pre> The method 
must contain the integrating method, included the parameters.
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_laplace_real&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(b:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(p:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;*.&nbsp;exp&nbsp;(&nbsp;-.&nbsp;p&nbsp;*.&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode&nbsp;g&nbsp;0.&nbsp;b&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_inv_laplace_complex methode abscissa ending function parameter</pre> The method 
must contain the integrating method, included the parameters.
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_inv_laplace_complex&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(a:float)&nbsp;(b:float)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;omega&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;[|&nbsp;a&nbsp;;&nbsp;omega&nbsp;|]&nbsp;).(0)&nbsp;*.&nbsp;exp&nbsp;(&nbsp;a&nbsp;*.&nbsp;x&nbsp;)&nbsp;*.&nbsp;cos&nbsp;(&nbsp;omega&nbsp;*.&nbsp;x&nbsp;)<br>
&nbsp;&nbsp;&nbsp;-.&nbsp;(&nbsp;f&nbsp;[|&nbsp;a&nbsp;;&nbsp;omega&nbsp;|]&nbsp;).(1)&nbsp;*.&nbsp;exp&nbsp;(&nbsp;a&nbsp;*.&nbsp;x&nbsp;)&nbsp;*.&nbsp;sin&nbsp;(&nbsp;omega&nbsp;*.&nbsp;x&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;omega&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;[|&nbsp;a&nbsp;;&nbsp;omega&nbsp;|]&nbsp;).(1)&nbsp;*.&nbsp;exp&nbsp;(&nbsp;a&nbsp;*.&nbsp;x&nbsp;)&nbsp;*.&nbsp;cos&nbsp;(&nbsp;omega&nbsp;*.&nbsp;x&nbsp;)<br>
&nbsp;&nbsp;&nbsp;+.&nbsp;(&nbsp;f&nbsp;[|&nbsp;a&nbsp;;&nbsp;omega&nbsp;|]&nbsp;).(0)&nbsp;*.&nbsp;exp&nbsp;(&nbsp;a&nbsp;*.&nbsp;x&nbsp;)&nbsp;*.&nbsp;sin&nbsp;(&nbsp;omega&nbsp;*.&nbsp;x&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;[|&nbsp;inv_doublepi&nbsp;*.&nbsp;methode&nbsp;g&nbsp;(&nbsp;-.&nbsp;b&nbsp;)&nbsp;b&nbsp;;&nbsp;inv_doublepi&nbsp;*.&nbsp;methode&nbsp;h&nbsp;(&nbsp;-.&nbsp;b&nbsp;)&nbsp;b&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_sumudu_real methode ending function parameter</pre> The method 
must contain the integrating method, included the parameters.
<p>

La méthode doit contenir la méthode d'intégration, y compris les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_sumudu_real&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(b:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(p:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;*.&nbsp;exp&nbsp;(&nbsp;-.&nbsp;x&nbsp;/.&nbsp;p&nbsp;)&nbsp;/.&nbsp;p&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode&nbsp;g&nbsp;0.&nbsp;b&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Transformesdiscrtes"><h2>Transformées discrètes</h2></span>
<span id="2_Discretetransforms"><h2>Discrete transforms</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** These transforms need some normalization of variables and parameters from the user.
<p>

Ces transformées nécessitent une normalisation des variables et paramètres de la part de l'utilisateur. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_float_causal_z_sequence vector complex</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_float_causal_z_sequence&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(z:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v<br>
&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;z.(0)&nbsp;*.&nbsp;z.(0)&nbsp;+.&nbsp;z.(1)&nbsp;*.&nbsp;z.(1)&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;z0&nbsp;=&nbsp;ref&nbsp;1.<br>
&nbsp;<span class="keyword">and</span>&nbsp;z1&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz0&nbsp;=&nbsp;ref&nbsp;1.<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz1&nbsp;=&nbsp;ref&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;n&nbsp;2&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;[|&nbsp;coeff&nbsp;*.&nbsp;z.(0)&nbsp;;&nbsp;-.&nbsp;coeff&nbsp;*.&nbsp;z.(1)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;n&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;w.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vv&nbsp;=&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(0)&nbsp;&lt;-&nbsp;vv&nbsp;*.&nbsp;!z0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(1)&nbsp;&lt;-&nbsp;vv&nbsp;*.&nbsp;!z1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;row&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz0&nbsp;:=&nbsp;!z0&nbsp;*.&nbsp;y.(0)&nbsp;-.&nbsp;!z1&nbsp;*.&nbsp;y.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz1&nbsp;:=&nbsp;(&nbsp;!z1&nbsp;*.&nbsp;y.(0)&nbsp;)&nbsp;+.&nbsp;(&nbsp;!z0&nbsp;*.&nbsp;y.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z0&nbsp;:=&nbsp;!zz0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z1&nbsp;:=&nbsp;!zz1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_float_symmetric_z_sequence vector complex</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_float_symmetric_z_sequence&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(z:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;v<br>
&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;1.&nbsp;/.&nbsp;(&nbsp;z.(0)&nbsp;*.&nbsp;z.(0)&nbsp;+.&nbsp;z.(1)&nbsp;*.&nbsp;z.(1)&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;z0&nbsp;=&nbsp;ref&nbsp;1.<br>
&nbsp;<span class="keyword">and</span>&nbsp;z1&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz0&nbsp;=&nbsp;ref&nbsp;1.<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz1&nbsp;=&nbsp;ref&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;n&nbsp;2&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;n&nbsp;/&nbsp;2<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;[|&nbsp;coeff&nbsp;*.&nbsp;z.(0)&nbsp;;&nbsp;-.&nbsp;coeff&nbsp;*.&nbsp;z.(1)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;nn&nbsp;<span class="keyword">to</span>&nbsp;(&nbsp;n&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;w.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vv&nbsp;=&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(0)&nbsp;&lt;-&nbsp;vv&nbsp;*.&nbsp;!z0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(1)&nbsp;&lt;-&nbsp;vv&nbsp;*.&nbsp;!z1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;row&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz0&nbsp;:=&nbsp;!z0&nbsp;*.&nbsp;y.(0)&nbsp;-.&nbsp;!z1&nbsp;*.&nbsp;y.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz1&nbsp;:=&nbsp;(&nbsp;!z1&nbsp;*.&nbsp;y.(0)&nbsp;)&nbsp;+.&nbsp;(&nbsp;!z0&nbsp;*.&nbsp;y.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z0&nbsp;:=&nbsp;!zz0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z1&nbsp;:=&nbsp;!zz1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z0&nbsp;:=&nbsp;z.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z1&nbsp;:=&nbsp;z.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz0&nbsp;:=&nbsp;z.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz1&nbsp;:=&nbsp;z.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;(&nbsp;nn&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">downto</span>&nbsp;0&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;w.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;vv&nbsp;=&nbsp;v.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(0)&nbsp;&lt;-&nbsp;vv&nbsp;*.&nbsp;!z0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(1)&nbsp;&lt;-&nbsp;vv&nbsp;*.&nbsp;!z1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;row&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz0&nbsp;:=&nbsp;!z0&nbsp;*.&nbsp;z.(0)&nbsp;-.&nbsp;!z1&nbsp;*.&nbsp;z.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz1&nbsp;:=&nbsp;(&nbsp;!z1&nbsp;*.&nbsp;z.(0)&nbsp;)&nbsp;+.&nbsp;(&nbsp;!z0&nbsp;*.&nbsp;z.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z0&nbsp;:=&nbsp;!zz0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z1&nbsp;:=&nbsp;!zz1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_float_causal_z_transform vector complex</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_float_causal_z_transform&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(z:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Matrix</span>.matrix_float_sum_by_column&nbsp;(&nbsp;discrete_float_causal_z_sequence&nbsp;v&nbsp;z&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_float_symmetric_z_transform vector complex</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_float_symmetric_z_transform&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(z:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="constructor">Matrix</span>.matrix_float_sum_by_column&nbsp;(&nbsp;discrete_float_symmetric_z_sequence&nbsp;v&nbsp;z&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_float_causal_fourier_sequence vector pulsation</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_float_causal_fourier_sequence&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(omega:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_float_causal_z_sequence&nbsp;v&nbsp;[|&nbsp;cos&nbsp;omega&nbsp;;&nbsp;sin&nbsp;omega&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_float_causal_fourier_transform vector pulsation</pre> This transform could be seen as a DTFT :
discrete time Fourier transform. The inversion may use <code class="code">float_inv_fourier_transform</code>.
<p>

Cette transformée pourrait se ranger dans la catégorie DTFT. 
L'inversion peut utiliser <code class="code">float_inv_fourier_transform</code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_float_causal_fourier_transform&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(omega:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_float_causal_z_transform&nbsp;v&nbsp;[|&nbsp;cos&nbsp;omega&nbsp;;&nbsp;sin&nbsp;omega&nbsp;|]&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_float_symmetric_fourier_sequence vector pulsation</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_float_symmetric_fourier_sequence&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(omega:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_float_symmetric_z_sequence&nbsp;v&nbsp;[|&nbsp;cos&nbsp;omega&nbsp;;&nbsp;sin&nbsp;omega&nbsp;|]&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_float_symmetric_fourier_transform vector complex</pre> This transform could be seen as a DTFT :
discrete time Fourier transform. The inversion may use <code class="code">float_inv_fourier_transform</code>.
<p>

Cette transformée pourrait se ranger dans la catégorie DTFT. 
L'inversion peut utiliser <code class="code">float_inv_fourier_transform</code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_float_symmetric_fourier_transform&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(v:float&nbsp;array)&nbsp;(omega:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;discrete_float_symmetric_z_transform&nbsp;v&nbsp;[|&nbsp;cos&nbsp;omega&nbsp;;&nbsp;sin&nbsp;omega&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="3_Remarque"><h3>Remarque</h3></span>
<span id="3_Remark"><h3>Remark</h3></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** Every transform defined on functions may be applied to discrete data via the interpolation.
<p>

Toute transformée définie sur des fonctions peut s'appliquer aux données discrètes via l'interpolation. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_float_transform_int methode_interpol methode_transform vector integer</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_float_transform_int&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_interpol&nbsp;methode_transform&nbsp;(v:float&nbsp;array)&nbsp;(n:int)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;methode_interpol&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_transform&nbsp;f&nbsp;n&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_float_transform_real methode_interpol methode_transform vector real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_float_transform_real&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_interpol&nbsp;methode_transform&nbsp;(v:float&nbsp;array)&nbsp;(omega:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;methode_interpol&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_transform&nbsp;f&nbsp;omega&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>discrete_float_transform_complex methode_interpol methode_transform vector complex</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;discrete_float_transform_complex&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_interpol&nbsp;methode_transform&nbsp;(v:float&nbsp;array)&nbsp;(z:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;methode_interpol&nbsp;v&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_transform&nbsp;f&nbsp;z&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Pointscritiquesetinversionslocales"><h1>Points critiques et inversions locales</h1></span>
<span id="1_Criticalpointsandlocalinversions"><h1>Critical points and local inversions</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_critical methode_zero methode_diff function start</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_critical&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_zero&nbsp;methode_diff&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;methode_diff&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_zero&nbsp;g&nbsp;a&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_float_critical methode_zero methode_diff function start</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_float_critical&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_zero&nbsp;methode_diff&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;gradient&nbsp;methode_diff&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_zero&nbsp;g&nbsp;a&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_critical methode_zero methode_diff function start</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_critical&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_zero&nbsp;methode_diff&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(a:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;vector&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.float_slow_invertibility_evaluation&nbsp;(&nbsp;tlm&nbsp;methode_diff&nbsp;f&nbsp;vector&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_zero&nbsp;g&nbsp;a&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_local_inverse methode_zero guess function real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_local_inverse&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_zero&nbsp;(a:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x&nbsp;-.&nbsp;f&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_zero&nbsp;g&nbsp;a&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_local_inverse methode_zero guess function real</pre> An exception
probably means that the local inversion passed through a critical point.
In this case, the start point <code class="code">guess</code> has to be changed, or the method of zero finding 
should not use a tangent linear application.
<p>

Une exception signifie probablement que l'inversion locale est passée par un point critique.
Dans ce cas, il faut changer le point de départ <code class="code">guess</code> ou prendre une méthode de recherche de zéro
qui n'utilise pas d'application linéaire tangente. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_local_inverse&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_zero&nbsp;(guess:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;)&nbsp;(x:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;x&nbsp;(&nbsp;f&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_zero&nbsp;g&nbsp;guess&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_implicit_function methode_zero guess function real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_implicit_function&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_zero&nbsp;(a:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_zero&nbsp;g&nbsp;a&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_implicit_function methode_zero guess function real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_implicit_function&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_zero&nbsp;(a:float&nbsp;array)&nbsp;(f:float&nbsp;array<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;)&nbsp;(x:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode_zero&nbsp;g&nbsp;a&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_flat_search methode_zero methode_int function start length</pre> It is question of
searching an interval of length <code class="code">length</code> and upon which the integral
of the absolute value of the function is zero.
The method of zero finding, the method of integration and a start point <code class="code">x</code> have to be stated.
<p>

Il s'agit de rechercher un intervalle de longueur <code class="code">length</code> sur lequel 
l'intégrale de la valeur absolue de la fonction est nulle.
Il faut préciser la méthode de recherche de zéro, la méthode d'intégration et un point de départ <code class="code">x</code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_flat_search&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_zero&nbsp;methode_int&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(x:float)&nbsp;(length:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;abs_float&nbsp;(&nbsp;f&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode_int&nbsp;g&nbsp;y&nbsp;(&nbsp;length&nbsp;+.&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;methode_zero&nbsp;h&nbsp;x&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_quationsdiffrentiellesordinairesexplicitesyfxy"><h1>Équations différentielles ordinaires explicites y' = f(x,y)</h1></span>
<span id="1_Explicitordinarydifferentialequationsyfxy"><h1>Explicit ordinary differential equations y' = f(x,y)</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Mthodesexplicites"><h2>Méthodes explicites</h2></span>
<span id="2_Explicitmethods"><h2>Explicit methods</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_euler function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_euler&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(i&nbsp;-&nbsp;1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;f&nbsp;!x&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_euler function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_ode_euler&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(i&nbsp;-&nbsp;1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;(&nbsp;f&nbsp;!x&nbsp;z&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_euler function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_ode_euler&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(i&nbsp;-&nbsp;1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;step&nbsp;(&nbsp;f&nbsp;!x&nbsp;z&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_euler function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_euler&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;+.&nbsp;step&nbsp;*.&nbsp;f&nbsp;!x&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_euler function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_end_ode_euler&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;!y&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;(&nbsp;f&nbsp;!x&nbsp;!y&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_euler function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_end_ode_euler&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;!y&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;step&nbsp;(&nbsp;f&nbsp;!x&nbsp;!y&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_adams_bashforth_2 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_adams_bashforth_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;y0&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!accu&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;f&nbsp;!x&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;z&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;3.&nbsp;*.&nbsp;zz&nbsp;-.&nbsp;!accu&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_adams_bashforth_2 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_ode_adams_bashforth_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y0&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;!accu&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;f&nbsp;!x&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;halfstep&nbsp;(&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;3.&nbsp;zz&nbsp;)&nbsp;!accu&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_adams_bashforth_2 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_ode_adams_bashforth_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;y0&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;step&nbsp;!accu&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;f&nbsp;!x&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;halfstep&nbsp;(&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;3.&nbsp;zz&nbsp;)&nbsp;!accu&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_adams_bashforth_2 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_adams_bashforth_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;y0&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!accu&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;f&nbsp;!x&nbsp;!y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!y&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;3.&nbsp;*.&nbsp;zz&nbsp;-.&nbsp;!accu&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_adams_bashforth_2 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_end_ode_adams_bashforth_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;2&nbsp;r&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;rr&nbsp;=&nbsp;r&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0).(j)&nbsp;&lt;-&nbsp;zzz.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;y0.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;accu.(0).(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;f&nbsp;!x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;y.(j)&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;3.&nbsp;*.&nbsp;zz.(j)&nbsp;-.&nbsp;accu.(0).(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1).(j)&nbsp;&lt;-&nbsp;zz.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;y.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0).(j)&nbsp;&lt;-&nbsp;accu.(1).(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_adams_bashforth_2 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_end_ode_adams_bashforth_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;[|&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;c&nbsp;0.&nbsp;;&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;c&nbsp;0.&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;rr&nbsp;=&nbsp;r&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;c&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;init&nbsp;=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;init.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;y0.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;accu.(0).(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_output&nbsp;=&nbsp;y.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(k)&nbsp;&lt;-&nbsp;row.(k)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;row_input.(k)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(k)&nbsp;&lt;-&nbsp;row_input.(k)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;first&nbsp;=&nbsp;f&nbsp;!x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_first&nbsp;=&nbsp;first.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_second&nbsp;=&nbsp;accu.(0).(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;y.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;accu.(1).(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_output&nbsp;=&nbsp;z.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(k)&nbsp;&lt;-&nbsp;row.(k)&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;3.&nbsp;*.&nbsp;row_first.(k)&nbsp;-.&nbsp;row_second.(k)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(k)&nbsp;&lt;-&nbsp;row_first.(k)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0).(j)&nbsp;&lt;-&nbsp;accu.(1).(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_adams_bashforth_3 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_adams_bashforth_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;2&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;twelfthstep&nbsp;=&nbsp;halfstep&nbsp;/.&nbsp;6.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;y0&nbsp;+.&nbsp;step&nbsp;*.&nbsp;accu.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;y.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(2)&nbsp;&lt;-&nbsp;y.(1)&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;3.&nbsp;*.&nbsp;accu.(1)&nbsp;-.&nbsp;accu.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;f&nbsp;!x&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;z&nbsp;+.&nbsp;twelfthstep&nbsp;*.&nbsp;(&nbsp;23.&nbsp;*.&nbsp;zzz&nbsp;-.&nbsp;16.&nbsp;*.&nbsp;accu.(1)&nbsp;+.&nbsp;5.&nbsp;*.&nbsp;accu.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;accu.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;zzz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_adams_bashforth_3 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_ode_adams_bashforth_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;2&nbsp;r&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;twelfthstep&nbsp;=&nbsp;halfstep&nbsp;/.&nbsp;6.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zzz&nbsp;=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y0&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zzz&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;zzz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;(&nbsp;f&nbsp;!x&nbsp;y.(1)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(2)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y.(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;halfstep&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;3.&nbsp;zz&nbsp;)&nbsp;accu.(0)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;eval&nbsp;=&nbsp;f&nbsp;!x&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;term1&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;23.&nbsp;eval<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;term2&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(-16.)&nbsp;accu.(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;term3&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;5.&nbsp;accu.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sum&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;term1&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;term2&nbsp;term3&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;twelfthstep&nbsp;sum&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;accu.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;eval&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_adams_bashforth_3 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_ode_adams_bashforth_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;[|&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;c&nbsp;0.&nbsp;;&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;c&nbsp;0.&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;twelfthstep&nbsp;=&nbsp;halfstep&nbsp;/.&nbsp;6.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zzz&nbsp;=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;y0&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;step&nbsp;zzz&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;zzz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;f&nbsp;!x&nbsp;y.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(2)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;y.(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;halfstep&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;3.&nbsp;zz&nbsp;)&nbsp;accu.(0)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;eval&nbsp;=&nbsp;f&nbsp;!x&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;term1&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;23.&nbsp;eval<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;term2&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(-16.)&nbsp;accu.(1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;term3&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;5.&nbsp;accu.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sum&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;term1&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;term2&nbsp;term3&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;twelfthstep&nbsp;sum&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;accu.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;eval&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_adams_bashforth_3 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_adams_bashforth_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;accu&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;2&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;twelfthstep&nbsp;=&nbsp;halfstep&nbsp;/.&nbsp;6.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;y0&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zzz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;zzz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;f&nbsp;!x&nbsp;!yy&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!yy&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;3.&nbsp;*.&nbsp;zz&nbsp;-.&nbsp;accu.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;eval&nbsp;=&nbsp;f&nbsp;!x&nbsp;!y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!y&nbsp;+.&nbsp;twelfthstep&nbsp;*.&nbsp;(&nbsp;23.&nbsp;*.&nbsp;eval&nbsp;-.&nbsp;16.&nbsp;*.&nbsp;accu.(1)&nbsp;+.&nbsp;5.&nbsp;*.&nbsp;accu.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(0)&nbsp;&lt;-&nbsp;accu.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accu.(1)&nbsp;&lt;-&nbsp;eval&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_adams_bashforth_3 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_end_ode_adams_bashforth_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;pointeur&nbsp;=&nbsp;ref&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;rr&nbsp;=&nbsp;r&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;3&nbsp;r&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;twelfthstep&nbsp;=&nbsp;halfstep&nbsp;/.&nbsp;6.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carrousel.(0).(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;y0.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;carrousel.(0).(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;!x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carrousel.(1).(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;y.(j)&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;3.&nbsp;*.&nbsp;carrousel.(1).(j)&nbsp;-.&nbsp;carrousel.(0).(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointeur&nbsp;:=&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;!x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carrousel.(!pointeur).(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;y.(j)&nbsp;+.&nbsp;twelfthstep&nbsp;*.&nbsp;(&nbsp;23.&nbsp;*.&nbsp;carrousel.(!pointeur).(j)&nbsp;-.&nbsp;16.&nbsp;*.&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;2&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;).(j)&nbsp;+.&nbsp;5.&nbsp;*.&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;).(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_adams_bashforth_3 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_end_ode_adams_bashforth_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;pointeur&nbsp;=&nbsp;ref&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;rr&nbsp;=&nbsp;r&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;c&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;carrousel&nbsp;=&nbsp;[|&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;c&nbsp;0.&nbsp;;&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;c&nbsp;0.&nbsp;;&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;c&nbsp;0.&nbsp;|]<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;twelfthstep&nbsp;=&nbsp;halfstep&nbsp;/.&nbsp;6.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_0&nbsp;=&nbsp;y.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne_0&nbsp;=&nbsp;carrousel.(0).(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_0_input&nbsp;=&nbsp;z.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne_0.(k)&nbsp;&lt;-&nbsp;row_0_input.(k)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_0.(k)&nbsp;&lt;-&nbsp;row_0.(k)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;row_0_input.(k)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;f&nbsp;!x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_1&nbsp;=&nbsp;y.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_1_input&nbsp;=&nbsp;zz.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne_1&nbsp;=&nbsp;carrousel.(1).(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne_1_entree&nbsp;=&nbsp;carrousel.(0).(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne_1.(k)&nbsp;&lt;-&nbsp;row_1_input.(k)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_1.(k)&nbsp;&lt;-&nbsp;row_1.(k)&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;3.&nbsp;*.&nbsp;row_1_input.(k)&nbsp;-.&nbsp;ligne_1_entree.(k)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointeur&nbsp;:=&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;f&nbsp;!x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;rr&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;term3&nbsp;=&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;).(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;term2&nbsp;=&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;2&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;).(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;term1&nbsp;=&nbsp;carrousel.(!pointeur).(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;zzz.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;y.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;term1.(k)&nbsp;&lt;-&nbsp;row_input.(k)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(k)&nbsp;&lt;-&nbsp;row.(k)&nbsp;+.&nbsp;twelfthstep&nbsp;*.&nbsp;(&nbsp;23.&nbsp;*.&nbsp;row_input.(k)&nbsp;-.&nbsp;16.&nbsp;*.&nbsp;term2.(k)&nbsp;+.&nbsp;5.&nbsp;*.&nbsp;term3.(k)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_adams_bashforth order function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_adams_bashforth&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(order:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;&lt;&nbsp;(&nbsp;float&nbsp;order&nbsp;)&nbsp;*.&nbsp;(&nbsp;log&nbsp;2.&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"The&nbsp;number&nbsp;of&nbsp;steps&nbsp;[nsteps]&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;2&nbsp;^&nbsp;[order]&nbsp;in&nbsp;Infinitesimal.float_ode_adams_bashforth."</span>&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;oo&nbsp;=&nbsp;order&nbsp;-&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;order&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;adams_bashforth_m.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ii&nbsp;=&nbsp;i&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carrousel.(ii)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;y.(ii)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;y.(ii)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;(&nbsp;adams_bashforth_m.(ii)&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;carrousel&nbsp;0&nbsp;i&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;order&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ii&nbsp;=&nbsp;i&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carrousel.(oo)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;y.(ii)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;y.(ii)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;w&nbsp;carrousel&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carrousel.(i)&nbsp;&lt;-&nbsp;carrousel.(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_adams_bashforth order function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_ode_adams_bashforth&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(order:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;&lt;&nbsp;(&nbsp;float&nbsp;order&nbsp;)&nbsp;*.&nbsp;(&nbsp;log&nbsp;2.&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"The&nbsp;number&nbsp;of&nbsp;steps&nbsp;[nsteps]&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;2&nbsp;^&nbsp;[order]&nbsp;in&nbsp;Infinitesimal.vector_ode_adams_bashforth."</span>&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ii&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;oo&nbsp;=&nbsp;order&nbsp;-&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;order&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;l&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;adams_bashforth_m.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;y0.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii&nbsp;:=&nbsp;i&nbsp;-&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;y.(!ii)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;!x&nbsp;row_input<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;carrousel.(!ii)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;adams_bashforth_m.(!ii)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;!ii&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;ligne.(k)&nbsp;*.&nbsp;carrousel.(k).(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;order&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii&nbsp;:=&nbsp;i&nbsp;-&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;y.(!ii)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;!x&nbsp;row_input<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;carrousel.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;w.(k)&nbsp;*.&nbsp;carrousel.(k).(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_output&nbsp;=&nbsp;carrousel.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;carrousel.(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_adams_bashforth order function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_ode_adams_bashforth&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(order:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;&lt;&nbsp;(&nbsp;float&nbsp;order&nbsp;)&nbsp;*.&nbsp;(&nbsp;log&nbsp;2.&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"The&nbsp;number&nbsp;of&nbsp;steps&nbsp;[nsteps]&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;2&nbsp;^&nbsp;[order]&nbsp;in&nbsp;Infinitesimal.matrix_ode_adams_bashforth."</span>&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;ii&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;oo&nbsp;=&nbsp;order&nbsp;-&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;order&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;adams_bashforth_m.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;y0.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii&nbsp;:=&nbsp;i&nbsp;-&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;y.(!ii)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;!x&nbsp;row_input<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;carrousel.(!ii)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;adams_bashforth_m.(!ii)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;!ii&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(j)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;step&nbsp;*.&nbsp;ligne.(k)&nbsp;)&nbsp;carrousel.(k).(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;order&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii&nbsp;:=&nbsp;i&nbsp;-&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;y.(!ii)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;!x&nbsp;row_input<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;carrousel.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(j)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;step&nbsp;*.&nbsp;w.(k)&nbsp;)&nbsp;carrousel.(k).(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_output&nbsp;=&nbsp;carrousel.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;carrousel.(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_adams_bashforth order function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_adams_bashforth&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(order:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;&lt;&nbsp;(&nbsp;float&nbsp;order&nbsp;)&nbsp;*.&nbsp;(&nbsp;log&nbsp;2.&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"The&nbsp;number&nbsp;of&nbsp;steps&nbsp;[nsteps]&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;2&nbsp;^&nbsp;[order]&nbsp;in&nbsp;Infinitesimal.float_end_ode_adams_bashforth."</span>&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;oo&nbsp;=&nbsp;order&nbsp;-&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;order&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;order&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;adams_bashforth_m.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ii&nbsp;=&nbsp;i&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carrousel.(ii)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;y.(ii)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;y.(ii)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;(&nbsp;adams_bashforth_m.(ii)&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.sub&nbsp;carrousel&nbsp;0&nbsp;i&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;order&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;carrousel.(oo)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;y.(oo)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(order)&nbsp;&lt;-&nbsp;y.(oo)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_prod&nbsp;w&nbsp;carrousel&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carrousel.(i)&nbsp;&lt;-&nbsp;carrousel.(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(oo)&nbsp;&lt;-&nbsp;y.(order)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(order)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_adams_bashforth order function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_end_ode_adams_bashforth&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(order:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;&lt;&nbsp;(&nbsp;float&nbsp;order&nbsp;)&nbsp;*.&nbsp;(&nbsp;log&nbsp;2.&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"The&nbsp;number&nbsp;of&nbsp;steps&nbsp;[nsteps]&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;2&nbsp;^&nbsp;[order]&nbsp;in&nbsp;Infinitesimal.vector_end_ode_adams_bashforth."</span>&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;oo&nbsp;=&nbsp;order&nbsp;-&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;ii&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;order&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;order&nbsp;+&nbsp;1&nbsp;)&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;adams_bashforth_m.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;y0.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;ii&nbsp;:=&nbsp;i&nbsp;-&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;carrousel.(!ii)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;y.(!ii)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_output&nbsp;=&nbsp;f&nbsp;!x&nbsp;row_input&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_output.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;adams_bashforth_m.(!ii)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;!ii&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;ligne.(k)&nbsp;*.&nbsp;carrousel.(k).(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;order&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;carrousel.(oo)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;!x&nbsp;y.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(order)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;y.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;w.(k)&nbsp;*.&nbsp;carrousel.(k).(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_output&nbsp;=&nbsp;carrousel.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;carrousel.(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;y.(order)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_output&nbsp;=&nbsp;y.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(order)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_adams_bashforth order function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_end_ode_adams_bashforth&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(order:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;log&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)&nbsp;&lt;&nbsp;(&nbsp;float&nbsp;order&nbsp;)&nbsp;*.&nbsp;(&nbsp;log&nbsp;2.&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"The&nbsp;number&nbsp;of&nbsp;steps&nbsp;[nsteps]&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;2&nbsp;^&nbsp;[order]&nbsp;in&nbsp;Infinitesimal.matrix_end_ode_adams_bashforth."</span>&nbsp;;<br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;c=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;oo&nbsp;=&nbsp;order&nbsp;-&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;ii&nbsp;=&nbsp;ref&nbsp;0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;order&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;order&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;w&nbsp;=&nbsp;adams_bashforth_m.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;y0.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;ii&nbsp;:=&nbsp;i&nbsp;-&nbsp;1&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;carrousel.(!ii)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;y.(!ii)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_output&nbsp;=&nbsp;f&nbsp;!x&nbsp;row_input&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_output.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;adams_bashforth_m.(!ii)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;!ii&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(j)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;step&nbsp;*.&nbsp;ligne.(k)&nbsp;)&nbsp;carrousel.(k).(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;order&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;carrousel.(oo)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;f&nbsp;!x&nbsp;y.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(order)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;y.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;k&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(j)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;step&nbsp;*.&nbsp;w.(k)&nbsp;)&nbsp;carrousel.(k).(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;oo&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_output&nbsp;=&nbsp;carrousel.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;carrousel.(&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;y.(order)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_output&nbsp;=&nbsp;y.(oo)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(order)&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_nystroem_3 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_nystroem_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;3&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;pointeur&nbsp;=&nbsp;ref&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;thirdstep&nbsp;=&nbsp;step&nbsp;/.&nbsp;3.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;carrousel.(0)&nbsp;&lt;-&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;y0&nbsp;+.&nbsp;step&nbsp;*.&nbsp;carrousel.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;carrousel.(1)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;y.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(2)&nbsp;&lt;-&nbsp;y0&nbsp;+.&nbsp;step&nbsp;*.&nbsp;2.&nbsp;*.&nbsp;carrousel.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;pointeur&nbsp;:=&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;carrousel.(!pointeur)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;2&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;z&nbsp;+.&nbsp;thirdstep&nbsp;*.&nbsp;(&nbsp;7.&nbsp;*.&nbsp;carrousel.(!pointeur)&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;2&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;)&nbsp;+.&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_nystroem_3 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_ode_nystroem_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;pointeur&nbsp;=&nbsp;ref&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;3&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;thirdstep&nbsp;=&nbsp;step&nbsp;/.&nbsp;3.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;beginning&nbsp;y0<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;carrousel.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y0&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;carrousel.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;!x&nbsp;y.(1)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;carrousel.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(2)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y0&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;step&nbsp;*.&nbsp;2.&nbsp;)&nbsp;carrousel.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;pointeur&nbsp;:=&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;!x&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;carrousel.(!pointeur)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;2&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;thirdstep&nbsp;*.&nbsp;7.&nbsp;)&nbsp;carrousel.(!pointeur)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;thirdstep&nbsp;)&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;2&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;)&nbsp;)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;thirdstep&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_nystroem_3 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_ode_nystroem_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;pointeur&nbsp;=&nbsp;ref&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;3&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;thirdstep&nbsp;=&nbsp;step&nbsp;/.&nbsp;3.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;beginning&nbsp;y0<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;carrousel.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;y0&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;step&nbsp;carrousel.(0)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;!x&nbsp;y.(1)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;carrousel.(1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(2)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;y0&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;step&nbsp;*.&nbsp;2.&nbsp;)&nbsp;carrousel.(1)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;pointeur&nbsp;:=&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;!x&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;carrousel.(!pointeur)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;2&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;thirdstep&nbsp;*.&nbsp;7.&nbsp;)&nbsp;carrousel.(!pointeur)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;thirdstep&nbsp;)&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;2&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;)&nbsp;)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;thirdstep&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_nystroem_3 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_nystroem_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;3&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;pointeur&nbsp;=&nbsp;ref&nbsp;1<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;thirdstep&nbsp;=&nbsp;step&nbsp;/.&nbsp;3.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;carrousel.(0)&nbsp;&lt;-&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;y0&nbsp;+.&nbsp;step&nbsp;*.&nbsp;carrousel.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;carrousel.(1)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;y0&nbsp;+.&nbsp;step&nbsp;*.&nbsp;2.&nbsp;*.&nbsp;carrousel.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;pointeur&nbsp;:=&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;carrousel.(!pointeur)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!yy&nbsp;+.&nbsp;thirdstep&nbsp;*.&nbsp;(&nbsp;7.&nbsp;*.&nbsp;carrousel.(!pointeur)&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;2&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;)&nbsp;+.&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_nystroem_3 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_end_ode_nystroem_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;pointeur&nbsp;=&nbsp;ref&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;3&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;thirdstep&nbsp;=&nbsp;step&nbsp;/.&nbsp;3.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;carrousel.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;y0.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;carrousel.(1)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;!x&nbsp;yy&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;y0.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;2.&nbsp;*.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;pointeur&nbsp;:=&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;carrousel.(!pointeur)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;!x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;yy.(j)&nbsp;+.&nbsp;thirdstep&nbsp;*.&nbsp;(&nbsp;7.&nbsp;*.&nbsp;row.(j)&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;2&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;).(j)&nbsp;+.&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;).(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;y.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_nystroem_3 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_end_ode_nystroem_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;pointeur&nbsp;=&nbsp;ref&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;carrousel&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;3&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;thirdstep&nbsp;=&nbsp;step&nbsp;/.&nbsp;3.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;carrousel.(0)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y0.(j)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;row.(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;carrousel.(1)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;!x&nbsp;yy&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y0.(j)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;step&nbsp;*.&nbsp;2.&nbsp;)&nbsp;row.(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;pointeur&nbsp;:=&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;carrousel.(!pointeur)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;!x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;yy.(j)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;thirdstep&nbsp;*.&nbsp;7.&nbsp;)&nbsp;row.(j)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;-2.&nbsp;*.&nbsp;thirdstep&nbsp;)&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;2&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;).(j)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;thirdstep&nbsp;carrousel.(&nbsp;(&nbsp;!pointeur&nbsp;+&nbsp;1&nbsp;)&nbsp;<span class="keyword">mod</span>&nbsp;3&nbsp;).(j)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;y.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_mid_point function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_mid_point&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!z&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;!z&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;halfstep&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!xx&nbsp;!z&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_mid_point function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_ode_mid_point&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;y0.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;f&nbsp;!x&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;halfstep&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_output&nbsp;=&nbsp;y.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;!xx&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;row.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;row_input.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_mid_point function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_ode_mid_point&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;y0.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;f&nbsp;!x&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z.(j)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;halfstep&nbsp;row.(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;halfstep&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_output&nbsp;=&nbsp;y.(i)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row_input&nbsp;=&nbsp;f&nbsp;!xx&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(j)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;row_input.(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_output.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_mid_point function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_mid_point&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!y&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;!y&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;halfstep&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!y&nbsp;+.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!xx&nbsp;!z&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_mid_point function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_end_ode_mid_point&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;f&nbsp;!x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;y.(j)&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;halfstep&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;f&nbsp;!xx&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;y.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_mid_point function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_end_ode_mid_point&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;f&nbsp;!x&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y.(j)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;halfstep&nbsp;row.(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;halfstep&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;f&nbsp;!xx&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y.(j)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;row.(j)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_rk4 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_rk4&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(i&nbsp;-&nbsp;1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k1&nbsp;=&nbsp;f&nbsp;!x&nbsp;z<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;!x&nbsp;+.&nbsp;halfstep&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k2&nbsp;=&nbsp;f&nbsp;xx&nbsp;(&nbsp;z&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;k1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k3&nbsp;=&nbsp;f&nbsp;xx&nbsp;(&nbsp;z&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;k2&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k4&nbsp;=&nbsp;f&nbsp;!x&nbsp;(&nbsp;z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;k3&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;z&nbsp;+.&nbsp;(&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;k1&nbsp;+.&nbsp;k4&nbsp;)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;(&nbsp;k2&nbsp;+.&nbsp;k3&nbsp;)&nbsp;)&nbsp;/.&nbsp;3.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_rk4 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_ode_rk4&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;thirdstep&nbsp;=&nbsp;step&nbsp;/.&nbsp;3.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sixthstep&nbsp;=&nbsp;thirdstep&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;y0.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(i&nbsp;-&nbsp;1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k1&nbsp;=&nbsp;f&nbsp;!x&nbsp;z<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;!x&nbsp;+.&nbsp;halfstep&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k2&nbsp;=&nbsp;f&nbsp;xx&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;halfstep&nbsp;k1&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k3&nbsp;=&nbsp;f&nbsp;xx&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;halfstep&nbsp;k2&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k4&nbsp;=&nbsp;f&nbsp;!x&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;k3&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;sixthstep&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;k1&nbsp;k4&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;thirdstep&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;k2&nbsp;k3&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_rk4 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_ode_rk4&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;thirdstep&nbsp;=&nbsp;step&nbsp;/.&nbsp;3.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sixthstep&nbsp;=&nbsp;thirdstep&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;y0.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(i&nbsp;-&nbsp;1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k1&nbsp;=&nbsp;f&nbsp;!x&nbsp;z<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;!x&nbsp;+.&nbsp;halfstep&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k2&nbsp;=&nbsp;f&nbsp;xx&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;halfstep&nbsp;k1&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k3&nbsp;=&nbsp;f&nbsp;xx&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;halfstep&nbsp;k2&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k4&nbsp;=&nbsp;f&nbsp;!x&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;step&nbsp;k3&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;z&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;sixthstep&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;k1&nbsp;k4&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;thirdstep&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;k2&nbsp;k3&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_rk4 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_rk4&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k1&nbsp;=&nbsp;f&nbsp;!x&nbsp;!y<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;!x&nbsp;+.&nbsp;halfstep&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k2&nbsp;=&nbsp;f&nbsp;xx&nbsp;(&nbsp;!y&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;k1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k3&nbsp;=&nbsp;f&nbsp;xx&nbsp;(&nbsp;!y&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;k2&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k4&nbsp;=&nbsp;f&nbsp;!x&nbsp;(&nbsp;!y&nbsp;+.&nbsp;step&nbsp;*.&nbsp;k3&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!y&nbsp;+.&nbsp;(&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;k1&nbsp;+.&nbsp;k4&nbsp;)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;(&nbsp;k2&nbsp;+.&nbsp;k3&nbsp;)&nbsp;)&nbsp;/.&nbsp;3.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_rk4 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_end_ode_rk4&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k1&nbsp;=&nbsp;f&nbsp;!x&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;!x&nbsp;+.&nbsp;halfstep&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k2&nbsp;=&nbsp;f&nbsp;xx&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;halfstep&nbsp;k1&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k3&nbsp;=&nbsp;f&nbsp;xx&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;halfstep&nbsp;k2&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k4&nbsp;=&nbsp;f&nbsp;!x&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;k3&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;y.(j)&nbsp;+.&nbsp;(&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;k1.(j)&nbsp;+.&nbsp;k4.(j)&nbsp;)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;(&nbsp;k2.(j)&nbsp;+.&nbsp;k3.(j)&nbsp;)&nbsp;)&nbsp;/.&nbsp;3.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_rk4 function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_end_ode_rk4&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;thirdstep&nbsp;=&nbsp;step&nbsp;/.&nbsp;3.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sixthstep&nbsp;=&nbsp;thirdstep&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k1&nbsp;=&nbsp;f&nbsp;!x&nbsp;y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;!x&nbsp;+.&nbsp;halfstep&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k2&nbsp;=&nbsp;f&nbsp;xx&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;y&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;halfstep&nbsp;k1&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k3&nbsp;=&nbsp;f&nbsp;xx&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;y&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;halfstep&nbsp;k2&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k4&nbsp;=&nbsp;f&nbsp;!x&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;y&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;step&nbsp;k3&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;y.(j)&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;sixthstep&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;k1.(j)&nbsp;k4.(j)&nbsp;)&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;thirdstep&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;k2.(j)&nbsp;k3.(j)&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(j)&nbsp;&lt;-&nbsp;z.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_runge_kutta butcher_matrix butcher_vector function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_runge_kutta&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;row.(index)&nbsp;*.&nbsp;k.(index)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;yy.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;b.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_runge_kutta butcher_matrix butcher_vector function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_ode_runge_kutta&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;y0.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;image&nbsp;=&nbsp;f&nbsp;!xx&nbsp;row&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(j)&nbsp;&lt;-&nbsp;image.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;image&nbsp;=&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;image.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;row.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_runge_kutta butcher_matrix butcher_vector function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_ode_runge_kutta&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim_r&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;dim_c&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(j)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;image&nbsp;=&nbsp;f&nbsp;!xx&nbsp;row&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(j)&nbsp;&lt;-&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(j)&nbsp;&lt;-&nbsp;image.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;image&nbsp;=&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;image.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;row.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;zz.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_runge_kutta butcher_matrix butcher_vector function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_runge_kutta&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;row.(index)&nbsp;*.&nbsp;k.(index)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;yy.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;b.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_runge_kutta butcher_matrix butcher_vector function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_end_ode_runge_kutta&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;y.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yyy.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;row&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;row.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_runge_kutta butcher_matrix butcher_vector function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_end_ode_runge_kutta&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim_r&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;dim_c&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;y.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yyy.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;row&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;row.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** Some Butcher tableaus are following. They have been harvested on the internet.
The square matrix must be lower triangular in the strict sense.
The tableaus of the explicit adaptative methods quoted further may also be used.
<p>

Suivent quelques tableaux de Butcher. Ils ont été glanés sur internet. 
La matrice carrée doit être triangulaire inférieure au sens strict.
Les tableaux des méthodes adaptatives explicites cités plus loin peuvent aussi être exploités. 
<p>

<center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;euler_a&nbsp;=&nbsp;([|&nbsp;[|&nbsp;|]&nbsp;|]:float&nbsp;array&nbsp;array)&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;euler_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;mid_point_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.5&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;mid_point_b&nbsp;=&nbsp;[|&nbsp;0.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;imex_ssp2_2_2_2_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** The previous method is also called Lobatto III for s = 2.
<p>

La méthode ci-dessus est aussi appelée Lobatto III pour s = 2. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imex_ssp2_2_2_2_b&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;heun_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;heun_b&nbsp;=&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.75&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_runge_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_runge_b&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;imex_ssp2_3_2_2_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imex_ssp2_3_2_2_b&nbsp;=&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;imex_ssp2_3_3_2_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.5&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imex_ssp2_3_3_2_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;imex_ssp3_3_3_2_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;0.25&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imex_ssp3_3_3_2_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;example_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;2.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;-1.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;example_b&nbsp;=&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.75&nbsp;;&nbsp;0.25&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;imex_ssp3_4_3_3_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.25&nbsp;;&nbsp;0.25&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imex_ssp3_4_3_3_b&nbsp;=&nbsp;[|&nbsp;0.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk4_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.5&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk4_b&nbsp;=&nbsp;[|&nbsp;1./.6.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk4_3_8_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;-1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;;&nbsp;-1.&nbsp;;&nbsp;1.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk4_3_8_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;8.&nbsp;;&nbsp;3.&nbsp;/.&nbsp;8.&nbsp;;&nbsp;3.&nbsp;/.&nbsp;8.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;8.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;hem_4_5_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.3&nbsp;|]&nbsp;;&nbsp;[|&nbsp;(&nbsp;1.&nbsp;+.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;30.&nbsp;;&nbsp;(&nbsp;11.&nbsp;-.&nbsp;4.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;30.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;(-79.&nbsp;-.&nbsp;31.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;150.&nbsp;;&nbsp;(&nbsp;-1.&nbsp;-.&nbsp;4.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;30.&nbsp;;&nbsp;(&nbsp;24.&nbsp;+.&nbsp;11.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;25.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;(&nbsp;14.&nbsp;+.&nbsp;5.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;6.&nbsp;;&nbsp;(&nbsp;7.&nbsp;*.&nbsp;sqrt_of_6&nbsp;-.&nbsp;8.&nbsp;)&nbsp;/.&nbsp;6.&nbsp;;&nbsp;(&nbsp;-9.&nbsp;-.&nbsp;7.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;4.&nbsp;;&nbsp;(&nbsp;9.&nbsp;-.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;4.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;hem_4_5_b&nbsp;=&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;(&nbsp;16.&nbsp;-.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;36.&nbsp;;&nbsp;(&nbsp;16.&nbsp;+.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;36.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;9.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk5_kutta_first_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.2&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.4&nbsp;|]&nbsp;;&nbsp;[|&nbsp;2.25&nbsp;;&nbsp;-5.&nbsp;;&nbsp;3.75&nbsp;|]&nbsp;;&nbsp;[|&nbsp;-0.63&nbsp;;&nbsp;1.8&nbsp;;&nbsp;-0.65&nbsp;;&nbsp;0.08&nbsp;|]&nbsp;;&nbsp;[|&nbsp;-0.24&nbsp;;&nbsp;0.8&nbsp;;&nbsp;2.&nbsp;/.&nbsp;15.&nbsp;;&nbsp;8.&nbsp;/.&nbsp;75.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk5_kutta_first_b&nbsp;=&nbsp;[|&nbsp;17.&nbsp;/.&nbsp;144.&nbsp;;&nbsp;0.&nbsp;;&nbsp;100.&nbsp;/.&nbsp;144.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;144.&nbsp;;&nbsp;-50.&nbsp;/.&nbsp;144.&nbsp;;&nbsp;75.&nbsp;/.&nbsp;144.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk5_kutta_second_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.16&nbsp;;&nbsp;0.24&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;-3.&nbsp;;&nbsp;3.75&nbsp;|]&nbsp;;&nbsp;[|&nbsp;2.&nbsp;/.&nbsp;27.&nbsp;;&nbsp;10.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;-50.&nbsp;/.&nbsp;81.&nbsp;;&nbsp;8.&nbsp;/.&nbsp;81.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;0.08&nbsp;;&nbsp;0.48&nbsp;;&nbsp;2.&nbsp;/.&nbsp;15.&nbsp;;&nbsp;8.&nbsp;/.&nbsp;75.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk5_kutta_second_b&nbsp;=&nbsp;[|&nbsp;23.&nbsp;/.&nbsp;192.&nbsp;;&nbsp;0.&nbsp;;&nbsp;125.&nbsp;/.&nbsp;192.&nbsp;;&nbsp;0.&nbsp;;&nbsp;-27.&nbsp;/.&nbsp;64.&nbsp;;&nbsp;125.&nbsp;/.&nbsp;192.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk5_cassity_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;7.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;-367.&nbsp;/.&nbsp;4088.&nbsp;;&nbsp;261.&nbsp;/.&nbsp;584.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;41991.&nbsp;/.&nbsp;2044.&nbsp;;&nbsp;-2493.&nbsp;/.&nbsp;73.&nbsp;;&nbsp;57.&nbsp;/.&nbsp;4.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;-108413.&nbsp;/.&nbsp;196224.&nbsp;;&nbsp;58865.&nbsp;/.&nbsp;65408.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;16.&nbsp;;&nbsp;265.&nbsp;/.&nbsp;1344.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;-204419.&nbsp;/.&nbsp;58984.&nbsp;;&nbsp;143829.&nbsp;/.&nbsp;58984.&nbsp;;&nbsp;171.&nbsp;/.&nbsp;202.&nbsp;;&nbsp;2205.&nbsp;/.&nbsp;404.&nbsp;;&nbsp;-432.&nbsp;/.&nbsp;101.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk5_cassity_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;7.&nbsp;/.&nbsp;2700.&nbsp;;&nbsp;413.&nbsp;/.&nbsp;810.&nbsp;;&nbsp;7.&nbsp;/.&nbsp;450.&nbsp;;&nbsp;28.&nbsp;/.&nbsp;75.&nbsp;;&nbsp;-101.&nbsp;/.&nbsp;8100.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk6_butcher_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.5&nbsp;-.&nbsp;sqrt_of_5&nbsp;/.&nbsp;10.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;-.&nbsp;sqrt_of_5&nbsp;/.&nbsp;10.&nbsp;;&nbsp;0.5&nbsp;+.&nbsp;sqrt_of_5&nbsp;/.&nbsp;5.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;(&nbsp;-15.&nbsp;+.&nbsp;7.&nbsp;*.&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;20.&nbsp;;&nbsp;-0.25&nbsp;+.&nbsp;sqrt_of_5&nbsp;/.&nbsp;4.&nbsp;;&nbsp;(&nbsp;15.&nbsp;-.&nbsp;7.&nbsp;*.&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;10.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;(&nbsp;5.&nbsp;-.&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;60.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;(&nbsp;15.&nbsp;-.&nbsp;7.&nbsp;*.&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;60.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;(&nbsp;5.&nbsp;-.&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;60.&nbsp;;&nbsp;0.&nbsp;;&nbsp;(&nbsp;9.&nbsp;-.&nbsp;5.&nbsp;*.&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;12.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;-0.5&nbsp;+.&nbsp;0.3&nbsp;*.&nbsp;sqrt_of_5&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;0.&nbsp;;&nbsp;(&nbsp;-55.&nbsp;+.&nbsp;25.&nbsp;*.&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;12.&nbsp;;&nbsp;(&nbsp;-25.&nbsp;-.&nbsp;7.&nbsp;*.&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;12.&nbsp;;&nbsp;5.&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;sqrt_of_5&nbsp;;&nbsp;2.5&nbsp;+.&nbsp;0.5&nbsp;*.&nbsp;sqrt_of_5&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk6_butcher_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;12.&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Mthodesimplicitesavecrsolutionunidimensionnelle"><h2>Méthodes implicites avec résolution unidimensionnelle</h2></span>
<span id="2_ImplicitMethodswithunidimensionalresolution"><h2>Implicit Methods with unidimensional resolution</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_back_euler methode function nsteps value beginning ending</pre> The method must contain the solving method, included
the method of derivation and all the parameters, as in the following example.
<p>

<pre> y' = f(x,y) float_zero_householder ( float_richardson_deriv 3. 4 1e-3 ) 3 100</pre>
<p>

La méthode doit contenir la méthode de résolution, y compris la méthode de dérivation et tous les paramètres, 
comme dans l'exemple ci-dessus.
*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_back_euler&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(i&nbsp;-&nbsp;1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;-.&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_back_euler methode function nsteps value beginning ending</pre> The method must contain the solving method, included
the method of derivation and all the parameters, as in the following example.
<p>

<pre> y' = f(x,y) float_zero_householder ( float_richardson_deriv 3. 4 1e-3 ) 3 100</pre>
<p>

La méthode doit contenir la méthode de résolution, y compris la méthode de dérivation et tous les paramètres, 
comme dans l'exemple ci-dessus.
*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_back_euler&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;!y&nbsp;+.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;-.&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;methode&nbsp;g&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_trapezoid methode function nsteps value beginning ending</pre> The method must contain the solving method, included
the method of derivation and all the parameters, as in the following example.
<p>

<pre>float_zero_householder ( float_richardson_deriv 3. 4 1e-3 ) 3 100</pre>
<p>

La méthode doit contenir la méthode de résolution, y compris la méthode de dérivation et tous les paramètres, 
comme dans l'exemple ci-dessus.
*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_trapezoid&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(i&nbsp;-&nbsp;1)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;f&nbsp;!x&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;zz&nbsp;+.&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;-.&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_trapezoid methode function nsteps value beginning ending</pre> The method must contain the solving method, included
the method of derivation and all the parameters, as in the following example.
<p>

<pre>float_zero_householder ( float_richardson_deriv 3. 4 1e-3 ) 3 100</pre>
<p>

La méthode doit contenir la méthode de résolution, y compris la méthode de dérivation et tous les paramètres, 
comme dans l'exemple ci-dessus.
*)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_trapezoid&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;!y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;f&nbsp;!x&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;+.&nbsp;halfstep&nbsp;*.&nbsp;(&nbsp;zz&nbsp;+.&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;-.&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;methode&nbsp;g&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_adams_moulton_2 methode function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_adams_moulton_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;(&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;twelfthstep&nbsp;=&nbsp;halfstep&nbsp;/.&nbsp;6.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y0&nbsp;-.&nbsp;t&nbsp;+.&nbsp;step&nbsp;*.&nbsp;f&nbsp;!x&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz.(1)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;y.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;-.&nbsp;t&nbsp;+.&nbsp;twelfthstep&nbsp;*.&nbsp;(&nbsp;5.&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;+.&nbsp;8.&nbsp;*.&nbsp;zz.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;-.&nbsp;zz.(&nbsp;i&nbsp;-&nbsp;2&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(i)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;y.(i)&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_adams_moulton_2 methode function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_adams_moulton_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zzz&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;halfstep&nbsp;=&nbsp;step&nbsp;*.&nbsp;0.5&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;twelfthstep&nbsp;=&nbsp;halfstep&nbsp;/.&nbsp;6.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y0&nbsp;-.&nbsp;t&nbsp;+.&nbsp;step&nbsp;*.&nbsp;f&nbsp;!x&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;methode&nbsp;g&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;f&nbsp;!x&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;!y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;-.&nbsp;t&nbsp;+.&nbsp;twelfthstep&nbsp;*.&nbsp;(&nbsp;5.&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;+.&nbsp;8.&nbsp;*.&nbsp;(&nbsp;f&nbsp;(&nbsp;!x&nbsp;-.&nbsp;step&nbsp;)&nbsp;z&nbsp;)&nbsp;-.&nbsp;(&nbsp;f&nbsp;(&nbsp;!x&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;step&nbsp;)&nbsp;!yy&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;methode&nbsp;g&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zzz&nbsp;:=&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;f&nbsp;!x&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_milne_simpson_2 methode function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_milne_simpson_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;zzz&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;(&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;thirdstep&nbsp;=&nbsp;step&nbsp;/.&nbsp;3.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y0&nbsp;-.&nbsp;t&nbsp;+.&nbsp;step&nbsp;*.&nbsp;f&nbsp;!x&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;zzz.(1)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;y.(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;2&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;z&nbsp;-.&nbsp;t&nbsp;+.&nbsp;thirdstep&nbsp;*.&nbsp;(&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;+.&nbsp;4.&nbsp;*.&nbsp;zzz.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;+.&nbsp;zzz.(&nbsp;i&nbsp;-&nbsp;2&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zzz.(i)&nbsp;&lt;-&nbsp;f&nbsp;!x&nbsp;y.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_milne_simpson_2 methode function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_milne_simpson_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;zzz&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;thirdstep&nbsp;=&nbsp;step&nbsp;/.&nbsp;3.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y0&nbsp;-.&nbsp;t&nbsp;+.&nbsp;step&nbsp;*.&nbsp;f&nbsp;!x&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;methode&nbsp;g&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;f&nbsp;!x&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;!yy&nbsp;-.&nbsp;t&nbsp;+.&nbsp;thirdstep&nbsp;*.&nbsp;(&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;+.&nbsp;4.&nbsp;*.&nbsp;!zz&nbsp;+.&nbsp;!zzz&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;methode&nbsp;g&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zzz&nbsp;:=&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;f&nbsp;!x&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_bdf_2 methode function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_bdf_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y0&nbsp;-.&nbsp;t&nbsp;+.&nbsp;step&nbsp;*.&nbsp;f&nbsp;!x&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;3.&nbsp;*.&nbsp;t&nbsp;-.&nbsp;4.&nbsp;*.&nbsp;z&nbsp;+.&nbsp;y.(&nbsp;i&nbsp;-&nbsp;2&nbsp;)&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_bdf_2 methode function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_bdf_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y0&nbsp;-.&nbsp;t&nbsp;+.&nbsp;step&nbsp;*.&nbsp;f&nbsp;!x&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;methode&nbsp;g&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;2&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;3.&nbsp;*.&nbsp;t&nbsp;-.&nbsp;4.&nbsp;*.&nbsp;!y&nbsp;+.&nbsp;!yy&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;methode&nbsp;g&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_bdf_3 methode function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_bdf_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y0&nbsp;-.&nbsp;t&nbsp;+.&nbsp;step&nbsp;*.&nbsp;f&nbsp;!x&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;3.&nbsp;*.&nbsp;t&nbsp;-.&nbsp;4.&nbsp;*.&nbsp;y.(1)&nbsp;+.&nbsp;y0&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;y.(2)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;y.(1)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;11.&nbsp;*.&nbsp;t&nbsp;-.&nbsp;18.&nbsp;*.&nbsp;z&nbsp;+.&nbsp;9.&nbsp;*.&nbsp;y.(&nbsp;i&nbsp;-&nbsp;2&nbsp;)&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;y.(&nbsp;i&nbsp;-&nbsp;3&nbsp;)&nbsp;-.&nbsp;6.&nbsp;*.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_bdf_3 methode function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_bdf_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yyy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y0&nbsp;-.&nbsp;t&nbsp;+.&nbsp;step&nbsp;*.&nbsp;f&nbsp;!x&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;methode&nbsp;g&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;3.&nbsp;*.&nbsp;t&nbsp;-.&nbsp;4.&nbsp;*.&nbsp;!yy&nbsp;+.&nbsp;y0&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;methode&nbsp;g&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;3&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;11.&nbsp;*.&nbsp;t&nbsp;-.&nbsp;18.&nbsp;*.&nbsp;!y&nbsp;+.&nbsp;9.&nbsp;*.&nbsp;!yy&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;!yyy&nbsp;-.&nbsp;6.&nbsp;*.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;methode&nbsp;g&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yyy&nbsp;:=&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_bdf_4 methode function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_bdf_4&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y0&nbsp;-.&nbsp;t&nbsp;+.&nbsp;step&nbsp;*.&nbsp;f&nbsp;!x&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;y.(1)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;3.&nbsp;*.&nbsp;t&nbsp;-.&nbsp;4.&nbsp;*.&nbsp;y.(1)&nbsp;+.&nbsp;y0&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;y.(2)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;y.(1)&nbsp;;<br>
&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;11.&nbsp;*.&nbsp;t&nbsp;-.&nbsp;18.&nbsp;*.&nbsp;y.(2)&nbsp;+.&nbsp;9.&nbsp;*.&nbsp;y.(1)&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;y0&nbsp;-.&nbsp;6.&nbsp;*.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;y.(3)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;y.(2)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;4&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;25.&nbsp;*.&nbsp;t&nbsp;-.&nbsp;48.&nbsp;*.&nbsp;z&nbsp;+.&nbsp;36.&nbsp;*.&nbsp;y.(&nbsp;i&nbsp;-&nbsp;2&nbsp;)&nbsp;-.&nbsp;16.&nbsp;*.&nbsp;y.(&nbsp;i&nbsp;-&nbsp;3&nbsp;)&nbsp;+.&nbsp;3.&nbsp;*.&nbsp;y.(&nbsp;i&nbsp;-&nbsp;4&nbsp;)&nbsp;-.&nbsp;12.&nbsp;*.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_bdf_4 methode function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_bdf_4&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yyy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yyyy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;y0&nbsp;-.&nbsp;t&nbsp;+.&nbsp;step&nbsp;*.&nbsp;f&nbsp;!x&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;yyy&nbsp;:=&nbsp;methode&nbsp;g&nbsp;y0&nbsp;;<br>
&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;3.&nbsp;*.&nbsp;t&nbsp;-.&nbsp;4.&nbsp;*.&nbsp;!yyy&nbsp;+.&nbsp;y0&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;methode&nbsp;g&nbsp;!yyy&nbsp;;<br>
&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;11.&nbsp;*.&nbsp;t&nbsp;-.&nbsp;18.&nbsp;*.&nbsp;!y&nbsp;+.&nbsp;9.&nbsp;*.&nbsp;!yy&nbsp;-.&nbsp;2.&nbsp;*.&nbsp;!yyy&nbsp;-.&nbsp;6.&nbsp;*.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;methode&nbsp;g&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;4&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;25.&nbsp;*.&nbsp;t&nbsp;-.&nbsp;48.&nbsp;*.&nbsp;!y&nbsp;+.&nbsp;36.&nbsp;*.&nbsp;!yy&nbsp;-.&nbsp;16.&nbsp;*.&nbsp;!yyy&nbsp;+.&nbsp;3.&nbsp;*.&nbsp;!yyyy&nbsp;-.&nbsp;12.&nbsp;*.&nbsp;step&nbsp;*.&nbsp;(&nbsp;f&nbsp;!x&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;methode&nbsp;g&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yyy&nbsp;:=&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;yy&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_runge_kutta_impl methode butcher_matrix butcher_vector function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_runge_kutta_impl&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;!xx&nbsp;+.&nbsp;c.(0)&nbsp;*.&nbsp;step&nbsp;)&nbsp;(&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;a.(0).(0)&nbsp;*.&nbsp;t&nbsp;)&nbsp;-.&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;row.(index)&nbsp;*.&nbsp;k.(index)&nbsp;*.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;(&nbsp;!xx&nbsp;+.&nbsp;c.(j)&nbsp;*.&nbsp;step&nbsp;)&nbsp;(&nbsp;!z&nbsp;+.&nbsp;!zz&nbsp;+.&nbsp;row.(j)&nbsp;*.&nbsp;step&nbsp;*.&nbsp;t&nbsp;)&nbsp;)&nbsp;-.&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;b.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_runge_kutta_impl methode butcher_matrix butcher_vector function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_runge_kutta_impl&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;(&nbsp;!xx&nbsp;+.&nbsp;c.(0)&nbsp;*.&nbsp;step&nbsp;)&nbsp;(&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;a.(0).(0)&nbsp;*.&nbsp;t&nbsp;)&nbsp;-.&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;row.(index)&nbsp;*.&nbsp;k.(index)&nbsp;*.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;f&nbsp;(&nbsp;!xx&nbsp;+.&nbsp;c.(j)&nbsp;*.&nbsp;step&nbsp;)&nbsp;(&nbsp;!z&nbsp;+.&nbsp;!zz&nbsp;+.&nbsp;row.(j)&nbsp;*.&nbsp;step&nbsp;*.&nbsp;t&nbsp;)&nbsp;)&nbsp;-.&nbsp;t&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;)&nbsp;&lt;-&nbsp;methode&nbsp;g&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;b.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** Some Butcher tableaus are following. They have been harvested on the internet.
The square matrix must be lower triangular in the loose sense.
(excepted in the particular case of the trapezoidal method).
Some tableaus quoted in the methods with multidimensional resolution
may be used if they satisfy the condition.
<p>

Suivent quelques tableaux de Butcher. Ils ont été glanés sur internet.
La matrice carrée doit être triangulaire inférieure au sens large.
(sauf dans le cas particulier de la méthode trapézoïdale).
Certains tableaux cités dans les méthodes à résolution multidimansionnelle
peuvent donc être utilisés s'ils répondent à la condition.
<p>

<center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;backward_euler_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;backward_euler_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk1_gauss_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.5&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk1_gauss_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_burrage_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.25&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_burrage_b&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_radauI_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_radauI_b&nbsp;=&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;0.75&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_radauII_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_radauII_b&nbsp;=&nbsp;[|&nbsp;0.75&nbsp;;&nbsp;0.25&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_sdirk_2A_b&nbsp;&nbsp;=&nbsp;[|&nbsp;inv_sqrt_of_2&nbsp;;&nbsp;1.&nbsp;-.&nbsp;inv_sqrt_of_2&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_sdirk_2A_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;-.&nbsp;inv_sqrt_of_2&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;rk2_sdirk_2A_b&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_sdirk_2B_b&nbsp;&nbsp;=&nbsp;[|&nbsp;-.&nbsp;inv_sqrt_of_2&nbsp;;&nbsp;1.&nbsp;+.&nbsp;inv_sqrt_of_2&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_sdirk_2B_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;+.&nbsp;inv_sqrt_of_2&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;rk2_sdirk_2B_b&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_sdirk_3A_b&nbsp;&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;-.&nbsp;0.5&nbsp;*.&nbsp;inv_sqrt_of_3&nbsp;;&nbsp;inv_sqrt_of_3&nbsp;;&nbsp;0.5&nbsp;-.&nbsp;0.5&nbsp;*.&nbsp;inv_sqrt_of_3&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_sdirk_3A_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;rk2_sdirk_3A_b.(0)&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;rk2_sdirk_3A_b.(0)&nbsp;;&nbsp;rk2_sdirk_3A_b.(0)&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;rk2_sdirk_3A_b&nbsp;|]&nbsp;;;&nbsp;<br>
<br>
<span class="keyword">let</span>&nbsp;rk3_example_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk3_example_b&nbsp;=&nbsp;[|&nbsp;0.75&nbsp;;&nbsp;0.25&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;imex_ssp2_2_2_2_impl_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;-.&nbsp;1.&nbsp;/.&nbsp;sqrt_of_2&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;sqrt_of_2&nbsp;-.&nbsp;1.&nbsp;;&nbsp;1.&nbsp;-.&nbsp;1.&nbsp;/.&nbsp;sqrt_of_2&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imex_ssp2_2_2_2_impl_b&nbsp;=&nbsp;imex_ssp2_2_2_2_b&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;imex_ssp2_3_2_2_impl_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;-0.5&nbsp;;&nbsp;0.5&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imex_ssp2_3_2_2_impl_b&nbsp;=&nbsp;imex_ssp2_3_2_2_b&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;imex_ssp2_3_3_2_impl_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.25&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imex_ssp2_3_3_2_impl_b&nbsp;=&nbsp;imex_ssp2_3_3_2_b&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;imex_ssp3_3_3_2_impl_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;-.&nbsp;1.&nbsp;/.&nbsp;sqrt_of_2&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;sqrt_of_2&nbsp;-.&nbsp;1.&nbsp;;&nbsp;1.&nbsp;-.&nbsp;1.&nbsp;/.&nbsp;sqrt_of_2&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;sqrt_of_2&nbsp;-.&nbsp;0.5&nbsp;;&nbsp;0.&nbsp;;&nbsp;1.&nbsp;-.&nbsp;1.&nbsp;/.&nbsp;sqrt_of_2&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imex_ssp3_3_3_2_impl_b&nbsp;=&nbsp;imex_ssp3_3_3_2_b&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;mod_ext_bdf_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;;&nbsp;1.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;-0.5&nbsp;;&nbsp;1.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;mod_ext_bdf_b&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;-0.5&nbsp;;&nbsp;1.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;lambda_example_start&nbsp;=&nbsp;0.4358665215&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;lambda_example_polynom&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;(&nbsp;18.&nbsp;-.&nbsp;6.&nbsp;*.&nbsp;x&nbsp;)&nbsp;*.&nbsp;x&nbsp;-.&nbsp;9.&nbsp;)&nbsp;*.&nbsp;x&nbsp;+.&nbsp;1.&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;lambda_example&nbsp;=&nbsp;float_zero_general&nbsp;(&nbsp;float_richardson_binary_deriv&nbsp;4&nbsp;1e-3&nbsp;)&nbsp;3&nbsp;100&nbsp;lambda_example_polynom&nbsp;lambda_example_start&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;lambda_example_b&nbsp;=&nbsp;[|&nbsp;(&nbsp;4.&nbsp;-.&nbsp;1.5&nbsp;*.&nbsp;lambda_example&nbsp;)&nbsp;*.&nbsp;lambda_example&nbsp;-.&nbsp;0.25&nbsp;;<br>
&nbsp;(&nbsp;1.5&nbsp;*.&nbsp;lambda_example&nbsp;-.&nbsp;5.&nbsp;)&nbsp;*.&nbsp;lambda_example&nbsp;&nbsp;+.&nbsp;1.25&nbsp;;&nbsp;lambda_example&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;lambda_example_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;lambda_example&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;(&nbsp;1.&nbsp;-.&nbsp;lambda_example&nbsp;)&nbsp;*.&nbsp;0.5&nbsp;;&nbsp;lambda_example&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;lambda_example_b&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;imex&nbsp;=&nbsp;[|&nbsp;0.24169426078821&nbsp;;&nbsp;&nbsp;0.06042356519705&nbsp;;&nbsp;&nbsp;0.12915286960590&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;imex_ssp3_4_3_3_impl_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;imex.(0)&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;-.&nbsp;imex.(0)&nbsp;;&nbsp;imex.(0)&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;1.&nbsp;-.&nbsp;imex.(0)&nbsp;;&nbsp;imex.(0)&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;imex.(1)&nbsp;;&nbsp;imex.(2)&nbsp;;&nbsp;0.5&nbsp;-.&nbsp;imex.(0)&nbsp;-.&nbsp;imex.(1)&nbsp;-.&nbsp;imex.(2)&nbsp;;&nbsp;imex.(0)&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;imex_ssp3_4_3_3_impl_b&nbsp;=&nbsp;imex_ssp3_4_3_3_b<br>
<br>
<span class="keyword">let</span>&nbsp;rk5_try_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.125&nbsp;;&nbsp;0.125&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;-0.01&nbsp;;&nbsp;0.56&nbsp;;&nbsp;0.15&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;2.&nbsp;/.&nbsp;7.&nbsp;;&nbsp;0.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;7.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk5_try_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;14.&nbsp;;&nbsp;32.&nbsp;/.&nbsp;81.&nbsp;;&nbsp;250.&nbsp;/.&nbsp;567.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;54.&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Mthodesimplicitesavecrsolutionmultidimensionnelle"><h2>Méthodes implicites avec résolution multidimensionnelle</h2></span>
<span id="2_ImplicitMethodswithmultidimensionalresolution"><h2>Implicit Methods with multidimensional resolution</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_runge_kutta_impl_multi methode butcher_matrix butcher_vector function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_runge_kutta_impl_multi&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;u&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_vector_float_prod&nbsp;a&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;!u&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_add&nbsp;!z&nbsp;!u&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!u.(j)&nbsp;&lt;-&nbsp;t.(j)&nbsp;-.&nbsp;f&nbsp;x.(j)&nbsp;!u.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!u<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;:=&nbsp;methode&nbsp;g&nbsp;yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;b.(j)&nbsp;*.&nbsp;!k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_runge_kutta_impl_multi methode butcher_matrix butcher_vector function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_runge_kutta_impl_multi&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;t&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;u&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_vector_float_prod&nbsp;a&nbsp;t&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;!u&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_add&nbsp;!z&nbsp;!u&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!u.(j)&nbsp;&lt;-&nbsp;t.(j)&nbsp;-.&nbsp;f&nbsp;x.(j)&nbsp;!u.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!u<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;:=&nbsp;methode&nbsp;g&nbsp;(&nbsp;yy&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;b.(j)&nbsp;*.&nbsp;!k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** Some Butcher tableaus are following. They have been harvested on the internet.
<p>

Suivent quelques tableaux de Butcher. Ils ont été glanés sur internet. 
<p>

<center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;trapezoid_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;trapezoid_b&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_gauss_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;0.25&nbsp;-.&nbsp;sqrt&nbsp;3.&nbsp;/.&nbsp;6.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.25&nbsp;+.&nbsp;sqrt&nbsp;3.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;0.25&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_gauss_b&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_radauIA_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;-0.25&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;5.&nbsp;/.&nbsp;12.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_radauIA_b&nbsp;=&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;0.75&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_radauIIA_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;5.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;-1.&nbsp;/.&nbsp;12.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.75&nbsp;;&nbsp;0.25&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_radauIIA_b&nbsp;=&nbsp;[|&nbsp;0.75&nbsp;;&nbsp;0.25&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk3_gauss_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;5.&nbsp;/.&nbsp;36.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;9.&nbsp;-.&nbsp;1.&nbsp;/.&nbsp;sqrt_of_15&nbsp;;&nbsp;5.&nbsp;/.&nbsp;36.&nbsp;-.&nbsp;0.5&nbsp;/.&nbsp;sqrt_of_15&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;&nbsp;5.&nbsp;/.&nbsp;36.&nbsp;+.&nbsp;sqrt_of_15&nbsp;/.&nbsp;24.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;36.&nbsp;-.&nbsp;sqrt_of_15&nbsp;/.&nbsp;24.&nbsp;|]&nbsp;;&nbsp;<br>
&nbsp;[|&nbsp;5.&nbsp;/.&nbsp;36.&nbsp;+.&nbsp;0.5&nbsp;/.&nbsp;sqrt_of_15&nbsp;;&nbsp;2.&nbsp;/.&nbsp;9.&nbsp;+.&nbsp;1.&nbsp;/.&nbsp;sqrt_of_15&nbsp;;&nbsp;5.&nbsp;/.&nbsp;36.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk3_gauss_b&nbsp;=&nbsp;[|&nbsp;5.&nbsp;/.&nbsp;18.&nbsp;;&nbsp;4.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;18.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk3_radauI_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;(&nbsp;9.&nbsp;+.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;75.&nbsp;;&nbsp;0.2&nbsp;+.&nbsp;sqrt_of_6&nbsp;/.&nbsp;120.&nbsp;;&nbsp;0.28&nbsp;-.&nbsp;73.&nbsp;*.&nbsp;sqrt_of_6&nbsp;/.&nbsp;600.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;(&nbsp;9.&nbsp;-.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;75.&nbsp;;&nbsp;0.28&nbsp;+.&nbsp;73.&nbsp;*.&nbsp;sqrt_of_6&nbsp;/.&nbsp;600.&nbsp;;&nbsp;0.2&nbsp;-.&nbsp;sqrt_of_6&nbsp;/.&nbsp;120.&nbsp;|]&nbsp;|]&nbsp;;;&nbsp;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk3_radauI_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;(&nbsp;16.&nbsp;+.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;36.&nbsp;;&nbsp;(&nbsp;16.&nbsp;-.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;36.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk5_radauIA_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;(&nbsp;-1.&nbsp;-.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;18.&nbsp;;&nbsp;(&nbsp;-1.&nbsp;+.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;18.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;(&nbsp;88.&nbsp;+.&nbsp;7.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;360.&nbsp;;&nbsp;(&nbsp;88.&nbsp;-.&nbsp;43.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;360.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;(&nbsp;88.&nbsp;+.&nbsp;43.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;360.&nbsp;;&nbsp;(&nbsp;88.&nbsp;-.&nbsp;7.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;360.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk5_radauIA_b&nbsp;=&nbsp;rk3_radauI_b&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk3_radauII_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.2&nbsp;-.&nbsp;sqrt_of_6&nbsp;/.&nbsp;120.&nbsp;;&nbsp;0.2&nbsp;-.&nbsp;11.&nbsp;*.&nbsp;sqrt_of_6&nbsp;/.&nbsp;120.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.2&nbsp;+.&nbsp;11.&nbsp;*.&nbsp;sqrt_of_6&nbsp;/.&nbsp;120.&nbsp;;&nbsp;0.2&nbsp;+.&nbsp;sqrt_of_6&nbsp;/.&nbsp;120.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;<br>
&nbsp;[|&nbsp;0.5&nbsp;-.&nbsp;0.5&nbsp;/.&nbsp;sqrt_of_6&nbsp;;&nbsp;0.5&nbsp;+.&nbsp;0.5&nbsp;/.&nbsp;sqrt_of_6&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk3_radauII_b&nbsp;=&nbsp;[|&nbsp;(&nbsp;16.&nbsp;-.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;36.&nbsp;;&nbsp;(&nbsp;16.&nbsp;+.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;36.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;9.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk3_radauIIA_b&nbsp;=&nbsp;[|&nbsp;(&nbsp;16.&nbsp;-.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;36.&nbsp;;&nbsp;(&nbsp;16.&nbsp;+.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;36.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;9.&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk3_radauIIA_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;(&nbsp;88.&nbsp;-.&nbsp;7.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;360.&nbsp;;&nbsp;(&nbsp;296.&nbsp;-.&nbsp;169.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;1800.&nbsp;;&nbsp;(&nbsp;-2.&nbsp;+.&nbsp;3.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;225.&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;(&nbsp;296.&nbsp;+.&nbsp;169.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;1800.&nbsp;;&nbsp;(&nbsp;88.&nbsp;+.&nbsp;7.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;360.&nbsp;;&nbsp;(&nbsp;-2.&nbsp;-.&nbsp;3.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;225.&nbsp;|]&nbsp;;&nbsp;rk3_radauIIA_b&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk5_radauIIA_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;9.1232394870892942792e-2&nbsp;;&nbsp;-0.14125529502095420843&nbsp;;&nbsp;-3.0029194105147424492e-2&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;0.24171793270710701896&nbsp;;&nbsp;0.20412935229379993199&nbsp;;&nbsp;0.38294211275726193779&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;0.96604818261509293619&nbsp;;&nbsp;1.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk5_radauIIA_a_inv&nbsp;=&nbsp;[|&nbsp;[|&nbsp;4.3255798900631553510&nbsp;;&nbsp;0.33919925181580986954&nbsp;;&nbsp;0.54177053993587487119&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-4.1787185915519047273&nbsp;;&nbsp;-0.32768282076106238708&nbsp;;&nbsp;0.47662355450055045196&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.50287263494578687595&nbsp;;&nbsp;2.5719269498556054292&nbsp;;&nbsp;-0.59603920482822492497&nbsp;|]&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk5_radauIIA_b&nbsp;=&nbsp;[|&nbsp;-.&nbsp;(&nbsp;13.&nbsp;+.&nbsp;7.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;3.&nbsp;;&nbsp;(&nbsp;-13.&nbsp;+.&nbsp;7.&nbsp;*.&nbsp;sqrt_of_6&nbsp;)&nbsp;/.&nbsp;3.&nbsp;;&nbsp;-1.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;rk9_radauIIA_b&nbsp;=&nbsp;[|&nbsp;-0.2778093394406463730479e2&nbsp;;&nbsp;0.3641478498049213152712e1&nbsp;;<br>
-0.1252547721169118720491e1&nbsp;;&nbsp;0.5920031671845428725662&nbsp;;&nbsp;-0.2&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk9_radauIIA_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;-0.1251758622050104589014e-1&nbsp;;&nbsp;-0.1024204781790882707009e-1&nbsp;;<br>
&nbsp;0.4767387729029572386318e-1&nbsp;;&nbsp;-0.1147851525522951470794e-1&nbsp;;&nbsp;-0.1401985889287541028108e-1&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.1491670151895382429004e-2&nbsp;;&nbsp;0.5017286451737105816299e-1&nbsp;;&nbsp;-0.9433181918161143698066e-1&nbsp;;&nbsp;<br>
-0.7668830749180162885157e-2&nbsp;;&nbsp;0.2470857842651852681253e-1&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.7298187638808714862266e-1&nbsp;;&nbsp;-0.2305395340434179467214&nbsp;;&nbsp;0.1027030453801258997922&nbsp;;&nbsp;<br>
0.1939846399882895091122e-1&nbsp;;&nbsp;0.8180035370375117083639e-1&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.3800914400035681041264&nbsp;;&nbsp;0.3778939022488612495439&nbsp;;&nbsp;0.4667441303324943592896&nbsp;;&nbsp;<br>
0.4076011712801990666217&nbsp;;&nbsp;0.1996824278868025259365&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.9219789736812104884883&nbsp;;&nbsp;1.&nbsp;;&nbsp;0.0&nbsp;;&nbsp;1.&nbsp;;&nbsp;0.0&nbsp;|]&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk9_radauIIA_a_inv&nbsp;=&nbsp;[|&nbsp;[|&nbsp;-0.3004156772154440162771e2&nbsp;;&nbsp;-0.1386510785627141316518e2&nbsp;;&nbsp;<br>
-0.3480002774795185561828e1&nbsp;;&nbsp;0.1032008797825263422771e1&nbsp;;&nbsp;-0.8043030450739899174753&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;0.5344186437834911598895e1&nbsp;;&nbsp;0.4593615567759161004454e1&nbsp;;&nbsp;-0.3036360323459424298646e1&nbsp;;&nbsp;<br>
0.1050660190231458863860e1&nbsp;;&nbsp;-0.2727786118642962705386&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;0.3748059807439804860051e1&nbsp;;&nbsp;-0.3984965736343884667252e1&nbsp;;&nbsp;-0.1044415641608018792942e1&nbsp;;&nbsp;<br>
0.1184098568137948487231e1&nbsp;;&nbsp;-0.4499177701567803688988&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.3304188021351900000806e2&nbsp;;&nbsp;-0.1737695347906356701945e2&nbsp;;&nbsp;-0.1721290632540055611515&nbsp;;&nbsp;<br>
-0.9916977798254264258817e-1&nbsp;;&nbsp;0.5312281158383066671849&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.8611443979875291977700e1&nbsp;;&nbsp;0.9699991409528808231336e1&nbsp;;&nbsp;0.1914728639696874284851e1&nbsp;;&nbsp;<br>
0.2418692006084940026427e1&nbsp;;&nbsp;-0.1047463487935337418694e1&nbsp;|]&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;rk13_radauIIA_b&nbsp;=&nbsp;[|&nbsp;-0.5437443689412861451458e2&nbsp;;&nbsp;0.7000024004259186512041e1&nbsp;;&nbsp;-0.2355661091987557192256e1&nbsp;;&nbsp;<br>
0.1132289066106134386384e1&nbsp;;&nbsp;-0.6468913267673587118673&nbsp;;&nbsp;0.3875333853753523774248&nbsp;;&nbsp;-0.1428571428571428571429&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk13_radauIIA_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;-0.2153754627310526422828e-2&nbsp;;&nbsp;0.2156755135132077338691e-1&nbsp;;&nbsp;0.8783567925144144407326e-2&nbsp;;&nbsp;<br>
-0.4055161452331023898198e-2&nbsp;;&nbsp;0.4427232753268285479678e-2&nbsp;;&nbsp;-0.1238646187952874056377e-2&nbsp;;&nbsp;-0.2760617480543852499548e-2&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;0.1600025077880428526831e-2&nbsp;;&nbsp;-0.3813164813441154669442e-1&nbsp;;&nbsp;-0.2152556059400687552385e-1&nbsp;;&nbsp;0.8415568276559589237177e-2&nbsp;;&nbsp;<br>
-0.4031949570224549492304e-2&nbsp;;&nbsp;-0.6666635339396338181761e-4&nbsp;;&nbsp;0.3185474825166209848748e-2&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.4059107301947683091650e-2&nbsp;;&nbsp;0.5739650893938171539757e-1&nbsp;;&nbsp;0.5885052920842679105612e-1&nbsp;;&nbsp;-0.8560431061603432060177e-2&nbsp;;&nbsp;<br>
-0.6923212665023908924141e-2&nbsp;;&nbsp;-0.2352180982943338340535e-2&nbsp;;&nbsp;0.4169077725297562691409e-3&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.1575048807937684420346e-1&nbsp;;&nbsp;-0.3821469359696835048464e-1&nbsp;;&nbsp;-0.1657368112729438512412&nbsp;;&nbsp;-0.3737124230238445741907e-1&nbsp;;&nbsp;<br>
0.8239007298507719404499e-2&nbsp;;&nbsp;0.3115071152346175252726e-2&nbsp;;&nbsp;0.2511660491343882192836e-1&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.1129776610242208076086&nbsp;;&nbsp;-0.2491742124652636863308&nbsp;;&nbsp;0.2735633057986623212132&nbsp;;&nbsp;0.5366761379181770094279e-2&nbsp;;&nbsp;<br>
0.1932111161012620144312&nbsp;;&nbsp;0.1017177324817151468081&nbsp;;&nbsp;0.9504502035604622821039e-1&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.4583810431839315010281&nbsp;;&nbsp;0.5315846490836284292051&nbsp;;&nbsp;0.4863228366175728940567&nbsp;;&nbsp;0.5265742264584492629141&nbsp;;&nbsp;<br>
0.2755343949896258141929&nbsp;;&nbsp;0.5217519452747652852946&nbsp;;&nbsp;0.1280719446355438944141&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.8813915783538183763135&nbsp;;&nbsp;1.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk13_radauIIA_a_inv&nbsp;=&nbsp;[|&nbsp;[|&nbsp;-0.2581319263199822292761e3&nbsp;;&nbsp;-0.1890737630813985089520e3&nbsp;;&nbsp;-0.4908731481793013119445e2&nbsp;;&nbsp;<br>
-0.4110647469661428418112e1&nbsp;;&nbsp;-0.4053447889315563304175e1&nbsp;;&nbsp;0.3112755366607346076554e1&nbsp;;&nbsp;-0.1646774913558444650169e1&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.3007390169451292131731e1&nbsp;;&nbsp;-0.1101586607876577132911e2&nbsp;;&nbsp;0.1487799456131656281486e1&nbsp;;&nbsp;0.2130388159559282459432e1&nbsp;;&nbsp;<br>
-0.1816141086817565624822e1&nbsp;;&nbsp;0.1134325587895161100083e1&nbsp;;&nbsp;-0.4146990459433035319930&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.8441963188321084681757e1&nbsp;;&nbsp;-0.6505252740575150028169&nbsp;;&nbsp;0.6940670730369876478804e1&nbsp;;&nbsp;-0.3205047525597898431565e1&nbsp;;&nbsp;<br>
0.1071280943546478589783e1&nbsp;;&nbsp;-0.3548507491216221879730&nbsp;;&nbsp;0.9198549132786554154409e-1&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;0.7467833223502269977153e2&nbsp;;&nbsp;0.8740858897990081640204e2&nbsp;;&nbsp;0.4024158737379997877014e1&nbsp;;&nbsp;-0.3714806315158364186639e1&nbsp;;&nbsp;<br>
-0.3430093985982317350741e1&nbsp;;&nbsp;0.2696604809765312378853e1&nbsp;;&nbsp;-0.9386927436075461933568&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;0.5835652885190657724237e2&nbsp;;&nbsp;-0.1006877395780018096325e2&nbsp;;&nbsp;-0.3036638884256667120811e2&nbsp;;&nbsp;-0.1020020865184865985027e1&nbsp;;&nbsp;<br>
-0.1124175003784249621267&nbsp;;&nbsp;0.1890640831000377622800e1&nbsp;;&nbsp;-0.9716486393831482282172&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.2991862480282520966786e3&nbsp;;&nbsp;-0.2430407453687447911819e3&nbsp;;&nbsp;-0.4877710407803786921219e2&nbsp;;&nbsp;-0.2038671905741934405280e1&nbsp;;&nbsp;<br>
0.1673560239861084944268e1&nbsp;;&nbsp;-0.1087374032057106164456e1&nbsp;;&nbsp;0.9019382492960993738427&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;-0.9307650289743530591157e2&nbsp;;&nbsp;0.2388163105628114427703e2&nbsp;;&nbsp;0.3927888073081384382710e2&nbsp;;&nbsp;0.1438891568549108006988e2&nbsp;;&nbsp;<br>
-0.3510438399399361221087e1&nbsp;;&nbsp;0.4863284885566180701215e1&nbsp;;&nbsp;-0.2246482729591239916400e1&nbsp;|]&nbsp;|]&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_lobattoIIIA_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_lobattoIIIA_b&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk4_lobattoIIIA_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;5.&nbsp;/.&nbsp;24.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;-1.&nbsp;/.&nbsp;24.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** The previous method is also quoted as Hermite-Simpson method. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk4_lobattoIIIA_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk6_lobattoIIIA_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;12.&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk6_lobattoIIIA_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;(&nbsp;11.&nbsp;+.&nbsp;&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;120.&nbsp;;&nbsp;(&nbsp;25.&nbsp;-.&nbsp;&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;120.&nbsp;;&nbsp;(&nbsp;25.&nbsp;-.&nbsp;13.&nbsp;*.&nbsp;&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;120.&nbsp;;&nbsp;(&nbsp;sqrt_of_5&nbsp;-.&nbsp;1.&nbsp;)&nbsp;/.&nbsp;120.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;(&nbsp;11.&nbsp;-.&nbsp;&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;120.&nbsp;;&nbsp;(&nbsp;25.&nbsp;+.&nbsp;13.&nbsp;*.&nbsp;&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;120.&nbsp;;&nbsp;(&nbsp;25.&nbsp;+.&nbsp;&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;120.&nbsp;;&nbsp;(&nbsp;-1.&nbsp;-.&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;120.&nbsp;|]&nbsp;;&nbsp;rk6_lobattoIIIA_b&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_lobattoIIIB_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_lobattoIIIB_b&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk4_lobattoIIIB_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;-1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk4_lobattoIIIB_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk6_lobattoIIIB_b&nbsp;=&nbsp;rk6_lobattoIIIA_b&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk6_lobattoIIIB_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;(&nbsp;-1.&nbsp;-.&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;24.&nbsp;;&nbsp;(&nbsp;sqrt_of_5&nbsp;-.&nbsp;1.&nbsp;)&nbsp;/.&nbsp;24.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;(&nbsp;25.&nbsp;+.&nbsp;&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;120.&nbsp;;&nbsp;(&nbsp;25.&nbsp;-.&nbsp;13.&nbsp;*.&nbsp;&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;120.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;(&nbsp;25.&nbsp;+.&nbsp;13.&nbsp;*.&nbsp;&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;120.&nbsp;;&nbsp;(&nbsp;25.&nbsp;-.&nbsp;&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;120.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;<br>
[|&nbsp;1.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;(&nbsp;11.&nbsp;-.&nbsp;&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;24.&nbsp;;&nbsp;(&nbsp;11.&nbsp;+.&nbsp;&nbsp;sqrt_of_5&nbsp;)&nbsp;/.&nbsp;24.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_lobattoIIIC_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;-0.5&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_lobattoIIIC_b&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk4_lobattoIIIC_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;-1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;-1.&nbsp;/.&nbsp;12.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk4_lobattoIIIC_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_lobattoIIICstar_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_lobattoIIICstar_b&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk4_lobattoIIICstar_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;0.25&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;1.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** The previous method is also called Lobatto III for s = 3. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk4_lobattoIIICstar_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk2_lobattoIIID_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;-0.25&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.75&nbsp;;&nbsp;0.25&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_lobattoIIID_b&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk4_lobattoIIID_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;-1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;12.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;5.&nbsp;/.&nbsp;24.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;-1.&nbsp;/.&nbsp;24.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;12.&nbsp;;&nbsp;5.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;12.&nbsp;|]&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk4_lobattoIIID_b&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;example_DESIRE_b&nbsp;=&nbsp;[|&nbsp;(&nbsp;16.&nbsp;+.&nbsp;sqrt_of_2&nbsp;)&nbsp;/.&nbsp;40.&nbsp;;&nbsp;(&nbsp;16.&nbsp;-.&nbsp;sqrt_of_2&nbsp;)&nbsp;/.&nbsp;40.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;5.&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;example_DESIRE_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;(&nbsp;4.&nbsp;-.&nbsp;sqrt_of_2&nbsp;)&nbsp;/.&nbsp;20.&nbsp;;&nbsp;(&nbsp;4.&nbsp;-.&nbsp;3.&nbsp;*.&nbsp;sqrt_of_2&nbsp;)&nbsp;/.&nbsp;20.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;(&nbsp;4.&nbsp;+.&nbsp;3.&nbsp;*.&nbsp;sqrt_of_2&nbsp;)&nbsp;/.&nbsp;20.&nbsp;;&nbsp;(&nbsp;4.&nbsp;+.&nbsp;sqrt_of_2&nbsp;)&nbsp;/.&nbsp;20.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;&nbsp;example_DESIRE_b&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Mthodesadaptativesexplicites"><h2>Méthodes adaptatives explicites</h2></span>
<span id="2_Explicitadaptativemethods"><h2>Explicit adaptative methods</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_runge_kutta_simple_adapt butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_runge_kutta_simple_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;row.(index)&nbsp;*.&nbsp;k.(index)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;yy.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;b.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;!error&nbsp;+.&nbsp;bb.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;!zz&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;float_end_ode_runge_kutta&nbsp;a&nbsp;b&nbsp;f&nbsp;nsteps&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;!xx&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_runge_kutta_simple_adapt butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_ode_runge_kutta_simple_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;y0.(indice)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;&nbsp;row.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;bb.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kk&nbsp;=&nbsp;row.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;kk&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;error.(indice)&nbsp;+.&nbsp;coefficient&nbsp;*.&nbsp;kk&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;zz&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;vector_end_ode_runge_kutta&nbsp;a&nbsp;b&nbsp;f&nbsp;nsteps&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;!xx&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_runge_kutta_simple_adapt butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_ode_runge_kutta_simple_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim_r&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;dim_c&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;y0.(indice)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;&nbsp;row.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;bb.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kk&nbsp;=&nbsp;row.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;kk&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;error.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coefficient&nbsp;kk&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;zz&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;matrix_end_ode_runge_kutta&nbsp;a&nbsp;b&nbsp;f&nbsp;nsteps&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;!xx&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;error.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_runge_kutta_simple_adapt butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_end_ode_runge_kutta_simple_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;row.(index)&nbsp;*.&nbsp;k.(index)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;yy.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;b.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;!error&nbsp;+.&nbsp;bb.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;!zz&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_end_ode_runge_kutta&nbsp;a&nbsp;b&nbsp;f&nbsp;nsteps&nbsp;!y&nbsp;!xx&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_runge_kutta_simple_adapt butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_end_ode_runge_kutta_simple_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;y.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;bb.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kk&nbsp;=&nbsp;ligne.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;kk&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;error.(indice)&nbsp;+.&nbsp;coefficient&nbsp;*.&nbsp;kk&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;zz&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;vector_end_ode_runge_kutta&nbsp;a&nbsp;b&nbsp;f&nbsp;nsteps&nbsp;y&nbsp;!xx&nbsp;x.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;zzz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_runge_kutta_simple_adapt butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_end_ode_runge_kutta_simple_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim_r&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;dim_c&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;y.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;bb.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kk&nbsp;=&nbsp;ligne.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;kk&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;error.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coefficient&nbsp;kk&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;zz&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;matrix_end_ode_runge_kutta&nbsp;a&nbsp;b&nbsp;f&nbsp;nsteps&nbsp;y&nbsp;!xx&nbsp;x.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;zzz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;error.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_runge_kutta_adapt butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_end_ode_runge_kutta_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;row.(index)&nbsp;*.&nbsp;k.(index)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;yy.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;b.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;!error&nbsp;+.&nbsp;bb.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;!zz&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_end_ode_runge_kutta&nbsp;a&nbsp;b&nbsp;f&nbsp;nsteps&nbsp;!y&nbsp;!xx&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;y&nbsp;:=&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_runge_kutta_adapt butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;vector_end_ode_runge_kutta_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;y.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;bb.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;error.(indice)&nbsp;+.&nbsp;coefficient&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;zz&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;vector_end_ode_runge_kutta&nbsp;a&nbsp;b&nbsp;f&nbsp;nsteps&nbsp;y&nbsp;!xx&nbsp;x.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;yyy.(indice)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_runge_kutta_adapt butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;matrix_end_ode_runge_kutta_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim_r&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;dim_c&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;y.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;bb.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;error.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coefficient&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;zz&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;matrix_end_ode_runge_kutta&nbsp;a&nbsp;b&nbsp;f&nbsp;nsteps&nbsp;y&nbsp;!xx&nbsp;x.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;yyy.(indice)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;error.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_runge_kutta_bounded maxstages butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_end_ode_runge_kutta_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_end_ode_runge_kutta_simple_adapt&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;y0<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;!y&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;row.(index)&nbsp;*.&nbsp;k.(index)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;yy.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;b.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;!error&nbsp;+.&nbsp;bb.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;!zz&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;float_end_ode_runge_kutta_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!y&nbsp;!xx&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;y&nbsp;:=&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_runge_kutta_bounded maxstages butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;vector_end_ode_runge_kutta_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;vector_end_ode_runge_kutta_simple_adapt&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;y.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;bb.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;error.(indice)&nbsp;+.&nbsp;coefficient&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;zz&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;vector_end_ode_runge_kutta_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y&nbsp;!xx&nbsp;x.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;yyy.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_runge_kutta_bounded maxstages butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;matrix_end_ode_runge_kutta_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;matrix_end_ode_runge_kutta_simple_adapt&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dim_r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dim_c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim_r&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;dim_c&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;y.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;bb.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;error.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coefficient&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;zz&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;matrix_end_ode_runge_kutta_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y&nbsp;!xx&nbsp;x.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;yyy.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;error.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_runge_kutta_adapt butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_runge_kutta_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;row.(index)&nbsp;*.&nbsp;k.(index)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;yy.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;b.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;!error&nbsp;+.&nbsp;bb.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;!zz&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;float_end_ode_runge_kutta_adapt&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;!xx&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;y.(i)&nbsp;&lt;-&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_runge_kutta_adapt butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_ode_runge_kutta_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;y0.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;bb.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;error.(indice)&nbsp;+.&nbsp;coefficient&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;zz&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;vector_end_ode_runge_kutta_adapt&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;!xx&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;yyy.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_runge_kutta_adapt butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_ode_runge_kutta_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim_r&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;dim_c&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;y0.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;bb.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;error.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coefficient&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;zz&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;matrix_end_ode_runge_kutta_adapt&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;!xx&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;yyy.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;error.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_runge_kutta_bounded maxstages butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_ode_runge_kutta_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_ode_runge_kutta_simple_adapt&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;ref&nbsp;0.<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;y0<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;row.(index)&nbsp;*.&nbsp;k.(index)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yy.(j)&nbsp;&lt;-&nbsp;yy.(j)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;!zz&nbsp;+.&nbsp;b.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;!error&nbsp;+.&nbsp;bb.(j)&nbsp;*.&nbsp;k.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;!zz&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;float_end_ode_runge_kutta_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;!xx&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;y.(i)&nbsp;&lt;-&nbsp;!z&nbsp;+.&nbsp;step&nbsp;*.&nbsp;!zz&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;:=&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_runge_kutta_bounded maxstages butcher_matrix butcher_vector_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_ode_runge_kutta_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;vector_ode_runge_kutta_simple_adapt&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;l&nbsp;dim&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;y0.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;ligne.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;bb.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kk&nbsp;=&nbsp;ligne.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;zz.(indice)&nbsp;+.&nbsp;coeff&nbsp;*.&nbsp;kk&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;error.(indice)&nbsp;+.&nbsp;coefficient&nbsp;*.&nbsp;kk&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;zz&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;vector_end_ode_runge_kutta_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;!xx&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;yyy.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;+.&nbsp;step&nbsp;*.&nbsp;zz.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_runge_kutta_bounded maxstages butcher_matrix butcher_matrix_fine butcher_vector_raw tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_ode_runge_kutta_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(b:float&nbsp;array)&nbsp;(bstar:float&nbsp;array)&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;matrix_ode_runge_kutta_simple_adapt&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;a<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dim_r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dim_c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;c&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;bb&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dd&nbsp;=&nbsp;dim_r&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;cc&nbsp;=&nbsp;dim_c&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;beginning<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;error&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;l&nbsp;0.&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;k&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;l&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;bb.(l)&nbsp;&lt;-&nbsp;b.(l)&nbsp;-.&nbsp;bstar.(l)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bb.(i)&nbsp;&lt;-&nbsp;b.(i)&nbsp;-.&nbsp;bstar.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;i&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.(i)&nbsp;&lt;-&nbsp;c.(i)&nbsp;+.&nbsp;row.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;y0.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;x.(0)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.(indice)&nbsp;&lt;-&nbsp;row.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(0)&nbsp;&lt;-&nbsp;f&nbsp;!xx&nbsp;z&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;ll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(j)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;*.&nbsp;c.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;a.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;index&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;j&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;k.(index)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;row.(index)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;ligne.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;yy.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;row.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k.(&nbsp;j&nbsp;+&nbsp;1&nbsp;)&nbsp;&lt;-&nbsp;f&nbsp;x.(j)&nbsp;yy.(j)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.(0)&nbsp;&lt;-&nbsp;!xx&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;z.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;j&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;k.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coeff&nbsp;=&nbsp;b.(j)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;coefficient&nbsp;=&nbsp;bb.(j)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;kk&nbsp;=&nbsp;ligne.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zz.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;zz.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coeff&nbsp;kk&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;error.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;coefficient&nbsp;kk&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;error&nbsp;)&nbsp;&gt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;zz&nbsp;)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;yyy&nbsp;=&nbsp;matrix_end_ode_runge_kutta_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;a&nbsp;b&nbsp;bstar&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;y.(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;!xx&nbsp;x.(0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;yyy.(indice)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(i)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(indice)&nbsp;&lt;-&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;z.(indice)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;step&nbsp;zz.(indice)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;indice&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dd&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ligne&nbsp;=&nbsp;zz.(indice)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;row&nbsp;=&nbsp;error.(indice)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;numero&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;cc&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ligne.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(numero)&nbsp;&lt;-&nbsp;0.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** Some Butcher tableaus are following. They have been harvested on the internet.
<p>

Suivent quelques tableaux de Butcher. Ils ont été glanés sur internet. 
<p>

<center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;rk2_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;rk2_b_fine&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk2_b_raw&nbsp;=&nbsp;[|&nbsp;1.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rkf_2_3_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.25&nbsp;;&nbsp;0.25&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;rkf_2_3_b_fine&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;6.&nbsp;;&nbsp;2.&nbsp;/.&nbsp;3.&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rkf_2_3_b_raw&nbsp;=&nbsp;[|&nbsp;0.5&nbsp;;&nbsp;0.5&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;bogacki_shampine_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.5&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.75&nbsp;|]&nbsp;;&nbsp;[|&nbsp;2.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;4.&nbsp;/.&nbsp;9.&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;bogacki_shampine_b_raw&nbsp;=&nbsp;[|&nbsp;2.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;4.&nbsp;/.&nbsp;9.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;bogacki_shampine_b_fine&nbsp;=&nbsp;[|&nbsp;7.&nbsp;/.&nbsp;24.&nbsp;;&nbsp;0.25&nbsp;;&nbsp;1.&nbsp;/.&nbsp;3.&nbsp;;&nbsp;0.125&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk4_bogacki_shampine_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;1.0&nbsp;/.&nbsp;6.0&nbsp;|]&nbsp;;&nbsp;[|&nbsp;2.0&nbsp;/.&nbsp;27.0&nbsp;;&nbsp;4.0&nbsp;/.&nbsp;27.0&nbsp;|]&nbsp;;&nbsp;[|&nbsp;183.0&nbsp;/.&nbsp;1372.0&nbsp;;&nbsp;-162.0&nbsp;/.&nbsp;343.0&nbsp;;&nbsp;1053.0&nbsp;/.&nbsp;1372.0&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;68.0&nbsp;/.&nbsp;297.0&nbsp;;&nbsp;-4.0&nbsp;/.&nbsp;11.0&nbsp;;&nbsp;42.0&nbsp;/.&nbsp;143.0&nbsp;;&nbsp;1960.0&nbsp;/.&nbsp;3861.0&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;597.0&nbsp;/.&nbsp;22528.0&nbsp;;&nbsp;81.0&nbsp;/.&nbsp;352.0&nbsp;;&nbsp;63099.0&nbsp;/.&nbsp;585728.0&nbsp;;&nbsp;58653.0&nbsp;/.&nbsp;366080.0&nbsp;;&nbsp;4617.0&nbsp;/.&nbsp;20480.0&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;174197.0&nbsp;/.&nbsp;959244.0&nbsp;;&nbsp;-30942.0&nbsp;/.&nbsp;79937.0&nbsp;;&nbsp;8152137.0&nbsp;/.&nbsp;19744439.0&nbsp;;&nbsp;666106.0&nbsp;/.&nbsp;1039181.0&nbsp;;&nbsp;-29421.0&nbsp;/.&nbsp;29068.0&nbsp;;&nbsp;482048.0&nbsp;/.&nbsp;414219.0&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;587.0&nbsp;/.&nbsp;8064.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;4440339.0&nbsp;/.&nbsp;15491840.0&nbsp;;&nbsp;24353.0&nbsp;/.&nbsp;124800.0&nbsp;;&nbsp;387.0&nbsp;/.&nbsp;44800.0&nbsp;;&nbsp;2152.0&nbsp;/.&nbsp;5985.0&nbsp;;&nbsp;7267.0&nbsp;/.&nbsp;94080.0&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;rk4_bogacki_shampine_b_fine&nbsp;=&nbsp;[|&nbsp;2479.0&nbsp;/.&nbsp;34992.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;123.0&nbsp;/.&nbsp;416.0&nbsp;;&nbsp;612941.0&nbsp;/.&nbsp;3411720.0&nbsp;;&nbsp;43.0&nbsp;/.&nbsp;1440.0&nbsp;;&nbsp;2272.0&nbsp;/.&nbsp;6561.0&nbsp;;&nbsp;79937.0&nbsp;/.&nbsp;1113912.0&nbsp;;&nbsp;3293.0&nbsp;/.&nbsp;556956.0&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;rk4_bogacki_shampine_b_err&nbsp;=&nbsp;[|&nbsp;-3.0&nbsp;/.&nbsp;1280.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;6561.0&nbsp;/.&nbsp;632320.0&nbsp;;&nbsp;-343.0&nbsp;/.&nbsp;20800.0&nbsp;;&nbsp;243.0&nbsp;/.&nbsp;12800.0&nbsp;;&nbsp;-1.0&nbsp;/.&nbsp;95.0&nbsp;;&nbsp;0.0&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk4_bogacki_shampine_b_raw&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;rk4_bogacki_shampine_b_err&nbsp;rk4_bogacki_shampine_b_fine&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;dormand_prince_4_5_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.2&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.075&nbsp;;&nbsp;0.225&nbsp;|]&nbsp;;&nbsp;[|&nbsp;44.&nbsp;/.&nbsp;45.&nbsp;;&nbsp;&nbsp;-56.&nbsp;/.&nbsp;15.&nbsp;;&nbsp;32.&nbsp;/.&nbsp;9.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;19372.&nbsp;/.&nbsp;6561.&nbsp;;&nbsp;-25360.&nbsp;/.&nbsp;2187.&nbsp;;&nbsp;64448.&nbsp;/.&nbsp;6561.&nbsp;;&nbsp;-212.&nbsp;/.&nbsp;729.&nbsp;;&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;9017.&nbsp;/.&nbsp;3168.&nbsp;;&nbsp;-355.&nbsp;/.&nbsp;33.&nbsp;;&nbsp;46732.&nbsp;/.&nbsp;5247.&nbsp;;&nbsp;49.&nbsp;/.&nbsp;176.&nbsp;;&nbsp;-5103.&nbsp;/.&nbsp;18656.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;35.&nbsp;/.&nbsp;384.&nbsp;;&nbsp;0.&nbsp;;&nbsp;500.&nbsp;/.&nbsp;1113.&nbsp;;&nbsp;125.&nbsp;/.&nbsp;192.&nbsp;;&nbsp;-2187.&nbsp;/.&nbsp;6784.&nbsp;;&nbsp;11.&nbsp;/.&nbsp;84.&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;dormand_prince_4_5_b_raw&nbsp;=&nbsp;[|&nbsp;5179.&nbsp;/.&nbsp;57600.&nbsp;;&nbsp;0.&nbsp;;&nbsp;7571.&nbsp;/.&nbsp;16695.&nbsp;;&nbsp;0.6140625&nbsp;;&nbsp;-92097.&nbsp;/.&nbsp;339200.&nbsp;;&nbsp;187.&nbsp;/.&nbsp;2100.&nbsp;;&nbsp;0.025&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;dormand_prince_4_5_b_fine&nbsp;=&nbsp;[|&nbsp;35.&nbsp;/.&nbsp;384.&nbsp;;&nbsp;0.&nbsp;;&nbsp;500.&nbsp;/.&nbsp;1113.&nbsp;;&nbsp;125.&nbsp;/.&nbsp;192.&nbsp;;&nbsp;-2187.&nbsp;/.&nbsp;6784.&nbsp;;&nbsp;11.&nbsp;/.&nbsp;84.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;runge_kutta_fehlberg_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.25&nbsp;|]&nbsp;;&nbsp;[|&nbsp;3.&nbsp;/.&nbsp;32.&nbsp;;&nbsp;9.&nbsp;/.&nbsp;32.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;1932.&nbsp;/.&nbsp;2197.&nbsp;;&nbsp;-7200.&nbsp;/.&nbsp;2197.&nbsp;;&nbsp;&nbsp;7296.&nbsp;/.&nbsp;2197.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;439.&nbsp;/.&nbsp;216.&nbsp;;&nbsp;-8.&nbsp;;&nbsp;3680.&nbsp;/.&nbsp;513.&nbsp;;&nbsp;-845.&nbsp;/.&nbsp;4104.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;-8.&nbsp;/.&nbsp;27.&nbsp;;&nbsp;2.&nbsp;;&nbsp;-3544.&nbsp;/.&nbsp;2565.&nbsp;;&nbsp;-1859.&nbsp;/.&nbsp;4104.&nbsp;;&nbsp;-0.275&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;runge_kutta_fehlberg_b_fine&nbsp;=&nbsp;[|&nbsp;16.&nbsp;/.&nbsp;135.&nbsp;;&nbsp;0.&nbsp;;&nbsp;6656.&nbsp;/.&nbsp;12825.&nbsp;;&nbsp;28561.&nbsp;/.&nbsp;56430.&nbsp;;&nbsp;-0.18&nbsp;;&nbsp;2.&nbsp;/.&nbsp;55.&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;runge_kutta_fehlberg_b_raw&nbsp;=&nbsp;[|&nbsp;25.&nbsp;/.&nbsp;216.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1408.&nbsp;/.&nbsp;2565.&nbsp;;&nbsp;2197.&nbsp;/.&nbsp;4104.&nbsp;;&nbsp;-0.2&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;cash_karp_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.2&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.075&nbsp;;&nbsp;0.225&nbsp;|]&nbsp;;&nbsp;[|&nbsp;0.3&nbsp;;&nbsp;-0.9&nbsp;;&nbsp;1.2&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;-11.&nbsp;/.&nbsp;54.&nbsp;;&nbsp;2.5&nbsp;;&nbsp;-70.&nbsp;/.&nbsp;27.&nbsp;;&nbsp;35.&nbsp;/.&nbsp;27.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;1631.&nbsp;/.&nbsp;55296.&nbsp;;&nbsp;0.341796875&nbsp;;&nbsp;575.&nbsp;/.&nbsp;13824.&nbsp;;&nbsp;44275.&nbsp;/.&nbsp;110592.&nbsp;;&nbsp;0.061767578125&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;cash_karp_b_fine&nbsp;=&nbsp;[|&nbsp;37.&nbsp;/.&nbsp;378.&nbsp;;&nbsp;0.&nbsp;;&nbsp;250.&nbsp;/.&nbsp;621.&nbsp;;&nbsp;125.&nbsp;/.&nbsp;594.&nbsp;;&nbsp;0.&nbsp;;&nbsp;&nbsp;512.&nbsp;/.&nbsp;1771.&nbsp;|]<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;cash_karp_b_raw&nbsp;=&nbsp;[|&nbsp;2825.&nbsp;/.&nbsp;27648.&nbsp;;&nbsp;0.&nbsp;;&nbsp;18575.&nbsp;/.&nbsp;48384.&nbsp;;&nbsp;13525.&nbsp;/.&nbsp;55296.&nbsp;;&nbsp;277.&nbsp;/.&nbsp;14336.&nbsp;;&nbsp;0.25&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;hem_5_3_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.1&nbsp;|]&nbsp;;<br>
[|&nbsp;0.375e-1&nbsp;;&nbsp;0.1125&nbsp;|]&nbsp;;<br>
[|&nbsp;0.3222169236216038&nbsp;;&nbsp;-0.1188883322987607e1&nbsp;;&nbsp;0.1228145134023366e1&nbsp;|]&nbsp;;<br>
[|&nbsp;-0.3501123898129943e-1&nbsp;;&nbsp;0.3725420601086163&nbsp;;&nbsp;-0.2721053535582034&nbsp;;&nbsp;0.1993037578575077e-1&nbsp;|]&nbsp;;<br>
[|&nbsp;-0.5576547055042005&nbsp;;&nbsp;0.1367307289645883e1&nbsp;;&nbsp;-0.1732236360460725e1&nbsp;;&nbsp;0.4587772007467548&nbsp;;&nbsp;0.9638065755722880&nbsp;|]&nbsp;;<br>
[|&nbsp;0.8654517193566155e-1&nbsp;;&nbsp;-0.8810082847945416e-1&nbsp;;&nbsp;0.1981275547329404&nbsp;;&nbsp;<br>
-0.4645422679331083&nbsp;;&nbsp;0.1615170091109488&nbsp;;&nbsp;0.9064533606330119&nbsp;|]&nbsp;;<br>
[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.3624477248753816e1&nbsp;;&nbsp;-0.4617724189181256&nbsp;;&nbsp;-0.3198024628164272e1&nbsp;;&nbsp;0.1035319798328740e1&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;hem_5_3_b_fine&nbsp;=&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.2467760667636791&nbsp;;&nbsp;0.2106594087489728&nbsp;;<br>
0.1769218149125021&nbsp;;&nbsp;0.3064446444147922&nbsp;;&nbsp;0.5919806516005373e-1&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;hem_5_3_b_raw&nbsp;=&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;2.5&nbsp;;&nbsp;-1.5&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk5_4_cash669_first_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.25&nbsp;|]&nbsp;;&nbsp;[|&nbsp;3.&nbsp;/.&nbsp;32.&nbsp;;&nbsp;9.&nbsp;/.&nbsp;32.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;1932.&nbsp;/.&nbsp;2197.&nbsp;;&nbsp;-7200.&nbsp;/.&nbsp;2197.&nbsp;;&nbsp;7296.&nbsp;/.&nbsp;2197.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;439.&nbsp;/.&nbsp;216.&nbsp;;&nbsp;-8.&nbsp;;&nbsp;3680.&nbsp;/.&nbsp;513.&nbsp;;&nbsp;-845.&nbsp;/.&nbsp;4104.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;-8.&nbsp;/.&nbsp;27.&nbsp;;&nbsp;2.&nbsp;;&nbsp;-3544.&nbsp;/.&nbsp;2565.&nbsp;;&nbsp;1859.&nbsp;/.&nbsp;4104.&nbsp;;&nbsp;-0.275&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;rk5_4_cash669_first_b_fine&nbsp;=&nbsp;[|&nbsp;16.&nbsp;/.&nbsp;135.&nbsp;;&nbsp;0.&nbsp;;&nbsp;6656.&nbsp;/.&nbsp;12825.&nbsp;;&nbsp;28561.&nbsp;/.&nbsp;56430.&nbsp;;&nbsp;-0.18&nbsp;;&nbsp;2.&nbsp;/.&nbsp;55.&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;rk5_4_cash669_first_b_halfdiff&nbsp;=&nbsp;[|&nbsp;1.&nbsp;/.&nbsp;360.&nbsp;;&nbsp;0.&nbsp;;&nbsp;-128.&nbsp;/.&nbsp;4275.&nbsp;;&nbsp;-2197.&nbsp;/.&nbsp;75240.&nbsp;;&nbsp;0.02&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk5_4_cash669_first_b_raw&nbsp;=&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1067091077380.&nbsp;/.&nbsp;1829119027671.&nbsp;;&nbsp;3284168845918.&nbsp;/.&nbsp;21339721989495.&nbsp;;<br>
&nbsp;110317750789.&nbsp;/.&nbsp;240996319200.&nbsp;-.&nbsp;4448925830089.&nbsp;/.&nbsp;12329617149531.&nbsp;;&nbsp;0.04&nbsp;;&nbsp;0.2&nbsp;;&nbsp;239992027043.&nbsp;/.&nbsp;361494478800.&nbsp;;&nbsp;1273.&nbsp;/.&nbsp;7800.&nbsp;|]&nbsp;;;<br>
rk5_4_cash669_first_b_raw.(0)&nbsp;&lt;-&nbsp;2.&nbsp;-.&nbsp;<span class="constructor">Matrix</span>.vector_float_sum&nbsp;rk5_4_cash669_first_b_raw&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** Ce qui suit pose prblème. What follows causes trouble. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk6_4_cash669_second_b_fine&nbsp;=&nbsp;[|&nbsp;931.&nbsp;/.&nbsp;6480.&nbsp;;&nbsp;0.&nbsp;;&nbsp;315392.&nbsp;/.&nbsp;1500525.&nbsp;;&nbsp;371293.&nbsp;/.&nbsp;615600.&nbsp;;&nbsp;0.02&nbsp;;&nbsp;0.4&nbsp;;&nbsp;-4.&nbsp;/.&nbsp;15.&nbsp;;&nbsp;85006.&nbsp;/.&nbsp;115425.&nbsp;;&nbsp;239.&nbsp;/.&nbsp;1560.&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;rk6_4_cash669_second_a&nbsp;=&nbsp;[|&nbsp;rk5_4_cash669_first_a.(0)&nbsp;;&nbsp;rk5_4_cash669_first_a.(1)&nbsp;;&nbsp;rk5_4_cash669_first_a.(2)&nbsp;;<br>
&nbsp;rk5_4_cash669_first_a.(3)&nbsp;;&nbsp;rk5_4_cash669_first_a.(4)&nbsp;;&nbsp;<span class="constructor">Array</span>.make&nbsp;6&nbsp;0.&nbsp;;<br>
&nbsp;[|&nbsp;-119397029895.&nbsp;/.&nbsp;151948225000.&nbsp;;&nbsp;78390.&nbsp;/.&nbsp;29081.&nbsp;;&nbsp;-51517464.&nbsp;/.&nbsp;132821875.&nbsp;;&nbsp;-3780749193.&nbsp;/.&nbsp;1168832500.&nbsp;;&nbsp;79268193.&nbsp;/.&nbsp;55925000.&nbsp;;&nbsp;-11370591.&nbsp;/.&nbsp;15379375.&nbsp;;&nbsp;5670.&nbsp;/.&nbsp;2237.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;23406188597.&nbsp;/.&nbsp;8429231250.&nbsp;;&nbsp;-62928.&nbsp;/.&nbsp;13623.&nbsp;;&nbsp;-31066887488.&nbsp;/.&nbsp;5747203125.&nbsp;;&nbsp;164486461399.&nbsp;/.&nbsp;8429231250.&nbsp;;<br>
&nbsp;-70336084.&nbsp;/.&nbsp;11203125.&nbsp;;&nbsp;185680664.&nbsp;/.&nbsp;24646875.&nbsp;;&nbsp;-3385330161.&nbsp;/.&nbsp;243117160.&nbsp;;&nbsp;232648.&nbsp;/.&nbsp;96795.&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;rk6_4_cash669_second_b_halfdiff&nbsp;=&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.224620349650850&nbsp;;&nbsp;-0.038462277720213&nbsp;;&nbsp;0.18&nbsp;;&nbsp;-7.&nbsp;/.&nbsp;30.&nbsp;;&nbsp;0.036286203014893&nbsp;;&nbsp;-0.005&nbsp;|]&nbsp;;;<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;rk6_4_cash669_second_b_raw&nbsp;=&nbsp;rk5_4_cash669_first_b_raw&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;rk7_dormand_prince_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;5.55555555555555555555555555556e-2&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;2.08333333333333333333333333333e-2&nbsp;;&nbsp;6.25e-2&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;3.125e-2&nbsp;;&nbsp;0.0&nbsp;;&nbsp;9.375e-2&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;3.125e-1&nbsp;;&nbsp;0.0&nbsp;;&nbsp;-1.171875&nbsp;;&nbsp;1.171875&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;3.75e-2&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;1.875e-1&nbsp;;&nbsp;1.5e-1&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;4.79101371111111111111111111111e-2&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;1.12248712777777777777777777778e-1&nbsp;;&nbsp;-2.55056737777777777777777777778e-2&nbsp;;<br>
&nbsp;1.28468238888888888888888888889e-2&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;1.6917989787292281181431107136e-2&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;3.87848278486043169526545744159e-1&nbsp;;<br>
&nbsp;3.59773698515003278967008896348e-2&nbsp;;&nbsp;1.96970214215666060156715256072e-1&nbsp;;&nbsp;-1.72713852340501838761392997002e-1&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;6.90957533591923006485645489846e-2&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;-6.34247976728854151882807874972e-1&nbsp;;&nbsp;-1.61197575224604080366876923982e-1&nbsp;;<br>
&nbsp;1.38650309458825255419866950133e-1&nbsp;;&nbsp;9.4092861403575626972423968413e-1&nbsp;;&nbsp;2.11636326481943981855372117132e-1&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;1.83556996839045385489806023537e-1&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;-2.46876808431559245274431575997&nbsp;;&nbsp;-2.91286887816300456388002572804e-1&nbsp;;<br>
&nbsp;-2.6473020233117375688439799466e-2&nbsp;;&nbsp;2.84783876419280044916451825422&nbsp;;&nbsp;2.81387331469849792539403641827e-1&nbsp;;<br>
&nbsp;1.23744899863314657627030212664e-1&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;-1.21542481739588805916051052503&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;1.66726086659457724322804132886e1&nbsp;;&nbsp;9.15741828416817960595718650451e-1&nbsp;;<br>
&nbsp;-6.05660580435747094755450554309&nbsp;;&nbsp;-1.60035735941561781118417064101e1&nbsp;;&nbsp;1.4849303086297662557545391898e1&nbsp;;<br>
&nbsp;-1.33715757352898493182930413962e1&nbsp;;&nbsp;5.13418264817963793317325361166&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;2.58860916438264283815730932232e-1&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;-4.77448578548920511231011750971&nbsp;;&nbsp;-4.3509301377703250944070041181e-1&nbsp;;<br>
&nbsp;-3.04948333207224150956051286631&nbsp;;&nbsp;5.57792003993609911742367663447&nbsp;;&nbsp;6.15583158986104009733868912669&nbsp;;<br>
&nbsp;-5.06210458673693837007740643391&nbsp;;&nbsp;2.19392617318067906127491429047&nbsp;;&nbsp;1.34627998659334941535726237887e-1&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;8.22427599626507477963168204773e-1&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;-1.16586732572776642839765530355e1&nbsp;;&nbsp;-7.57622116690936195881116154088e-1&nbsp;;<br>
&nbsp;7.13973588159581527978269282765e-1&nbsp;;&nbsp;1.20757749868900567395661704486e1&nbsp;;&nbsp;-2.12765911392040265639082085897&nbsp;;<br>
&nbsp;1.99016620704895541832807169835&nbsp;;&nbsp;-2.34286471544040292660294691857e-1&nbsp;;&nbsp;1.7589857770794226507310510589e-1&nbsp;;&nbsp;0.0&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;rk7_dormand_prince_b_raw&nbsp;=&nbsp;[|&nbsp;4.17474911415302462220859284685e-2&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;-5.54523286112393089615218946547e-2<br>
&nbsp;;&nbsp;2.39312807201180097046747354249e-1&nbsp;;&nbsp;7.0351066940344302305804641089e-1&nbsp;;&nbsp;-7.59759613814460929884487677085e-1&nbsp;;<br>
&nbsp;6.60563030922286341461378594838e-1&nbsp;;&nbsp;1.58187482510123335529614838601e-1&nbsp;;&nbsp;-2.38109538752862804471863555306e-1&nbsp;;&nbsp;2.5e-1&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;rk7_dormand_prince_b_fine&nbsp;=&nbsp;[|&nbsp;2.9553213676353496981964883112e-2&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;0.0&nbsp;;&nbsp;-8.28606276487797039766805612689e-1&nbsp;;<br>
&nbsp;3.11240900051118327929913751627e-1&nbsp;;&nbsp;2.46734519059988698196468570407&nbsp;;&nbsp;-2.54694165184190873912738007542&nbsp;;<br>
&nbsp;1.44354858367677524030187495069&nbsp;;&nbsp;7.94155958811272872713019541622e-2&nbsp;;&nbsp;4.44444444444444444444444444445e-2&nbsp;;&nbsp;0.0&nbsp;|]&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;dormand_prince_8_5_3_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;5.26001519587677318785587544488e-2&nbsp;|]&nbsp;;&nbsp;<br>
&nbsp;[|&nbsp;1.97250569845378994544595329183e-2&nbsp;;&nbsp;5.91751709536136983633785987549e-2&nbsp;|]&nbsp;;&nbsp;<br>
&nbsp;[|&nbsp;2.95875854768068491816892993775e-2&nbsp;;&nbsp;0.&nbsp;;&nbsp;8.87627564304205475450678981324e-2&nbsp;|]&nbsp;;&nbsp;<br>
&nbsp;[|&nbsp;2.41365134159266685502369798665e-1&nbsp;;&nbsp;0.&nbsp;;&nbsp;-8.84549479328286085344864962717e-1&nbsp;;&nbsp;9.24834003261792003115737966543e-1&nbsp;|]&nbsp;;&nbsp;<br>
&nbsp;[|&nbsp;3.7037037037037037037037037037e-2&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1.70828608729473871279604482173e-1&nbsp;;&nbsp;1.25467687566822425016691814123e-1&nbsp;|]&nbsp;;&nbsp;<br>
&nbsp;[|&nbsp;3.7109375e-2&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1.70252211019544039314978060272e-1&nbsp;;&nbsp;6.02165389804559606850219397283e-2&nbsp;;&nbsp;-1.7578125e-2&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;3.70920001185047927108779319836e-2&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1.70383925712239993810214054705e-1&nbsp;;&nbsp;1.07262030446373284651809199168e-1&nbsp;;&nbsp;<br>
&nbsp;-1.53194377486244017527936158236e-2&nbsp;;&nbsp;8.27378916381402288758473766002e-3&nbsp;|]&nbsp;;&nbsp;<br>
&nbsp;[|&nbsp;6.24110958716075717114429577812e-1&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;-3.36089262944694129406857109825&nbsp;;&nbsp;-8.68219346841726006818189891453e-1&nbsp;;&nbsp;<br>
&nbsp;2.75920996994467083049415600797e1&nbsp;;&nbsp;2.01540675504778934086186788979e1&nbsp;;&nbsp;-4.34898841810699588477366255144e1&nbsp;|]&nbsp;;&nbsp;<br>
&nbsp;[|&nbsp;4.77662536438264365890433908527e-1&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;-2.48811461997166764192642586468&nbsp;;<br>
&nbsp;-5.90290826836842996371446475743e-1&nbsp;;&nbsp;2.12300514481811942347288949897e1&nbsp;;&nbsp;1.52792336328824235832596922938e1&nbsp;;<br>
&nbsp;-3.32882109689848629194453265587e1&nbsp;;&nbsp;-2.03312017085086261358222928593e-2&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;-9.3714243008598732571704021658e-1&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;5.18637242884406370830023853209&nbsp;;&nbsp;1.09143734899672957818500254654&nbsp;;&nbsp;<br>
&nbsp;-8.14978701074692612513997267357&nbsp;;&nbsp;-1.85200656599969598641566180701e1&nbsp;;&nbsp;2.27394870993505042818970056734e1&nbsp;;&nbsp;<br>
&nbsp;2.49360555267965238987089396762&nbsp;;&nbsp;-3.0467644718982195003823669022&nbsp;|]&nbsp;;&nbsp;<br>
&nbsp;[|&nbsp;2.27331014751653820792359768449&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;-1.05344954667372501984066689879e1&nbsp;;&nbsp;-2.00087205822486249909675718444&nbsp;;&nbsp;<br>
&nbsp;-1.79589318631187989172765950534e1&nbsp;;&nbsp;2.79488845294199600508499808837e1&nbsp;;&nbsp;-2.85899827713502369474065508674&nbsp;;&nbsp;<br>
&nbsp;-8.87285693353062954433549289258&nbsp;;&nbsp;1.23605671757943030647266201528e1&nbsp;;&nbsp;6.43392746015763530355970484046e-1&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;5.61675022830479523392909219681e-2&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;2.53500210216624811088794765333e-1&nbsp;;&nbsp;<br>
&nbsp;-2.46239037470802489917441475441e-1&nbsp;;&nbsp;-1.24191423263816360469010140626e-1&nbsp;;&nbsp;1.5329179827876569731206322685e-1&nbsp;;&nbsp;<br>
&nbsp;8.20105229563468988491666602057e-3&nbsp;;&nbsp;7.56789766054569976138603589584e-3&nbsp;;&nbsp;-8.298e-3&nbsp;|]&nbsp;;<br>
&nbsp;[|&nbsp;3.18346481635021405060768473261e-2&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;2.83009096723667755288322961402e-2&nbsp;;&nbsp;<br>
&nbsp;5.35419883074385676223797384372e-2&nbsp;;&nbsp;-5.49237485713909884646569340306e-2&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;-1.08347328697249322858509316994e-4&nbsp;;<br>
&nbsp;3.82571090835658412954920192323e-4&nbsp;;&nbsp;-3.40465008687404560802977114492e-4&nbsp;;&nbsp;1.41312443674632500278074618366e-1&nbsp;|]&nbsp;;&nbsp;<br>
&nbsp;[|&nbsp;-4.28896301583791923408573538692e-1&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;-4.69762141536116384314449447206&nbsp;;&nbsp;<br>
&nbsp;7.68342119606259904184240953878&nbsp;;&nbsp;4.06898981839711007970213554331&nbsp;;&nbsp;3.56727187455281109270669543021e-1&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;<br>
&nbsp;0.&nbsp;;&nbsp;-1.39902416515901462129418009734e-3&nbsp;;&nbsp;2.9475147891527723389556272149&nbsp;;&nbsp;-9.15095847217987001081870187138&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;dormand_prince_8_5_3_b_fine&nbsp;=&nbsp;[|&nbsp;5.42937341165687622380535766363e-2&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;4.45031289275240888144113950566&nbsp;;&nbsp;<br>
&nbsp;1.89151789931450038304281599044&nbsp;;&nbsp;-5.8012039600105847814672114227&nbsp;;&nbsp;3.1116436695781989440891606237e-1&nbsp;;&nbsp;<br>
&nbsp;-1.52160949662516078556178806805e-1&nbsp;;&nbsp;2.01365400804030348374776537501e-1&nbsp;;&nbsp;4.47106157277725905176885569043e-2&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;dormand_prince_8_5_3_b_err&nbsp;=&nbsp;[|&nbsp;0.1312004499419488073250102996e-1&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;-0.1225156446376204440720569753e1&nbsp;;&nbsp;<br>
-0.4957589496572501915214079952&nbsp;;&nbsp;0.1664377182454986536961530415e1&nbsp;;&nbsp;-0.3503288487499736816886487290&nbsp;;&nbsp;<br>
0.3341791187130174790297318841&nbsp;;&nbsp;0.8192320648511571246570742613e-1&nbsp;;&nbsp;-0.2235530786388629525884427845e-1&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;dormand_prince_8_5_3_b_raw&nbsp;=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;dormand_prince_8_5_3_b_err&nbsp;dormand_prince_8_5_3_b_fine&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="2_Mthodesadaptativesquelconques"><h2>Méthodes adaptatives quelconques</h2></span>
<span id="2_Unspecializedadaptativemethods"><h2>Unspecialized adaptative methods</h2></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The following adaptative methods fit to any Runge-Kutta method, wether it is implicit or explicit.
<p>

Les méthodes adaptatives qui suivent sont adaptées à n'importe quelle méthode de Runge-Kutta, qu'elle soit implicite ou explicite. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_adapt methode tolerance function nsteps value beginning ending</pre> The <code class="code">methode</code> must
give the final value of a solution.
<p>

La méthode <code class="code">methode</code> doit donner la valeur finale d'une solution. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_end_ode_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;methode&nbsp;f&nbsp;1&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!zz&nbsp;-.&nbsp;!z&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;abs_float&nbsp;!zz&nbsp;<span class="keyword">then</span>&nbsp;yy&nbsp;:=&nbsp;!zz<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;yy&nbsp;:=&nbsp;float_end_ode_adapt&nbsp;methode&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_adapt methode tolerance function nsteps value beginning ending</pre> The <code class="code">methode</code> must
give the final value of a solution.
<p>

La méthode <code class="code">methode</code> doit donner la valeur finale d'une solution. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;vector_end_ode_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;methode&nbsp;f&nbsp;1&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;!zz&nbsp;!z&nbsp;)&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;!zz&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;yy&nbsp;:=&nbsp;!zz<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;yy&nbsp;:=&nbsp;vector_end_ode_adapt&nbsp;methode&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_adapt methode tolerance function nsteps value beginning ending</pre> The <code class="code">methode</code> must
give the final value of a solution.
<p>

La méthode <code class="code">methode</code> doit donner la valeur finale d'une solution. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;matrix_end_ode_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;methode&nbsp;f&nbsp;1&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;!zz&nbsp;!z&nbsp;)&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;!zz&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;yy&nbsp;:=&nbsp;!zz<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;yy&nbsp;:=&nbsp;matrix_end_ode_adapt&nbsp;methode&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_end_ode_bounded maxstages methode tolerance function nsteps value beginning ending</pre> The <code class="code">methode</code> must only give the final value
of the solution of the ordinary differential equation.
<p>

La méthode <code class="code">methode</code> doit donner seulement la valeur finale de la solution de l'équation différentielle ordinaire. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_end_ode_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;methode&nbsp;f&nbsp;1&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!zz&nbsp;-.&nbsp;!z&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;abs_float&nbsp;!zz&nbsp;<span class="keyword">then</span>&nbsp;yy&nbsp;:=&nbsp;!zz<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;yy&nbsp;:=&nbsp;float_end_ode_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;methode&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_end_ode_bounded maxstages methode tolerance function nsteps value beginning ending</pre> The <code class="code">methode</code> must only give the final value
of the solution of the ordinary differential equation.
<p>

La méthode <code class="code">methode</code> doit donner seulement la valeur finale de la solution de l'équation différentielle ordinaire. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;vector_end_ode_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;methode&nbsp;f&nbsp;1&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;!zz&nbsp;!z&nbsp;)&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;!zz&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;yy&nbsp;:=&nbsp;!zz<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;yy&nbsp;:=&nbsp;vector_end_ode_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;methode&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_end_ode_bounded maxstages methode tolerance function nsteps value beginning ending</pre> The <code class="code">methode</code> must only give the final value
of the solution of the ordinary differential equation.
<p>

La méthode <code class="code">methode</code> doit donner seulement la valeur finale de la solution de l'équation différentielle ordinaire. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;matrix_end_ode_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;methode&nbsp;f&nbsp;1&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;!zz&nbsp;!z&nbsp;)&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;!zz&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;yy&nbsp;:=&nbsp;!zz<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;yy&nbsp;:=&nbsp;matrix_end_ode_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;methode&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;!y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_adapt methode tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_ode_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;(&nbsp;methode&nbsp;f&nbsp;1&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;(&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(nsteps)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!zz&nbsp;-.&nbsp;!z&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;abs_float&nbsp;!zz&nbsp;<span class="keyword">then</span>&nbsp;yy&nbsp;:=&nbsp;!zz<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;yy&nbsp;:=&nbsp;(&nbsp;float_ode_adapt&nbsp;methode&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(nsteps)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_adapt methode tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;vector_ode_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dim&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(i)&nbsp;&lt;-&nbsp;y0.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;(&nbsp;methode&nbsp;f&nbsp;1&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;(&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(nsteps)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;!zz&nbsp;!z&nbsp;)&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;!zz&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;yy&nbsp;:=&nbsp;!zz<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;yy&nbsp;:=&nbsp;(&nbsp;vector_ode_adapt&nbsp;methode&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(nsteps)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_adapt methode tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;matrix_ode_adapt&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;<span class="keyword">and</span>&nbsp;dim_c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dim_r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(i)&nbsp;&lt;-&nbsp;y0.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;(&nbsp;methode&nbsp;f&nbsp;1&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;(&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(nsteps)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;!zz&nbsp;!z&nbsp;)&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;!zz&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;yy&nbsp;:=&nbsp;!zz<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;yy&nbsp;:=&nbsp;(&nbsp;matrix_ode_adapt&nbsp;methode&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(nsteps)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_bounded methode tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;float_ode_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;y0&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;(&nbsp;methode&nbsp;f&nbsp;1&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;(&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(nsteps)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;(&nbsp;!zz&nbsp;-.&nbsp;!z&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;abs_float&nbsp;!zz&nbsp;<span class="keyword">then</span>&nbsp;yy&nbsp;:=&nbsp;!zz<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;yy&nbsp;:=&nbsp;(&nbsp;float_ode_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;methode&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(nsteps)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_bounded methode tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;vector_ode_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dim&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_copy&nbsp;y0&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;dim&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dim&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(i)&nbsp;&lt;-&nbsp;y0.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;(&nbsp;methode&nbsp;f&nbsp;1&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;(&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(nsteps)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_minus&nbsp;!zz&nbsp;!z&nbsp;)&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_inf&nbsp;!zz&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;yy&nbsp;:=&nbsp;!zz<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;yy&nbsp;:=&nbsp;(&nbsp;vector_ode_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;methode&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(nsteps)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_ode_bounded methode tolerance function nsteps value beginning ending</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;matrix_ode_bounded&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(maxstages:int)&nbsp;methode&nbsp;(tol:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">match</span>&nbsp;maxstages&nbsp;<span class="keyword">with</span>&nbsp;<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;0&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending<br>
&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;step&nbsp;=&nbsp;(&nbsp;ending&nbsp;-.&nbsp;beginning&nbsp;)&nbsp;/.&nbsp;(&nbsp;float&nbsp;nsteps&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dim_r&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;dim_c&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;y0.(0)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;x&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;xx&nbsp;=&nbsp;ref&nbsp;beginning<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;yy&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;zz&nbsp;=&nbsp;ref&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_copy&nbsp;y0&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;y&nbsp;=&nbsp;<span class="constructor">Array</span>.map&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;dim_r&nbsp;dim_c&nbsp;)&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;nsteps&nbsp;+&nbsp;1&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;row&nbsp;=&nbsp;y.(0)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;dim_r&nbsp;-&nbsp;1&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row.(i)&nbsp;&lt;-&nbsp;y0.(i)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;nsteps&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;xx&nbsp;:=&nbsp;!x&nbsp;+.&nbsp;step&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;(&nbsp;methode&nbsp;f&nbsp;1&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(1)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;zz&nbsp;:=&nbsp;(&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(nsteps)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;!zz&nbsp;!z&nbsp;)&nbsp;)&nbsp;&lt;&nbsp;tol&nbsp;*.&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;!zz&nbsp;)&nbsp;<span class="keyword">then</span>&nbsp;yy&nbsp;:=&nbsp;!zz<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;yy&nbsp;:=&nbsp;(&nbsp;matrix_ode_bounded&nbsp;(&nbsp;(&nbsp;abs&nbsp;maxstages&nbsp;)&nbsp;-&nbsp;1&nbsp;)&nbsp;methode&nbsp;tol&nbsp;f&nbsp;nsteps&nbsp;!yy&nbsp;!x&nbsp;!xx&nbsp;).(nsteps)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;!xx&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;y.(i)&nbsp;&lt;-&nbsp;!yy&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;y&nbsp;;;<br>
<br>
<br>
<span class="keyword">let</span>&nbsp;phem_5_6_a&nbsp;=&nbsp;[|&nbsp;[|&nbsp;0.&nbsp;|]&nbsp;;&nbsp;[|&nbsp;3.&nbsp;/.&nbsp;40.&nbsp;;&nbsp;9.&nbsp;/.&nbsp;40.&nbsp;|]&nbsp;;<br>
[|&nbsp;21.&nbsp;/.&nbsp;256.&nbsp;;&nbsp;45.&nbsp;/.&nbsp;256.&nbsp;;&nbsp;15.&nbsp;/.&nbsp;128.&nbsp;|]&nbsp;;<br>
[|&nbsp;19235.&nbsp;/.&nbsp;98784.&nbsp;;&nbsp;-225.&nbsp;/.&nbsp;392.&nbsp;;&nbsp;6235.&nbsp;/.&nbsp;6174.&nbsp;;&nbsp;2755.&nbsp;/.&nbsp;32928.&nbsp;|]&nbsp;;<br>
[|&nbsp;-293.&nbsp;/.&nbsp;1152.&nbsp;;&nbsp;85.&nbsp;/.&nbsp;48.&nbsp;;&nbsp;-2275.&nbsp;/.&nbsp;1908.&nbsp;;&nbsp;35.&nbsp;/.&nbsp;32.&nbsp;;&nbsp;-2835.&nbsp;/.&nbsp;6784.&nbsp;|]&nbsp;;<br>
(&nbsp;<span class="constructor">Array</span>.sub&nbsp;dormand_prince_4_5_b_fine&nbsp;0&nbsp;6&nbsp;)&nbsp;;<br>
[|&nbsp;10752038939.&nbsp;/.&nbsp;66307507200.&nbsp;;&nbsp;-19259.&nbsp;/.&nbsp;50160.&nbsp;;&nbsp;19581770468.&nbsp;/.&nbsp;24023520675.&nbsp;;<br>
&nbsp;9941999.&nbsp;/.&nbsp;650073600.&nbsp;;&nbsp;180060831.&nbsp;/.&nbsp;4820710400.&nbsp;;&nbsp;-11331659.&nbsp;/.&nbsp;439538400.&nbsp;;&nbsp;1.&nbsp;/.&nbsp;76.&nbsp;|]&nbsp;|]&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;phem_5_6_b_raw&nbsp;=&nbsp;dormand_prince_4_5_b_raw&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;phem_5_6_b_fine&nbsp;=&nbsp;[|&nbsp;1812923.&nbsp;/.&nbsp;20736000.&nbsp;;&nbsp;0.&nbsp;;&nbsp;45847.&nbsp;/.&nbsp;100170.&nbsp;;&nbsp;56677.&nbsp;/.&nbsp;414720.&nbsp;;<br>
-289161.&nbsp;/.&nbsp;13568000.&nbsp;;&nbsp;-67507.&nbsp;/.&nbsp;4536000.&nbsp;;&nbsp;-3971.&nbsp;/.&nbsp;324000.&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_quationsdiffrentiellesordinairesimplicitesfxyy0"><h1>Équations différentielles ordinaires implicites f(x,y,y') = 0.</h1></span>
<span id="1_Implicitordinarydifferentialequationsfxyy0"><h1>Implicit ordinary differential equations f(x,y,y') = 0.</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** The resolutions presented here work if it is possible to extract an implicit function in order to give y'.
<p>

Les présentes résolutions fonctionnent s'il est possible d'extraire une fonction implicite pour donner y'. *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_ode_implicit methode_ode methode_zero function guess nsteps value beginning ending</pre> The ordinary 
differential equations solving method <code class="code">methode_ode</code> must apply to explicit equations y' = f(x,y) as in the following example.
The hint <code class="code">guess</code> permits to proceed to an initial seek for y'(beginning).
Beware ! this method is polymorphic and gives at end either a vector or a real, mimicing the behaviour of <code class="code">methode_ode</code>.
<p>

<pre>float_ode_adapt ( float_ode_runge_kutta_adapt cash_karp_a cash_karp_b_fine cash_karp_b_raw 1e-1 ) 1e-2</pre>
<p>

La méthode <code class="code">methode_ode</code> de résolution d'équations différentielles ordinaires doit s'appliquer 
aux équations explicites y' = f(x,y) comme dans l'exemple ci-dessus. 
L'indice <code class="code">guess</code> permet de faire une recherche initiale pour y'(beginning).
Attention ! cette méthode est polymorphe et donne à la fin soit un vecteur soit un réel
calquant le ccomportement de <code class="code">methode_ode</code>. *)</span></td></tr></table><code class="code"><br>
&nbsp;<span class="keyword">let</span>&nbsp;float_ode_implicit&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_ode&nbsp;methode_zero&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(guess:float)&nbsp;(nsteps:int)&nbsp;(y0:float)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z0&nbsp;=&nbsp;float_local_inverse&nbsp;methode_zero&nbsp;guess&nbsp;(&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float_local_inverse&nbsp;methode_zero&nbsp;z0&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;x&nbsp;y&nbsp;z&nbsp;)&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;methode_ode&nbsp;g&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_ode_implicit methode_ode methode_zero function guess nsteps value beginning ending</pre> The ordinary 
differential equations solving method <code class="code">methode_ode</code> must apply to explicit equations y' = f(x,y) as in the following example.
The hint <code class="code">guess</code> permits to proceed to an initial seek for y'(beginning).
Beware ! this method is polymorphic and gives at end either a vector or a real, mimicing the behaviour of <code class="code">methode_ode</code>.
<p>

<pre>vector_ode_adapt ( vector_ode_runge_kutta_adapt cash_karp_a cash_karp_b_fine cash_karp_b_raw 1e-1 ) 1e-2</pre>
<p>

La méthode <code class="code">methode_ode</code> de résolution d'équations différentielles ordinaires doit s'appliquer 
aux équations explicites y' = f(x,y) comme dans l'exemple ci-dessus. 
L'indice <code class="code">guess</code> permet de faire une recherche initiale pour y'(beginning).
Attention ! cette méthode est polymorphe et donne à la fin soit un vecteur soit un réel
calquant le ccomportement de <code class="code">methode_ode</code>. *)</span></td></tr></table><code class="code"><br>
&nbsp;<span class="keyword">let</span>&nbsp;vector_ode_implicit&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_ode&nbsp;methode_zero&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(guess:float&nbsp;array)&nbsp;(nsteps:int)&nbsp;(y0:float&nbsp;array)&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;nullvector&nbsp;=&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;(&nbsp;<span class="constructor">Array</span>.length&nbsp;y0&nbsp;)&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z0&nbsp;=&nbsp;vector_local_inverse&nbsp;methode_zero&nbsp;guess&nbsp;(&nbsp;f&nbsp;beginning&nbsp;y0&nbsp;)&nbsp;nullvector&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;vector_local_inverse&nbsp;methode_zero&nbsp;z0&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;x&nbsp;y&nbsp;z&nbsp;)&nbsp;nullvector&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;methode_ode&nbsp;g&nbsp;nsteps&nbsp;y0&nbsp;beginning&nbsp;ending&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Distributions"><h1>Distributions</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>gen_dirac_mass</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;gen_dirac_mass&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;a&nbsp;f&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;a&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_dirac_mass function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_dirac_mass&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;f&nbsp;0.&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_gen_dirac_mass position function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_gen_dirac_mass&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;f&nbsp;a&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_dirac_comb size function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_dirac_comb&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(size:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;abs&nbsp;size&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;!accu&nbsp;+.&nbsp;f&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;+.&nbsp;f&nbsp;(&nbsp;float&nbsp;(&nbsp;-&nbsp;i&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_vector_dirac_comb size function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_vector_dirac_comb&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(size:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;abs&nbsp;size&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;!accu&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;(&nbsp;f&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;)&nbsp;(&nbsp;f&nbsp;(&nbsp;float&nbsp;(&nbsp;-&nbsp;i&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_matrix_dirac_comb size function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_matrix_dirac_comb&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(size:int)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;accu&nbsp;=&nbsp;ref&nbsp;(&nbsp;f&nbsp;0.&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;abs&nbsp;size&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;accu&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;!accu&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;(&nbsp;f&nbsp;(&nbsp;float&nbsp;i&nbsp;)&nbsp;)&nbsp;(&nbsp;f&nbsp;(&nbsp;float&nbsp;(&nbsp;-&nbsp;i&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;!accu&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_dirac_mass dimension function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_dirac_mass&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;n&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;f&nbsp;(&nbsp;<span class="constructor">Array</span>.make&nbsp;n&nbsp;0.&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_gen_dirac_mass position function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_gen_dirac_mass&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;f&nbsp;a&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_dirac_mass n_rows n_columns function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_dirac_mass&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;r&nbsp;c&nbsp;(f:float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;f&nbsp;(&nbsp;<span class="constructor">Array</span>.make_matrix&nbsp;r&nbsp;c&nbsp;0.&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_gen_dirac_mass position function</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_gen_dirac_mass&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;f&nbsp;a&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_dirac_family_bell parameter real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_dirac_family_bell&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;inv_sqrt_doublepi&nbsp;*.&nbsp;(&nbsp;gauss_bell&nbsp;(&nbsp;x&nbsp;*.&nbsp;n&nbsp;)&nbsp;)&nbsp;*.&nbsp;n&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_dirac_family_rectangle parameter real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_dirac_family_rectangle&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">if</span>&nbsp;abs_float&nbsp;x&nbsp;&lt;=&nbsp;1.&nbsp;/.&nbsp;n&nbsp;<span class="keyword">then</span>&nbsp;0.5&nbsp;*.&nbsp;n<br>
&nbsp;<span class="keyword">else</span>&nbsp;0.&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_dirac_family_triangle parameter real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_dirac_family_triangle&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(n:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;xx&nbsp;=&nbsp;abs_float&nbsp;x&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;1.&nbsp;/.&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;xx&nbsp;&lt;=&nbsp;nn&nbsp;<span class="keyword">then</span>&nbsp;n&nbsp;*.&nbsp;n&nbsp;*.&nbsp;(&nbsp;nn&nbsp;-.&nbsp;xx&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;0.&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_distrib_deriv</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_distrib_deriv&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;distribution&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">function</span>&nbsp;(f:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;-.&nbsp;(&nbsp;distribution&nbsp;(&nbsp;methode&nbsp;f&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_distrib_deriv</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_distrib_deriv&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;distribution&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">function</span>&nbsp;(f:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_opp&nbsp;(&nbsp;distribution&nbsp;(&nbsp;methode&nbsp;f&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_distrib_deriv</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_distrib_deriv&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;distribution&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">function</span>&nbsp;(f:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.matrix_float_opp&nbsp;(&nbsp;distribution&nbsp;(&nbsp;methode&nbsp;f&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_variable_translation value function real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_variable_translation&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float)&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;f&nbsp;(&nbsp;x&nbsp;+.&nbsp;a&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>vector_float_variable_translation value function real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;vector_float_variable_translation&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a)&nbsp;(x:float&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;f&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;x&nbsp;a&nbsp;)&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>matrix_float_variable_translation value function real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;matrix_float_variable_translation&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(a:float&nbsp;array&nbsp;array)&nbsp;(f:float&nbsp;array&nbsp;array&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>a)&nbsp;(x:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;f&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;x&nbsp;a&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>float_distrib_transform</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;float_distrib_transform&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;transform&nbsp;distribution&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;(&nbsp;<span class="keyword">function</span>&nbsp;(f:<span class="keywordsign">'</span>a&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">'</span>b)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;distribution&nbsp;(&nbsp;transform&nbsp;f&nbsp;)&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ </center> *)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** 
<span id="1_Constructionssupplmentaires"><h1>Constructions supplémentaires</h1></span>
<span id="1_Furtherconstructions"><h1>Further constructions</h1></span>
*)</span></td></tr></table><code class="code"><br>
</code><table><tr><td></td><td><span class="comment">(** <center> </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>normal_cumul_distribution real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;normal_cumul_distribution&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;(&nbsp;sqrt&nbsp;inv_doublepi&nbsp;)&nbsp;*.&nbsp;float_int_multi_adapt&nbsp;float_simple_step_gauss_kronrod&nbsp;100&nbsp;1e-3&nbsp;gauss_bell&nbsp;(-38.7)&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>normal_cumul_distribution_complem real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;normal_cumul_distribution_complem&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;(&nbsp;sqrt&nbsp;inv_doublepi&nbsp;)&nbsp;*.&nbsp;float_int_multi_adapt&nbsp;float_simple_step_gauss_kronrod&nbsp;100&nbsp;1e-3&nbsp;gauss_bell&nbsp;x&nbsp;38.7&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>erf real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;erf&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;gauss_bell&nbsp;(&nbsp;y&nbsp;*.&nbsp;sqrt_of_2)&nbsp;<span class="keyword">in</span><br>
&nbsp;2.&nbsp;*.&nbsp;inv_sqrt_pi&nbsp;*.&nbsp;float_int_multi_adapt&nbsp;float_simple_step_gauss_kronrod&nbsp;100&nbsp;1e-3&nbsp;f&nbsp;0.&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>erf_complem real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;erf_complem&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;gauss_bell&nbsp;(&nbsp;y&nbsp;*.&nbsp;sqrt_of_2)&nbsp;<span class="keyword">in</span><br>
&nbsp;2.&nbsp;*.&nbsp;inv_sqrt_pi&nbsp;*.&nbsp;float_int_multi_adapt&nbsp;float_simple_step_gauss_kronrod&nbsp;100&nbsp;1e-3&nbsp;f&nbsp;x&nbsp;38.7&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>normal_quantile real</pre> This function must be equal to <code class="code">probit</code>.
<p>

Cette fonction doit être égale à <code class="code">probit</code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;normal_quantile&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;x&nbsp;-.&nbsp;normal_cumul_distribution&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;float_zero_general&nbsp;(&nbsp;float_richardson_binary_deriv&nbsp;2&nbsp;1e-3&nbsp;)&nbsp;2&nbsp;5&nbsp;g&nbsp;0.5&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>probit real</pre> This function must be equal to <code class="code">normal_quantile</code>.
<p>

Cette fonction doit être égale à <code class="code">normal_quantile</code>. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;probit&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;2.&nbsp;*.&nbsp;x&nbsp;-.&nbsp;erf_complem&nbsp;(&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;(-.&nbsp;sqrt_of_2&nbsp;)&nbsp;*.&nbsp;(&nbsp;float_zero_general&nbsp;(&nbsp;float_richardson_binary_deriv&nbsp;2&nbsp;1e-3&nbsp;)&nbsp;2&nbsp;5&nbsp;g&nbsp;0.5&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>sin_int real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;sin_int&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;float_int_multi_adapt&nbsp;float_simple_step_gauss_kronrod&nbsp;100&nbsp;1e-3&nbsp;sinc&nbsp;0.&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>si real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;si&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;float_int_multi_adapt&nbsp;float_simple_step_gauss_kronrod&nbsp;100&nbsp;1e-3&nbsp;sinc&nbsp;1000.&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>shi real</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;shi&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;y&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;0.&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(&nbsp;sinh&nbsp;y&nbsp;)&nbsp;/.&nbsp;y<br>
&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;float_int_multi_adapt&nbsp;float_simple_step_gauss_kronrod&nbsp;100&nbsp;1e-3&nbsp;f&nbsp;0.&nbsp;x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>elliptic_integral_first_kind k x</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;elliptic_integral_first_kind&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(k:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;k&nbsp;*.&nbsp;(&nbsp;sin&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;1.&nbsp;/.&nbsp;(&nbsp;sqrt&nbsp;(&nbsp;1.&nbsp;-.&nbsp;z&nbsp;*.&nbsp;z&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;float_int_multi_adapt&nbsp;float_simple_step_gauss_kronrod&nbsp;100&nbsp;1e-3&nbsp;f&nbsp;0.&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>elliptic_integral_second_kind k x</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;elliptic_integral_second_kind&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(k:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;k&nbsp;*.&nbsp;(&nbsp;sin&nbsp;y&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;sqrt&nbsp;(&nbsp;1.&nbsp;-.&nbsp;z&nbsp;*.&nbsp;z&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;float_int_multi_adapt&nbsp;float_simple_step_gauss_kronrod&nbsp;100&nbsp;1e-3&nbsp;f&nbsp;0.&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>elliptic_integral_secondBis_kind k x</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;elliptic_integral_secondBis_kind&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(k:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;sin&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;k&nbsp;*.&nbsp;w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;w&nbsp;*.&nbsp;w&nbsp;)&nbsp;&nbsp;/.&nbsp;(&nbsp;sqrt&nbsp;(&nbsp;1.&nbsp;-.&nbsp;z&nbsp;*.&nbsp;z&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float_int_multi_adapt&nbsp;float_simple_step_gauss_kronrod&nbsp;100&nbsp;1e-3&nbsp;f&nbsp;0.&nbsp;x&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>elliptic_integral_third_kind k c x</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;elliptic_integral_third_kind&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(k:float)&nbsp;(c:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;sin&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;k&nbsp;*.&nbsp;w&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;/.&nbsp;(&nbsp;(&nbsp;w&nbsp;-.&nbsp;c&nbsp;)&nbsp;*.&nbsp;(&nbsp;sqrt&nbsp;(&nbsp;1.&nbsp;-.&nbsp;z&nbsp;*.&nbsp;z&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float_int_multi_adapt&nbsp;float_simple_step_gauss_kronrod&nbsp;100&nbsp;1e-3&nbsp;f&nbsp;0.&nbsp;x&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>elliptic_integral methode coefficients_up coefficients_down root_coefficients x</pre> The integration method <code class="code">methode</code>
must contain all the parameters.
<p>

La méthode d'intégration <code class="code">methode</code> doit contenir tous les paramètres. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;elliptic_integral&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(num:float&nbsp;array&nbsp;array)&nbsp;(denom:float&nbsp;array&nbsp;array)&nbsp;(c:float&nbsp;array)&nbsp;(a:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;z&nbsp;=&nbsp;float_polynomial_1&nbsp;c&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;float_rational_2&nbsp;num&nbsp;denom&nbsp;y&nbsp;z&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;methode&nbsp;f&nbsp;a&nbsp;x&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>expm_ode methode nsteps matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;expm_ode&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(nsteps:int)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;m&nbsp;y&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;(&nbsp;<span class="constructor">Matrix</span>.eye_float&nbsp;m&nbsp;)&nbsp;0.&nbsp;1.&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>expm_ode_bis methode nsteps matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;expm_ode_bis&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(nsteps:int)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;y&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.matrix_float_plus&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;m&nbsp;y&nbsp;)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;y&nbsp;m&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;(&nbsp;<span class="constructor">Matrix</span>.eye_float&nbsp;m&nbsp;)&nbsp;0.&nbsp;0.5&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>slow_tune_expm threshold matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;slow_tune_expm&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_trace&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;z&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;zz&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;m&nbsp;(&nbsp;<span class="constructor">Matrix</span>.scal_float&nbsp;n&nbsp;n&nbsp;zz&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;m&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;!mm<br>
</code><table><tr><td></td><td><span class="comment">(** The bias is tuned by experimenatl adjustment.
<p>

Le biais est ajusté empiriquement. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;biais&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;6.&nbsp;-.&nbsp;(&nbsp;floor&nbsp;(&nbsp;log_bin&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iteration&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;(&nbsp;ceil&nbsp;(&nbsp;log_bin&nbsp;zzz&nbsp;)&nbsp;)&nbsp;-.&nbsp;biais&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&gt;=&nbsp;1.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;2.&nbsp;**&nbsp;(&nbsp;-.&nbsp;iteration&nbsp;)&nbsp;)&nbsp;!mm<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;!mm&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;methode&nbsp;=&nbsp;matrix_end_ode_runge_kutta_simple_adapt&nbsp;dormand_prince_8_5_3_a&nbsp;dormand_prince_8_5_3_b_fine&nbsp;dormand_prince_8_5_3_b_raw&nbsp;threshold&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;expm_ode&nbsp;methode&nbsp;15&nbsp;!mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;int_of_float&nbsp;iteration&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;!ww&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;exp&nbsp;zz&nbsp;)&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!ww&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>slow_tune_expm_bis threshold matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;slow_tune_expm_bis&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_trace&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;z&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;zz&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;m&nbsp;(&nbsp;<span class="constructor">Matrix</span>.scal_float&nbsp;n&nbsp;n&nbsp;zz&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;m&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;!mm<br>
</code><table><tr><td></td><td><span class="comment">(** The bias is tuned by experimenatl adjustment.
<p>

Le biais est ajusté empiriquement. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;biais&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;6.&nbsp;-.&nbsp;(&nbsp;floor&nbsp;(&nbsp;log_bin&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iteration&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;(&nbsp;ceil&nbsp;(&nbsp;log_bin&nbsp;zzz&nbsp;)&nbsp;)&nbsp;-.&nbsp;biais&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&gt;=&nbsp;1.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;2.&nbsp;**&nbsp;(&nbsp;-.&nbsp;iteration&nbsp;)&nbsp;)&nbsp;!mm<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;!mm&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;methode&nbsp;=&nbsp;matrix_end_ode_runge_kutta_simple_adapt&nbsp;dormand_prince_8_5_3_a&nbsp;dormand_prince_8_5_3_b_fine&nbsp;dormand_prince_8_5_3_b_raw&nbsp;threshold&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;expm_ode_bis&nbsp;methode&nbsp;15&nbsp;!mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;int_of_float&nbsp;iteration&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;!ww&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;exp&nbsp;zz&nbsp;)&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!ww&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>tune_expm threshold matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;tune_expm&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_trace&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;z&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;zz&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;m&nbsp;(&nbsp;<span class="constructor">Matrix</span>.scal_float&nbsp;n&nbsp;n&nbsp;zz&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;m&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;!mm<br>
</code><table><tr><td></td><td><span class="comment">(** The bias is tuned by experimenatl adjustment.
<p>

Le biais est ajusté empiriquement. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;biais&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;6.&nbsp;-.&nbsp;(&nbsp;floor&nbsp;(&nbsp;log_bin&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iteration&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;(&nbsp;ceil&nbsp;(&nbsp;log_bin&nbsp;zzz&nbsp;)&nbsp;)&nbsp;-.&nbsp;biais&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&gt;=&nbsp;1.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;2.&nbsp;**&nbsp;(&nbsp;-.&nbsp;iteration&nbsp;)&nbsp;)&nbsp;!mm<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;!mm&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;methode&nbsp;=&nbsp;matrix_end_ode_runge_kutta_simple_adapt&nbsp;rk7_dormand_prince_a&nbsp;rk7_dormand_prince_b_fine&nbsp;rk7_dormand_prince_b_raw&nbsp;threshold&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;expm_ode&nbsp;methode&nbsp;36&nbsp;!mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;int_of_float&nbsp;iteration&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;!ww&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;exp&nbsp;zz&nbsp;)&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!ww&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>tune_expm_bis threshold matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;tune_expm_bis&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;(threshold:float)&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_trace&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;z&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;zz&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;m&nbsp;(&nbsp;<span class="constructor">Matrix</span>.scal_float&nbsp;n&nbsp;n&nbsp;zz&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;m&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;!mm<br>
</code><table><tr><td></td><td><span class="comment">(** The bias is tuned by experimenatl adjustment.
<p>

Le biais est ajusté empiriquement. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;biais&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;6.&nbsp;-.&nbsp;(&nbsp;floor&nbsp;(&nbsp;log_bin&nbsp;(&nbsp;float&nbsp;n&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iteration&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;(&nbsp;ceil&nbsp;(&nbsp;log_bin&nbsp;zzz&nbsp;)&nbsp;)&nbsp;-.&nbsp;biais&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&gt;=&nbsp;1.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;2.&nbsp;**&nbsp;(&nbsp;-.&nbsp;iteration&nbsp;)&nbsp;)&nbsp;!mm<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;!mm&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;methode&nbsp;=&nbsp;matrix_end_ode_runge_kutta_simple_adapt&nbsp;rk7_dormand_prince_a&nbsp;rk7_dormand_prince_b_fine&nbsp;rk7_dormand_prince_b_raw&nbsp;threshold&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;expm_ode_bis&nbsp;methode&nbsp;36&nbsp;!mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;int_of_float&nbsp;iteration&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;!ww&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;exp&nbsp;zz&nbsp;)&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!ww&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>slow_direct_expm matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;slow_direct_expm&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_trace&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;z&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;float&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;zz&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;m&nbsp;(&nbsp;<span class="constructor">Matrix</span>.scal_float&nbsp;n&nbsp;n&nbsp;zz&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;m&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;!mm<br>
</code><table><tr><td></td><td><span class="comment">(** The bias is tuned by experimenatl adjustment.
<p>

Le biais est ajusté empiriquement. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;biais&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;ceil&nbsp;(&nbsp;9.9&nbsp;-.&nbsp;(&nbsp;log_bin&nbsp;nn&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iteration&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;(&nbsp;ceil&nbsp;(&nbsp;log_bin&nbsp;zzz&nbsp;)&nbsp;)&nbsp;-.&nbsp;biais&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&gt;=&nbsp;1.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;2.&nbsp;**&nbsp;(&nbsp;-.&nbsp;iteration&nbsp;)&nbsp;)&nbsp;!mm<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;!mm&nbsp;;<br>
</code><table><tr><td></td><td><span class="comment">(** The threshold is tuned by experimenatl adjustment.
<p>

Le seuil est ajusté empiriquement. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;threshold&nbsp;=&nbsp;min&nbsp;9e-1&nbsp;(&nbsp;zzz&nbsp;*.&nbsp;epsilon_float&nbsp;*.&nbsp;2.&nbsp;**&nbsp;(&nbsp;1e1&nbsp;*.&nbsp;nn&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;methode&nbsp;=&nbsp;matrix_end_ode_runge_kutta_simple_adapt&nbsp;dormand_prince_8_5_3_a&nbsp;dormand_prince_8_5_3_b_fine&nbsp;dormand_prince_8_5_3_b_raw&nbsp;threshold&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;[|&nbsp;expm_ode&nbsp;methode&nbsp;14&nbsp;!mmm&nbsp;;&nbsp;expm_ode&nbsp;methode&nbsp;20&nbsp;!mmm&nbsp;;&nbsp;expm_ode&nbsp;methode&nbsp;28&nbsp;!mmm&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_trans_float_approx&nbsp;w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;int_of_float&nbsp;iteration&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;!ww&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;exp&nbsp;zz&nbsp;)&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!ww&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>slow_direct_expm_bis matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;slow_direct_expm_bis&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_trace&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;z&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;float&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;zz&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;m&nbsp;(&nbsp;<span class="constructor">Matrix</span>.scal_float&nbsp;n&nbsp;n&nbsp;zz&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;m&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;!mm<br>
</code><table><tr><td></td><td><span class="comment">(** The bias is tuned by experimenatl adjustment.
<p>

Le biais est ajusté empiriquement. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;biais&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;ceil&nbsp;(&nbsp;9.9&nbsp;-.&nbsp;(&nbsp;log_bin&nbsp;nn&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iteration&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;(&nbsp;ceil&nbsp;(&nbsp;log_bin&nbsp;zzz&nbsp;)&nbsp;)&nbsp;-.&nbsp;biais&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&gt;=&nbsp;1.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;2.&nbsp;**&nbsp;(&nbsp;-.&nbsp;iteration&nbsp;)&nbsp;)&nbsp;!mm<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;!mm&nbsp;;<br>
</code><table><tr><td></td><td><span class="comment">(** The threshold is tuned by experimenatl adjustment.
<p>

Le seuil est ajusté empiriquement. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;threshold&nbsp;=&nbsp;min&nbsp;9e-1&nbsp;(&nbsp;zzz&nbsp;*.&nbsp;epsilon_float&nbsp;*.&nbsp;2.&nbsp;**&nbsp;(&nbsp;1e1&nbsp;*.&nbsp;nn&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;methode&nbsp;=&nbsp;matrix_end_ode_runge_kutta_simple_adapt&nbsp;dormand_prince_8_5_3_a&nbsp;dormand_prince_8_5_3_b_fine&nbsp;dormand_prince_8_5_3_b_raw&nbsp;threshold&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;[|&nbsp;expm_ode_bis&nbsp;methode&nbsp;14&nbsp;!mmm&nbsp;;&nbsp;expm_ode_bis&nbsp;methode&nbsp;20&nbsp;!mmm&nbsp;;&nbsp;expm_ode_bis&nbsp;methode&nbsp;28&nbsp;!mmm&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_trans_float_approx&nbsp;w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;int_of_float&nbsp;iteration&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;!ww&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;exp&nbsp;zz&nbsp;)&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!ww&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>direct_expm matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;direct_expm&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_trace&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;z&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;float&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;zz&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;m&nbsp;(&nbsp;<span class="constructor">Matrix</span>.scal_float&nbsp;n&nbsp;n&nbsp;zz&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;m&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;!mm<br>
</code><table><tr><td></td><td><span class="comment">(** The bias is tuned by experimenatl adjustment.
<p>

Le biais est ajusté empiriquement. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;biais&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;6.&nbsp;-.&nbsp;(&nbsp;floor&nbsp;(&nbsp;log_bin&nbsp;nn&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iteration&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;(&nbsp;ceil&nbsp;(&nbsp;log_bin&nbsp;zzz&nbsp;)&nbsp;)&nbsp;-.&nbsp;biais&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&gt;=&nbsp;1.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;2.&nbsp;**&nbsp;(&nbsp;-.&nbsp;iteration&nbsp;)&nbsp;)&nbsp;!mm<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;!mm&nbsp;;<br>
</code><table><tr><td></td><td><span class="comment">(** The threshold is tuned by experimenatl adjustment.
<p>

Le seuil est ajusté empiriquement. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;threshold&nbsp;=&nbsp;min&nbsp;9e-1&nbsp;(&nbsp;zzz&nbsp;*.&nbsp;epsilon_float&nbsp;*.&nbsp;2.&nbsp;**&nbsp;nn&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;methode&nbsp;=&nbsp;matrix_end_ode_runge_kutta_simple_adapt&nbsp;rk7_dormand_prince_a&nbsp;rk7_dormand_prince_b_fine&nbsp;rk7_dormand_prince_b_raw&nbsp;threshold&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;expm_ode&nbsp;methode&nbsp;36&nbsp;!mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;int_of_float&nbsp;iteration&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;!ww&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;exp&nbsp;zz&nbsp;)&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!ww&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>direct_expm_bis matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;direct_expm_bis&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;n&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;ww&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;ref&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;z&nbsp;=&nbsp;<span class="constructor">Matrix</span>.float_trace&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zz&nbsp;=&nbsp;z&nbsp;/.&nbsp;(&nbsp;float&nbsp;n&nbsp;)<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;nn&nbsp;=&nbsp;float&nbsp;n&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;zz&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_minus&nbsp;m&nbsp;(&nbsp;<span class="constructor">Matrix</span>.scal_float&nbsp;n&nbsp;n&nbsp;zz&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;mm&nbsp;:=&nbsp;m&nbsp;;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;zzz&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_norm_inf&nbsp;!mm<br>
</code><table><tr><td></td><td><span class="comment">(** The bias is tuned by experimenatl adjustment.
<p>

Le biais est ajusté empiriquement. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;biais&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;6.&nbsp;-.&nbsp;(&nbsp;floor&nbsp;(&nbsp;log_bin&nbsp;nn&nbsp;)&nbsp;)&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iteration&nbsp;=&nbsp;<span class="constructor">Util</span>.float_pos_part&nbsp;(&nbsp;(&nbsp;ceil&nbsp;(&nbsp;log_bin&nbsp;zzz&nbsp;)&nbsp;)&nbsp;-.&nbsp;biais&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&gt;=&nbsp;1.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;2.&nbsp;**&nbsp;(&nbsp;-.&nbsp;iteration&nbsp;)&nbsp;)&nbsp;!mm<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmm&nbsp;:=&nbsp;!mm&nbsp;;<br>
</code><table><tr><td></td><td><span class="comment">(** The threshold is tuned by experimenatl adjustment.
<p>

Le seuil est ajusté empiriquement. *)</span></td></tr></table><code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;threshold&nbsp;=&nbsp;min&nbsp;9e-1&nbsp;(&nbsp;zzz&nbsp;*.&nbsp;epsilon_float&nbsp;*.&nbsp;2.&nbsp;**&nbsp;nn&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;methode&nbsp;=&nbsp;matrix_end_ode_runge_kutta_simple_adapt&nbsp;rk7_dormand_prince_a&nbsp;rk7_dormand_prince_b_fine&nbsp;rk7_dormand_prince_b_raw&nbsp;threshold&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;expm_ode_bis&nbsp;methode&nbsp;36&nbsp;!mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;w&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;iteration&nbsp;&lt;&gt;&nbsp;0.&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;int_of_float&nbsp;iteration&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;!ww&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ww&nbsp;:=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(&nbsp;exp&nbsp;zz&nbsp;)&nbsp;!ww&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!ww&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>slow_expm matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;slow_expm&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;0.5&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(-0.5)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;slow_direct_expm&nbsp;mm<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;www&nbsp;=&nbsp;slow_direct_expm&nbsp;mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;inverse&nbsp;=&nbsp;<span class="constructor">Matrix</span>.aggressive_inv&nbsp;www&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;inverse&nbsp;ww&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>slow_expm_bis matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;slow_expm_bis&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;0.5&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(-0.5)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;slow_direct_expm_bis&nbsp;mm<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;www&nbsp;=&nbsp;slow_direct_expm_bis&nbsp;mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;inverse&nbsp;=&nbsp;<span class="constructor">Matrix</span>.aggressive_inv&nbsp;www&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;inverse&nbsp;ww&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>slow_expm_ter matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;slow_expm_ter&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;0.25&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(-0.5)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;slow_direct_expm&nbsp;mm<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;www&nbsp;=&nbsp;slow_direct_expm&nbsp;mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;inverse&nbsp;=&nbsp;<span class="constructor">Matrix</span>.aggressive_inv&nbsp;www&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_triple_prod&nbsp;ww&nbsp;inverse&nbsp;ww&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>slow_expm_quater matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;slow_expm_quater&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;0.25&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(-0.5)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;slow_direct_expm_bis&nbsp;mm<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;www&nbsp;=&nbsp;slow_direct_expm_bis&nbsp;mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;inverse&nbsp;=&nbsp;<span class="constructor">Matrix</span>.aggressive_inv&nbsp;www&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_triple_prod&nbsp;ww&nbsp;inverse&nbsp;ww&nbsp;;;<br>
<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>expm matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;expm&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;0.5&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(-0.5)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;direct_expm&nbsp;mm<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;www&nbsp;=&nbsp;direct_expm&nbsp;mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;inverse&nbsp;=&nbsp;<span class="constructor">Matrix</span>.clean_inv&nbsp;www&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;inverse&nbsp;ww&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>expm_bis matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;expm_bis&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;0.5&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(-0.5)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;direct_expm_bis&nbsp;mm<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;www&nbsp;=&nbsp;direct_expm_bis&nbsp;mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;inverse&nbsp;=&nbsp;<span class="constructor">Matrix</span>.clean_inv&nbsp;www&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_prod&nbsp;inverse&nbsp;ww&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>expm_ter matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;expm_ter&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;0.25&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(-0.5)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;direct_expm&nbsp;mm<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;www&nbsp;=&nbsp;direct_expm&nbsp;mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;inverse&nbsp;=&nbsp;<span class="constructor">Matrix</span>.clean_inv&nbsp;www&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_triple_prod&nbsp;ww&nbsp;inverse&nbsp;ww&nbsp;;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>expm_quater matrix</pre> *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;expm_quater&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;(m:float&nbsp;array&nbsp;array)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;mm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;0.25&nbsp;m<br>
&nbsp;<span class="keyword">and</span>&nbsp;mmm&nbsp;=&nbsp;<span class="constructor">Matrix</span>.matrix_float_scal_mult&nbsp;(-0.5)&nbsp;m&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ww&nbsp;=&nbsp;direct_expm_bis&nbsp;mm<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;www&nbsp;=&nbsp;direct_expm_bis&nbsp;mmm&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;inverse&nbsp;=&nbsp;<span class="constructor">Matrix</span>.clean_inv&nbsp;www&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.matrix_float_triple_prod&nbsp;ww&nbsp;inverse&nbsp;ww&nbsp;;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>curv_absc methode_diff methode_int function x y</pre> The (unidimensional) derivating method <code class="code">methode_diff</code> must contain the parameters, including the step.
The integrating method <code class="code">methode_int</code> must contain all the needed parameters.
<p>

La méthode de dérivation (unidimensionnelle) <code class="code">methode_diff</code> doit contenir les paramètres, y compris le pas.
La méthode d'intégration <code class="code">methode_int</code> doit contenir tous les paramaètres nécessaires. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;curv_absc&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_diff&nbsp;methode_int&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(x:float)&nbsp;(y:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;vector_speed&nbsp;methode_diff&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;(&nbsp;g&nbsp;z&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;methode_int&nbsp;h&nbsp;x&nbsp;y&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>developpante methode_diff methode_int function parameter beginning real</pre> The (unidimensional) derivating method <code class="code">methode_diff</code> must contain the parameters, including the step.
The integrating method <code class="code">methode_int</code> must contain all the needed parameters.
<p>

La méthode de dérivation (unidimensionnelle) <code class="code">methode_diff</code> doit contenir les paramètres, y compris le pas.
La méthode d'intégration <code class="code">methode_int</code> doit contenir tous les paramaètres nécessaires. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;developpante&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode_diff&nbsp;methode_int&nbsp;(f:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;(parameter:float)&nbsp;(beginning:float)&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;vector_speed&nbsp;methode_diff&nbsp;f&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;h&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_norm_2&nbsp;(&nbsp;g&nbsp;z&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;k&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;z&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_left_div&nbsp;(&nbsp;h&nbsp;z&nbsp;)&nbsp;(&nbsp;g&nbsp;z&nbsp;)<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;s&nbsp;=&nbsp;methode_int&nbsp;h&nbsp;beginning&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Matrix</span>.vector_float_plus&nbsp;(&nbsp;f&nbsp;x&nbsp;)&nbsp;(&nbsp;<span class="constructor">Matrix</span>.vector_float_scal_mult&nbsp;(&nbsp;parameter&nbsp;-.&nbsp;s&nbsp;)&nbsp;(&nbsp;k&nbsp;x&nbsp;)&nbsp;)&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>prescribed_curvature_2 methode function nsteps beginning ending</pre> The vectorial ordinary differential equations solving method <code class="code">methode</code> may either
give all the steps or only the final value.
<p>

La méthode de résolution d'équations différentielles ordinaires vectorielles <code class="code">methode</code> peut soit donner tous les pas soit donner seulement la valeur finale. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;prescribed_curvature_2&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(kappa:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;nsteps&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;v.(2)&nbsp;;&nbsp;v.(3)&nbsp;;&nbsp;-.&nbsp;(&nbsp;kappa&nbsp;x&nbsp;)&nbsp;*.&nbsp;v.(3)&nbsp;;&nbsp;(&nbsp;kappa&nbsp;x&nbsp;)&nbsp;*.&nbsp;v.(2)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;beginning&nbsp;ending&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>prescribed_curvature_torsion_3 methode function nsteps beginning ending</pre> The vectorial ordinary differential equations solving method <code class="code">methode</code> may either
give all the steps or only the final value.
<p>

La méthode de résolution d'équations différentielles ordinaires vectorielles <code class="code">methode</code> peut soit donner tous les pas soit donner seulement la valeur finale. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;prescribed_curvature_torsion_3&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(kappa:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;(tau:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float)&nbsp;nsteps&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;[|&nbsp;v.(3)&nbsp;;&nbsp;v.(4)&nbsp;;&nbsp;v.(5)&nbsp;;&nbsp;(&nbsp;kappa&nbsp;x&nbsp;)&nbsp;*.&nbsp;v.(4)&nbsp;;&nbsp;-.&nbsp;(&nbsp;kappa&nbsp;x&nbsp;)&nbsp;*.&nbsp;v.(3)&nbsp;+.&nbsp;(&nbsp;tau&nbsp;x&nbsp;)&nbsp;*.&nbsp;v.(5)&nbsp;;&nbsp;-.&nbsp;(&nbsp;tau&nbsp;x&nbsp;)&nbsp;*.&nbsp;v.(4)&nbsp;|]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;[|&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;;&nbsp;1.&nbsp;;&nbsp;0.&nbsp;;&nbsp;0.&nbsp;|]&nbsp;beginning&nbsp;ending&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>prescribed_multicurvature methode function nsteps beginning ending</pre> The vectorial ordinary differential equations solving method <code class="code">methode</code> may either
give all the steps or only the final value.
<p>

La méthode de résolution d'équations différentielles ordinaires vectorielles <code class="code">methode</code> peut soit donner tous les pas soit donner seulement la valeur finale. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;prescribed_multicurvature&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(kappa:float&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;float&nbsp;array)&nbsp;nsteps&nbsp;(beginning:float)&nbsp;(ending:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;<span class="constructor">Array</span>.length&nbsp;(&nbsp;kappa&nbsp;beginning&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;ll&nbsp;=&nbsp;l&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;lll&nbsp;=&nbsp;l&nbsp;-&nbsp;1&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;r&nbsp;=&nbsp;2&nbsp;*&nbsp;ll&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;x&nbsp;v&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;w&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;0&nbsp;<span class="keyword">to</span>&nbsp;l&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w.(i)&nbsp;&lt;-&nbsp;v.(&nbsp;ll&nbsp;+&nbsp;i&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w.(ll)&nbsp;&lt;-&nbsp;(&nbsp;kappa&nbsp;x&nbsp;).(0)&nbsp;*.&nbsp;v.(&nbsp;ll&nbsp;+&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w.(&nbsp;ll&nbsp;+&nbsp;l&nbsp;)&nbsp;&lt;-&nbsp;-.&nbsp;(&nbsp;kappa&nbsp;x&nbsp;).(lll)&nbsp;*.&nbsp;v.(&nbsp;l&nbsp;+&nbsp;l&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;i&nbsp;=&nbsp;1&nbsp;<span class="keyword">to</span>&nbsp;lll&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w.(&nbsp;ll&nbsp;+&nbsp;i&nbsp;)&nbsp;&lt;-&nbsp;-.&nbsp;(&nbsp;kappa&nbsp;x&nbsp;).(&nbsp;i&nbsp;-&nbsp;1&nbsp;)&nbsp;*.&nbsp;v.(&nbsp;l&nbsp;+&nbsp;i&nbsp;)&nbsp;+.&nbsp;(&nbsp;kappa&nbsp;x&nbsp;).(i)&nbsp;*.&nbsp;v.(&nbsp;ll&nbsp;+&nbsp;i&nbsp;+&nbsp;1&nbsp;)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">and</span>&nbsp;init&nbsp;=&nbsp;<span class="constructor">Array</span>.make&nbsp;r&nbsp;0.&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;init.(ll)&nbsp;&lt;-&nbsp;1.&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;methode&nbsp;f&nbsp;nsteps&nbsp;init&nbsp;beginning&nbsp;ending&nbsp;;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <pre>clothoid methode real</pre> The method <code class="code">methode</code> is that of one-dimensional integration.
<p>

La méthode <code class="code">methode</code> est celle d'intégration unidimensionnelle. *)</span></td></tr></table><code class="code"><br>
<span class="keyword">let</span>&nbsp;clothoid&nbsp;=&nbsp;<span class="keyword">fun</span>&nbsp;methode&nbsp;(x:float)&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;s&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;cos&nbsp;(&nbsp;s&nbsp;*.&nbsp;s&nbsp;)<br>
&nbsp;<span class="keyword">and</span>&nbsp;g&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;s&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;sin&nbsp;(s&nbsp;*.&nbsp;s&nbsp;)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;[|&nbsp;methode&nbsp;f&nbsp;0.&nbsp;x&nbsp;;&nbsp;methode&nbsp;g&nbsp;0.&nbsp;x&nbsp;|]&nbsp;;;<br>
<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <center>§ § § </center> *)</span></td></tr></table><code class="code"><br>
<br>
<br>
<br>
<br>
<span class="keyword">end</span></code></body></html>